(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[137],{5885:function(e,t,s){Promise.resolve().then(s.bind(s,5553))},9205:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var a=s(2265);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:o="",children:h,iconNode:u,...x}=e;return(0,a.createElement)("svg",{ref:t,...d,width:r,height:r,stroke:s,strokeWidth:n?24*Number(l)/Number(r):l,className:i("lucide",o),...!h&&!c(x)&&{"aria-hidden":"true"},...x},[...u.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(h)?h:[h]])}),h=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:c,...d}=s;return(0,a.createElement)(o,{ref:l,iconNode:t,className:i("lucide-".concat(r(n(e))),"lucide-".concat(e),c),...d})});return s.displayName=n(e),s}},4401:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},8420:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},6215:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},2451:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9322:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},7486:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("hand-coins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]])},1817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7692:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},6865:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},1804:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5553:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Z}});var a=s(7437),r=s(2265),l=s(9376),n=s(1671),i=s(9322),c=s(9205);let d=(0,c.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=s(1723),h=s(7486),u=s(6215),x=s(5805),m=s(1804),p=s(4401),f=s(7692),b=s(407);let j=(0,c.Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),y=(0,c.Z)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var N=s(1817),g=s(6865),v=s(8420),w=s(2451);function k(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),[s,c]=(0,r.useState)(null),[k,Z]=(0,r.useState)(null),[S,A]=(0,r.useState)([]),[M,E]=(0,r.useState)(0),[C,D]=(0,r.useState)(!0),[P,I]=(0,r.useState)(null),[R,T]=(0,r.useState)(t.get("status")||""),[V,L]=(0,r.useState)(t.get("sort")||"referredAt"),[_,z]=(0,r.useState)("desc"),[U,O]=(0,r.useState)(0);async function q(){try{let t=await fetch("/api/auth/session"),s=await t.json();if(!s.authenticated){e.push("/login");return}c(s.user);let a=await fetch("/api/partners/me"),r=await a.json();if(!r.success||!r.partnerId){I("You are not associated with a partner organization"),D(!1);return}Z(r.partnerId)}catch(e){I("Failed to load data"),D(!1)}}async function H(){D(!0);try{let e=new URLSearchParams;R&&e.set("status",R),e.set("sortBy",V),e.set("sortOrder",_),e.set("limit","20"),e.set("offset",U.toString());let t=await fetch("/api/partners/".concat(k,"/dashboard/referrals?").concat(e)),s=await t.json();s.error?I(s.error):(A(s.tenants||[]),E(s.total||0))}catch(e){I("Failed to load referrals")}finally{D(!1)}}async function F(){await fetch("/api/auth/logout",{method:"POST"}),e.push("/login")}(0,r.useEffect)(()=>{q()},[]),(0,r.useEffect)(()=>{k&&H()},[k,R,V,_,U]);let G=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(e),W=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),B=e=>{switch(e.toUpperCase()){case"ACTIVE":return(0,a.jsx)(n.Z,{className:"w-4 h-4 text-emerald-400"});case"PENDING":case"PENDING_ACTIVATION":return(0,a.jsx)(i.Z,{className:"w-4 h-4 text-amber-400"});case"SUSPENDED":return(0,a.jsx)(d,{className:"w-4 h-4 text-red-400"});default:return(0,a.jsx)(o.Z,{className:"w-4 h-4 text-slate-400"})}},$=e=>{switch(e.toUpperCase()){case"ACTIVE":return"bg-emerald-500/20 text-emerald-400 border-emerald-500/30";case"PENDING":case"PENDING_ACTIVATION":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"SUSPENDED":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}},Y=Math.ceil(M/20);return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-900 text-white",children:[(0,a.jsxs)("aside",{className:"fixed left-0 top-0 h-full w-64 bg-slate-800 border-r border-slate-700 z-40",children:[(0,a.jsx)("div",{className:"p-6 border-b border-slate-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center",children:(0,a.jsx)(h.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold",children:"Partner Portal"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Referrals"})]})]})}),(0,a.jsx)("nav",{className:"p-4",children:(0,a.jsx)("ul",{className:"space-y-2",children:[{icon:u.Z,label:"Dashboard",href:"/partner"},{icon:x.Z,label:"Referrals",href:"/partner/referrals",active:!0},{icon:m.Z,label:"Earnings",href:"/partner/earnings"},{icon:p.Z,label:"Audit Log",href:"/partner/audit"}].map((e,t)=>(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:e.href,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl transition ".concat(e.active?"bg-indigo-600/20 text-indigo-400":"text-slate-400 hover:bg-slate-700/50 hover:text-white"),children:[(0,a.jsx)(e.icon,{className:"w-5 h-5"}),e.label]})},t))})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-slate-700",children:(0,a.jsxs)("button",{onClick:F,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-700/50 hover:text-white transition",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5"}),"Sign Out"]})})]}),(0,a.jsxs)("main",{className:"ml-64 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 text-sm mb-2",children:[(0,a.jsx)("a",{href:"/partner",className:"hover:text-white transition",children:"Dashboard"}),(0,a.jsx)(b.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-white",children:"Referrals"})]}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Referrals"}),(0,a.jsx)("p",{className:"text-slate-400 mt-1",children:"View and track all your referred tenants"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:M}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Total Referrals"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j,{className:"w-4 h-4 text-slate-500"}),(0,a.jsxs)("select",{value:R,onChange:e=>{T(e.target.value),O(0)},className:"px-4 py-2 bg-slate-800 border border-slate-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 outline-none",children:[(0,a.jsx)("option",{value:"",children:"All Status"}),(0,a.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,a.jsx)("option",{value:"PENDING_ACTIVATION",children:"Pending"}),(0,a.jsx)("option",{value:"SUSPENDED",children:"Suspended"}),(0,a.jsx)("option",{value:"DEACTIVATED",children:"Churned"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{className:"w-4 h-4 text-slate-500"}),(0,a.jsxs)("select",{value:V,onChange:e=>L(e.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 outline-none",children:[(0,a.jsx)("option",{value:"referredAt",children:"Date Referred"}),(0,a.jsx)("option",{value:"revenue",children:"Revenue"})]}),(0,a.jsx)("button",{onClick:()=>z("asc"===_?"desc":"asc"),className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded-xl hover:bg-slate-700 transition",children:"asc"===_?"↑":"↓"})]})]}),C?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(N.Z,{className:"w-8 h-8 animate-spin text-indigo-500"})}):P?(0,a.jsxs)("div",{className:"text-center py-20 text-red-400",children:[(0,a.jsx)(g.Z,{className:"w-12 h-12 mx-auto mb-4"}),(0,a.jsx)("p",{children:P})]}):0===S.length?(0,a.jsxs)("div",{className:"text-center py-20 bg-slate-800/50 rounded-2xl border border-slate-700 border-dashed",children:[(0,a.jsx)(v.Z,{className:"w-16 h-16 mx-auto text-slate-600 mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No referrals found"}),(0,a.jsx)("p",{className:"text-slate-400",children:R?"Try adjusting your filters":"Start referring tenants to see them here"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,a.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Tenant"}),(0,a.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Status"}),(0,a.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Referred"}),(0,a.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Attribution"}),(0,a.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Revenue"})]})}),(0,a.jsx)("tbody",{children:S.map(e=>(0,a.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-indigo-500/20 text-indigo-400 flex items-center justify-center font-bold",children:e.tenantName.charAt(0)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.tenantName}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:e.tenantSlug})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium border ".concat($(e.tenantStatus)),children:[B(e.tenantStatus),e.tenantStatus.replace("_"," ")]})}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("p",{className:"text-sm",children:W(e.referredAt)}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:e.attributionMethod.replace("_"," ")})]}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.isLifetime?(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-purple-500/20 text-purple-400",children:"Lifetime"}):e.attributionExpiresAt?(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:["Expires ",W(e.attributionExpiresAt)]}):(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"-"})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-right",children:[(0,a.jsx)("p",{className:"font-semibold text-emerald-400",children:G(e.totalRevenue)}),e.lastPaymentDate&&(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["Last: ",W(e.lastPaymentDate)]})]})]},e.referralId))})]})}),Y>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-400",children:["Showing ",U+1," to ",Math.min(U+20,M)," of ",M," referrals"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>O(Math.max(0,U-20)),disabled:0===U,className:"p-2 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(w.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("span",{className:"px-4 py-2 text-sm",children:["Page ",Math.floor(U/20)+1," of ",Y]}),(0,a.jsx)("button",{onClick:()=>O(U+20),disabled:U+20>=M,className:"p-2 bg-slate-800 border border-slate-700 rounded-lg hover:bg-slate-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(b.Z,{className:"w-5 h-5"})})]})]})]})]})]})}function Z(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:(0,a.jsx)(N.Z,{className:"w-10 h-10 animate-spin text-indigo-500"})}),children:(0,a.jsx)(k,{})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5885)}),_N_E=e.O()}]);