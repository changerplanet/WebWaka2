{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/saas-core/src/lib/tenant-context.ts"],"sourcesContent":["import { Tenant, TenantBranding } from '@prisma/client'\n\nexport type TenantWithBranding = Tenant & {\n  branding: TenantBranding | null\n}\n\n// Default branding for when no tenant is resolved (super admin view)\nexport const DEFAULT_BRANDING: TenantBranding = {\n  id: 'default',\n  tenantId: 'default',\n  appName: 'SaaS Core',\n  logoUrl: null,\n  faviconUrl: null,\n  primaryColor: '#6366f1',\n  secondaryColor: '#8b5cf6',\n}\n\n// Tenant context header name\nexport const TENANT_HEADER = 'x-tenant-id'\nexport const TENANT_SLUG_HEADER = 'x-tenant-slug'\n"],"names":[],"mappings":";;;;;;;;AAOO,MAAM,mBAAmC;IAC9C,IAAI;IACJ,UAAU;IACV,SAAS;IACT,SAAS;IACT,YAAY;IACZ,cAAc;IACd,gBAAgB;AAClB;AAGO,MAAM,gBAAgB;AACtB,MAAM,qBAAqB"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/saas-core/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\nimport { TENANT_HEADER, TENANT_SLUG_HEADER } from './lib/tenant-context'\n\n// Paths that don't require tenant resolution\nconst PUBLIC_PATHS = ['/api/health', '/api/tenants', '/api/auth', '/_next', '/favicon.ico']\nconst SUPER_ADMIN_PATHS = ['/super-admin']\n\nexport async function middleware(request: NextRequest) {\n  const { pathname, hostname } = request.nextUrl\n  \n  // Skip middleware for static files and public paths\n  if (PUBLIC_PATHS.some(path => pathname.startsWith(path))) {\n    return NextResponse.next()\n  }\n  \n  // For development/preview, we use query param or header for tenant\n  // In production, subdomain/custom domain resolution happens here\n  \n  const host = hostname || request.headers.get('host') || ''\n  const parts = host.split(':')[0].split('.')\n  \n  // Clone the response to add headers\n  const response = NextResponse.next()\n  \n  // Try to extract tenant from subdomain\n  if (parts.length >= 3) {\n    const potentialSlug = parts[0]\n    // Skip common non-tenant subdomains\n    if (!['www', 'api', 'app', 'admin', 'preview', 'localhost'].includes(potentialSlug)) {\n      response.headers.set(TENANT_SLUG_HEADER, potentialSlug)\n    }\n  }\n  \n  // Check for tenant in query param (for testing/preview)\n  const tenantSlug = request.nextUrl.searchParams.get('tenant')\n  if (tenantSlug) {\n    response.headers.set(TENANT_SLUG_HEADER, tenantSlug)\n  }\n  \n  // Check for tenant in cookie\n  const tenantCookie = request.cookies.get('tenant_slug')?.value\n  if (tenantCookie && !response.headers.get(TENANT_SLUG_HEADER)) {\n    response.headers.set(TENANT_SLUG_HEADER, tenantCookie)\n  }\n  \n  return response\n}\n\nexport const config = {\n  matcher: [\n    // Match all paths except static files\n    '/((?!_next/static|_next/image|favicon.ico).*)',\n  ],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEA,6CAA6C;AAC7C,MAAM,eAAe;IAAC;IAAe;IAAgB;IAAa;IAAU;CAAe;AAC3F,MAAM,oBAAoB;IAAC;CAAe;AAEnC,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAE9C,oDAAoD;IACpD,IAAI,aAAa,IAAI,CAAC,CAAA,OAAQ,SAAS,UAAU,CAAC,QAAQ;QACxD,OAAO,gNAAY,CAAC,IAAI;IAC1B;IAEA,mEAAmE;IACnE,iEAAiE;IAEjE,MAAM,OAAO,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IACxD,MAAM,QAAQ,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;IAEvC,oCAAoC;IACpC,MAAM,WAAW,gNAAY,CAAC,IAAI;IAElC,uCAAuC;IACvC,IAAI,MAAM,MAAM,IAAI,GAAG;QACrB,MAAM,gBAAgB,KAAK,CAAC,EAAE;QAC9B,oCAAoC;QACpC,IAAI,CAAC;YAAC;YAAO;YAAO;YAAO;YAAS;YAAW;SAAY,CAAC,QAAQ,CAAC,gBAAgB;YACnF,SAAS,OAAO,CAAC,GAAG,CAAC,6KAAkB,EAAE;QAC3C;IACF;IAEA,wDAAwD;IACxD,MAAM,aAAa,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;IACpD,IAAI,YAAY;QACd,SAAS,OAAO,CAAC,GAAG,CAAC,6KAAkB,EAAE;IAC3C;IAEA,6BAA6B;IAC7B,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;IACzD,IAAI,gBAAgB,CAAC,SAAS,OAAO,CAAC,GAAG,CAAC,6KAAkB,GAAG;QAC7D,SAAS,OAAO,CAAC,GAAG,CAAC,6KAAkB,EAAE;IAC3C;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QACP,sCAAsC;QACtC;KACD;AACH"}}]
}