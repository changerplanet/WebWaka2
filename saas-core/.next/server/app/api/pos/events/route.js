"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/pos/events/route";
exports.ids = ["app/api/pos/events/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "./action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "./request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "./static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpos%2Fevents%2Froute&page=%2Fapi%2Fpos%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpos%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpos%2Fevents%2Froute&page=%2Fapi%2Fpos%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpos%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_pos_events_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/pos/events/route.ts */ \"(rsc)/./src/app/api/pos/events/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/pos/events/route\",\n        pathname: \"/api/pos/events\",\n        filename: \"route\",\n        bundlePath: \"app/api/pos/events/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/pos/events/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_pos_events_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/pos/events/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwb3MlMkZldmVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnBvcyUyRmV2ZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnBvcyUyRmV2ZW50cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDRjtBQUMzRTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/MmM3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9wb3MvZXZlbnRzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9wb3MvZXZlbnRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcG9zL2V2ZW50c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcG9zL2V2ZW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL3Bvcy9ldmVudHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3Bvcy9ldmVudHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpos%2Fevents%2Froute&page=%2Fapi%2Fpos%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpos%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/pos/events/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/pos/events/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_pos_event_handlers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/pos-event-handlers */ \"(rsc)/./src/lib/pos-event-handlers.ts\");\n/**\n * POS Events API\n * \n * POST /api/pos/events - Receive events from POS module\n * \n * This endpoint receives events from the POS module (either directly\n * or via the offline sync queue) and routes them to the appropriate handlers.\n */ \n\nasync function POST(request) {\n    try {\n        const event = await request.json();\n        // Validate event structure\n        if (!event.eventType || !event.eventId || !event.idempotencyKey || !event.payload) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid event structure\"\n            }, {\n                status: 400\n            });\n        }\n        // Process the event\n        const result = await (0,_lib_pos_event_handlers__WEBPACK_IMPORTED_MODULE_1__.handlePOSEvent)(event);\n        if (result.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                eventId: event.eventId,\n                processed: true\n            });\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: result.error\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error processing POS event:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wb3MvZXZlbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7O0NBT0MsR0FFc0Q7QUFDRTtBQUVsRCxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsUUFBUSxNQUFNRCxRQUFRRSxJQUFJO1FBRWhDLDJCQUEyQjtRQUMzQixJQUFJLENBQUNELE1BQU1FLFNBQVMsSUFBSSxDQUFDRixNQUFNRyxPQUFPLElBQUksQ0FBQ0gsTUFBTUksY0FBYyxJQUFJLENBQUNKLE1BQU1LLE9BQU8sRUFBRTtZQUNqRixPQUFPVCxxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtnQkFBRUssU0FBUztnQkFBT0MsT0FBTztZQUEwQixHQUNuRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1DLFNBQVMsTUFBTVosdUVBQWNBLENBQUNHO1FBRXBDLElBQUlTLE9BQU9ILE9BQU8sRUFBRTtZQUNsQixPQUFPVixxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDO2dCQUN2QkssU0FBUztnQkFDVEgsU0FBU0gsTUFBTUcsT0FBTztnQkFDdEJPLFdBQVc7WUFDYjtRQUNGLE9BQU87WUFDTCxPQUFPZCxxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtnQkFBRUssU0FBUztnQkFBT0MsT0FBT0UsT0FBT0YsS0FBSztZQUFDLEdBQ3RDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7SUFDRixFQUFFLE9BQU9ELE9BQU87UUFDZEksUUFBUUosS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBT1gscURBQVlBLENBQUNLLElBQUksQ0FDdEI7WUFBRUssU0FBUztZQUFPQyxPQUFPO1FBQXdCLEdBQ2pEO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2FwcC9hcGkvcG9zL2V2ZW50cy9yb3V0ZS50cz9lZTU2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUE9TIEV2ZW50cyBBUElcbiAqIFxuICogUE9TVCAvYXBpL3Bvcy9ldmVudHMgLSBSZWNlaXZlIGV2ZW50cyBmcm9tIFBPUyBtb2R1bGVcbiAqIFxuICogVGhpcyBlbmRwb2ludCByZWNlaXZlcyBldmVudHMgZnJvbSB0aGUgUE9TIG1vZHVsZSAoZWl0aGVyIGRpcmVjdGx5XG4gKiBvciB2aWEgdGhlIG9mZmxpbmUgc3luYyBxdWV1ZSkgYW5kIHJvdXRlcyB0aGVtIHRvIHRoZSBhcHByb3ByaWF0ZSBoYW5kbGVycy5cbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBoYW5kbGVQT1NFdmVudCB9IGZyb20gJ0AvbGliL3Bvcy1ldmVudC1oYW5kbGVycydcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBldmVudCA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG5cbiAgICAvLyBWYWxpZGF0ZSBldmVudCBzdHJ1Y3R1cmVcbiAgICBpZiAoIWV2ZW50LmV2ZW50VHlwZSB8fCAhZXZlbnQuZXZlbnRJZCB8fCAhZXZlbnQuaWRlbXBvdGVuY3lLZXkgfHwgIWV2ZW50LnBheWxvYWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIGV2ZW50IHN0cnVjdHVyZScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyB0aGUgZXZlbnRcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVQT1NFdmVudChldmVudClcblxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZXZlbnRJZDogZXZlbnQuZXZlbnRJZCxcbiAgICAgICAgcHJvY2Vzc2VkOiB0cnVlXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiByZXN1bHQuZXJyb3IgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgUE9TIGV2ZW50OicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiaGFuZGxlUE9TRXZlbnQiLCJQT1NUIiwicmVxdWVzdCIsImV2ZW50IiwianNvbiIsImV2ZW50VHlwZSIsImV2ZW50SWQiLCJpZGVtcG90ZW5jeUtleSIsInBheWxvYWQiLCJzdWNjZXNzIiwiZXJyb3IiLCJzdGF0dXMiLCJyZXN1bHQiLCJwcm9jZXNzZWQiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/pos/events/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/audit.ts":
/*!**************************!*\
  !*** ./src/lib/audit.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuditLog: () => (/* binding */ createAuditLog),\n/* harmony export */   getAuditLogs: () => (/* binding */ getAuditLogs)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n/**\n * Create an audit log entry\n */ async function createAuditLog(input) {\n    try {\n        const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.headers)();\n        const ipAddress = headersList.get(\"x-forwarded-for\") || headersList.get(\"x-real-ip\") || \"unknown\";\n        const userAgent = headersList.get(\"user-agent\") || \"unknown\";\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                action: input.action,\n                actorId: input.actorId,\n                actorEmail: input.actorEmail,\n                tenantId: input.tenantId || null,\n                targetType: input.targetType || null,\n                targetId: input.targetId || null,\n                metadata: input.metadata || undefined,\n                ipAddress,\n                userAgent\n            }\n        });\n    } catch (error) {\n        console.error(\"Failed to create audit log:\", error);\n    // Don't throw - audit logging should not break operations\n    }\n}\n/**\n * Get audit logs for a tenant\n */ async function getAuditLogs(options) {\n    const { tenantId, actorId, action, targetType, limit = 50, offset = 0 } = options;\n    const where = {};\n    if (tenantId) where.tenantId = tenantId;\n    if (actorId) where.actorId = actorId;\n    if (action) where.action = action;\n    if (targetType) where.targetType = targetType;\n    const [logs, total] = await Promise.all([\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n            where,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: limit,\n            skip: offset\n        }),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.count({\n            where\n        })\n    ]);\n    return {\n        logs,\n        total\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1ZGl0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWlDO0FBRUU7QUFDRztBQVl0Qzs7Q0FFQyxHQUNNLGVBQWVJLGVBQWVDLEtBQW9CO0lBQ3ZELElBQUk7UUFDRixNQUFNQyxjQUFjLE1BQU1ILHFEQUFPQTtRQUNqQyxNQUFNSSxZQUFZRCxZQUFZRSxHQUFHLENBQUMsc0JBQXNCRixZQUFZRSxHQUFHLENBQUMsZ0JBQWdCO1FBQ3hGLE1BQU1DLFlBQVlILFlBQVlFLEdBQUcsQ0FBQyxpQkFBaUI7UUFFbkQsTUFBTVIsMkNBQU1BLENBQUNVLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDO1lBQzNCQyxNQUFNO2dCQUNKQyxJQUFJWCxnREFBTUE7Z0JBQ1ZZLFFBQVFULE1BQU1TLE1BQU07Z0JBQ3BCQyxTQUFTVixNQUFNVSxPQUFPO2dCQUN0QkMsWUFBWVgsTUFBTVcsVUFBVTtnQkFDNUJDLFVBQVVaLE1BQU1ZLFFBQVEsSUFBSTtnQkFDNUJDLFlBQVliLE1BQU1hLFVBQVUsSUFBSTtnQkFDaENDLFVBQVVkLE1BQU1jLFFBQVEsSUFBSTtnQkFDNUJDLFVBQVVmLE1BQU1lLFFBQVEsSUFBSUM7Z0JBQzVCZDtnQkFDQUU7WUFDRjtRQUNGO0lBQ0YsRUFBRSxPQUFPYSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywrQkFBK0JBO0lBQzdDLDBEQUEwRDtJQUM1RDtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlRSxhQUFhQyxPQU9sQztJQUNDLE1BQU0sRUFBRVIsUUFBUSxFQUFFRixPQUFPLEVBQUVELE1BQU0sRUFBRUksVUFBVSxFQUFFUSxRQUFRLEVBQUUsRUFBRUMsU0FBUyxDQUFDLEVBQUUsR0FBR0Y7SUFFMUUsTUFBTUcsUUFBYSxDQUFDO0lBQ3BCLElBQUlYLFVBQVVXLE1BQU1YLFFBQVEsR0FBR0E7SUFDL0IsSUFBSUYsU0FBU2EsTUFBTWIsT0FBTyxHQUFHQTtJQUM3QixJQUFJRCxRQUFRYyxNQUFNZCxNQUFNLEdBQUdBO0lBQzNCLElBQUlJLFlBQVlVLE1BQU1WLFVBQVUsR0FBR0E7SUFFbkMsTUFBTSxDQUFDVyxNQUFNQyxNQUFNLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO1FBQ3RDaEMsMkNBQU1BLENBQUNVLFFBQVEsQ0FBQ3VCLFFBQVEsQ0FBQztZQUN2Qkw7WUFDQU0sU0FBUztnQkFBRUMsV0FBVztZQUFPO1lBQzdCQyxNQUFNVjtZQUNOVyxNQUFNVjtRQUNSO1FBQ0EzQiwyQ0FBTUEsQ0FBQ1UsUUFBUSxDQUFDNEIsS0FBSyxDQUFDO1lBQUVWO1FBQU07S0FDL0I7SUFFRCxPQUFPO1FBQUVDO1FBQU1DO0lBQU07QUFDdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL2F1ZGl0LnRzP2Y0NjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnXG5pbXBvcnQgeyBBdWRpdEFjdGlvbiB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCdcbmltcG9ydCB7IGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmludGVyZmFjZSBBdWRpdExvZ0lucHV0IHtcbiAgYWN0aW9uOiBBdWRpdEFjdGlvblxuICBhY3RvcklkOiBzdHJpbmdcbiAgYWN0b3JFbWFpbDogc3RyaW5nXG4gIHRlbmFudElkPzogc3RyaW5nIHwgbnVsbFxuICB0YXJnZXRUeXBlPzogc3RyaW5nXG4gIHRhcmdldElkPzogc3RyaW5nXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxufVxuXG4vKipcbiAqIENyZWF0ZSBhbiBhdWRpdCBsb2cgZW50cnlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUF1ZGl0TG9nKGlucHV0OiBBdWRpdExvZ0lucHV0KTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgaGVhZGVyc0xpc3QgPSBhd2FpdCBoZWFkZXJzKClcbiAgICBjb25zdCBpcEFkZHJlc3MgPSBoZWFkZXJzTGlzdC5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IGhlYWRlcnNMaXN0LmdldCgneC1yZWFsLWlwJykgfHwgJ3Vua25vd24nXG4gICAgY29uc3QgdXNlckFnZW50ID0gaGVhZGVyc0xpc3QuZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXG4gICAgXG4gICAgYXdhaXQgcHJpc21hLmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgYWN0aW9uOiBpbnB1dC5hY3Rpb24sXG4gICAgICAgIGFjdG9ySWQ6IGlucHV0LmFjdG9ySWQsXG4gICAgICAgIGFjdG9yRW1haWw6IGlucHV0LmFjdG9yRW1haWwsXG4gICAgICAgIHRlbmFudElkOiBpbnB1dC50ZW5hbnRJZCB8fCBudWxsLFxuICAgICAgICB0YXJnZXRUeXBlOiBpbnB1dC50YXJnZXRUeXBlIHx8IG51bGwsXG4gICAgICAgIHRhcmdldElkOiBpbnB1dC50YXJnZXRJZCB8fCBudWxsLFxuICAgICAgICBtZXRhZGF0YTogaW5wdXQubWV0YWRhdGEgfHwgdW5kZWZpbmVkLFxuICAgICAgICBpcEFkZHJlc3MsXG4gICAgICAgIHVzZXJBZ2VudFxuICAgICAgfVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBhdWRpdCBsb2c6JywgZXJyb3IpXG4gICAgLy8gRG9uJ3QgdGhyb3cgLSBhdWRpdCBsb2dnaW5nIHNob3VsZCBub3QgYnJlYWsgb3BlcmF0aW9uc1xuICB9XG59XG5cbi8qKlxuICogR2V0IGF1ZGl0IGxvZ3MgZm9yIGEgdGVuYW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpdExvZ3Mob3B0aW9uczoge1xuICB0ZW5hbnRJZD86IHN0cmluZ1xuICBhY3RvcklkPzogc3RyaW5nXG4gIGFjdGlvbj86IEF1ZGl0QWN0aW9uXG4gIHRhcmdldFR5cGU/OiBzdHJpbmdcbiAgbGltaXQ/OiBudW1iZXJcbiAgb2Zmc2V0PzogbnVtYmVyXG59KSB7XG4gIGNvbnN0IHsgdGVuYW50SWQsIGFjdG9ySWQsIGFjdGlvbiwgdGFyZ2V0VHlwZSwgbGltaXQgPSA1MCwgb2Zmc2V0ID0gMCB9ID0gb3B0aW9uc1xuICBcbiAgY29uc3Qgd2hlcmU6IGFueSA9IHt9XG4gIGlmICh0ZW5hbnRJZCkgd2hlcmUudGVuYW50SWQgPSB0ZW5hbnRJZFxuICBpZiAoYWN0b3JJZCkgd2hlcmUuYWN0b3JJZCA9IGFjdG9ySWRcbiAgaWYgKGFjdGlvbikgd2hlcmUuYWN0aW9uID0gYWN0aW9uXG4gIGlmICh0YXJnZXRUeXBlKSB3aGVyZS50YXJnZXRUeXBlID0gdGFyZ2V0VHlwZVxuICBcbiAgY29uc3QgW2xvZ3MsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBwcmlzbWEuYXVkaXRMb2cuZmluZE1hbnkoe1xuICAgICAgd2hlcmUsXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiBsaW1pdCxcbiAgICAgIHNraXA6IG9mZnNldFxuICAgIH0pLFxuICAgIHByaXNtYS5hdWRpdExvZy5jb3VudCh7IHdoZXJlIH0pXG4gIF0pXG4gIFxuICByZXR1cm4geyBsb2dzLCB0b3RhbCB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwidjQiLCJ1dWlkdjQiLCJoZWFkZXJzIiwiY3JlYXRlQXVkaXRMb2ciLCJpbnB1dCIsImhlYWRlcnNMaXN0IiwiaXBBZGRyZXNzIiwiZ2V0IiwidXNlckFnZW50IiwiYXVkaXRMb2ciLCJjcmVhdGUiLCJkYXRhIiwiaWQiLCJhY3Rpb24iLCJhY3RvcklkIiwiYWN0b3JFbWFpbCIsInRlbmFudElkIiwidGFyZ2V0VHlwZSIsInRhcmdldElkIiwibWV0YWRhdGEiLCJ1bmRlZmluZWQiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRBdWRpdExvZ3MiLCJvcHRpb25zIiwibGltaXQiLCJvZmZzZXQiLCJ3aGVyZSIsImxvZ3MiLCJ0b3RhbCIsIlByb21pc2UiLCJhbGwiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJjcmVhdGVkQXQiLCJ0YWtlIiwic2tpcCIsImNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/audit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/pos-event-handlers.ts":
/*!***************************************!*\
  !*** ./src/lib/pos-event-handlers.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getPOSEntitlements: () => (/* binding */ getPOSEntitlements),\n/* harmony export */   handlePOSEvent: () => (/* binding */ handlePOSEvent),\n/* harmony export */   handlePaymentCaptured: () => (/* binding */ handlePaymentCaptured),\n/* harmony export */   handleRefundCreated: () => (/* binding */ handleRefundCreated),\n/* harmony export */   handleSaleCancelled: () => (/* binding */ handleSaleCancelled),\n/* harmony export */   handleSaleCompleted: () => (/* binding */ handleSaleCompleted)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _audit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./audit */ \"(rsc)/./src/lib/audit.ts\");\n/**\n * POS Event Handlers\n * \n * Core's handlers for events emitted by the POS module.\n */ \n\n// ============================================================================\n// IDEMPOTENCY CHECK\n// ============================================================================\nasync function isEventProcessed(idempotencyKey) {\n    const existing = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findFirst({\n        where: {\n            targetId: idempotencyKey,\n            action: \"TENANT_UPDATED\" // Using existing action for POS events\n        }\n    });\n    return !!existing;\n}\nasync function markEventProcessed(idempotencyKey, eventType, tenantId, staffId) {\n    await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n        action: \"TENANT_UPDATED\",\n        actorId: staffId || \"system\",\n        actorEmail: \"pos-system@internal\",\n        tenantId,\n        targetType: \"POS_EVENT\",\n        targetId: idempotencyKey,\n        metadata: {\n            eventType,\n            processedAt: new Date().toISOString()\n        }\n    });\n}\n// ============================================================================\n// EVENT HANDLERS\n// ============================================================================\nasync function handleSaleCompleted(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        console.log(\"[POS] Event already processed:\", idempotencyKey);\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, saleId, saleNumber, staffId, lineItems, grandTotal, payments } = payload;\n        console.log(\"[POS] Sale completed:\", saleNumber, \"for tenant\", tenantId);\n        console.log(\"[POS] Total: $\" + grandTotal + \", Items:\", lineItems.length);\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_CREATED\",\n            actorId: staffId,\n            actorEmail: \"pos@internal\",\n            tenantId,\n            targetType: \"SALE\",\n            targetId: saleId,\n            metadata: {\n                eventType: \"POS_SALE_COMPLETED\",\n                saleNumber,\n                grandTotal,\n                itemCount: lineItems.length,\n                paymentMethods: payments.map((p)=>p.method)\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"pos.sale.completed\", tenantId, staffId);\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[POS] Error handling sale completed:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\nasync function handleSaleCancelled(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, saleId, saleNumber, staffId, voidedByStaffId, reason, lineItems } = payload;\n        console.log(\"[POS] Sale cancelled:\", saleNumber, \"by\", voidedByStaffId);\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_SUSPENDED\",\n            actorId: voidedByStaffId,\n            actorEmail: \"pos@internal\",\n            tenantId,\n            targetType: \"SALE\",\n            targetId: saleId,\n            metadata: {\n                eventType: \"POS_SALE_VOIDED\",\n                saleNumber,\n                reason,\n                originalStaffId: staffId,\n                itemCount: lineItems.length\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"pos.sale.cancelled\", tenantId, voidedByStaffId);\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[POS] Error handling sale cancelled:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\nasync function handlePaymentCaptured(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, paymentId, saleId, staffId, method, amount, tipAmount } = payload;\n        console.log(\"[POS] Payment captured:\", method, \"$\" + amount, \"for sale\", saleId);\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_UPDATED\",\n            actorId: staffId,\n            actorEmail: \"pos@internal\",\n            tenantId,\n            targetType: \"PAYMENT\",\n            targetId: paymentId,\n            metadata: {\n                eventType: \"POS_PAYMENT_RECORDED\",\n                saleId,\n                method,\n                amount,\n                tipAmount: tipAmount || 0\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"pos.payment.captured\", tenantId, staffId);\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[POS] Error handling payment captured:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\nasync function handleRefundCreated(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, refundId, refundNumber, staffId, totalRefunded, reason, items } = payload;\n        console.log(\"[POS] Refund created:\", refundNumber, \"for $\" + totalRefunded);\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_ACTIVATED\",\n            actorId: staffId,\n            actorEmail: \"pos@internal\",\n            tenantId,\n            targetType: \"REFUND\",\n            targetId: refundId,\n            metadata: {\n                eventType: \"POS_REFUND_CREATED\",\n                refundNumber,\n                totalRefunded,\n                reason,\n                itemCount: items.length\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"pos.refund.created\", tenantId, staffId);\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[POS] Error handling refund created:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n// ============================================================================\n// EVENT ROUTER\n// ============================================================================\nasync function handlePOSEvent(event) {\n    console.log(\"[POS] Received event:\", event.eventType);\n    switch(event.eventType){\n        case \"pos.sale.completed\":\n            return handleSaleCompleted(event);\n        case \"pos.sale.cancelled\":\n        case \"pos.sale.voided\":\n            return handleSaleCancelled(event);\n        case \"pos.payment.captured\":\n            return handlePaymentCaptured(event);\n        case \"pos.refund.created\":\n            return handleRefundCreated(event);\n        default:\n            console.log(\"[POS] Unhandled event type:\", event.eventType);\n            return {\n                success: true\n            };\n    }\n}\n// ============================================================================\n// POS ENTITLEMENT SERVICE\n// ============================================================================\nasync function getPOSEntitlements(tenantId) {\n    try {\n        const entitlement = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.entitlement.findUnique({\n            where: {\n                tenantId_module: {\n                    tenantId,\n                    module: \"POS\"\n                }\n            }\n        });\n        if (!entitlement || entitlement.status !== \"ACTIVE\") {\n            return null;\n        }\n        const limits = entitlement.limits || {};\n        const features = [\n            \"offline\"\n        ];\n        const maxRegisters = typeof limits.max_registers === \"number\" ? limits.max_registers : 1;\n        if (maxRegisters > 1) features.push(\"multi_register\");\n        if (limits.layaway_enabled === true) features.push(\"layaway\");\n        if (limits.advanced_discounts === true) features.push(\"advanced_discounts\");\n        if (limits.custom_receipts === true) features.push(\"custom_receipts\");\n        if (limits.reports_enabled !== false) features.push(\"reports\");\n        if (limits.api_enabled === true) features.push(\"api\");\n        return {\n            module: \"POS\",\n            features,\n            limits: {\n                max_locations: typeof limits.max_locations === \"number\" ? limits.max_locations : 1,\n                max_registers: maxRegisters,\n                max_staff: typeof limits.max_staff === \"number\" ? limits.max_staff : 5,\n                max_offline_transactions: typeof limits.max_offline_transactions === \"number\" ? limits.max_offline_transactions : 50,\n                max_products_cache: typeof limits.max_products_cache === \"number\" ? limits.max_products_cache : 500\n            },\n            expiresAt: entitlement.validUntil?.toISOString() || null\n        };\n    } catch (error) {\n        console.error(\"[POS] Error fetching entitlements:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0JBQ2pGUCxlQUFlRDtnQkFDZlMsV0FBVyxPQUFPWCxPQUFPVyxTQUFTLEtBQUssV0FBV1gsT0FBT1csU0FBUyxHQUFHO2dCQUNyRUMsMEJBQTBCLE9BQU9aLE9BQU9ZLHdCQUF3QixLQUFLLFdBQVdaLE9BQU9ZLHdCQUF3QixHQUFHO2dCQUNsSEMsb0JBQW9CLE9BQU9iLE9BQU9hLGtCQUFrQixLQUFLLFdBQVdiLE9BQU9hLGtCQUFrQixHQUFHO1lBQ2xHO1lBQ0FDLFdBQVduQixZQUFZb0IsVUFBVSxFQUFFeEQsaUJBQWlCO1FBQ3REO0lBQ0YsRUFBRSxPQUFPa0IsT0FBTztRQUNkZCxRQUFRYyxLQUFLLENBQUMsc0NBQXNDQTtRQUNwRCxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9saWIvcG9zLWV2ZW50LWhhbmRsZXJzLnRzP2RjZGEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQT1MgRXZlbnQgSGFuZGxlcnNcbiAqIFxuICogQ29yZSdzIGhhbmRsZXJzIGZvciBldmVudHMgZW1pdHRlZCBieSB0aGUgUE9TIG1vZHVsZS5cbiAqL1xuXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSdcbmltcG9ydCB7IGNyZWF0ZUF1ZGl0TG9nIH0gZnJvbSAnLi9hdWRpdCdcbmltcG9ydCB7IEF1ZGl0QWN0aW9uIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmludGVyZmFjZSBQT1NFdmVudEJhc2Uge1xuICBldmVudElkOiBzdHJpbmdcbiAgZXZlbnRUeXBlOiBzdHJpbmdcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgaWRlbXBvdGVuY3lLZXk6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgU2FsZUNvbXBsZXRlZFBheWxvYWQge1xuICBzYWxlSWQ6IHN0cmluZ1xuICBzYWxlTnVtYmVyOiBzdHJpbmdcbiAgdGVuYW50SWQ6IHN0cmluZ1xuICBzdGFmZklkOiBzdHJpbmdcbiAgc3VidG90YWw6IG51bWJlclxuICBkaXNjb3VudFRvdGFsOiBudW1iZXJcbiAgdGF4VG90YWw6IG51bWJlclxuICBncmFuZFRvdGFsOiBudW1iZXJcbiAgbGluZUl0ZW1zOiBBcnJheTx7XG4gICAgbGluZUl0ZW1JZDogc3RyaW5nXG4gICAgcHJvZHVjdElkOiBzdHJpbmdcbiAgICB2YXJpYW50SWQ/OiBzdHJpbmdcbiAgICBxdWFudGl0eTogbnVtYmVyXG4gICAgdW5pdFByaWNlOiBudW1iZXJcbiAgfT5cbiAgcGF5bWVudHM6IEFycmF5PHtcbiAgICBwYXltZW50SWQ6IHN0cmluZ1xuICAgIG1ldGhvZDogc3RyaW5nXG4gICAgYW1vdW50OiBudW1iZXJcbiAgfT5cbiAgY29tcGxldGVkQXQ6IHN0cmluZ1xuICBvZmZsaW5lSWQ/OiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFNhbGVDYW5jZWxsZWRQYXlsb2FkIHtcbiAgc2FsZUlkOiBzdHJpbmdcbiAgc2FsZU51bWJlcjogc3RyaW5nXG4gIHRlbmFudElkOiBzdHJpbmdcbiAgc3RhZmZJZDogc3RyaW5nXG4gIHZvaWRlZEJ5U3RhZmZJZDogc3RyaW5nXG4gIHJlYXNvbjogc3RyaW5nXG4gIGxpbmVJdGVtczogQXJyYXk8e1xuICAgIGxpbmVJdGVtSWQ6IHN0cmluZ1xuICAgIHByb2R1Y3RJZDogc3RyaW5nXG4gICAgcXVhbnRpdHk6IG51bWJlclxuICB9PlxuICBjYW5jZWxsZWRBdDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBQYXltZW50Q2FwdHVyZWRQYXlsb2FkIHtcbiAgcGF5bWVudElkOiBzdHJpbmdcbiAgc2FsZUlkOiBzdHJpbmdcbiAgdGVuYW50SWQ6IHN0cmluZ1xuICBzdGFmZklkOiBzdHJpbmdcbiAgbWV0aG9kOiAnQ0FTSCcgfCAnQ0FSRCcgfCAnTU9CSUxFX1BBWU1FTlQnIHwgJ1NQTElUJ1xuICBhbW91bnQ6IG51bWJlclxuICB0aXBBbW91bnQ/OiBudW1iZXJcbiAgdG90YWxBbW91bnQ6IG51bWJlclxuICBjdXJyZW5jeTogc3RyaW5nXG4gIGNhc2hSZWNlaXZlZD86IG51bWJlclxuICBjaGFuZ2VHaXZlbj86IG51bWJlclxuICBwcm9jZXNzZWRBdDogc3RyaW5nXG4gIG9mZmxpbmVJZD86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUmVmdW5kQ3JlYXRlZFBheWxvYWQge1xuICByZWZ1bmRJZDogc3RyaW5nXG4gIHJlZnVuZE51bWJlcjogc3RyaW5nXG4gIG9yaWdpbmFsU2FsZUlkPzogc3RyaW5nXG4gIHRlbmFudElkOiBzdHJpbmdcbiAgc3RhZmZJZDogc3RyaW5nXG4gIGFwcHJvdmVkQnlTdGFmZklkPzogc3RyaW5nXG4gIHRvdGFsUmVmdW5kZWQ6IG51bWJlclxuICByZWZ1bmRNZXRob2Q6IHN0cmluZ1xuICByZWFzb246IHN0cmluZ1xuICBpdGVtczogQXJyYXk8e1xuICAgIGxpbmVJdGVtSWQ6IHN0cmluZ1xuICAgIHByb2R1Y3RJZDogc3RyaW5nXG4gICAgcXVhbnRpdHk6IG51bWJlclxuICAgIHJlZnVuZEFtb3VudDogbnVtYmVyXG4gICAgcmVzdG9jazogYm9vbGVhblxuICB9PlxuICBwcm9jZXNzZWRBdDogc3RyaW5nXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIElERU1QT1RFTkNZIENIRUNLXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmFzeW5jIGZ1bmN0aW9uIGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXk6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5hdWRpdExvZy5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICB0YXJnZXRJZDogaWRlbXBvdGVuY3lLZXksXG4gICAgICBhY3Rpb246ICdURU5BTlRfVVBEQVRFRCcgLy8gVXNpbmcgZXhpc3RpbmcgYWN0aW9uIGZvciBQT1MgZXZlbnRzXG4gICAgfVxuICB9KVxuICByZXR1cm4gISFleGlzdGluZ1xufVxuXG5hc3luYyBmdW5jdGlvbiBtYXJrRXZlbnRQcm9jZXNzZWQoXG4gIGlkZW1wb3RlbmN5S2V5OiBzdHJpbmcsIFxuICBldmVudFR5cGU6IHN0cmluZyxcbiAgdGVuYW50SWQ6IHN0cmluZyxcbiAgc3RhZmZJZDogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgY3JlYXRlQXVkaXRMb2coe1xuICAgIGFjdGlvbjogJ1RFTkFOVF9VUERBVEVEJyBhcyBBdWRpdEFjdGlvbiwgLy8gVXNpbmcgZXhpc3RpbmcgYWN0aW9uXG4gICAgYWN0b3JJZDogc3RhZmZJZCB8fCAnc3lzdGVtJyxcbiAgICBhY3RvckVtYWlsOiAncG9zLXN5c3RlbUBpbnRlcm5hbCcsXG4gICAgdGVuYW50SWQsXG4gICAgdGFyZ2V0VHlwZTogJ1BPU19FVkVOVCcsXG4gICAgdGFyZ2V0SWQ6IGlkZW1wb3RlbmN5S2V5LFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBldmVudFR5cGUsXG4gICAgICBwcm9jZXNzZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfVxuICB9KVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFVkVOVCBIQU5ETEVSU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2FsZUNvbXBsZXRlZChcbiAgZXZlbnQ6IFBPU0V2ZW50QmFzZSAmIHsgcGF5bG9hZDogU2FsZUNvbXBsZXRlZFBheWxvYWQgfVxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgY29uc3QgeyBpZGVtcG90ZW5jeUtleSwgcGF5bG9hZCB9ID0gZXZlbnRcblxuICBpZiAoYXdhaXQgaXNFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSkpIHtcbiAgICBjb25zb2xlLmxvZygnW1BPU10gRXZlbnQgYWxyZWFkeSBwcm9jZXNzZWQ6JywgaWRlbXBvdGVuY3lLZXkpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgdGVuYW50SWQsIHNhbGVJZCwgc2FsZU51bWJlciwgc3RhZmZJZCwgbGluZUl0ZW1zLCBncmFuZFRvdGFsLCBwYXltZW50cyB9ID0gcGF5bG9hZFxuXG4gICAgY29uc29sZS5sb2coJ1tQT1NdIFNhbGUgY29tcGxldGVkOicsIHNhbGVOdW1iZXIsICdmb3IgdGVuYW50JywgdGVuYW50SWQpXG4gICAgY29uc29sZS5sb2coJ1tQT1NdIFRvdGFsOiAkJyArIGdyYW5kVG90YWwgKyAnLCBJdGVtczonLCBsaW5lSXRlbXMubGVuZ3RoKVxuXG4gICAgYXdhaXQgY3JlYXRlQXVkaXRMb2coe1xuICAgICAgYWN0aW9uOiAnVEVOQU5UX0NSRUFURUQnIGFzIEF1ZGl0QWN0aW9uLCAvLyBVc2luZyBmb3IgUE9TX1NBTEVfQ09NUExFVEVEXG4gICAgICBhY3RvcklkOiBzdGFmZklkLFxuICAgICAgYWN0b3JFbWFpbDogJ3Bvc0BpbnRlcm5hbCcsXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHRhcmdldFR5cGU6ICdTQUxFJyxcbiAgICAgIHRhcmdldElkOiBzYWxlSWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBldmVudFR5cGU6ICdQT1NfU0FMRV9DT01QTEVURUQnLFxuICAgICAgICBzYWxlTnVtYmVyLFxuICAgICAgICBncmFuZFRvdGFsLFxuICAgICAgICBpdGVtQ291bnQ6IGxpbmVJdGVtcy5sZW5ndGgsXG4gICAgICAgIHBheW1lbnRNZXRob2RzOiBwYXltZW50cy5tYXAocCA9PiBwLm1ldGhvZClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgYXdhaXQgbWFya0V2ZW50UHJvY2Vzc2VkKGlkZW1wb3RlbmN5S2V5LCAncG9zLnNhbGUuY29tcGxldGVkJywgdGVuYW50SWQsIHN0YWZmSWQpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1BPU10gRXJyb3IgaGFuZGxpbmcgc2FsZSBjb21wbGV0ZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVTYWxlQ2FuY2VsbGVkKFxuICBldmVudDogUE9TRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBTYWxlQ2FuY2VsbGVkUGF5bG9hZCB9XG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICBjb25zdCB7IGlkZW1wb3RlbmN5S2V5LCBwYXlsb2FkIH0gPSBldmVudFxuXG4gIGlmIChhd2FpdCBpc0V2ZW50UHJvY2Vzc2VkKGlkZW1wb3RlbmN5S2V5KSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHRlbmFudElkLCBzYWxlSWQsIHNhbGVOdW1iZXIsIHN0YWZmSWQsIHZvaWRlZEJ5U3RhZmZJZCwgcmVhc29uLCBsaW5lSXRlbXMgfSA9IHBheWxvYWRcblxuICAgIGNvbnNvbGUubG9nKCdbUE9TXSBTYWxlIGNhbmNlbGxlZDonLCBzYWxlTnVtYmVyLCAnYnknLCB2b2lkZWRCeVN0YWZmSWQpXG5cbiAgICBhd2FpdCBjcmVhdGVBdWRpdExvZyh7XG4gICAgICBhY3Rpb246ICdURU5BTlRfU1VTUEVOREVEJyBhcyBBdWRpdEFjdGlvbiwgLy8gVXNpbmcgZm9yIFBPU19TQUxFX1ZPSURFRFxuICAgICAgYWN0b3JJZDogdm9pZGVkQnlTdGFmZklkLFxuICAgICAgYWN0b3JFbWFpbDogJ3Bvc0BpbnRlcm5hbCcsXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHRhcmdldFR5cGU6ICdTQUxFJyxcbiAgICAgIHRhcmdldElkOiBzYWxlSWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBldmVudFR5cGU6ICdQT1NfU0FMRV9WT0lERUQnLFxuICAgICAgICBzYWxlTnVtYmVyLFxuICAgICAgICByZWFzb24sXG4gICAgICAgIG9yaWdpbmFsU3RhZmZJZDogc3RhZmZJZCxcbiAgICAgICAgaXRlbUNvdW50OiBsaW5lSXRlbXMubGVuZ3RoXG4gICAgICB9XG4gICAgfSlcblxuICAgIGF3YWl0IG1hcmtFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSwgJ3Bvcy5zYWxlLmNhbmNlbGxlZCcsIHRlbmFudElkLCB2b2lkZWRCeVN0YWZmSWQpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1BPU10gRXJyb3IgaGFuZGxpbmcgc2FsZSBjYW5jZWxsZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVQYXltZW50Q2FwdHVyZWQoXG4gIGV2ZW50OiBQT1NFdmVudEJhc2UgJiB7IHBheWxvYWQ6IFBheW1lbnRDYXB0dXJlZFBheWxvYWQgfVxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgY29uc3QgeyBpZGVtcG90ZW5jeUtleSwgcGF5bG9hZCB9ID0gZXZlbnRcblxuICBpZiAoYXdhaXQgaXNFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSkpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyB0ZW5hbnRJZCwgcGF5bWVudElkLCBzYWxlSWQsIHN0YWZmSWQsIG1ldGhvZCwgYW1vdW50LCB0aXBBbW91bnQgfSA9IHBheWxvYWRcblxuICAgIGNvbnNvbGUubG9nKCdbUE9TXSBQYXltZW50IGNhcHR1cmVkOicsIG1ldGhvZCwgJyQnICsgYW1vdW50LCAnZm9yIHNhbGUnLCBzYWxlSWQpXG5cbiAgICBhd2FpdCBjcmVhdGVBdWRpdExvZyh7XG4gICAgICBhY3Rpb246ICdURU5BTlRfVVBEQVRFRCcgYXMgQXVkaXRBY3Rpb24sIC8vIFVzaW5nIGZvciBQT1NfUEFZTUVOVFxuICAgICAgYWN0b3JJZDogc3RhZmZJZCxcbiAgICAgIGFjdG9yRW1haWw6ICdwb3NAaW50ZXJuYWwnLFxuICAgICAgdGVuYW50SWQsXG4gICAgICB0YXJnZXRUeXBlOiAnUEFZTUVOVCcsXG4gICAgICB0YXJnZXRJZDogcGF5bWVudElkLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZXZlbnRUeXBlOiAnUE9TX1BBWU1FTlRfUkVDT1JERUQnLFxuICAgICAgICBzYWxlSWQsXG4gICAgICAgIG1ldGhvZCxcbiAgICAgICAgYW1vdW50LFxuICAgICAgICB0aXBBbW91bnQ6IHRpcEFtb3VudCB8fCAwXG4gICAgICB9XG4gICAgfSlcblxuICAgIGF3YWl0IG1hcmtFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSwgJ3Bvcy5wYXltZW50LmNhcHR1cmVkJywgdGVuYW50SWQsIHN0YWZmSWQpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1BPU10gRXJyb3IgaGFuZGxpbmcgcGF5bWVudCBjYXB0dXJlZDonLCBlcnJvcilcbiAgICByZXR1cm4geyBcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyBcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlZnVuZENyZWF0ZWQoXG4gIGV2ZW50OiBQT1NFdmVudEJhc2UgJiB7IHBheWxvYWQ6IFJlZnVuZENyZWF0ZWRQYXlsb2FkIH1cbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gIGNvbnN0IHsgaWRlbXBvdGVuY3lLZXksIHBheWxvYWQgfSA9IGV2ZW50XG5cbiAgaWYgKGF3YWl0IGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXkpKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgdGVuYW50SWQsIHJlZnVuZElkLCByZWZ1bmROdW1iZXIsIHN0YWZmSWQsIHRvdGFsUmVmdW5kZWQsIHJlYXNvbiwgaXRlbXMgfSA9IHBheWxvYWRcblxuICAgIGNvbnNvbGUubG9nKCdbUE9TXSBSZWZ1bmQgY3JlYXRlZDonLCByZWZ1bmROdW1iZXIsICdmb3IgJCcgKyB0b3RhbFJlZnVuZGVkKVxuXG4gICAgYXdhaXQgY3JlYXRlQXVkaXRMb2coe1xuICAgICAgYWN0aW9uOiAnVEVOQU5UX0FDVElWQVRFRCcgYXMgQXVkaXRBY3Rpb24sIC8vIFVzaW5nIGZvciBQT1NfUkVGVU5EXG4gICAgICBhY3RvcklkOiBzdGFmZklkLFxuICAgICAgYWN0b3JFbWFpbDogJ3Bvc0BpbnRlcm5hbCcsXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHRhcmdldFR5cGU6ICdSRUZVTkQnLFxuICAgICAgdGFyZ2V0SWQ6IHJlZnVuZElkLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZXZlbnRUeXBlOiAnUE9TX1JFRlVORF9DUkVBVEVEJyxcbiAgICAgICAgcmVmdW5kTnVtYmVyLFxuICAgICAgICB0b3RhbFJlZnVuZGVkLFxuICAgICAgICByZWFzb24sXG4gICAgICAgIGl0ZW1Db3VudDogaXRlbXMubGVuZ3RoXG4gICAgICB9XG4gICAgfSlcblxuICAgIGF3YWl0IG1hcmtFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSwgJ3Bvcy5yZWZ1bmQuY3JlYXRlZCcsIHRlbmFudElkLCBzdGFmZklkKVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tQT1NdIEVycm9yIGhhbmRsaW5nIHJlZnVuZCBjcmVhdGVkOicsIGVycm9yKVxuICAgIHJldHVybiB7IFxuICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIFxuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFVkVOVCBST1VURVJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVBPU0V2ZW50KFxuICBldmVudDogUE9TRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9XG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICBjb25zb2xlLmxvZygnW1BPU10gUmVjZWl2ZWQgZXZlbnQ6JywgZXZlbnQuZXZlbnRUeXBlKVxuXG4gIHN3aXRjaCAoZXZlbnQuZXZlbnRUeXBlKSB7XG4gICAgY2FzZSAncG9zLnNhbGUuY29tcGxldGVkJzpcbiAgICAgIHJldHVybiBoYW5kbGVTYWxlQ29tcGxldGVkKGV2ZW50IGFzIHVua25vd24gYXMgUE9TRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBTYWxlQ29tcGxldGVkUGF5bG9hZCB9KVxuICAgIGNhc2UgJ3Bvcy5zYWxlLmNhbmNlbGxlZCc6XG4gICAgY2FzZSAncG9zLnNhbGUudm9pZGVkJzpcbiAgICAgIHJldHVybiBoYW5kbGVTYWxlQ2FuY2VsbGVkKGV2ZW50IGFzIHVua25vd24gYXMgUE9TRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBTYWxlQ2FuY2VsbGVkUGF5bG9hZCB9KVxuICAgIGNhc2UgJ3Bvcy5wYXltZW50LmNhcHR1cmVkJzpcbiAgICAgIHJldHVybiBoYW5kbGVQYXltZW50Q2FwdHVyZWQoZXZlbnQgYXMgdW5rbm93biBhcyBQT1NFdmVudEJhc2UgJiB7IHBheWxvYWQ6IFBheW1lbnRDYXB0dXJlZFBheWxvYWQgfSlcbiAgICBjYXNlICdwb3MucmVmdW5kLmNyZWF0ZWQnOlxuICAgICAgcmV0dXJuIGhhbmRsZVJlZnVuZENyZWF0ZWQoZXZlbnQgYXMgdW5rbm93biBhcyBQT1NFdmVudEJhc2UgJiB7IHBheWxvYWQ6IFJlZnVuZENyZWF0ZWRQYXlsb2FkIH0pXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKCdbUE9TXSBVbmhhbmRsZWQgZXZlbnQgdHlwZTonLCBldmVudC5ldmVudFR5cGUpXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQT1MgRU5USVRMRU1FTlQgU0VSVklDRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UE9TRW50aXRsZW1lbnRzKHRlbmFudElkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgbW9kdWxlOiAnUE9TJ1xuICBmZWF0dXJlczogc3RyaW5nW11cbiAgbGltaXRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXIgfCBudWxsPlxuICBleHBpcmVzQXQ6IHN0cmluZyB8IG51bGxcbn0gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZW50aXRsZW1lbnQgPSBhd2FpdCBwcmlzbWEuZW50aXRsZW1lbnQuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB0ZW5hbnRJZF9tb2R1bGU6IHsgdGVuYW50SWQsIG1vZHVsZTogJ1BPUycgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBpZiAoIWVudGl0bGVtZW50IHx8IGVudGl0bGVtZW50LnN0YXR1cyAhPT0gJ0FDVElWRScpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgbGltaXRzID0gKGVudGl0bGVtZW50LmxpbWl0cyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgfHwge31cbiAgICBjb25zdCBmZWF0dXJlczogc3RyaW5nW10gPSBbJ29mZmxpbmUnXVxuICAgIFxuICAgIGNvbnN0IG1heFJlZ2lzdGVycyA9IHR5cGVvZiBsaW1pdHMubWF4X3JlZ2lzdGVycyA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X3JlZ2lzdGVycyA6IDFcbiAgICBpZiAobWF4UmVnaXN0ZXJzID4gMSkgZmVhdHVyZXMucHVzaCgnbXVsdGlfcmVnaXN0ZXInKVxuICAgIGlmIChsaW1pdHMubGF5YXdheV9lbmFibGVkID09PSB0cnVlKSBmZWF0dXJlcy5wdXNoKCdsYXlhd2F5JylcbiAgICBpZiAobGltaXRzLmFkdmFuY2VkX2Rpc2NvdW50cyA9PT0gdHJ1ZSkgZmVhdHVyZXMucHVzaCgnYWR2YW5jZWRfZGlzY291bnRzJylcbiAgICBpZiAobGltaXRzLmN1c3RvbV9yZWNlaXB0cyA9PT0gdHJ1ZSkgZmVhdHVyZXMucHVzaCgnY3VzdG9tX3JlY2VpcHRzJylcbiAgICBpZiAobGltaXRzLnJlcG9ydHNfZW5hYmxlZCAhPT0gZmFsc2UpIGZlYXR1cmVzLnB1c2goJ3JlcG9ydHMnKVxuICAgIGlmIChsaW1pdHMuYXBpX2VuYWJsZWQgPT09IHRydWUpIGZlYXR1cmVzLnB1c2goJ2FwaScpXG5cbiAgICByZXR1cm4ge1xuICAgICAgbW9kdWxlOiAnUE9TJyxcbiAgICAgIGZlYXR1cmVzLFxuICAgICAgbGltaXRzOiB7XG4gICAgICAgIG1heF9sb2NhdGlvbnM6IHR5cGVvZiBsaW1pdHMubWF4X2xvY2F0aW9ucyA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X2xvY2F0aW9ucyA6IDEsXG4gICAgICAgIG1heF9yZWdpc3RlcnM6IG1heFJlZ2lzdGVycyxcbiAgICAgICAgbWF4X3N0YWZmOiB0eXBlb2YgbGltaXRzLm1heF9zdGFmZiA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X3N0YWZmIDogNSxcbiAgICAgICAgbWF4X29mZmxpbmVfdHJhbnNhY3Rpb25zOiB0eXBlb2YgbGltaXRzLm1heF9vZmZsaW5lX3RyYW5zYWN0aW9ucyA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X29mZmxpbmVfdHJhbnNhY3Rpb25zIDogNTAsXG4gICAgICAgIG1heF9wcm9kdWN0c19jYWNoZTogdHlwZW9mIGxpbWl0cy5tYXhfcHJvZHVjdHNfY2FjaGUgPT09ICdudW1iZXInID8gbGltaXRzLm1heF9wcm9kdWN0c19jYWNoZSA6IDUwMFxuICAgICAgfSxcbiAgICAgIGV4cGlyZXNBdDogZW50aXRsZW1lbnQudmFsaWRVbnRpbD8udG9JU09TdHJpbmcoKSB8fCBudWxsXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tQT1NdIEVycm9yIGZldGNoaW5nIGVudGl0bGVtZW50czonLCBlcnJvcilcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiY3JlYXRlQXVkaXRMb2ciLCJpc0V2ZW50UHJvY2Vzc2VkIiwiaWRlbXBvdGVuY3lLZXkiLCJleGlzdGluZyIsImF1ZGl0TG9nIiwiZmluZEZpcnN0Iiwid2hlcmUiLCJ0YXJnZXRJZCIsImFjdGlvbiIsIm1hcmtFdmVudFByb2Nlc3NlZCIsImV2ZW50VHlwZSIsInRlbmFudElkIiwic3RhZmZJZCIsImFjdG9ySWQiLCJhY3RvckVtYWlsIiwidGFyZ2V0VHlwZSIsIm1ldGFkYXRhIiwicHJvY2Vzc2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJoYW5kbGVTYWxlQ29tcGxldGVkIiwiZXZlbnQiLCJwYXlsb2FkIiwiY29uc29sZSIsImxvZyIsInN1Y2Nlc3MiLCJzYWxlSWQiLCJzYWxlTnVtYmVyIiwibGluZUl0ZW1zIiwiZ3JhbmRUb3RhbCIsInBheW1lbnRzIiwibGVuZ3RoIiwiaXRlbUNvdW50IiwicGF5bWVudE1ldGhvZHMiLCJtYXAiLCJwIiwibWV0aG9kIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJoYW5kbGVTYWxlQ2FuY2VsbGVkIiwidm9pZGVkQnlTdGFmZklkIiwicmVhc29uIiwib3JpZ2luYWxTdGFmZklkIiwiaGFuZGxlUGF5bWVudENhcHR1cmVkIiwicGF5bWVudElkIiwiYW1vdW50IiwidGlwQW1vdW50IiwiaGFuZGxlUmVmdW5kQ3JlYXRlZCIsInJlZnVuZElkIiwicmVmdW5kTnVtYmVyIiwidG90YWxSZWZ1bmRlZCIsIml0ZW1zIiwiaGFuZGxlUE9TRXZlbnQiLCJnZXRQT1NFbnRpdGxlbWVudHMiLCJlbnRpdGxlbWVudCIsImZpbmRVbmlxdWUiLCJ0ZW5hbnRJZF9tb2R1bGUiLCJtb2R1bGUiLCJzdGF0dXMiLCJsaW1pdHMiLCJmZWF0dXJlcyIsIm1heFJlZ2lzdGVycyIsIm1heF9yZWdpc3RlcnMiLCJwdXNoIiwibGF5YXdheV9lbmFibGVkIiwiYWR2YW5jZWRfZGlzY291bnRzIiwiY3VzdG9tX3JlY2VpcHRzIiwicmVwb3J0c19lbmFibGVkIiwiYXBpX2VuYWJsZWQiLCJtYXhfbG9jYXRpb25zIiwibWF4X3N0YWZmIiwibWF4X29mZmxpbmVfdHJhbnNhY3Rpb25zIiwibWF4X3Byb2R1Y3RzX2NhY2hlIiwiZXhwaXJlc0F0IiwidmFsaWRVbnRpbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/pos-event-handlers.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpos%2Fevents%2Froute&page=%2Fapi%2Fpos%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpos%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();