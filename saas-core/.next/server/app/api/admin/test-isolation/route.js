"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/test-isolation/route";
exports.ids = ["app/api/admin/test-isolation/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Ftest-isolation%2Froute&page=%2Fapi%2Fadmin%2Ftest-isolation%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Ftest-isolation%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Ftest-isolation%2Froute&page=%2Fapi%2Fadmin%2Ftest-isolation%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Ftest-isolation%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_admin_test_isolation_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/admin/test-isolation/route.ts */ \"(rsc)/./src/app/api/admin/test-isolation/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/test-isolation/route\",\n        pathname: \"/api/admin/test-isolation\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/test-isolation/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/admin/test-isolation/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_admin_test_isolation_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/admin/test-isolation/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRnRlc3QtaXNvbGF0aW9uJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhZG1pbiUyRnRlc3QtaXNvbGF0aW9uJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYWRtaW4lMkZ0ZXN0LWlzb2xhdGlvbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/MTIwNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9hZG1pbi90ZXN0LWlzb2xhdGlvbi9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWRtaW4vdGVzdC1pc29sYXRpb24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hZG1pbi90ZXN0LWlzb2xhdGlvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWRtaW4vdGVzdC1pc29sYXRpb24vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9hZG1pbi90ZXN0LWlzb2xhdGlvbi9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYWRtaW4vdGVzdC1pc29sYXRpb24vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Ftest-isolation%2Froute&page=%2Fapi%2Fadmin%2Ftest-isolation%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Ftest-isolation%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/admin/test-isolation/route.ts":
/*!***************************************************!*\
  !*** ./src/app/api/admin/test-isolation/route.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_authorization__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/authorization */ \"(rsc)/./src/lib/authorization.ts\");\n\n\n\n/**\n * Test endpoint for verifying tenant isolation\n * Only accessible by Super Admins\n * \n * GET /api/admin/test-isolation - Get violation logs\n * POST /api/admin/test-isolation - Run isolation tests\n * DELETE /api/admin/test-isolation - Clear violation logs\n */ // GET - Retrieve violation logs\nasync function GET(request) {\n    try {\n        const authResult = await (0,_lib_authorization__WEBPACK_IMPORTED_MODULE_2__.requireSuperAdmin)();\n        if (!authResult.authorized) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: authResult.error\n            }, {\n                status: authResult.status\n            });\n        }\n        const logs = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs)();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            violationCount: logs.length,\n            violations: logs.slice(-50)\n        });\n    } catch (error) {\n        console.error(\"Failed to get violation logs:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to get violation logs\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST - Run isolation tests\nasync function POST(request) {\n    try {\n        const authResult = await (0,_lib_authorization__WEBPACK_IMPORTED_MODULE_2__.requireSuperAdmin)();\n        if (!authResult.authorized) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: authResult.error\n            }, {\n                status: authResult.status\n            });\n        }\n        const results = [];\n        // Clear previous logs\n        (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs)();\n        // Get two different tenants for testing\n        const tenants = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findMany({\n            take: 2\n        });\n        if (tenants.length < 2) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Need at least 2 tenants for isolation testing\"\n            }, {\n                status: 400\n            });\n        }\n        const tenant1 = tenants[0];\n        const tenant2 = tenants[1];\n        // Test 1: Query without tenant context (should fail)\n        try {\n            const noContext = null;\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", noContext);\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantMembership.findMany();\n            results.push({\n                test: \"Query without tenant context\",\n                passed: false,\n                error: \"Should have thrown\"\n            });\n        } catch (e) {\n            if (e instanceof _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError) {\n                results.push({\n                    test: \"Query without tenant context\",\n                    passed: true\n                });\n            } else {\n                results.push({\n                    test: \"Query without tenant context\",\n                    passed: false,\n                    error: String(e)\n                });\n            }\n        }\n        // Test 2: Query with wrong tenantId filter (should fail) - Cross-tenant access\n        try {\n            const context1 = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(tenant1.id, \"test-user\", false);\n            // Trying to query tenant2's data while context is tenant1\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", context1, tenant2.id);\n            results.push({\n                test: \"Cross-tenant query attempt\",\n                passed: false,\n                error: \"Should have thrown\"\n            });\n        } catch (e) {\n            if (e instanceof _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError) {\n                results.push({\n                    test: \"Cross-tenant query attempt\",\n                    passed: true\n                });\n            } else {\n                results.push({\n                    test: \"Cross-tenant query attempt\",\n                    passed: false,\n                    error: String(e)\n                });\n            }\n        }\n        // Test 3: Query with correct tenantId (should succeed)\n        try {\n            const context1 = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(tenant1.id, \"test-user\", false);\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", context1, tenant1.id);\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantMembership.findMany({\n                where: (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)({}, tenant1.id)\n            });\n            results.push({\n                test: \"Valid tenant-scoped query\",\n                passed: true\n            });\n        } catch (e) {\n            results.push({\n                test: \"Valid tenant-scoped query\",\n                passed: false,\n                error: String(e)\n            });\n        }\n        // Test 4: Super admin can query across tenants\n        try {\n            const superAdminContext = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(null, authResult.user.id, true);\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", superAdminContext);\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantMembership.findMany();\n            results.push({\n                test: \"Super admin cross-tenant query\",\n                passed: true\n            });\n        } catch (e) {\n            results.push({\n                test: \"Super admin cross-tenant query\",\n                passed: false,\n                error: String(e)\n            });\n        }\n        // Test 5: Bypass without super admin (should fail)\n        try {\n            const bypassAttempt = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(tenant1.id, \"test-user\", false, true) // bypassIsolation=true\n            ;\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", bypassAttempt);\n            results.push({\n                test: \"Non-admin bypass attempt\",\n                passed: false,\n                error: \"Should have thrown\"\n            });\n        } catch (e) {\n            if (e instanceof _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError) {\n                results.push({\n                    test: \"Non-admin bypass attempt\",\n                    passed: true\n                });\n            } else {\n                results.push({\n                    test: \"Non-admin bypass attempt\",\n                    passed: false,\n                    error: String(e)\n                });\n            }\n        }\n        // Test 6: Super admin explicit bypass (should succeed)\n        try {\n            const superAdminBypass = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(null, authResult.user.id, true, true);\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", superAdminBypass);\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantMembership.findMany();\n            results.push({\n                test: \"Super admin explicit bypass\",\n                passed: true\n            });\n        } catch (e) {\n            results.push({\n                test: \"Super admin explicit bypass\",\n                passed: false,\n                error: String(e)\n            });\n        }\n        // Test 7: Global model (User) should work without tenant context\n        try {\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"User\", \"findMany\", null);\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findMany({\n                take: 1\n            });\n            results.push({\n                test: \"Global model query without context\",\n                passed: true\n            });\n        } catch (e) {\n            results.push({\n                test: \"Global model query without context\",\n                passed: false,\n                error: String(e)\n            });\n        }\n        // Test 8: Context with no tenantId (should fail for regular user)\n        try {\n            const noTenantContext = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.createTenantContext)(null, \"test-user\", false);\n            (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess)(\"TenantMembership\", \"findMany\", noTenantContext);\n            results.push({\n                test: \"Regular user without tenantId\",\n                passed: false,\n                error: \"Should have thrown\"\n            });\n        } catch (e) {\n            if (e instanceof _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError) {\n                results.push({\n                    test: \"Regular user without tenantId\",\n                    passed: true\n                });\n            } else {\n                results.push({\n                    test: \"Regular user without tenantId\",\n                    passed: false,\n                    error: String(e)\n                });\n            }\n        }\n        const violations = (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs)();\n        const allPassed = results.every((r)=>r.passed);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            allPassed,\n            results,\n            violationsLogged: violations.length,\n            violations: violations.slice(-10)\n        });\n    } catch (error) {\n        console.error(\"Failed to run isolation tests:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to run isolation tests: \" + String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n// DELETE - Clear violation logs\nasync function DELETE(request) {\n    try {\n        const authResult = await (0,_lib_authorization__WEBPACK_IMPORTED_MODULE_2__.requireSuperAdmin)();\n        if (!authResult.authorized) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: authResult.error\n            }, {\n                status: authResult.status\n            });\n        }\n        (0,_lib_prisma__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs)();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"Violation logs cleared\"\n        });\n    } catch (error) {\n        console.error(\"Failed to clear violation logs:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to clear violation logs\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZG1pbi90ZXN0LWlzb2xhdGlvbi9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBdUQ7QUFTbEM7QUFDa0M7QUFFdkQ7Ozs7Ozs7Q0FPQyxHQUVELGdDQUFnQztBQUN6QixlQUFlUyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTUMsYUFBYSxNQUFNSCxxRUFBaUJBO1FBRTFDLElBQUksQ0FBQ0csV0FBV0MsVUFBVSxFQUFFO1lBQzFCLE9BQU9aLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPSixXQUFXSSxLQUFLO1lBQUMsR0FDMUM7Z0JBQUVDLFFBQVFMLFdBQVdLLE1BQU07WUFBQztRQUVoQztRQUVBLE1BQU1DLE9BQU9aLDZEQUFnQkE7UUFFN0IsT0FBT0wscURBQVlBLENBQUNhLElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNUSSxnQkFBZ0JELEtBQUtFLE1BQU07WUFDM0JDLFlBQVlILEtBQUtJLEtBQUssQ0FBQyxDQUFDO1FBQzFCO0lBRUYsRUFBRSxPQUFPTixPQUFPO1FBQ2RPLFFBQVFQLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9mLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0MsT0FBTztRQUErQixHQUN4RDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLDZCQUE2QjtBQUN0QixlQUFlTyxLQUFLYixPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsYUFBYSxNQUFNSCxxRUFBaUJBO1FBRTFDLElBQUksQ0FBQ0csV0FBV0MsVUFBVSxFQUFFO1lBQzFCLE9BQU9aLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPSixXQUFXSSxLQUFLO1lBQUMsR0FDMUM7Z0JBQUVDLFFBQVFMLFdBQVdLLE1BQU07WUFBQztRQUVoQztRQUVBLE1BQU1RLFVBQStELEVBQUU7UUFFdkUsc0JB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ekIsZUFBZWtDLE9BQU94QyxPQUFvQjtJQUMvQyxJQUFJO1FBQ0YsTUFBTUMsYUFBYSxNQUFNSCxxRUFBaUJBO1FBRTFDLElBQUksQ0FBQ0csV0FBV0MsVUFBVSxFQUFFO1lBQzFCLE9BQU9aLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPSixXQUFXSSxLQUFLO1lBQUMsR0FDMUM7Z0JBQUVDLFFBQVFMLFdBQVdLLE1BQU07WUFBQztRQUVoQztRQUVBViwrREFBa0JBO1FBRWxCLE9BQU9OLHFEQUFZQSxDQUFDYSxJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVHFDLFNBQVM7UUFDWDtJQUVGLEVBQUUsT0FBT3BDLE9BQU87UUFDZE8sUUFBUVAsS0FBSyxDQUFDLG1DQUFtQ0E7UUFDakQsT0FBT2YscURBQVlBLENBQUNhLElBQUksQ0FDdEI7WUFBRUMsU0FBUztZQUFPQyxPQUFPO1FBQWlDLEdBQzFEO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2FwcC9hcGkvYWRtaW4vdGVzdC1pc29sYXRpb24vcm91dGUudHM/ZWI2OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBcbiAgcHJpc21hLCBcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsIFxuICBjcmVhdGVUZW5hbnRDb250ZXh0LFxuICBUZW5hbnRJc29sYXRpb25FcnJvciwgXG4gIGdldFZpb2xhdGlvbkxvZ3MsIFxuICBjbGVhclZpb2xhdGlvbkxvZ3MsXG4gIHdpdGhUZW5hbnRGaWx0ZXJcbn0gZnJvbSAnQC9saWIvcHJpc21hJ1xuaW1wb3J0IHsgcmVxdWlyZVN1cGVyQWRtaW4gfSBmcm9tICdAL2xpYi9hdXRob3JpemF0aW9uJ1xuXG4vKipcbiAqIFRlc3QgZW5kcG9pbnQgZm9yIHZlcmlmeWluZyB0ZW5hbnQgaXNvbGF0aW9uXG4gKiBPbmx5IGFjY2Vzc2libGUgYnkgU3VwZXIgQWRtaW5zXG4gKiBcbiAqIEdFVCAvYXBpL2FkbWluL3Rlc3QtaXNvbGF0aW9uIC0gR2V0IHZpb2xhdGlvbiBsb2dzXG4gKiBQT1NUIC9hcGkvYWRtaW4vdGVzdC1pc29sYXRpb24gLSBSdW4gaXNvbGF0aW9uIHRlc3RzXG4gKiBERUxFVEUgL2FwaS9hZG1pbi90ZXN0LWlzb2xhdGlvbiAtIENsZWFyIHZpb2xhdGlvbiBsb2dzXG4gKi9cblxuLy8gR0VUIC0gUmV0cmlldmUgdmlvbGF0aW9uIGxvZ3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZVN1cGVyQWRtaW4oKVxuICAgIFxuICAgIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBhdXRoUmVzdWx0LmVycm9yIH0sXG4gICAgICAgIHsgc3RhdHVzOiBhdXRoUmVzdWx0LnN0YXR1cyB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGxvZ3MgPSBnZXRWaW9sYXRpb25Mb2dzKClcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHZpb2xhdGlvbkNvdW50OiBsb2dzLmxlbmd0aCxcbiAgICAgIHZpb2xhdGlvbnM6IGxvZ3Muc2xpY2UoLTUwKVxuICAgIH0pXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCB2aW9sYXRpb24gbG9nczonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBnZXQgdmlvbGF0aW9uIGxvZ3MnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuLy8gUE9TVCAtIFJ1biBpc29sYXRpb24gdGVzdHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHJlcXVpcmVTdXBlckFkbWluKClcbiAgICBcbiAgICBpZiAoIWF1dGhSZXN1bHQuYXV0aG9yaXplZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogYXV0aFJlc3VsdC5lcnJvciB9LFxuICAgICAgICB7IHN0YXR1czogYXV0aFJlc3VsdC5zdGF0dXMgfVxuICAgICAgKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXN1bHRzOiB7IHRlc3Q6IHN0cmluZzsgcGFzc2VkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9W10gPSBbXVxuICAgIFxuICAgIC8vIENsZWFyIHByZXZpb3VzIGxvZ3NcbiAgICBjbGVhclZpb2xhdGlvbkxvZ3MoKVxuICAgIFxuICAgIC8vIEdldCB0d28gZGlmZmVyZW50IHRlbmFudHMgZm9yIHRlc3RpbmdcbiAgICBjb25zdCB0ZW5hbnRzID0gYXdhaXQgcHJpc21hLnRlbmFudC5maW5kTWFueSh7IHRha2U6IDIgfSlcbiAgICBcbiAgICBpZiAodGVuYW50cy5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdOZWVkIGF0IGxlYXN0IDIgdGVuYW50cyBmb3IgaXNvbGF0aW9uIHRlc3RpbmcnXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRlbmFudDEgPSB0ZW5hbnRzWzBdXG4gICAgY29uc3QgdGVuYW50MiA9IHRlbmFudHNbMV1cbiAgICBcbiAgICAvLyBUZXN0IDE6IFF1ZXJ5IHdpdGhvdXQgdGVuYW50IGNvbnRleHQgKHNob3VsZCBmYWlsKVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBub0NvbnRleHQgPSBudWxsXG4gICAgICB2YWxpZGF0ZVRlbmFudEFjY2VzcygnVGVuYW50TWVtYmVyc2hpcCcsICdmaW5kTWFueScsIG5vQ29udGV4dClcbiAgICAgIGF3YWl0IHByaXNtYS50ZW5hbnRNZW1iZXJzaGlwLmZpbmRNYW55KClcbiAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdRdWVyeSB3aXRob3V0IHRlbmFudCBjb250ZXh0JywgcGFzc2VkOiBmYWxzZSwgZXJyb3I6ICdTaG91bGQgaGF2ZSB0aHJvd24nIH0pXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBUZW5hbnRJc29sYXRpb25FcnJvcikge1xuICAgICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnUXVlcnkgd2l0aG91dCB0ZW5hbnQgY29udGV4dCcsIHBhc3NlZDogdHJ1ZSB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ1F1ZXJ5IHdpdGhvdXQgdGVuYW50IGNvbnRleHQnLCBwYXNzZWQ6IGZhbHNlLCBlcnJvcjogU3RyaW5nKGUpIH0pXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFRlc3QgMjogUXVlcnkgd2l0aCB3cm9uZyB0ZW5hbnRJZCBmaWx0ZXIgKHNob3VsZCBmYWlsKSAtIENyb3NzLXRlbmFudCBhY2Nlc3NcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGV4dDEgPSBjcmVhdGVUZW5hbnRDb250ZXh0KHRlbmFudDEuaWQsICd0ZXN0LXVzZXInLCBmYWxzZSlcbiAgICAgIC8vIFRyeWluZyB0byBxdWVyeSB0ZW5hbnQyJ3MgZGF0YSB3aGlsZSBjb250ZXh0IGlzIHRlbmFudDFcbiAgICAgIHZhbGlkYXRlVGVuYW50QWNjZXNzKCdUZW5hbnRNZW1iZXJzaGlwJywgJ2ZpbmRNYW55JywgY29udGV4dDEsIHRlbmFudDIuaWQpXG4gICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnQ3Jvc3MtdGVuYW50IHF1ZXJ5IGF0dGVtcHQnLCBwYXNzZWQ6IGZhbHNlLCBlcnJvcjogJ1Nob3VsZCBoYXZlIHRocm93bicgfSlcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIFRlbmFudElzb2xhdGlvbkVycm9yKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdDcm9zcy10ZW5hbnQgcXVlcnkgYXR0ZW1wdCcsIHBhc3NlZDogdHJ1ZSB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ0Nyb3NzLXRlbmFudCBxdWVyeSBhdHRlbXB0JywgcGFzc2VkOiBmYWxzZSwgZXJyb3I6IFN0cmluZyhlKSB9KVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBUZXN0IDM6IFF1ZXJ5IHdpdGggY29ycmVjdCB0ZW5hbnRJZCAoc2hvdWxkIHN1Y2NlZWQpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnRleHQxID0gY3JlYXRlVGVuYW50Q29udGV4dCh0ZW5hbnQxLmlkLCAndGVzdC11c2VyJywgZmFsc2UpXG4gICAgICB2YWxpZGF0ZVRlbmFudEFjY2VzcygnVGVuYW50TWVtYmVyc2hpcCcsICdmaW5kTWFueScsIGNvbnRleHQxLCB0ZW5hbnQxLmlkKVxuICAgICAgYXdhaXQgcHJpc21hLnRlbmFudE1lbWJlcnNoaXAuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogd2l0aFRlbmFudEZpbHRlcih7fSwgdGVuYW50MS5pZClcbiAgICAgIH0pXG4gICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnVmFsaWQgdGVuYW50LXNjb3BlZCBxdWVyeScsIHBhc3NlZDogdHJ1ZSB9KVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdWYWxpZCB0ZW5hbnQtc2NvcGVkIHF1ZXJ5JywgcGFzc2VkOiBmYWxzZSwgZXJyb3I6IFN0cmluZyhlKSB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBUZXN0IDQ6IFN1cGVyIGFkbWluIGNhbiBxdWVyeSBhY3Jvc3MgdGVuYW50c1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdXBlckFkbWluQ29udGV4dCA9IGNyZWF0ZVRlbmFudENvbnRleHQobnVsbCwgYXV0aFJlc3VsdC51c2VyLmlkLCB0cnVlKVxuICAgICAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MoJ1RlbmFudE1lbWJlcnNoaXAnLCAnZmluZE1hbnknLCBzdXBlckFkbWluQ29udGV4dClcbiAgICAgIGF3YWl0IHByaXNtYS50ZW5hbnRNZW1iZXJzaGlwLmZpbmRNYW55KClcbiAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdTdXBlciBhZG1pbiBjcm9zcy10ZW5hbnQgcXVlcnknLCBwYXNzZWQ6IHRydWUgfSlcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnU3VwZXIgYWRtaW4gY3Jvc3MtdGVuYW50IHF1ZXJ5JywgcGFzc2VkOiBmYWxzZSwgZXJyb3I6IFN0cmluZyhlKSB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBUZXN0IDU6IEJ5cGFzcyB3aXRob3V0IHN1cGVyIGFkbWluIChzaG91bGQgZmFpbClcbiAgICB0cnkge1xuICAgICAgY29uc3QgYnlwYXNzQXR0ZW1wdCA9IGNyZWF0ZVRlbmFudENvbnRleHQodGVuYW50MS5pZCwgJ3Rlc3QtdXNlcicsIGZhbHNlLCB0cnVlKSAvLyBieXBhc3NJc29sYXRpb249dHJ1ZVxuICAgICAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MoJ1RlbmFudE1lbWJlcnNoaXAnLCAnZmluZE1hbnknLCBieXBhc3NBdHRlbXB0KVxuICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ05vbi1hZG1pbiBieXBhc3MgYXR0ZW1wdCcsIHBhc3NlZDogZmFsc2UsIGVycm9yOiAnU2hvdWxkIGhhdmUgdGhyb3duJyB9KVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgVGVuYW50SXNvbGF0aW9uRXJyb3IpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ05vbi1hZG1pbiBieXBhc3MgYXR0ZW1wdCcsIHBhc3NlZDogdHJ1ZSB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ05vbi1hZG1pbiBieXBhc3MgYXR0ZW1wdCcsIHBhc3NlZDogZmFsc2UsIGVycm9yOiBTdHJpbmcoZSkgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gVGVzdCA2OiBTdXBlciBhZG1pbiBleHBsaWNpdCBieXBhc3MgKHNob3VsZCBzdWNjZWVkKVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdXBlckFkbWluQnlwYXNzID0gY3JlYXRlVGVuYW50Q29udGV4dChudWxsLCBhdXRoUmVzdWx0LnVzZXIuaWQsIHRydWUsIHRydWUpXG4gICAgICB2YWxpZGF0ZVRlbmFudEFjY2VzcygnVGVuYW50TWVtYmVyc2hpcCcsICdmaW5kTWFueScsIHN1cGVyQWRtaW5CeXBhc3MpXG4gICAgICBhd2FpdCBwcmlzbWEudGVuYW50TWVtYmVyc2hpcC5maW5kTWFueSgpXG4gICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnU3VwZXIgYWRtaW4gZXhwbGljaXQgYnlwYXNzJywgcGFzc2VkOiB0cnVlIH0pXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ1N1cGVyIGFkbWluIGV4cGxpY2l0IGJ5cGFzcycsIHBhc3NlZDogZmFsc2UsIGVycm9yOiBTdHJpbmcoZSkgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gVGVzdCA3OiBHbG9iYWwgbW9kZWwgKFVzZXIpIHNob3VsZCB3b3JrIHdpdGhvdXQgdGVuYW50IGNvbnRleHRcbiAgICB0cnkge1xuICAgICAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MoJ1VzZXInLCAnZmluZE1hbnknLCBudWxsKVxuICAgICAgYXdhaXQgcHJpc21hLnVzZXIuZmluZE1hbnkoeyB0YWtlOiAxIH0pXG4gICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnR2xvYmFsIG1vZGVsIHF1ZXJ5IHdpdGhvdXQgY29udGV4dCcsIHBhc3NlZDogdHJ1ZSB9KVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdHbG9iYWwgbW9kZWwgcXVlcnkgd2l0aG91dCBjb250ZXh0JywgcGFzc2VkOiBmYWxzZSwgZXJyb3I6IFN0cmluZyhlKSB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBUZXN0IDg6IENvbnRleHQgd2l0aCBubyB0ZW5hbnRJZCAoc2hvdWxkIGZhaWwgZm9yIHJlZ3VsYXIgdXNlcilcbiAgICB0cnkge1xuICAgICAgY29uc3Qgbm9UZW5hbnRDb250ZXh0ID0gY3JlYXRlVGVuYW50Q29udGV4dChudWxsLCAndGVzdC11c2VyJywgZmFsc2UpXG4gICAgICB2YWxpZGF0ZVRlbmFudEFjY2VzcygnVGVuYW50TWVtYmVyc2hpcCcsICdmaW5kTWFueScsIG5vVGVuYW50Q29udGV4dClcbiAgICAgIHJlc3VsdHMucHVzaCh7IHRlc3Q6ICdSZWd1bGFyIHVzZXIgd2l0aG91dCB0ZW5hbnRJZCcsIHBhc3NlZDogZmFsc2UsIGVycm9yOiAnU2hvdWxkIGhhdmUgdGhyb3duJyB9KVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgVGVuYW50SXNvbGF0aW9uRXJyb3IpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgdGVzdDogJ1JlZ3VsYXIgdXNlciB3aXRob3V0IHRlbmFudElkJywgcGFzc2VkOiB0cnVlIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzLnB1c2goeyB0ZXN0OiAnUmVndWxhciB1c2VyIHdpdGhvdXQgdGVuYW50SWQnLCBwYXNzZWQ6IGZhbHNlLCBlcnJvcjogU3RyaW5nKGUpIH0pXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHZpb2xhdGlvbnMgPSBnZXRWaW9sYXRpb25Mb2dzKClcbiAgICBjb25zdCBhbGxQYXNzZWQgPSByZXN1bHRzLmV2ZXJ5KHIgPT4gci5wYXNzZWQpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBhbGxQYXNzZWQsXG4gICAgICByZXN1bHRzLFxuICAgICAgdmlvbGF0aW9uc0xvZ2dlZDogdmlvbGF0aW9ucy5sZW5ndGgsXG4gICAgICB2aW9sYXRpb25zOiB2aW9sYXRpb25zLnNsaWNlKC0xMClcbiAgICB9KVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBydW4gaXNvbGF0aW9uIHRlc3RzOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmFpbGVkIHRvIHJ1biBpc29sYXRpb24gdGVzdHM6ICcgKyBTdHJpbmcoZXJyb3IpIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuLy8gREVMRVRFIC0gQ2xlYXIgdmlvbGF0aW9uIGxvZ3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZVN1cGVyQWRtaW4oKVxuICAgIFxuICAgIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBhdXRoUmVzdWx0LmVycm9yIH0sXG4gICAgICAgIHsgc3RhdHVzOiBhdXRoUmVzdWx0LnN0YXR1cyB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGNsZWFyVmlvbGF0aW9uTG9ncygpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnVmlvbGF0aW9uIGxvZ3MgY2xlYXJlZCdcbiAgICB9KVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjbGVhciB2aW9sYXRpb24gbG9nczonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBjbGVhciB2aW9sYXRpb24gbG9ncycgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInByaXNtYSIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwiY3JlYXRlVGVuYW50Q29udGV4dCIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIndpdGhUZW5hbnRGaWx0ZXIiLCJyZXF1aXJlU3VwZXJBZG1pbiIsIkdFVCIsInJlcXVlc3QiLCJhdXRoUmVzdWx0IiwiYXV0aG9yaXplZCIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJzdGF0dXMiLCJsb2dzIiwidmlvbGF0aW9uQ291bnQiLCJsZW5ndGgiLCJ2aW9sYXRpb25zIiwic2xpY2UiLCJjb25zb2xlIiwiUE9TVCIsInJlc3VsdHMiLCJ0ZW5hbnRzIiwidGVuYW50IiwiZmluZE1hbnkiLCJ0YWtlIiwidGVuYW50MSIsInRlbmFudDIiLCJub0NvbnRleHQiLCJ0ZW5hbnRNZW1iZXJzaGlwIiwicHVzaCIsInRlc3QiLCJwYXNzZWQiLCJlIiwiU3RyaW5nIiwiY29udGV4dDEiLCJpZCIsIndoZXJlIiwic3VwZXJBZG1pbkNvbnRleHQiLCJ1c2VyIiwiYnlwYXNzQXR0ZW1wdCIsInN1cGVyQWRtaW5CeXBhc3MiLCJub1RlbmFudENvbnRleHQiLCJhbGxQYXNzZWQiLCJldmVyeSIsInIiLCJ2aW9sYXRpb25zTG9nZ2VkIiwiREVMRVRFIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/admin/test-isolation/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMagicLink: () => (/* binding */ createMagicLink),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getCurrentSession: () => (/* binding */ getCurrentSession),\n/* harmony export */   getSessionByToken: () => (/* binding */ getSessionByToken),\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   isTenantAdmin: () => (/* binding */ isTenantAdmin),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   switchTenant: () => (/* binding */ switchTenant),\n/* harmony export */   verifyMagicLink: () => (/* binding */ verifyMagicLink)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n// Token expiration times\nconst MAGIC_LINK_EXPIRY_MINUTES = 15;\nconst SESSION_EXPIRY_DAYS = 7;\n/**\n * Generate a secure random token\n */ function generateToken() {\n    return (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])() + \"-\" + (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n}\n/**\n * Create a magic link for a user\n * If user doesn't exist, creates them\n */ async function createMagicLink(email, tenantId) {\n    const normalizedEmail = email.toLowerCase().trim();\n    // Find or create user\n    let user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email: normalizedEmail\n        }\n    });\n    if (!user) {\n        user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                email: normalizedEmail,\n                globalRole: \"USER\"\n            }\n        });\n    }\n    // Generate token\n    const token = generateToken();\n    const expiresAt = new Date();\n    expiresAt.setMinutes(expiresAt.getMinutes() + MAGIC_LINK_EXPIRY_MINUTES);\n    // Create magic link record\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            token,\n            userId: user.id,\n            tenantId: tenantId || null,\n            expiresAt\n        }\n    });\n    return {\n        token,\n        user\n    };\n}\n/**\n * Verify and consume a magic link\n * Returns user and creates session if valid\n */ async function verifyMagicLink(token) {\n    // Find the magic link\n    const magicLink = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: true\n        }\n    });\n    if (!magicLink) {\n        return null;\n    }\n    // Check if expired\n    if (magicLink.expiresAt < new Date()) {\n        // Delete expired token\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.delete({\n            where: {\n                id: magicLink.id\n            }\n        });\n        return null;\n    }\n    // Check if already used\n    if (magicLink.usedAt) {\n        return null;\n    }\n    // Mark as used\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.update({\n        where: {\n            id: magicLink.id\n        },\n        data: {\n            usedAt: new Date()\n        }\n    });\n    // Update user's last login\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n        where: {\n            id: magicLink.userId\n        },\n        data: {\n            lastLoginAt: new Date()\n        }\n    });\n    // Create session\n    const sessionToken = generateToken();\n    const sessionExpiresAt = new Date();\n    sessionExpiresAt.setDate(sessionExpiresAt.getDate() + SESSION_EXPIRY_DAYS);\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            userId: magicLink.userId,\n            token: sessionToken,\n            activeTenant: magicLink.tenantId,\n            expiresAt: sessionExpiresAt\n        }\n    });\n    // Get user with memberships\n    const user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            id: magicLink.userId\n        },\n        include: {\n            memberships: {\n                where: {\n                    isActive: true\n                },\n                include: {\n                    tenant: true\n                }\n            }\n        }\n    });\n    return {\n        user: user,\n        session: {\n            id: session.id,\n            token: sessionToken\n        },\n        tenantId: magicLink.tenantId\n    };\n}\n/**\n * Get session from token\n */ async function getSessionByToken(token) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: {\n                        where: {\n                            isActive: true\n                        },\n                        include: {\n                            tenant: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    // Check if expired\n    if (session.expiresAt < new Date()) {\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.delete({\n            where: {\n                id: session.id\n            }\n        });\n        return null;\n    }\n    // Update last active\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            lastActiveAt: new Date()\n        }\n    });\n    return {\n        user: session.user,\n        sessionId: session.id,\n        activeTenantId: session.activeTenant\n    };\n}\n/**\n * Get current session from cookies\n */ async function getCurrentSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (!sessionToken) {\n        return null;\n    }\n    return getSessionByToken(sessionToken);\n}\n/**\n * Set session cookie\n */ async function setSessionCookie(token) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    cookieStore.set(\"session_token\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: SESSION_EXPIRY_DAYS * 24 * 60 * 60,\n        path: \"/\"\n    });\n}\n/**\n * Clear session cookie and delete session\n */ async function logout() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (sessionToken) {\n        // Delete session from database\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.deleteMany({\n            where: {\n                token: sessionToken\n            }\n        });\n    }\n    // Clear cookie\n    cookieStore.delete(\"session_token\");\n}\n/**\n * Switch active tenant for a session\n */ async function switchTenant(sessionToken, tenantId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token: sessionToken\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: true\n                }\n            }\n        }\n    });\n    if (!session) return false;\n    // Check if user has access to this tenant\n    const hasMembership = session.user.memberships.some((m)=>m.tenantId === tenantId && m.isActive);\n    // Super admins can access any tenant\n    const isSuperAdmin = session.user.globalRole === \"SUPER_ADMIN\";\n    if (!hasMembership && !isSuperAdmin) {\n        return false;\n    }\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            activeTenant: tenantId\n        }\n    });\n    return true;\n}\n/**\n * Check if user is Super Admin\n */ function isSuperAdmin(user) {\n    return user.globalRole === \"SUPER_ADMIN\";\n}\n/**\n * Check if user is Tenant Admin for a specific tenant\n */ async function isTenantAdmin(userId, tenantId) {\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.tenantMembership.findUnique({\n        where: {\n            userId_tenantId: {\n                userId,\n                tenantId\n            }\n        }\n    });\n    return membership?.role === \"TENANT_ADMIN\" && membership.isActive;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YTtRQUFhO1FBQzdCTCxTQUFTO1lBQUVmLE1BQU07Z0JBQUVlLFNBQVM7b0JBQUVXLGFBQWE7Z0JBQUs7WUFBRTtRQUFFO0lBQ3REO0lBRUEsSUFBSSxDQUFDRixTQUFTLE9BQU87SUFFckIsMENBQTBDO0lBQzFDLE1BQU13QixnQkFBZ0J4QixRQUFReEIsSUFBSSxDQUFDMEIsV0FBVyxDQUFDdUIsSUFBSSxDQUNqREMsQ0FBQUEsSUFBS0EsRUFBRXRELFFBQVEsS0FBS0EsWUFBWXNELEVBQUV2QixRQUFRO0lBRzVDLHFDQUFxQztJQUNyQyxNQUFNd0IsZUFBZTNCLFFBQVF4QixJQUFJLENBQUNNLFVBQVUsS0FBSztJQUVqRCxJQUFJLENBQUMwQyxpQkFBaUIsQ0FBQ0csY0FBYztRQUNuQyxPQUFPO0lBQ1Q7SUFFQSxNQUFNaEUsMkNBQU1BLENBQUNxQyxPQUFPLENBQUNOLE1BQU0sQ0FBQztRQUMxQmhCLE9BQU87WUFBRUcsSUFBSW1CLFFBQVFuQixFQUFFO1FBQUM7UUFDeEJELE1BQU07WUFBRXFCLGNBQWM3QjtRQUFTO0lBQ2pDO0lBRUEsT0FBTztBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTdUQsYUFBYW5ELElBQVU7SUFDckMsT0FBT0EsS0FBS00sVUFBVSxLQUFLO0FBQzdCO0FBRUE7O0NBRUMsR0FDTSxlQUFlOEMsY0FBY3ZDLE1BQWMsRUFBRWpCLFFBQWdCO0lBQ2xFLE1BQU15RCxhQUFhLE1BQU1sRSwyQ0FBTUEsQ0FBQ21FLGdCQUFnQixDQUFDckQsVUFBVSxDQUFDO1FBQzFEQyxPQUFPO1lBQ0xxRCxpQkFBaUI7Z0JBQUUxQztnQkFBUWpCO1lBQVM7UUFDdEM7SUFDRjtJQUVBLE9BQU95RCxZQUFZRyxTQUFTLGtCQUFrQkgsV0FBVzFCLFFBQVE7QUFDbkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgVXNlciwgR2xvYmFsUm9sZSwgVGVuYW50Um9sZSwgVGVuYW50LCBUZW5hbnRNZW1iZXJzaGlwIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vIFRva2VuIGV4cGlyYXRpb24gdGltZXNcbmNvbnN0IE1BR0lDX0xJTktfRVhQSVJZX01JTlVURVMgPSAxNVxuY29uc3QgU0VTU0lPTl9FWFBJUllfREFZUyA9IDdcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIFNlc3Npb25Vc2VyID0gVXNlciAmIHtcbiAgbWVtYmVyc2hpcHM6IChUZW5hbnRNZW1iZXJzaGlwICYge1xuICAgIHRlbmFudDogVGVuYW50XG4gIH0pW11cbn1cblxuZXhwb3J0IHR5cGUgQXV0aFNlc3Npb24gPSB7XG4gIHVzZXI6IFNlc3Npb25Vc2VyXG4gIHNlc3Npb25JZDogc3RyaW5nXG4gIGFjdGl2ZVRlbmFudElkOiBzdHJpbmcgfCBudWxsXG59XG5cbi8qKlxuICogR2VuZXJhdGUgYSBzZWN1cmUgcmFuZG9tIHRva2VuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKCk6IHN0cmluZyB7XG4gIHJldHVybiB1dWlkdjQoKSArICctJyArIHV1aWR2NCgpXG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbWFnaWMgbGluayBmb3IgYSB1c2VyXG4gKiBJZiB1c2VyIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZXMgdGhlbVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTWFnaWNMaW5rKGVtYWlsOiBzdHJpbmcsIHRlbmFudElkPzogc3RyaW5nKTogUHJvbWlzZTx7IHRva2VuOiBzdHJpbmc7IHVzZXI6IFVzZXIgfT4ge1xuICBjb25zdCBub3JtYWxpemVkRW1haWwgPSBlbWFpbC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICBcbiAgLy8gRmluZCBvciBjcmVhdGUgdXNlclxuICBsZXQgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGVtYWlsOiBub3JtYWxpemVkRW1haWwgfVxuICB9KVxuICBcbiAgaWYgKCF1c2VyKSB7XG4gICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgZW1haWw6IG5vcm1hbGl6ZWRFbWFpbCxcbiAgICAgICAgZ2xvYmFsUm9sZTogJ1VTRVInXG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gR2VuZXJhdGUgdG9rZW5cbiAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZVRva2VuKClcbiAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoKVxuICBleHBpcmVzQXQuc2V0TWludXRlcyhleHBpcmVzQXQuZ2V0TWludXRlcygpICsgTUFHSUNfTElOS19FWFBJUllfTUlOVVRFUylcbiAgXG4gIC8vIENyZWF0ZSBtYWdpYyBsaW5rIHJlY29yZFxuICBhd2FpdCBwcmlzbWEubWFnaWNMaW5rLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgdG9rZW4sXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICB0ZW5hbnRJZDogdGVuYW50SWQgfHwgbnVsbCxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH1cbiAgfSlcbiAgXG4gIHJldHVybiB7IHRva2VuLCB1c2VyIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgYW5kIGNvbnN1bWUgYSBtYWdpYyBsaW5rXG4gKiBSZXR1cm5zIHVzZXIgYW5kIGNyZWF0ZXMgc2Vzc2lvbiBpZiB2YWxpZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWFnaWNMaW5rKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHsgdXNlcjogU2Vzc2lvblVzZXI7IHNlc3Npb246IHsgaWQ6IHN0cmluZzsgdG9rZW46IHN0cmluZyB9OyB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCB9IHwgbnVsbD4ge1xuICAvLyBGaW5kIHRoZSBtYWdpYyBsaW5rXG4gIGNvbnN0IG1hZ2ljTGluayA9IGF3YWl0IHByaXNtYS5tYWdpY0xpbmsuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7IHVzZXI6IHRydWUgfVxuICB9KVxuICBcbiAgaWYgKCFtYWdpY0xpbmspIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChtYWdpY0xpbmsuZXhwaXJlc0F0IDwgbmV3IERhdGUoKSkge1xuICAgIC8vIERlbGV0ZSBleHBpcmVkIHRva2VuXG4gICAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay5kZWxldGUoeyB3aGVyZTogeyBpZDogbWFnaWNMaW5rLmlkIH0gfSlcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBhbHJlYWR5IHVzZWRcbiAgaWYgKG1hZ2ljTGluay51c2VkQXQpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBNYXJrIGFzIHVzZWRcbiAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay51cGRhdGUoe1xuICAgIHdoZXJlOiB7IGlkOiBtYWdpY0xpbmsuaWQgfSxcbiAgICBkYXRhOiB7IHVzZWRBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICAvLyBVcGRhdGUgdXNlcidzIGxhc3QgbG9naW5cbiAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGRhdGE6IHsgbGFzdExvZ2luQXQ6IG5ldyBEYXRlKCkgfVxuICB9KVxuICBcbiAgLy8gQ3JlYXRlIHNlc3Npb25cbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2VuZXJhdGVUb2tlbigpXG4gIGNvbnN0IHNlc3Npb25FeHBpcmVzQXQgPSBuZXcgRGF0ZSgpXG4gIHNlc3Npb25FeHBpcmVzQXQuc2V0RGF0ZShzZXNzaW9uRXhwaXJlc0F0LmdldERhdGUoKSArIFNFU1NJT05fRVhQSVJZX0RBWVMpXG4gIFxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBpZDogdXVpZHY0KCksXG4gICAgICB1c2VySWQ6IG1hZ2ljTGluay51c2VySWQsXG4gICAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxuICAgICAgYWN0aXZlVGVuYW50OiBtYWdpY0xpbmsudGVuYW50SWQsXG4gICAgICBleHBpcmVzQXQ6IHNlc3Npb25FeHBpcmVzQXRcbiAgICB9XG4gIH0pXG4gIFxuICAvLyBHZXQgdXNlciB3aXRoIG1lbWJlcnNoaXBzXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHVzZXIgYXMgU2Vzc2lvblVzZXIsXG4gICAgc2Vzc2lvbjogeyBpZDogc2Vzc2lvbi5pZCwgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIHRlbmFudElkOiBtYWdpY0xpbmsudGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEdldCBzZXNzaW9uIGZyb20gdG9rZW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25CeVRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPEF1dGhTZXNzaW9uIHwgbnVsbD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBtZW1iZXJzaGlwczoge1xuICAgICAgICAgICAgd2hlcmU6IHsgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChzZXNzaW9uLmV4cGlyZXNBdCA8IG5ldyBEYXRlKCkpIHtcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGUoeyB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9IH0pXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuICBcbiAgLy8gVXBkYXRlIGxhc3QgYWN0aXZlXG4gIGF3YWl0IHByaXNtYS5zZXNzaW9uLnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHNlc3Npb24uaWQgfSxcbiAgICBkYXRhOiB7IGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHNlc3Npb24udXNlciBhcyBTZXNzaW9uVXNlcixcbiAgICBzZXNzaW9uSWQ6IHNlc3Npb24uaWQsXG4gICAgYWN0aXZlVGVuYW50SWQ6IHNlc3Npb24uYWN0aXZlVGVuYW50XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCBzZXNzaW9uIGZyb20gY29va2llc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFNlc3Npb24oKTogUHJvbWlzZTxBdXRoU2Vzc2lvbiB8IG51bGw+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gY29va2llU3RvcmUuZ2V0KCdzZXNzaW9uX3Rva2VuJyk/LnZhbHVlXG4gIFxuICBpZiAoIXNlc3Npb25Ub2tlbikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgXG4gIHJldHVybiBnZXRTZXNzaW9uQnlUb2tlbihzZXNzaW9uVG9rZW4pXG59XG5cbi8qKlxuICogU2V0IHNlc3Npb24gY29va2llXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29va2llU3RvcmUuc2V0KCdzZXNzaW9uX3Rva2VuJywgdG9rZW4sIHtcbiAgICBodHRwT25seTogdHJ1ZSxcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgIG1heEFnZTogU0VTU0lPTl9FWFBJUllfREFZUyAqIDI0ICogNjAgKiA2MCwgLy8gZGF5cyB0byBzZWNvbmRzXG4gICAgcGF0aDogJy8nXG4gIH0pXG59XG5cbi8qKlxuICogQ2xlYXIgc2Vzc2lvbiBjb29raWUgYW5kIGRlbGV0ZSBzZXNzaW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dvdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGNvb2tpZVN0b3JlLmdldCgnc2Vzc2lvbl90b2tlbicpPy52YWx1ZVxuICBcbiAgaWYgKHNlc3Npb25Ub2tlbikge1xuICAgIC8vIERlbGV0ZSBzZXNzaW9uIGZyb20gZGF0YWJhc2VcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGVNYW55KHtcbiAgICAgIHdoZXJlOiB7IHRva2VuOiBzZXNzaW9uVG9rZW4gfVxuICAgIH0pXG4gIH1cbiAgXG4gIC8vIENsZWFyIGNvb2tpZVxuICBjb29raWVTdG9yZS5kZWxldGUoJ3Nlc3Npb25fdG9rZW4nKVxufVxuXG4vKipcbiAqIFN3aXRjaCBhY3RpdmUgdGVuYW50IGZvciBhIHNlc3Npb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN3aXRjaFRlbmFudChzZXNzaW9uVG9rZW46IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIGluY2x1ZGU6IHsgdXNlcjogeyBpbmNsdWRlOiB7IG1lbWJlcnNoaXBzOiB0cnVlIH0gfSB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHJldHVybiBmYWxzZVxuICBcbiAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWNjZXNzIHRvIHRoaXMgdGVuYW50XG4gIGNvbnN0IGhhc01lbWJlcnNoaXAgPSBzZXNzaW9uLnVzZXIubWVtYmVyc2hpcHMuc29tZShcbiAgICBtID0+IG0udGVuYW50SWQgPT09IHRlbmFudElkICYmIG0uaXNBY3RpdmVcbiAgKVxuICBcbiAgLy8gU3VwZXIgYWRtaW5zIGNhbiBhY2Nlc3MgYW55IHRlbmFudFxuICBjb25zdCBpc1N1cGVyQWRtaW4gPSBzZXNzaW9uLnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJ1xuICBcbiAgaWYgKCFoYXNNZW1iZXJzaGlwICYmICFpc1N1cGVyQWRtaW4pIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBcbiAgYXdhaXQgcHJpc21hLnNlc3Npb24udXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9LFxuICAgIGRhdGE6IHsgYWN0aXZlVGVuYW50OiB0ZW5hbnRJZCB9XG4gIH0pXG4gIFxuICByZXR1cm4gdHJ1ZVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgU3VwZXIgQWRtaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU3VwZXJBZG1pbih1c2VyOiBVc2VyKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VyLmdsb2JhbFJvbGUgPT09ICdTVVBFUl9BRE1JTidcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB1c2VyIGlzIFRlbmFudCBBZG1pbiBmb3IgYSBzcGVjaWZpYyB0ZW5hbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzVGVuYW50QWRtaW4odXNlcklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF3YWl0IHByaXNtYS50ZW5hbnRNZW1iZXJzaGlwLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7XG4gICAgICB1c2VySWRfdGVuYW50SWQ6IHsgdXNlcklkLCB0ZW5hbnRJZCB9XG4gICAgfVxuICB9KVxuICBcbiAgcmV0dXJuIG1lbWJlcnNoaXA/LnJvbGUgPT09ICdURU5BTlRfQURNSU4nICYmIG1lbWJlcnNoaXAuaXNBY3RpdmVcbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJ2NCIsInV1aWR2NCIsImNvb2tpZXMiLCJNQUdJQ19MSU5LX0VYUElSWV9NSU5VVEVTIiwiU0VTU0lPTl9FWFBJUllfREFZUyIsImdlbmVyYXRlVG9rZW4iLCJjcmVhdGVNYWdpY0xpbmsiLCJlbWFpbCIsInRlbmFudElkIiwibm9ybWFsaXplZEVtYWlsIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImNyZWF0ZSIsImRhdGEiLCJpZCIsImdsb2JhbFJvbGUiLCJ0b2tlbiIsImV4cGlyZXNBdCIsIkRhdGUiLCJzZXRNaW51dGVzIiwiZ2V0TWludXRlcyIsIm1hZ2ljTGluayIsInVzZXJJZCIsInZlcmlmeU1hZ2ljTGluayIsImluY2x1ZGUiLCJkZWxldGUiLCJ1c2VkQXQiLCJ1cGRhdGUiLCJsYXN0TG9naW5BdCIsInNlc3Npb25Ub2tlbiIsInNlc3Npb25FeHBpcmVzQXQiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNlc3Npb24iLCJhY3RpdmVUZW5hbnQiLCJtZW1iZXJzaGlwcyIsImlzQWN0aXZlIiwidGVuYW50IiwiZ2V0U2Vzc2lvbkJ5VG9rZW4iLCJsYXN0QWN0aXZlQXQiLCJzZXNzaW9uSWQiLCJhY3RpdmVUZW5hbnRJZCIsImdldEN1cnJlbnRTZXNzaW9uIiwiY29va2llU3RvcmUiLCJnZXQiLCJ2YWx1ZSIsInNldFNlc3Npb25Db29raWUiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJsb2dvdXQiLCJkZWxldGVNYW55Iiwic3dpdGNoVGVuYW50IiwiaGFzTWVtYmVyc2hpcCIsInNvbWUiLCJtIiwiaXNTdXBlckFkbWluIiwiaXNUZW5hbnRBZG1pbiIsIm1lbWJlcnNoaXAiLCJ0ZW5hbnRNZW1iZXJzaGlwIiwidXNlcklkX3RlbmFudElkIiwicm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/authorization.ts":
/*!**********************************!*\
  !*** ./src/lib/authorization.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireSuperAdmin: () => (/* binding */ requireSuperAdmin),\n/* harmony export */   requireTenantAdmin: () => (/* binding */ requireTenantAdmin),\n/* harmony export */   requireTenantAdminBySlug: () => (/* binding */ requireTenantAdminBySlug),\n/* harmony export */   requireTenantMember: () => (/* binding */ requireTenantMember),\n/* harmony export */   requireTenantMemberBySlug: () => (/* binding */ requireTenantMemberBySlug)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\n\n/**\n * Require any authenticated user\n */ async function requireAuth() {\n    const session = await (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCurrentSession)();\n    if (!session) {\n        return {\n            authorized: false,\n            error: \"Authentication required\",\n            status: 401\n        };\n    }\n    if (!session.user.isActive) {\n        return {\n            authorized: false,\n            error: \"Account is disabled\",\n            status: 403\n        };\n    }\n    return {\n        authorized: true,\n        user: session.user,\n        session\n    };\n}\n/**\n * Require Super Admin role\n */ async function requireSuperAdmin() {\n    const authResult = await requireAuth();\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    if (authResult.user.globalRole !== \"SUPER_ADMIN\") {\n        return {\n            authorized: false,\n            error: \"Super Admin access required\",\n            status: 403\n        };\n    }\n    return authResult;\n}\n/**\n * Require Tenant Admin role for a specific tenant\n */ async function requireTenantAdmin(tenantId) {\n    const authResult = await requireAuth();\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    // Super admins can access any tenant as admin\n    if (authResult.user.globalRole === \"SUPER_ADMIN\") {\n        return {\n            ...authResult,\n            role: \"TENANT_ADMIN\",\n            tenantId\n        };\n    }\n    // Check tenant membership\n    const membership = authResult.session.user.memberships.find((m)=>m.tenantId === tenantId && m.isActive);\n    if (!membership) {\n        return {\n            authorized: false,\n            error: \"Not a member of this tenant\",\n            status: 403\n        };\n    }\n    if (membership.role !== \"TENANT_ADMIN\") {\n        return {\n            authorized: false,\n            error: \"Tenant Admin access required\",\n            status: 403\n        };\n    }\n    return {\n        ...authResult,\n        role: membership.role,\n        tenantId\n    };\n}\n/**\n * Require membership in a tenant (any role)\n */ async function requireTenantMember(tenantId) {\n    const authResult = await requireAuth();\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    // Super admins can access any tenant\n    if (authResult.user.globalRole === \"SUPER_ADMIN\") {\n        return {\n            ...authResult,\n            role: \"TENANT_ADMIN\",\n            tenantId\n        };\n    }\n    // Check tenant membership\n    const membership = authResult.session.user.memberships.find((m)=>m.tenantId === tenantId && m.isActive);\n    if (!membership) {\n        return {\n            authorized: false,\n            error: \"Not a member of this tenant\",\n            status: 403\n        };\n    }\n    return {\n        ...authResult,\n        role: membership.role,\n        tenantId\n    };\n}\n/**\n * Get tenant from slug and authorize\n */ async function requireTenantAdminBySlug(slug) {\n    const tenant = await _prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findUnique({\n        where: {\n            slug\n        },\n        include: {\n            domains: true\n        }\n    });\n    if (!tenant) {\n        return {\n            authorized: false,\n            error: \"Tenant not found\",\n            status: 404\n        };\n    }\n    const authResult = await requireTenantAdmin(tenant.id);\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    return {\n        ...authResult,\n        tenant\n    };\n}\n/**\n * Get tenant from slug and authorize as member\n */ async function requireTenantMemberBySlug(slug) {\n    const tenant = await _prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findUnique({\n        where: {\n            slug\n        },\n        include: {\n            domains: true\n        }\n    });\n    if (!tenant) {\n        return {\n            authorized: false,\n            error: \"Tenant not found\",\n            status: 404\n        };\n    }\n    const authResult = await requireTenantMember(tenant.id);\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    return {\n        ...authResult,\n        tenant\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxJQUFJLENBQUNKLFFBQVE7UUFDWCxPQUFPO1lBQ0xsQixZQUFZO1lBQ1pDLE9BQU87WUFDUEMsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxNQUFNSSxhQUFhLE1BQU1FLG1CQUFtQlUsT0FBT0ssRUFBRTtJQUVyRCxJQUFJLENBQUNqQixXQUFXTixVQUFVLEVBQUU7UUFDMUIsT0FBT007SUFDVDtJQUVBLE9BQU87UUFDTCxHQUFHQSxVQUFVO1FBQ2JZO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZU0sMEJBQTBCUCxJQUFZO0lBQzFELE1BQU1DLFNBQVMsTUFBTXJCLDJDQUFNQSxDQUFDcUIsTUFBTSxDQUFDQyxVQUFVLENBQUM7UUFDNUNDLE9BQU87WUFBRUg7UUFBSztRQUNkSSxTQUFTO1lBQUVDLFNBQVM7UUFBSztJQUMzQjtJQUVBLElBQUksQ0FBQ0osUUFBUTtRQUNYLE9BQU87WUFDTGxCLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLE1BQU1JLGFBQWEsTUFBTVMsb0JBQW9CRyxPQUFPSyxFQUFFO0lBRXRELElBQUksQ0FBQ2pCLFdBQVdOLFVBQVUsRUFBRTtRQUMxQixPQUFPTTtJQUNUO0lBRUEsT0FBTztRQUNMLEdBQUdBLFVBQVU7UUFDYlk7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9hdXRob3JpemF0aW9uLnRzPzM1YTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q3VycmVudFNlc3Npb24sIEF1dGhTZXNzaW9uIH0gZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnXG5pbXBvcnQgeyBVc2VyLCBUZW5hbnRSb2xlIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmV4cG9ydCB0eXBlIEF1dGhvcml6YXRpb25SZXN1bHQgPSBcbiAgfCB7IGF1dGhvcml6ZWQ6IHRydWU7IHVzZXI6IFVzZXI7IHNlc3Npb246IEF1dGhTZXNzaW9uIH1cbiAgfCB7IGF1dGhvcml6ZWQ6IGZhbHNlOyBlcnJvcjogc3RyaW5nOyBzdGF0dXM6IG51bWJlciB9XG5cbmV4cG9ydCB0eXBlIFRlbmFudEF1dGhvcml6YXRpb25SZXN1bHQgPSBcbiAgfCB7IGF1dGhvcml6ZWQ6IHRydWU7IHVzZXI6IFVzZXI7IHNlc3Npb246IEF1dGhTZXNzaW9uOyByb2xlOiBUZW5hbnRSb2xlOyB0ZW5hbnRJZDogc3RyaW5nIH1cbiAgfCB7IGF1dGhvcml6ZWQ6IGZhbHNlOyBlcnJvcjogc3RyaW5nOyBzdGF0dXM6IG51bWJlciB9XG5cbi8qKlxuICogUmVxdWlyZSBhbnkgYXV0aGVudGljYXRlZCB1c2VyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXV0aCgpOiBQcm9taXNlPEF1dGhvcml6YXRpb25SZXN1bHQ+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEN1cnJlbnRTZXNzaW9uKClcbiAgXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLFxuICAgICAgc3RhdHVzOiA0MDFcbiAgICB9XG4gIH1cbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyLmlzQWN0aXZlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdBY2NvdW50IGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGF1dGhvcml6ZWQ6IHRydWUsXG4gICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgIHNlc3Npb25cbiAgfVxufVxuXG4vKipcbiAqIFJlcXVpcmUgU3VwZXIgQWRtaW4gcm9sZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVN1cGVyQWRtaW4oKTogUHJvbWlzZTxBdXRob3JpemF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlQXV0aCgpXG4gIFxuICBpZiAoIWF1dGhSZXN1bHQuYXV0aG9yaXplZCkge1xuICAgIHJldHVybiBhdXRoUmVzdWx0XG4gIH1cbiAgXG4gIGlmIChhdXRoUmVzdWx0LnVzZXIuZ2xvYmFsUm9sZSAhPT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnU3VwZXIgQWRtaW4gYWNjZXNzIHJlcXVpcmVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gYXV0aFJlc3VsdFxufVxuXG4vKipcbiAqIFJlcXVpcmUgVGVuYW50IEFkbWluIHJvbGUgZm9yIGEgc3BlY2lmaWMgdGVuYW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlVGVuYW50QWRtaW4odGVuYW50SWQ6IHN0cmluZyk6IFByb21pc2U8VGVuYW50QXV0aG9yaXphdGlvblJlc3VsdD4ge1xuICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZUF1dGgoKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICAvLyBTdXBlciBhZG1pbnMgY2FuIGFjY2VzcyBhbnkgdGVuYW50IGFzIGFkbWluXG4gIGlmIChhdXRoUmVzdWx0LnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5hdXRoUmVzdWx0LFxuICAgICAgcm9sZTogJ1RFTkFOVF9BRE1JTicsXG4gICAgICB0ZW5hbnRJZFxuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2hlY2sgdGVuYW50IG1lbWJlcnNoaXBcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF1dGhSZXN1bHQuc2Vzc2lvbi51c2VyLm1lbWJlcnNoaXBzLmZpbmQoXG4gICAgbSA9PiBtLnRlbmFudElkID09PSB0ZW5hbnRJZCAmJiBtLmlzQWN0aXZlXG4gIClcbiAgXG4gIGlmICghbWVtYmVyc2hpcCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnTm90IGEgbWVtYmVyIG9mIHRoaXMgdGVuYW50JyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICBpZiAobWVtYmVyc2hpcC5yb2xlICE9PSAnVEVOQU5UX0FETUlOJykge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnVGVuYW50IEFkbWluIGFjY2VzcyByZXF1aXJlZCcsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICAuLi5hdXRoUmVzdWx0LFxuICAgIHJvbGU6IG1lbWJlcnNoaXAucm9sZSxcbiAgICB0ZW5hbnRJZFxuICB9XG59XG5cbi8qKlxuICogUmVxdWlyZSBtZW1iZXJzaGlwIGluIGEgdGVuYW50IChhbnkgcm9sZSlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVUZW5hbnRNZW1iZXIodGVuYW50SWQ6IHN0cmluZyk6IFByb21pc2U8VGVuYW50QXV0aG9yaXphdGlvblJlc3VsdD4ge1xuICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZUF1dGgoKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICAvLyBTdXBlciBhZG1pbnMgY2FuIGFjY2VzcyBhbnkgdGVuYW50XG4gIGlmIChhdXRoUmVzdWx0LnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5hdXRoUmVzdWx0LFxuICAgICAgcm9sZTogJ1RFTkFOVF9BRE1JTicsXG4gICAgICB0ZW5hbnRJZFxuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2hlY2sgdGVuYW50IG1lbWJlcnNoaXBcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF1dGhSZXN1bHQuc2Vzc2lvbi51c2VyLm1lbWJlcnNoaXBzLmZpbmQoXG4gICAgbSA9PiBtLnRlbmFudElkID09PSB0ZW5hbnRJZCAmJiBtLmlzQWN0aXZlXG4gIClcbiAgXG4gIGlmICghbWVtYmVyc2hpcCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnTm90IGEgbWVtYmVyIG9mIHRoaXMgdGVuYW50JyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIC4uLmF1dGhSZXN1bHQsXG4gICAgcm9sZTogbWVtYmVyc2hpcC5yb2xlLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGZyb20gc2x1ZyBhbmQgYXV0aG9yaXplXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlVGVuYW50QWRtaW5CeVNsdWcoc2x1Zzogc3RyaW5nKTogUHJvbWlzZTxUZW5hbnRBdXRob3JpemF0aW9uUmVzdWx0ICYgeyB0ZW5hbnQ/OiBhbnkgfT4ge1xuICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBwcmlzbWEudGVuYW50LmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNsdWcgfSxcbiAgICBpbmNsdWRlOiB7IGRvbWFpbnM6IHRydWUgfVxuICB9KVxuICBcbiAgaWYgKCF0ZW5hbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ1RlbmFudCBub3QgZm91bmQnLFxuICAgICAgc3RhdHVzOiA0MDRcbiAgICB9XG4gIH1cbiAgXG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlVGVuYW50QWRtaW4odGVuYW50LmlkKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIC4uLmF1dGhSZXN1bHQsXG4gICAgdGVuYW50XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGZyb20gc2x1ZyBhbmQgYXV0aG9yaXplIGFzIG1lbWJlclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVRlbmFudE1lbWJlckJ5U2x1ZyhzbHVnOiBzdHJpbmcpOiBQcm9taXNlPFRlbmFudEF1dGhvcml6YXRpb25SZXN1bHQgJiB7IHRlbmFudD86IGFueSB9PiB7XG4gIGNvbnN0IHRlbmFudCA9IGF3YWl0IHByaXNtYS50ZW5hbnQuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgc2x1ZyB9LFxuICAgIGluY2x1ZGU6IHsgZG9tYWluczogdHJ1ZSB9XG4gIH0pXG4gIFxuICBpZiAoIXRlbmFudCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnVGVuYW50IG5vdCBmb3VuZCcsXG4gICAgICBzdGF0dXM6IDQwNFxuICAgIH1cbiAgfVxuICBcbiAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHJlcXVpcmVUZW5hbnRNZW1iZXIodGVuYW50LmlkKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIC4uLmF1dGhSZXN1bHQsXG4gICAgdGVuYW50XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJnZXRDdXJyZW50U2Vzc2lvbiIsInByaXNtYSIsInJlcXVpcmVBdXRoIiwic2Vzc2lvbiIsImF1dGhvcml6ZWQiLCJlcnJvciIsInN0YXR1cyIsInVzZXIiLCJpc0FjdGl2ZSIsInJlcXVpcmVTdXBlckFkbWluIiwiYXV0aFJlc3VsdCIsImdsb2JhbFJvbGUiLCJyZXF1aXJlVGVuYW50QWRtaW4iLCJ0ZW5hbnRJZCIsInJvbGUiLCJtZW1iZXJzaGlwIiwibWVtYmVyc2hpcHMiLCJmaW5kIiwibSIsInJlcXVpcmVUZW5hbnRNZW1iZXIiLCJyZXF1aXJlVGVuYW50QWRtaW5CeVNsdWciLCJzbHVnIiwidGVuYW50IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaW5jbHVkZSIsImRvbWFpbnMiLCJpZCIsInJlcXVpcmVUZW5hbnRNZW1iZXJCeVNsdWciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/authorization.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxDQUFDO0lBQy9ESSxLQUFLQyxLQUF5QixHQUFnQjtRQUFDO1FBQVM7S0FBTyxHQUFHLENBQVM7QUFDN0UsR0FBRTtBQUVGLElBQUlBLElBQXlCLEVBQWNKLGdCQUFnQkUsTUFBTSxHQUFHQTtBQUVwRSx1Q0FBdUM7QUFjWiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9saWIvcHJpc21hLnRzPzAxZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoe1xuICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gWydlcnJvcicsICd3YXJuJ10gOiBbJ2Vycm9yJ10sXG59KVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuXG4vLyBSZS1leHBvcnQgdGVuYW50IGlzb2xhdGlvbiB1dGlsaXRpZXNcbmV4cG9ydCB7XG4gIHZhbGlkYXRlVGVuYW50QWNjZXNzLFxuICBjcmVhdGVUZW5hbnRDb250ZXh0LFxuICB3aXRoVGVuYW50RmlsdGVyLFxuICB3aXRoVGVuYW50RGF0YSxcbiAgVGVuYW50SXNvbGF0aW9uRXJyb3IsXG4gIGlzVGVuYW50U2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgdHlwZSBUZW5hbnRDb250ZXh0LFxuICB0eXBlIFRlbmFudFNjb3BlZE1vZGVsXG59IGZyb20gJy4vdGVuYW50LWlzb2xhdGlvbidcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwiY3JlYXRlVGVuYW50Q29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImdldFZpb2xhdGlvbkxvZ3MiLCJjbGVhclZpb2xhdGlvbkxvZ3MiLCJsb2dWaW9sYXRpb24iLCJURU5BTlRfU0NPUEVEX01PREVMUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxZQUFxQixFQUNyQkQsa0JBQTJCLEtBQUs7SUFFaEMsT0FBTztRQUNMSTtRQUNBRTtRQUNBTDtRQUNBRDtJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNPLGlCQUNkQyxLQUFRLEVBQ1JKLFFBQWdCO0lBRWhCLE9BQU87UUFDTCxHQUFHSSxLQUFLO1FBQ1JKO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0ssZUFDZEMsSUFBTyxFQUNQTixRQUFnQjtJQUVoQixPQUFPO1FBQ0wsR0FBR00sSUFBSTtRQUNQTjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3RlbmFudC1pc29sYXRpb24udHM/ZjI1MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlbmFudCBJc29sYXRpb24gRW5mb3JjZW1lbnRcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgc3RyaWN0IHRlbmFudCBkYXRhIGlzb2xhdGlvbiBhdCB0aGUgZGF0YWJhc2UgbGV2ZWwuXG4gKiBJbnN0ZWFkIG9mIFByaXNtYSBtaWRkbGV3YXJlICh3aGljaCBoYXMgYXN5bmMgY29udGV4dCBpc3N1ZXMpLCB0aGlzIHVzZXNcbiAqIGFwcGxpY2F0aW9uLWxldmVsIHZhbGlkYXRpb24gYmVmb3JlIHF1ZXJpZXMgYXJlIGV4ZWN1dGVkLlxuICogXG4gKiBGZWF0dXJlczpcbiAqIC0gUHJlLXF1ZXJ5IHZhbGlkYXRpb24gZnVuY3Rpb25zXG4gKiAtIFNVUEVSX0FETUlOIGJ5cGFzcyB3aXRoIGV4cGxpY2l0IGZsYWdcbiAqIC0gVmlvbGF0aW9uIGxvZ2dpbmcgYW5kIGhhcmQgZmFpbHVyZVxuICogLSBTYWZlIHF1ZXJ5IGJ1aWxkZXJzIHRoYXQgZW5mb3JjZSB0ZW5hbnQgc2NvcGluZ1xuICovXG5cbi8vIE1vZGVscyB0aGF0IHJlcXVpcmUgdGVuYW50IGlzb2xhdGlvblxuZXhwb3J0IGNvbnN0IFRFTkFOVF9TQ09QRURfTU9ERUxTID0gW1xuICAnVGVuYW50TWVtYmVyc2hpcCcsXG4gICdUZW5hbnREb21haW4nLCBcbiAgJ0F1ZGl0TG9nJyxcbiAgLy8gQWRkIGZ1dHVyZSB0ZW5hbnQtc2NvcGVkIG1vZGVscyBoZXJlXG5dIGFzIGNvbnN0XG5cbmV4cG9ydCB0eXBlIFRlbmFudFNjb3BlZE1vZGVsID0gdHlwZW9mIFRFTkFOVF9TQ09QRURfTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbi8qKlxuICogVmlvbGF0aW9uIGxvZ2dlclxuICovXG5pbnRlcmZhY2UgVmlvbGF0aW9uTG9nIHtcbiAgdGltZXN0YW1wOiBEYXRlXG4gIG1vZGVsOiBzdHJpbmdcbiAgYWN0aW9uOiBzdHJpbmdcbiAgY29udGV4dDogVGVuYW50Q29udGV4dCB8IG51bGxcbiAgcXVlcnk6IGFueVxuICByZWFzb246IHN0cmluZ1xufVxuXG5jb25zdCB2aW9sYXRpb25zOiBWaW9sYXRpb25Mb2dbXSA9IFtdXG5jb25zdCBNQVhfVklPTEFUSU9OX0xPR1MgPSAxMDAwXG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dWaW9sYXRpb24odmlvbGF0aW9uOiBPbWl0PFZpb2xhdGlvbkxvZywgJ3RpbWVzdGFtcCc+KTogdm9pZCB7XG4gIGNvbnN0IGxvZzogVmlvbGF0aW9uTG9nID0ge1xuICAgIC4uLnZpb2xhdGlvbixcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgfVxuICBcbiAgdmlvbGF0aW9ucy5wdXNoKGxvZylcbiAgXG4gIGlmICh2aW9sYXRpb25zLmxlbmd0aCA+IE1BWF9WSU9MQVRJT05fTE9HUykge1xuICAgIHZpb2xhdGlvbnMuc2hpZnQoKVxuICB9XG4gIFxuICBjb25zb2xlLmVycm9yKCdbVEVOQU5UIElTT0xBVElPTiBWSU9MQVRJT05dJywgSlNPTi5zdHJpbmdpZnkobG9nLCBudWxsLCAyKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZpb2xhdGlvbkxvZ3MoKTogVmlvbGF0aW9uTG9nW10ge1xuICByZXR1cm4gWy4uLnZpb2xhdGlvbnNdXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclZpb2xhdGlvbkxvZ3MoKTogdm9pZCB7XG4gIHZpb2xhdGlvbnMubGVuZ3RoID0gMFxufVxuXG4vKipcbiAqIFRlbmFudCBJc29sYXRpb24gRXJyb3JcbiAqL1xuZXhwb3J0IGNsYXNzIFRlbmFudElzb2xhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgcHVibGljIG1vZGVsOiBzdHJpbmcsXG4gICAgcHVibGljIGFjdGlvbjogc3RyaW5nLFxuICAgIHB1YmxpYyBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdUZW5hbnRJc29sYXRpb25FcnJvcidcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIGEgbW9kZWwgaXMgdGVuYW50LXNjb3BlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUZW5hbnRTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgVGVuYW50U2NvcGVkTW9kZWwge1xuICByZXR1cm4gVEVOQU5UX1NDT1BFRF9NT0RFTFMuaW5jbHVkZXMobW9kZWwgYXMgYW55KVxufVxuXG4vKipcbiAqIFZhbGlkYXRlIHRlbmFudCBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgdGVuYW50LXNjb3BlZCBkYXRhYmFzZSBvcGVyYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVGVuYW50QWNjZXNzKFxuICBtb2RlbDogc3RyaW5nLFxuICBhY3Rpb246IHN0cmluZyxcbiAgY29udGV4dDogVGVuYW50Q29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5VGVuYW50SWQ/OiBzdHJpbmcgfCBudWxsXG4pOiB2b2lkIHtcbiAgLy8gU2tpcCB2YWxpZGF0aW9uIGZvciBnbG9iYWwgbW9kZWxzXG4gIGlmICghaXNUZW5hbnRTY29wZWRNb2RlbChtb2RlbCkpIHtcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gQWxsb3cgZXhwbGljaXQgYnlwYXNzIChmb3IgbWlncmF0aW9ucywgYWRtaW4gdG9vbHMsIGV0Yy4pXG4gIGlmIChjb250ZXh0Py5ieXBhc3NJc29sYXRpb24gPT09IHRydWUpIHtcbiAgICBpZiAoIWNvbnRleHQuaXNTdXBlckFkbWluKSB7XG4gICAgICBjb25zdCByZWFzb24gPSAnQnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBkYXRhXG4gIGlmIChjb250ZXh0Py5pc1N1cGVyQWRtaW4pIHtcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gTm8gY29udGV4dCA9IHZpb2xhdGlvblxuICBpZiAoIWNvbnRleHQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gdGVuYW50IGNvbnRleHQgcHJvdmlkZWQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBObyB0ZW5hbnRJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC50ZW5hbnRJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnRJZCBpbiBjb250ZXh0IGZvciB0ZW5hbnQtc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgdGVuYW50SWQsIGl0IG11c3QgbWF0Y2ggY29udGV4dFxuICBpZiAocXVlcnlUZW5hbnRJZCAmJiBxdWVyeVRlbmFudElkICE9PSBjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gYENyb3NzLXRlbmFudCBhY2Nlc3MgYXR0ZW1wdDogcXVlcnkgdGVuYW50SWQgKCR7cXVlcnlUZW5hbnRJZH0pICE9IGNvbnRleHQgdGVuYW50SWQgKCR7Y29udGV4dC50ZW5hbnRJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHRlbmFudCBjb250ZXh0IGZyb20gdXNlciBzZXNzaW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUZW5hbnRDb250ZXh0KFxuICB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsLFxuICBpc1N1cGVyQWRtaW46IGJvb2xlYW4sXG4gIGJ5cGFzc0lzb2xhdGlvbjogYm9vbGVhbiA9IGZhbHNlXG4pOiBUZW5hbnRDb250ZXh0IHtcbiAgcmV0dXJuIHtcbiAgICB0ZW5hbnRJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJURU5BTlRfU0NPUEVEX01PREVMUyIsInZpb2xhdGlvbnMiLCJNQVhfVklPTEFUSU9OX0xPR1MiLCJsb2dWaW9sYXRpb24iLCJ2aW9sYXRpb24iLCJsb2ciLCJ0aW1lc3RhbXAiLCJEYXRlIiwicHVzaCIsImxlbmd0aCIsInNoaWZ0IiwiY29uc29sZSIsImVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFZpb2xhdGlvbkxvZ3MiLCJjbGVhclZpb2xhdGlvbkxvZ3MiLCJUZW5hbnRJc29sYXRpb25FcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwibW9kZWwiLCJhY3Rpb24iLCJjb250ZXh0IiwibmFtZSIsImlzVGVuYW50U2NvcGVkTW9kZWwiLCJpbmNsdWRlcyIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwicXVlcnlUZW5hbnRJZCIsImJ5cGFzc0lzb2xhdGlvbiIsImlzU3VwZXJBZG1pbiIsInJlYXNvbiIsInF1ZXJ5IiwidGVuYW50SWQiLCJjcmVhdGVUZW5hbnRDb250ZXh0IiwidXNlcklkIiwid2l0aFRlbmFudEZpbHRlciIsIndoZXJlIiwid2l0aFRlbmFudERhdGEiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Ftest-isolation%2Froute&page=%2Fapi%2Fadmin%2Ftest-isolation%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Ftest-isolation%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();