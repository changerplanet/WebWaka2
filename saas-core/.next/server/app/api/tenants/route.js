"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tenants/route";
exports.ids = ["app/api/tenants/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_tenants_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/tenants/route.ts */ \"(rsc)/./src/app/api/tenants/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tenants/route\",\n        pathname: \"/api/tenants\",\n        filename: \"route\",\n        bundlePath: \"app/api/tenants/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/tenants/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_tenants_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/tenants/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0ZW5hbnRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0ZW5hbnRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGVuYW50cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDTDtBQUN4RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2VtYXJrZXR3YWthLz9hODFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL3RlbmFudHMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RlbmFudHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90ZW5hbnRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS90ZW5hbnRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2FwcC9zYWFzLWNvcmUvc3JjL2FwcC9hcGkvdGVuYW50cy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvdGVuYW50cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/tenants/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/tenants/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n\n\n\n// GET /api/tenants - List all tenants (Super Admin only in production)\nasync function GET(request) {\n    try {\n        const tenants = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findMany({\n            include: {\n                domains: true,\n                _count: {\n                    select: {\n                        memberships: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            tenants: tenants.map((t)=>({\n                    ...t,\n                    // Map _count to users for backwards compatibility\n                    _count: {\n                        users: t._count.memberships\n                    }\n                }))\n        });\n    } catch (error) {\n        console.error(\"Failed to fetch tenants:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to fetch tenants\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST /api/tenants - Create a new tenant\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { name, slug, customDomain, appName, logoUrl, faviconUrl, primaryColor, secondaryColor } = body;\n        // Validate required fields\n        if (!name || !slug) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Name and slug are required\"\n            }, {\n                status: 400\n            });\n        }\n        const normalizedSlug = slug.toLowerCase();\n        // Validate slug format (alphanumeric and hyphens only)\n        if (!/^[a-z0-9-]+$/.test(normalizedSlug)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Slug must contain only lowercase letters, numbers, and hyphens\"\n            }, {\n                status: 400\n            });\n        }\n        // Check for existing slug\n        const existingTenant = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findUnique({\n            where: {\n                slug: normalizedSlug\n            }\n        });\n        if (existingTenant) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"This subdomain is already taken\"\n            }, {\n                status: 409\n            });\n        }\n        // Check for existing domain\n        const existingDomain = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantDomain.findUnique({\n            where: {\n                domain: normalizedSlug\n            }\n        });\n        if (existingDomain) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"This subdomain is already in use\"\n            }, {\n                status: 409\n            });\n        }\n        // Check for existing custom domain if provided\n        if (customDomain) {\n            const existingCustomDomain = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantDomain.findUnique({\n                where: {\n                    domain: customDomain.toLowerCase()\n                }\n            });\n            if (existingCustomDomain) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"This custom domain is already in use\"\n                }, {\n                    status: 409\n                });\n            }\n        }\n        // Create tenant with domains in a transaction\n        const tenant = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                name,\n                slug: normalizedSlug,\n                appName: appName || name,\n                logoUrl: logoUrl || null,\n                faviconUrl: faviconUrl || null,\n                primaryColor: primaryColor || \"#6366f1\",\n                secondaryColor: secondaryColor || \"#8b5cf6\",\n                domains: {\n                    create: [\n                        // Always create subdomain\n                        {\n                            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                            domain: normalizedSlug,\n                            type: \"SUBDOMAIN\",\n                            status: \"VERIFIED\",\n                            isPrimary: !customDomain,\n                            verifiedAt: new Date()\n                        },\n                        // Optionally create custom domain\n                        ...customDomain ? [\n                            {\n                                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                                domain: customDomain.toLowerCase(),\n                                type: \"CUSTOM\",\n                                status: \"PENDING\",\n                                isPrimary: true,\n                                verificationToken: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])()\n                            }\n                        ] : []\n                    ]\n                }\n            },\n            include: {\n                domains: true\n            }\n        });\n        // Transform for backwards compatibility\n        const response = {\n            ...tenant,\n            branding: {\n                id: tenant.id,\n                tenantId: tenant.id,\n                appName: tenant.appName,\n                logoUrl: tenant.logoUrl,\n                faviconUrl: tenant.faviconUrl,\n                primaryColor: tenant.primaryColor,\n                secondaryColor: tenant.secondaryColor\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            tenant: response\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Failed to create tenant:\", error);\n        // Handle Prisma unique constraint errors\n        if (error.code === \"P2002\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"A tenant with this slug or domain already exists\"\n            }, {\n                status: 409\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to create tenant\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjFCLE9BQU8wQixjQUFjO1lBQ3ZDO1FBQ0Y7UUFFQSxPQUFPakMscURBQVlBLENBQUNnQixJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVFYsUUFBUTZDO1FBQ1YsR0FBRztZQUFFN0IsUUFBUTtRQUFJO0lBRW5CLEVBQUUsT0FBT0YsT0FBWTtRQUNuQkMsUUFBUUQsS0FBSyxDQUFDLDRCQUE0QkE7UUFFMUMseUNBQXlDO1FBQ3pDLElBQUlBLE1BQU1rQyxJQUFJLEtBQUssU0FBUztZQUMxQixPQUFPdkQscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPSSxPQUFPO1lBQW1ELEdBQzVFO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPdkIscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0ksT0FBTztRQUEwQixHQUNuRDtZQUFFRSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2VtYXJrZXR3YWthLy4vc3JjL2FwcC9hcGkvdGVuYW50cy9yb3V0ZS50cz9lOWM5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5cbi8vIEdFVCAvYXBpL3RlbmFudHMgLSBMaXN0IGFsbCB0ZW5hbnRzIChTdXBlciBBZG1pbiBvbmx5IGluIHByb2R1Y3Rpb24pXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdGVuYW50cyA9IGF3YWl0IHByaXNtYS50ZW5hbnQuZmluZE1hbnkoe1xuICAgICAgaW5jbHVkZToge1xuICAgICAgICBkb21haW5zOiB0cnVlLFxuICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICBzZWxlY3Q6IHsgbWVtYmVyc2hpcHM6IHRydWUgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XG4gICAgfSlcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdGVuYW50czogdGVuYW50cy5tYXAodCA9PiAoe1xuICAgICAgICAuLi50LFxuICAgICAgICAvLyBNYXAgX2NvdW50IHRvIHVzZXJzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuICAgICAgICBfY291bnQ6IHsgdXNlcnM6IHQuX2NvdW50Lm1lbWJlcnNoaXBzIH1cbiAgICAgIH0pKVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHRlbmFudHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggdGVuYW50cycgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vLyBQT1NUIC9hcGkvdGVuYW50cyAtIENyZWF0ZSBhIG5ldyB0ZW5hbnRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3Qge1xuICAgICAgbmFtZSxcbiAgICAgIHNsdWcsXG4gICAgICBjdXN0b21Eb21haW4sXG4gICAgICBhcHBOYW1lLFxuICAgICAgbG9nb1VybCxcbiAgICAgIGZhdmljb25VcmwsXG4gICAgICBwcmltYXJ5Q29sb3IsXG4gICAgICBzZWNvbmRhcnlDb2xvclxuICAgIH0gPSBib2R5XG5cbiAgICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBmaWVsZHNcbiAgICBpZiAoIW5hbWUgfHwgIXNsdWcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOYW1lIGFuZCBzbHVnIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3Qgbm9ybWFsaXplZFNsdWcgPSBzbHVnLnRvTG93ZXJDYXNlKClcblxuICAgIC8vIFZhbGlkYXRlIHNsdWcgZm9ybWF0IChhbHBoYW51bWVyaWMgYW5kIGh5cGhlbnMgb25seSlcbiAgICBpZiAoIS9eW2EtejAtOS1dKyQvLnRlc3Qobm9ybWFsaXplZFNsdWcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnU2x1ZyBtdXN0IGNvbnRhaW4gb25seSBsb3dlcmNhc2UgbGV0dGVycywgbnVtYmVycywgYW5kIGh5cGhlbnMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBzbHVnXG4gICAgY29uc3QgZXhpc3RpbmdUZW5hbnQgPSBhd2FpdCBwcmlzbWEudGVuYW50LmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgc2x1Zzogbm9ybWFsaXplZFNsdWcgfVxuICAgIH0pXG4gICAgaWYgKGV4aXN0aW5nVGVuYW50KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVGhpcyBzdWJkb21haW4gaXMgYWxyZWFkeSB0YWtlbicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwOSB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIGRvbWFpblxuICAgIGNvbnN0IGV4aXN0aW5nRG9tYWluID0gYXdhaXQgcHJpc21hLnRlbmFudERvbWFpbi5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGRvbWFpbjogbm9ybWFsaXplZFNsdWcgfVxuICAgIH0pXG4gICAgaWYgKGV4aXN0aW5nRG9tYWluKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVGhpcyBzdWJkb21haW4gaXMgYWxyZWFkeSBpbiB1c2UnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBjdXN0b20gZG9tYWluIGlmIHByb3ZpZGVkXG4gICAgaWYgKGN1c3RvbURvbWFpbikge1xuICAgICAgY29uc3QgZXhpc3RpbmdDdXN0b21Eb21haW4gPSBhd2FpdCBwcmlzbWEudGVuYW50RG9tYWluLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBkb21haW46IGN1c3RvbURvbWFpbi50b0xvd2VyQ2FzZSgpIH1cbiAgICAgIH0pXG4gICAgICBpZiAoZXhpc3RpbmdDdXN0b21Eb21haW4pIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVGhpcyBjdXN0b20gZG9tYWluIGlzIGFscmVhZHkgaW4gdXNlJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRlbmFudCB3aXRoIGRvbWFpbnMgaW4gYSB0cmFuc2FjdGlvblxuICAgIGNvbnN0IHRlbmFudCA9IGF3YWl0IHByaXNtYS50ZW5hbnQuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgICBuYW1lLFxuICAgICAgICBzbHVnOiBub3JtYWxpemVkU2x1ZyxcbiAgICAgICAgYXBwTmFtZTogYXBwTmFtZSB8fCBuYW1lLFxuICAgICAgICBsb2dvVXJsOiBsb2dvVXJsIHx8IG51bGwsXG4gICAgICAgIGZhdmljb25Vcmw6IGZhdmljb25VcmwgfHwgbnVsbCxcbiAgICAgICAgcHJpbWFyeUNvbG9yOiBwcmltYXJ5Q29sb3IgfHwgJyM2MzY2ZjEnLFxuICAgICAgICBzZWNvbmRhcnlDb2xvcjogc2Vjb25kYXJ5Q29sb3IgfHwgJyM4YjVjZjYnLFxuICAgICAgICBkb21haW5zOiB7XG4gICAgICAgICAgY3JlYXRlOiBbXG4gICAgICAgICAgICAvLyBBbHdheXMgY3JlYXRlIHN1YmRvbWFpblxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgICAgICAgIGRvbWFpbjogbm9ybWFsaXplZFNsdWcsXG4gICAgICAgICAgICAgIHR5cGU6ICdTVUJET01BSU4nLFxuICAgICAgICAgICAgICBzdGF0dXM6ICdWRVJJRklFRCcsIC8vIFN1YmRvbWFpbnMgYXJlIGF1dG8tdmVyaWZpZWRcbiAgICAgICAgICAgICAgaXNQcmltYXJ5OiAhY3VzdG9tRG9tYWluLCAvLyBQcmltYXJ5IGlmIG5vIGN1c3RvbSBkb21haW5cbiAgICAgICAgICAgICAgdmVyaWZpZWRBdDogbmV3IERhdGUoKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIE9wdGlvbmFsbHkgY3JlYXRlIGN1c3RvbSBkb21haW5cbiAgICAgICAgICAgIC4uLihjdXN0b21Eb21haW4gPyBbe1xuICAgICAgICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgICAgICAgIGRvbWFpbjogY3VzdG9tRG9tYWluLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgIHR5cGU6ICdDVVNUT00nIGFzIGNvbnN0LFxuICAgICAgICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyBhcyBjb25zdCwgLy8gQ3VzdG9tIGRvbWFpbnMgbmVlZCB2ZXJpZmljYXRpb25cbiAgICAgICAgICAgICAgaXNQcmltYXJ5OiB0cnVlLFxuICAgICAgICAgICAgICB2ZXJpZmljYXRpb25Ub2tlbjogdXVpZHY0KClcbiAgICAgICAgICAgIH1dIDogW10pXG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBkb21haW5zOiB0cnVlXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIFRyYW5zZm9ybSBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIC4uLnRlbmFudCxcbiAgICAgIGJyYW5kaW5nOiB7XG4gICAgICAgIGlkOiB0ZW5hbnQuaWQsXG4gICAgICAgIHRlbmFudElkOiB0ZW5hbnQuaWQsXG4gICAgICAgIGFwcE5hbWU6IHRlbmFudC5hcHBOYW1lLFxuICAgICAgICBsb2dvVXJsOiB0ZW5hbnQubG9nb1VybCxcbiAgICAgICAgZmF2aWNvblVybDogdGVuYW50LmZhdmljb25VcmwsXG4gICAgICAgIHByaW1hcnlDb2xvcjogdGVuYW50LnByaW1hcnlDb2xvcixcbiAgICAgICAgc2Vjb25kYXJ5Q29sb3I6IHRlbmFudC5zZWNvbmRhcnlDb2xvclxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdGVuYW50OiByZXNwb25zZVxuICAgIH0sIHsgc3RhdHVzOiAyMDEgfSlcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSB0ZW5hbnQ6JywgZXJyb3IpXG4gICAgXG4gICAgLy8gSGFuZGxlIFByaXNtYSB1bmlxdWUgY29uc3RyYWludCBlcnJvcnNcbiAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1AyMDAyJykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0EgdGVuYW50IHdpdGggdGhpcyBzbHVnIG9yIGRvbWFpbiBhbHJlYWR5IGV4aXN0cycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwOSB9XG4gICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIHRlbmFudCcgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInByaXNtYSIsInY0IiwidXVpZHY0IiwiR0VUIiwicmVxdWVzdCIsInRlbmFudHMiLCJ0ZW5hbnQiLCJmaW5kTWFueSIsImluY2x1ZGUiLCJkb21haW5zIiwiX2NvdW50Iiwic2VsZWN0IiwibWVtYmVyc2hpcHMiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwianNvbiIsInN1Y2Nlc3MiLCJtYXAiLCJ0IiwidXNlcnMiLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJQT1NUIiwiYm9keSIsIm5hbWUiLCJzbHVnIiwiY3VzdG9tRG9tYWluIiwiYXBwTmFtZSIsImxvZ29VcmwiLCJmYXZpY29uVXJsIiwicHJpbWFyeUNvbG9yIiwic2Vjb25kYXJ5Q29sb3IiLCJub3JtYWxpemVkU2x1ZyIsInRvTG93ZXJDYXNlIiwidGVzdCIsImV4aXN0aW5nVGVuYW50IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiZXhpc3RpbmdEb21haW4iLCJ0ZW5hbnREb21haW4iLCJkb21haW4iLCJleGlzdGluZ0N1c3RvbURvbWFpbiIsImNyZWF0ZSIsImRhdGEiLCJpZCIsInR5cGUiLCJpc1ByaW1hcnkiLCJ2ZXJpZmllZEF0IiwiRGF0ZSIsInZlcmlmaWNhdGlvblRva2VuIiwicmVzcG9uc2UiLCJicmFuZGluZyIsInRlbmFudElkIiwiY29kZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenants/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZW1hcmtldHdha2EvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KHtcbiAgbG9nOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IFsnZXJyb3InLCAnd2FybiddIDogWydlcnJvciddLFxufSlcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWFcblxuLy8gUmUtZXhwb3J0IHRlbmFudCBpc29sYXRpb24gdXRpbGl0aWVzXG5leHBvcnQge1xuICB2YWxpZGF0ZVRlbmFudEFjY2VzcyxcbiAgdmFsaWRhdGVQYXJ0bmVyQWNjZXNzLFxuICBjcmVhdGVUZW5hbnRDb250ZXh0LFxuICBjcmVhdGVQYXJ0bmVyQ29udGV4dCxcbiAgd2l0aFRlbmFudEZpbHRlcixcbiAgd2l0aFRlbmFudERhdGEsXG4gIHdpdGhQYXJ0bmVyRmlsdGVyLFxuICB3aXRoUGFydG5lckRhdGEsXG4gIFRlbmFudElzb2xhdGlvbkVycm9yLFxuICBpc1RlbmFudFNjb3BlZE1vZGVsLFxuICBpc1BhcnRuZXJTY29wZWRNb2RlbCxcbiAgZ2V0VmlvbGF0aW9uTG9ncyxcbiAgY2xlYXJWaW9sYXRpb25Mb2dzLFxuICBsb2dWaW9sYXRpb24sXG4gIFRFTkFOVF9TQ09QRURfTU9ERUxTLFxuICBQQVJUTkVSX1NDT1BFRF9NT0RFTFMsXG4gIFBMQVRGT1JNX01PREVMUyxcbiAgdHlwZSBUZW5hbnRDb250ZXh0LFxuICB0eXBlIFBhcnRuZXJDb250ZXh0LFxuICB0eXBlIFRlbmFudFNjb3BlZE1vZGVsLFxuICB0eXBlIFBhcnRuZXJTY29wZWRNb2RlbCxcbiAgdHlwZSBQbGF0Zm9ybU1vZGVsXG59IGZyb20gJy4vdGVuYW50LWlzb2xhdGlvbidcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwidmFsaWRhdGVQYXJ0bmVyQWNjZXNzIiwiY3JlYXRlVGVuYW50Q29udGV4dCIsImNyZWF0ZVBhcnRuZXJDb250ZXh0Iiwid2l0aFRlbmFudEZpbHRlciIsIndpdGhUZW5hbnREYXRhIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiLCJUZW5hbnRJc29sYXRpb25FcnJvciIsImlzVGVuYW50U2NvcGVkTW9kZWwiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsImdldFZpb2xhdGlvbkxvZ3MiLCJjbGVhclZpb2xhdGlvbkxvZ3MiLCJsb2dWaW9sYXRpb24iLCJURU5BTlRfU0NPUEVEX01PREVMUyIsIlBBUlRORVJfU0NPUEVEX01PREVMUyIsIlBMQVRGT1JNX01PREVMUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZW1hcmtldHdha2EvLi9zcmMvbGliL3RlbmFudC1pc29sYXRpb24udHM/ZjI1MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlbmFudCBJc29sYXRpb24gRW5mb3JjZW1lbnRcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgc3RyaWN0IHRlbmFudCBkYXRhIGlzb2xhdGlvbiBhdCB0aGUgZGF0YWJhc2UgbGV2ZWwuXG4gKiBJbnN0ZWFkIG9mIFByaXNtYSBtaWRkbGV3YXJlICh3aGljaCBoYXMgYXN5bmMgY29udGV4dCBpc3N1ZXMpLCB0aGlzIHVzZXNcbiAqIGFwcGxpY2F0aW9uLWxldmVsIHZhbGlkYXRpb24gYmVmb3JlIHF1ZXJpZXMgYXJlIGV4ZWN1dGVkLlxuICogXG4gKiBGZWF0dXJlczpcbiAqIC0gUHJlLXF1ZXJ5IHZhbGlkYXRpb24gZnVuY3Rpb25zXG4gKiAtIFNVUEVSX0FETUlOIGJ5cGFzcyB3aXRoIGV4cGxpY2l0IGZsYWdcbiAqIC0gVmlvbGF0aW9uIGxvZ2dpbmcgYW5kIGhhcmQgZmFpbHVyZVxuICogLSBTYWZlIHF1ZXJ5IGJ1aWxkZXJzIHRoYXQgZW5mb3JjZSB0ZW5hbnQgc2NvcGluZ1xuICovXG5cbi8vIE1vZGVscyB0aGF0IHJlcXVpcmUgdGVuYW50IGlzb2xhdGlvbiAodGVuYW50LXNjb3BlZClcbmV4cG9ydCBjb25zdCBURU5BTlRfU0NPUEVEX01PREVMUyA9IFtcbiAgJ1RlbmFudE1lbWJlcnNoaXAnLFxuICAnVGVuYW50RG9tYWluJywgXG4gICdBdWRpdExvZycsXG4gIC8vIEFkZCBmdXR1cmUgdGVuYW50LXNjb3BlZCBtb2RlbHMgaGVyZVxuXSBhcyBjb25zdFxuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHBhcnRuZXIgaXNvbGF0aW9uIChwYXJ0bmVyLXNjb3BlZClcbi8vIFRoZXNlIGFyZSBzZXBhcmF0ZSBmcm9tIHRlbmFudCBpc29sYXRpb24gLSBwYXJ0bmVycyBhcmUgcGxhdGZvcm0tbGV2ZWxcbmV4cG9ydCBjb25zdCBQQVJUTkVSX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdQYXJ0bmVyVXNlcicsXG4gICdQYXJ0bmVyQWdyZWVtZW50JyxcbiAgJ1BhcnRuZXJSZWZlcnJhbENvZGUnLFxuICAnUGFydG5lclJlZmVycmFsJyxcbiAgJ1BhcnRuZXJFYXJuaW5nJyxcbl0gYXMgY29uc3RcblxuLy8gUGxhdGZvcm0tbGV2ZWwgbW9kZWxzIChubyBpc29sYXRpb24sIFN1cGVyIEFkbWluIG9ubHkpXG5leHBvcnQgY29uc3QgUExBVEZPUk1fTU9ERUxTID0gW1xuICAnUGFydG5lcicsXG4gICdVc2VyJyxcbiAgJ1RlbmFudCcsXG4gICdTZXNzaW9uJyxcbiAgJ01hZ2ljTGluaycsXG5dIGFzIGNvbnN0XG5cbmV4cG9ydCB0eXBlIFRlbmFudFNjb3BlZE1vZGVsID0gdHlwZW9mIFRFTkFOVF9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBhcnRuZXJTY29wZWRNb2RlbCA9IHR5cGVvZiBQQVJUTkVSX1NDT1BFRF9NT0RFTFNbbnVtYmVyXVxuZXhwb3J0IHR5cGUgUGxhdGZvcm1Nb2RlbCA9IHR5cGVvZiBQTEFURk9STV9NT0RFTFNbbnVtYmVyXVxuXG5leHBvcnQgaW50ZXJmYWNlIFRlbmFudENvbnRleHQge1xuICB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXJ0bmVyQ29udGV4dCB7XG4gIHBhcnRuZXJJZDogc3RyaW5nIHwgbnVsbFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuXG4gIGlzUGFydG5lck93bmVyPzogYm9vbGVhblxuICBpc1BhcnRuZXJBZG1pbj86IGJvb2xlYW5cbiAgYnlwYXNzSXNvbGF0aW9uPzogYm9vbGVhblxufVxuXG4vKipcbiAqIFZpb2xhdGlvbiBsb2dnZXJcbiAqL1xuaW50ZXJmYWNlIFZpb2xhdGlvbkxvZyB7XG4gIHRpbWVzdGFtcDogRGF0ZVxuICBtb2RlbDogc3RyaW5nXG4gIGFjdGlvbjogc3RyaW5nXG4gIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gIHF1ZXJ5OiBhbnlcbiAgcmVhc29uOiBzdHJpbmdcbn1cblxuY29uc3QgdmlvbGF0aW9uczogVmlvbGF0aW9uTG9nW10gPSBbXVxuY29uc3QgTUFYX1ZJT0xBVElPTl9MT0dTID0gMTAwMFxuXG5leHBvcnQgZnVuY3Rpb24gbG9nVmlvbGF0aW9uKHZpb2xhdGlvbjogT21pdDxWaW9sYXRpb25Mb2csICd0aW1lc3RhbXAnPik6IHZvaWQge1xuICBjb25zdCBsb2c6IFZpb2xhdGlvbkxvZyA9IHtcbiAgICAuLi52aW9sYXRpb24sXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gIH1cbiAgXG4gIHZpb2xhdGlvbnMucHVzaChsb2cpXG4gIFxuICBpZiAodmlvbGF0aW9ucy5sZW5ndGggPiBNQVhfVklPTEFUSU9OX0xPR1MpIHtcbiAgICB2aW9sYXRpb25zLnNoaWZ0KClcbiAgfVxuICBcbiAgY29uc29sZS5lcnJvcignW1RFTkFOVCBJU09MQVRJT04gVklPTEFUSU9OXScsIEpTT04uc3RyaW5naWZ5KGxvZywgbnVsbCwgMikpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWaW9sYXRpb25Mb2dzKCk6IFZpb2xhdGlvbkxvZ1tdIHtcbiAgcmV0dXJuIFsuLi52aW9sYXRpb25zXVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWaW9sYXRpb25Mb2dzKCk6IHZvaWQge1xuICB2aW9sYXRpb25zLmxlbmd0aCA9IDBcbn1cblxuLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVycm9yXG4gKi9cbmV4cG9ydCBjbGFzcyBUZW5hbnRJc29sYXRpb25FcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHB1YmxpYyBtb2RlbDogc3RyaW5nLFxuICAgIHB1YmxpYyBhY3Rpb246IHN0cmluZyxcbiAgICBwdWJsaWMgY29udGV4dDogVGVuYW50Q29udGV4dCB8IG51bGxcbiAgKSB7XG4gICAgc3VwZXIobWVzc2FnZSlcbiAgICB0aGlzLm5hbWUgPSAnVGVuYW50SXNvbGF0aW9uRXJyb3InXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHRlbmFudC1zY29wZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVGVuYW50U2NvcGVkTW9kZWwobW9kZWw6IHN0cmluZyk6IG1vZGVsIGlzIFRlbmFudFNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFRFTkFOVF9TQ09QRURfTU9ERUxTLmluY2x1ZGVzKG1vZGVsIGFzIGFueSlcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSB0ZW5hbnQgY29udGV4dCBiZWZvcmUgZXhlY3V0aW5nIGEgcXVlcnlcbiAqIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgYW55IHRlbmFudC1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVRlbmFudEFjY2VzcyhcbiAgbW9kZWw6IHN0cmluZyxcbiAgYWN0aW9uOiBzdHJpbmcsXG4gIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsLFxuICBxdWVyeVRlbmFudElkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3IgZ2xvYmFsIG1vZGVsc1xuICBpZiAoIWlzVGVuYW50U2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ0J5cGFzcyBpc29sYXRpb24gYXR0ZW1wdGVkIHdpdGhvdXQgU1VQRVJfQURNSU4gcm9sZSdcbiAgICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICAgIH1cbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gU1VQRVJfQURNSU4gY2FuIGFjY2VzcyBhbGwgZGF0YVxuICBpZiAoY29udGV4dD8uaXNTdXBlckFkbWluKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIE5vIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudCBjb250ZXh0IHByb3ZpZGVkIGZvciB0ZW5hbnQtc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgfVxuICBcbiAgLy8gTm8gdGVuYW50SWQgaW4gY29udGV4dCA9IHZpb2xhdGlvblxuICBpZiAoIWNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gdGVuYW50SWQgaW4gY29udGV4dCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIElmIHF1ZXJ5IHNwZWNpZmllcyBhIHRlbmFudElkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5VGVuYW50SWQgJiYgcXVlcnlUZW5hbnRJZCAhPT0gY29udGV4dC50ZW5hbnRJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy10ZW5hbnQgYWNjZXNzIGF0dGVtcHQ6IHF1ZXJ5IHRlbmFudElkICgke3F1ZXJ5VGVuYW50SWR9KSAhPSBjb250ZXh0IHRlbmFudElkICgke2NvbnRleHQudGVuYW50SWR9KWBcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSB0ZW5hbnQgY29udGV4dCBmcm9tIHVzZXIgc2Vzc2lvblxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGVuYW50Q29udGV4dChcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogVGVuYW50Q29udGV4dCB7XG4gIHJldHVybiB7XG4gICAgdGVuYW50SWQsXG4gICAgdXNlcklkLFxuICAgIGlzU3VwZXJBZG1pbixcbiAgICBieXBhc3NJc29sYXRpb25cbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHBhcnRuZXIgY29udGV4dCBmcm9tIHVzZXIgc2Vzc2lvblxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGFydG5lckNvbnRleHQoXG4gIHBhcnRuZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsLFxuICBpc1N1cGVyQWRtaW46IGJvb2xlYW4sXG4gIGlzUGFydG5lck93bmVyOiBib29sZWFuID0gZmFsc2UsXG4gIGlzUGFydG5lckFkbWluOiBib29sZWFuID0gZmFsc2UsXG4gIGJ5cGFzc0lzb2xhdGlvbjogYm9vbGVhbiA9IGZhbHNlXG4pOiBQYXJ0bmVyQ29udGV4dCB7XG4gIHJldHVybiB7XG4gICAgcGFydG5lcklkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgaXNQYXJ0bmVyT3duZXIsXG4gICAgaXNQYXJ0bmVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBFbnN1cmUgYSBXSEVSRSBjbGF1c2UgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnRGaWx0ZXI8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICB3aGVyZTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICB0ZW5hbnRJZFxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGRhdGEgYmVpbmcgY3JlYXRlZCBpbmNsdWRlcyB0aGUgY29ycmVjdCB0ZW5hbnRJZFxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aFRlbmFudERhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICB0ZW5hbnRJZDogc3RyaW5nXG4pOiBUICYgeyB0ZW5hbnRJZDogc3RyaW5nIH0ge1xuICByZXR1cm4ge1xuICAgIC4uLmRhdGEsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIGEgbW9kZWwgaXMgcGFydG5lci1zY29wZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUGFydG5lclNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBQYXJ0bmVyU2NvcGVkTW9kZWwge1xuICByZXR1cm4gUEFSVE5FUl9TQ09QRURfTU9ERUxTLmluY2x1ZGVzKG1vZGVsIGFzIGFueSlcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBwYXJ0bmVyIGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSBwYXJ0bmVyLXNjb3BlZCBkYXRhYmFzZSBvcGVyYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUGFydG5lckFjY2VzcyhcbiAgbW9kZWw6IHN0cmluZyxcbiAgYWN0aW9uOiBzdHJpbmcsXG4gIGNvbnRleHQ6IFBhcnRuZXJDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlQYXJ0bmVySWQ/OiBzdHJpbmcgfCBudWxsXG4pOiB2b2lkIHtcbiAgLy8gU2tpcCB2YWxpZGF0aW9uIGZvciBub24tcGFydG5lciBtb2RlbHNcbiAgaWYgKCFpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbCkpIHtcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gQWxsb3cgZXhwbGljaXQgYnlwYXNzIChmb3IgbWlncmF0aW9ucywgYWRtaW4gdG9vbHMsIGV0Yy4pXG4gIGlmIChjb250ZXh0Py5ieXBhc3NJc29sYXRpb24gPT09IHRydWUpIHtcbiAgICBpZiAoIWNvbnRleHQuaXNTdXBlckFkbWluKSB7XG4gICAgICBjb25zdCByZWFzb24gPSAnUGFydG5lciBieXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0OiBjb250ZXh0IGFzIGFueSwgcXVlcnk6IHsgcXVlcnlQYXJ0bmVySWQgfSwgcmVhc29uIH0pXG4gICAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIHBhcnRuZXIgZGF0YVxuICBpZiAoY29udGV4dD8uaXNTdXBlckFkbWluKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIE5vIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHBhcnRuZXIgY29udGV4dCBwcm92aWRlZCBmb3IgcGFydG5lci1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogbnVsbCwgcXVlcnk6IHsgcXVlcnlQYXJ0bmVySWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgbnVsbClcbiAgfVxuICBcbiAgLy8gTm8gcGFydG5lcklkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVySWQgaW4gY29udGV4dCBmb3IgcGFydG5lci1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQgYXMgYW55KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSBwYXJ0bmVySWQsIGl0IG11c3QgbWF0Y2ggY29udGV4dFxuICBpZiAocXVlcnlQYXJ0bmVySWQgJiYgcXVlcnlQYXJ0bmVySWQgIT09IGNvbnRleHQucGFydG5lcklkKSB7XG4gICAgY29uc3QgcmVhc29uID0gYENyb3NzLXBhcnRuZXIgYWNjZXNzIGF0dGVtcHQ6IHF1ZXJ5IHBhcnRuZXJJZCAoJHtxdWVyeVBhcnRuZXJJZH0pICE9IGNvbnRleHQgcGFydG5lcklkICgke2NvbnRleHQucGFydG5lcklkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQgYXMgYW55KVxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHBhcnRuZXJJZFxuICovXG5leHBvcnQgZnVuY3Rpb24gd2l0aFBhcnRuZXJGaWx0ZXI8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICB3aGVyZTogVCxcbiAgcGFydG5lcklkOiBzdHJpbmdcbik6IFQgJiB7IHBhcnRuZXJJZDogc3RyaW5nIH0ge1xuICByZXR1cm4ge1xuICAgIC4uLndoZXJlLFxuICAgIHBhcnRuZXJJZFxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGRhdGEgYmVpbmcgY3JlYXRlZCBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRGF0YTxUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgYW55Pj4oXG4gIGRhdGE6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHBhcnRuZXJJZFxuICB9XG59XG4iXSwibmFtZXMiOlsiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiLCJ2aW9sYXRpb25zIiwiTUFYX1ZJT0xBVElPTl9MT0dTIiwibG9nVmlvbGF0aW9uIiwidmlvbGF0aW9uIiwibG9nIiwidGltZXN0YW1wIiwiRGF0ZSIsInB1c2giLCJsZW5ndGgiLCJzaGlmdCIsImNvbnNvbGUiLCJlcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsIm1vZGVsIiwiYWN0aW9uIiwiY29udGV4dCIsIm5hbWUiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaW5jbHVkZXMiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInF1ZXJ5VGVuYW50SWQiLCJieXBhc3NJc29sYXRpb24iLCJpc1N1cGVyQWRtaW4iLCJyZWFzb24iLCJxdWVyeSIsInRlbmFudElkIiwiY3JlYXRlVGVuYW50Q29udGV4dCIsInVzZXJJZCIsImNyZWF0ZVBhcnRuZXJDb250ZXh0IiwicGFydG5lcklkIiwiaXNQYXJ0bmVyT3duZXIiLCJpc1BhcnRuZXJBZG1pbiIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aGVyZSIsIndpdGhUZW5hbnREYXRhIiwiZGF0YSIsImlzUGFydG5lclNjb3BlZE1vZGVsIiwidmFsaWRhdGVQYXJ0bmVyQWNjZXNzIiwicXVlcnlQYXJ0bmVySWQiLCJ3aXRoUGFydG5lckZpbHRlciIsIndpdGhQYXJ0bmVyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();