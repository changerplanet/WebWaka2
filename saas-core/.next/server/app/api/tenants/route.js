"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tenants/route";
exports.ids = ["app/api/tenants/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_tenants_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/tenants/route.ts */ \"(rsc)/./src/app/api/tenants/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tenants/route\",\n        pathname: \"/api/tenants\",\n        filename: \"route\",\n        bundlePath: \"app/api/tenants/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/tenants/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_tenants_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/tenants/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0ZW5hbnRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0ZW5hbnRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGVuYW50cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDTDtBQUN4RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/YTgxYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS90ZW5hbnRzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90ZW5hbnRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGVuYW50c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdGVuYW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL3RlbmFudHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3RlbmFudHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/tenants/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/tenants/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n\n\n\n// GET /api/tenants - List all tenants (Super Admin only in production)\nasync function GET(request) {\n    try {\n        const tenants = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findMany({\n            include: {\n                domains: true,\n                _count: {\n                    select: {\n                        memberships: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            tenants: tenants.map((t)=>({\n                    ...t,\n                    // Map _count to users for backwards compatibility\n                    _count: {\n                        users: t._count.memberships\n                    }\n                }))\n        });\n    } catch (error) {\n        console.error(\"Failed to fetch tenants:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to fetch tenants\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST /api/tenants - Create a new tenant\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { name, slug, customDomain, appName, logoUrl, faviconUrl, primaryColor, secondaryColor } = body;\n        // Validate required fields\n        if (!name || !slug) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Name and slug are required\"\n            }, {\n                status: 400\n            });\n        }\n        const normalizedSlug = slug.toLowerCase();\n        // Validate slug format (alphanumeric and hyphens only)\n        if (!/^[a-z0-9-]+$/.test(normalizedSlug)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Slug must contain only lowercase letters, numbers, and hyphens\"\n            }, {\n                status: 400\n            });\n        }\n        // Check for existing slug\n        const existingTenant = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.findUnique({\n            where: {\n                slug: normalizedSlug\n            }\n        });\n        if (existingTenant) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"This subdomain is already taken\"\n            }, {\n                status: 409\n            });\n        }\n        // Check for existing domain\n        const existingDomain = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantDomain.findUnique({\n            where: {\n                domain: normalizedSlug\n            }\n        });\n        if (existingDomain) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"This subdomain is already in use\"\n            }, {\n                status: 409\n            });\n        }\n        // Check for existing custom domain if provided\n        if (customDomain) {\n            const existingCustomDomain = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenantDomain.findUnique({\n                where: {\n                    domain: customDomain.toLowerCase()\n                }\n            });\n            if (existingCustomDomain) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"This custom domain is already in use\"\n                }, {\n                    status: 409\n                });\n            }\n        }\n        // Create tenant with domains in a transaction\n        const tenant = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.tenant.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                name,\n                slug: normalizedSlug,\n                appName: appName || name,\n                logoUrl: logoUrl || null,\n                faviconUrl: faviconUrl || null,\n                primaryColor: primaryColor || \"#6366f1\",\n                secondaryColor: secondaryColor || \"#8b5cf6\",\n                domains: {\n                    create: [\n                        // Always create subdomain\n                        {\n                            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                            domain: normalizedSlug,\n                            type: \"SUBDOMAIN\",\n                            status: \"VERIFIED\",\n                            isPrimary: !customDomain,\n                            verifiedAt: new Date()\n                        },\n                        // Optionally create custom domain\n                        ...customDomain ? [\n                            {\n                                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                                domain: customDomain.toLowerCase(),\n                                type: \"CUSTOM\",\n                                status: \"PENDING\",\n                                isPrimary: true,\n                                verificationToken: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])()\n                            }\n                        ] : []\n                    ]\n                }\n            },\n            include: {\n                domains: true\n            }\n        });\n        // Transform for backwards compatibility\n        const response = {\n            ...tenant,\n            branding: {\n                id: tenant.id,\n                tenantId: tenant.id,\n                appName: tenant.appName,\n                logoUrl: tenant.logoUrl,\n                faviconUrl: tenant.faviconUrl,\n                primaryColor: tenant.primaryColor,\n                secondaryColor: tenant.secondaryColor\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            tenant: response\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Failed to create tenant:\", error);\n        // Handle Prisma unique constraint errors\n        if (error.code === \"P2002\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"A tenant with this slug or domain already exists\"\n            }, {\n                status: 409\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to create tenant\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS90ZW5hbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXVEO0FBQ2xCO0FBQ0Y7QUFFbkMsdUVBQXVFO0FBQ2hFLGVBQWVJLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNQyxVQUFVLE1BQU1MLCtDQUFNQSxDQUFDTSxNQUFNLENBQUNDLFFBQVEsQ0FBQztZQUMzQ0MsU0FBUztnQkFDUEMsU0FBUztnQkFDVEMsUUFBUTtvQkFDTkMsUUFBUTt3QkFBRUMsYUFBYTtvQkFBSztnQkFDOUI7WUFDRjtZQUNBQyxTQUFTO2dCQUFFQyxXQUFXO1lBQU87UUFDL0I7UUFFQSxPQUFPZixxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNUWCxTQUFTQSxRQUFRWSxHQUFHLENBQUNDLENBQUFBLElBQU07b0JBQ3pCLEdBQUdBLENBQUM7b0JBQ0osa0RBQWtEO29CQUNsRFIsUUFBUTt3QkFBRVMsT0FBT0QsRUFBRVIsTUFBTSxDQUFDRSxXQUFXO29CQUFDO2dCQUN4QztRQUNGO0lBQ0YsRUFBRSxPQUFPUSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU9yQixxREFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7WUFBRUMsU0FBUztZQUFPSSxPQUFPO1FBQTBCLEdBQ25EO1lBQUVFLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRUEsMENBQTBDO0FBQ25DLGVBQWVDLEtBQUtuQixPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTW9CLE9BQU8sTUFBTXBCLFFBQVFXLElBQUk7UUFDL0IsTUFBTSxFQUNKVSxJQUFJLEVBQ0pDLElBQUksRUFDSkMsWUFBWSxFQUNaQyxPQUFPLEVBQ1BDLE9BQU8sRUFDUEMsVUFBVSxFQUNWQyxZQUFZLEVBQ1pDLGNBQWMsRUFDZixHQUFHUjtRQUVKLDJCQUEyQjtRQUMzQixJQUFJLENBQUNDLFFBQVEsQ0FBQ0MsTUFBTTtZQUNsQixPQUFPM0IscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPSSxPQUFPO1lBQTZCLEdBQ3REO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNVyxpQkFBaUJQLEtBQUtRLFdBQVc7UUFFdkMsdURBQXVEO1FBQ3ZELElBQUksQ0FBQyxlQUFlQyxJQUFJLENBQUNGLGlCQUFpQjtZQUN4QyxPQUFPbEMscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPSSxPQUFPO1lBQWlFLEdBQzFGO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSwwQkFBMEI7UUFDMUIsTUFBTWMsaUJBQWlCLE1BQU1wQywrQ0FBTUEsQ0FBQ00sTUFBTSxDQUFDK0IsVUFBVSxDQUFDO1lBQ3BEQyxPQUFPO2dCQUFFWixNQUFNTztZQUFlO1FBQ2hDO1FBQ0EsSUFBSUcsZ0JBQWdCO1lBQ2xCLE9BQU9yQyxxREFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9JLE9BQU87WUFBa0MsR0FDM0Q7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLDRCQUE0QjtRQUM1QixNQUFNaUIsaUJBQWlCLE1BQU12QywrQ0FBTUEsQ0FBQ3dDLFlBQVksQ0FBQ0gsVUFBVSxDQUFDO1lBQzFEQyxPQUFPO2dCQUFFRyxRQUFRUjtZQUFlO1FBQ2xDO1FBQ0EsSUFBSU0sZ0JBQWdCO1lBQ2xCLE9BQU94QyxxREFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9JLE9BQU87WUFBbUMsR0FDNUQ7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLCtDQUErQztRQUMvQyxJQUFJSyxjQUFjO1lBQ2hCLE1BQU1lLHVCQUF1QixNQUFNMUMsK0NBQU1BLENBQUN3QyxZQUFZLENBQUNILFVBQVUsQ0FBQztnQkFDaEVDLE9BQU87b0JBQUVHLFFBQVFkLGFBQWFPLFdBQVc7Z0JBQUc7WUFDOUM7WUFDQSxJQUFJUSxzQkFBc0I7Z0JBQ3hCLE9BQU8zQyxxREFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7b0JBQUVDLFNBQVM7b0JBQU9JLE9BQU87Z0JBQXVDLEdBQ2hFO29CQUFFRSxRQUFRO2dCQUFJO1lBRWxCO1FBQ0Y7UUFFQSw4Q0FBOEM7UUFDOUMsTUFBTWhCLFNBQVMsTUFBTU4sK0NBQU1BLENBQUNNLE1BQU0sQ0FBQ3FDLE1BQU0sQ0FBQztZQUN4Q0MsTUFBTTtnQkFDSkMsSUFBSTNDLGdEQUFNQTtnQkFDVnVCO2dCQUNBQyxNQUFNTztnQkFDTkwsU0FBU0EsV0FBV0g7Z0JBQ3BCSSxTQUFTQSxXQUFXO2dCQUNwQkMsWUFBWUEsY0FBYztnQkFDMUJDLGNBQWNBLGdCQUFnQjtnQkFDOUJDLGdCQUFnQkEsa0JBQWtCO2dCQUNsQ3ZCLFNBQVM7b0JBQ1BrQyxRQUFRO3dCQUNOLDBCQUEwQjt3QkFDMUI7NEJBQ0VFLElBQUkzQyxnREFBTUE7NEJBQ1Z1QyxRQUFRUjs0QkFDUmEsTUFBTTs0QkFDTnhCLFFBQVE7NEJBQ1J5QixXQUFXLENBQUNwQjs0QkFDWnFCLFlBQVksSUFBSUM7d0JBQ2xCO3dCQUNBLGtDQUFrQzsyQkFDOUJ0QixlQUFlOzRCQUFDO2dDQUNsQmtCLElBQUkzQyxnREFBTUE7Z0NBQ1Z1QyxRQUFRZCxhQUFhTyxXQUFXO2dDQUNoQ1ksTUFBTTtnQ0FDTnhCLFFBQVE7Z0NBQ1J5QixXQUFXO2dDQUNYRyxtQkFBbUJoRCxnREFBTUE7NEJBQzNCO3lCQUFFLEdBQUcsRUFBRTtxQkFDUjtnQkFDSDtZQUNGO1lBQ0FNLFNBQVM7Z0JBQ1BDLFNBQVM7WUFDWDtRQUNGO1FBRUEsd0NBQXdDO1FBQ3hDLE1BQU0wQyxXQUFXO1lBQ2YsR0FBRzdDLE1BQU07WUFDVDhDLFVBQVU7Z0JBQ1JQLElBQUl2QyxPQUFPdUMsRUFBRTtnQkFDYlEsVUFBVS9DLE9BQU91QyxFQUFFO2dCQUNuQmpCLFNBQVN0QixPQUFPc0IsT0FBTztnQkFDdkJDLFNBQVN2QixPQUFPdUIsT0FBTztnQkFDdkJDLFlBQVl4QixPQUFPd0IsVUFBVTtnQkFDN0JDLGNBQWN6QixPQUFPeUIsWUFBWTtnQkFDakNDLGdCQUFnQjFCLE9BQU8wQixjQUFjO1lBQ3ZDO1FBQ0Y7UUFFQSxPQUFPakMscURBQVlBLENBQUNnQixJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVFYsUUFBUTZDO1FBQ1YsR0FBRztZQUFFN0IsUUFBUTtRQUFJO0lBRW5CLEVBQUUsT0FBT0YsT0FBWTtRQUNuQkMsUUFBUUQsS0FBSyxDQUFDLDRCQUE0QkE7UUFFMUMseUNBQXlDO1FBQ3pDLElBQUlBLE1BQU1rQyxJQUFJLEtBQUssU0FBUztZQUMxQixPQUFPdkQscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPSSxPQUFPO1lBQW1ELEdBQzVFO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPdkIscURBQVlBLENBQUNnQixJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0ksT0FBTztRQUEwQixHQUNuRDtZQUFFRSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9hcHAvYXBpL3RlbmFudHMvcm91dGUudHM/ZTljOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJ1xuXG4vLyBHRVQgL2FwaS90ZW5hbnRzIC0gTGlzdCBhbGwgdGVuYW50cyAoU3VwZXIgQWRtaW4gb25seSBpbiBwcm9kdWN0aW9uKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHRlbmFudHMgPSBhd2FpdCBwcmlzbWEudGVuYW50LmZpbmRNYW55KHtcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgZG9tYWluczogdHJ1ZSxcbiAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgc2VsZWN0OiB7IG1lbWJlcnNoaXBzOiB0cnVlIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHRlbmFudHM6IHRlbmFudHMubWFwKHQgPT4gKHtcbiAgICAgICAgLi4udCxcbiAgICAgICAgLy8gTWFwIF9jb3VudCB0byB1c2VycyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgICAgICAgX2NvdW50OiB7IHVzZXJzOiB0Ll9jb3VudC5tZW1iZXJzaGlwcyB9XG4gICAgICB9KSlcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCB0ZW5hbnRzOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIHRlbmFudHMnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuLy8gUE9TVCAvYXBpL3RlbmFudHMgLSBDcmVhdGUgYSBuZXcgdGVuYW50XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHtcbiAgICAgIG5hbWUsXG4gICAgICBzbHVnLFxuICAgICAgY3VzdG9tRG9tYWluLFxuICAgICAgYXBwTmFtZSxcbiAgICAgIGxvZ29VcmwsXG4gICAgICBmYXZpY29uVXJsLFxuICAgICAgcHJpbWFyeUNvbG9yLFxuICAgICAgc2Vjb25kYXJ5Q29sb3JcbiAgICB9ID0gYm9keVxuXG4gICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFuYW1lIHx8ICFzbHVnKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTmFtZSBhbmQgc2x1ZyBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTbHVnID0gc2x1Zy50b0xvd2VyQ2FzZSgpXG5cbiAgICAvLyBWYWxpZGF0ZSBzbHVnIGZvcm1hdCAoYWxwaGFudW1lcmljIGFuZCBoeXBoZW5zIG9ubHkpXG4gICAgaWYgKCEvXlthLXowLTktXSskLy50ZXN0KG5vcm1hbGl6ZWRTbHVnKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1NsdWcgbXVzdCBjb250YWluIG9ubHkgbG93ZXJjYXNlIGxldHRlcnMsIG51bWJlcnMsIGFuZCBoeXBoZW5zJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgZXhpc3Rpbmcgc2x1Z1xuICAgIGNvbnN0IGV4aXN0aW5nVGVuYW50ID0gYXdhaXQgcHJpc21hLnRlbmFudC5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IHNsdWc6IG5vcm1hbGl6ZWRTbHVnIH1cbiAgICB9KVxuICAgIGlmIChleGlzdGluZ1RlbmFudCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1RoaXMgc3ViZG9tYWluIGlzIGFscmVhZHkgdGFrZW4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBkb21haW5cbiAgICBjb25zdCBleGlzdGluZ0RvbWFpbiA9IGF3YWl0IHByaXNtYS50ZW5hbnREb21haW4uZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBkb21haW46IG5vcm1hbGl6ZWRTbHVnIH1cbiAgICB9KVxuICAgIGlmIChleGlzdGluZ0RvbWFpbikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1RoaXMgc3ViZG9tYWluIGlzIGFscmVhZHkgaW4gdXNlJyB9LFxuICAgICAgICB7IHN0YXR1czogNDA5IH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgZXhpc3RpbmcgY3VzdG9tIGRvbWFpbiBpZiBwcm92aWRlZFxuICAgIGlmIChjdXN0b21Eb21haW4pIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nQ3VzdG9tRG9tYWluID0gYXdhaXQgcHJpc21hLnRlbmFudERvbWFpbi5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgZG9tYWluOiBjdXN0b21Eb21haW4udG9Mb3dlckNhc2UoKSB9XG4gICAgICB9KVxuICAgICAgaWYgKGV4aXN0aW5nQ3VzdG9tRG9tYWluKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1RoaXMgY3VzdG9tIGRvbWFpbiBpcyBhbHJlYWR5IGluIHVzZScgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDA5IH1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENyZWF0ZSB0ZW5hbnQgd2l0aCBkb21haW5zIGluIGEgdHJhbnNhY3Rpb25cbiAgICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBwcmlzbWEudGVuYW50LmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc2x1Zzogbm9ybWFsaXplZFNsdWcsXG4gICAgICAgIGFwcE5hbWU6IGFwcE5hbWUgfHwgbmFtZSxcbiAgICAgICAgbG9nb1VybDogbG9nb1VybCB8fCBudWxsLFxuICAgICAgICBmYXZpY29uVXJsOiBmYXZpY29uVXJsIHx8IG51bGwsXG4gICAgICAgIHByaW1hcnlDb2xvcjogcHJpbWFyeUNvbG9yIHx8ICcjNjM2NmYxJyxcbiAgICAgICAgc2Vjb25kYXJ5Q29sb3I6IHNlY29uZGFyeUNvbG9yIHx8ICcjOGI1Y2Y2JyxcbiAgICAgICAgZG9tYWluczoge1xuICAgICAgICAgIGNyZWF0ZTogW1xuICAgICAgICAgICAgLy8gQWx3YXlzIGNyZWF0ZSBzdWJkb21haW5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgICAgICAgICBkb21haW46IG5vcm1hbGl6ZWRTbHVnLFxuICAgICAgICAgICAgICB0eXBlOiAnU1VCRE9NQUlOJyxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnVkVSSUZJRUQnLCAvLyBTdWJkb21haW5zIGFyZSBhdXRvLXZlcmlmaWVkXG4gICAgICAgICAgICAgIGlzUHJpbWFyeTogIWN1c3RvbURvbWFpbiwgLy8gUHJpbWFyeSBpZiBubyBjdXN0b20gZG9tYWluXG4gICAgICAgICAgICAgIHZlcmlmaWVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBPcHRpb25hbGx5IGNyZWF0ZSBjdXN0b20gZG9tYWluXG4gICAgICAgICAgICAuLi4oY3VzdG9tRG9tYWluID8gW3tcbiAgICAgICAgICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgICAgICAgICBkb21haW46IGN1c3RvbURvbWFpbi50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICB0eXBlOiAnQ1VTVE9NJyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnUEVORElORycgYXMgY29uc3QsIC8vIEN1c3RvbSBkb21haW5zIG5lZWQgdmVyaWZpY2F0aW9uXG4gICAgICAgICAgICAgIGlzUHJpbWFyeTogdHJ1ZSxcbiAgICAgICAgICAgICAgdmVyaWZpY2F0aW9uVG9rZW46IHV1aWR2NCgpXG4gICAgICAgICAgICB9XSA6IFtdKVxuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgZG9tYWluczogdHJ1ZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBUcmFuc2Zvcm0gZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5XG4gICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAuLi50ZW5hbnQsXG4gICAgICBicmFuZGluZzoge1xuICAgICAgICBpZDogdGVuYW50LmlkLFxuICAgICAgICB0ZW5hbnRJZDogdGVuYW50LmlkLFxuICAgICAgICBhcHBOYW1lOiB0ZW5hbnQuYXBwTmFtZSxcbiAgICAgICAgbG9nb1VybDogdGVuYW50LmxvZ29VcmwsXG4gICAgICAgIGZhdmljb25Vcmw6IHRlbmFudC5mYXZpY29uVXJsLFxuICAgICAgICBwcmltYXJ5Q29sb3I6IHRlbmFudC5wcmltYXJ5Q29sb3IsXG4gICAgICAgIHNlY29uZGFyeUNvbG9yOiB0ZW5hbnQuc2Vjb25kYXJ5Q29sb3JcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHRlbmFudDogcmVzcG9uc2VcbiAgICB9LCB7IHN0YXR1czogMjAxIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgdGVuYW50OicsIGVycm9yKVxuICAgIFxuICAgIC8vIEhhbmRsZSBQcmlzbWEgdW5pcXVlIGNvbnN0cmFpbnQgZXJyb3JzXG4gICAgaWYgKGVycm9yLmNvZGUgPT09ICdQMjAwMicpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdBIHRlbmFudCB3aXRoIHRoaXMgc2x1ZyBvciBkb21haW4gYWxyZWFkeSBleGlzdHMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmFpbGVkIHRvIGNyZWF0ZSB0ZW5hbnQnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJ2NCIsInV1aWR2NCIsIkdFVCIsInJlcXVlc3QiLCJ0ZW5hbnRzIiwidGVuYW50IiwiZmluZE1hbnkiLCJpbmNsdWRlIiwiZG9tYWlucyIsIl9jb3VudCIsInNlbGVjdCIsIm1lbWJlcnNoaXBzIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsImpzb24iLCJzdWNjZXNzIiwibWFwIiwidCIsInVzZXJzIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIiwiUE9TVCIsImJvZHkiLCJuYW1lIiwic2x1ZyIsImN1c3RvbURvbWFpbiIsImFwcE5hbWUiLCJsb2dvVXJsIiwiZmF2aWNvblVybCIsInByaW1hcnlDb2xvciIsInNlY29uZGFyeUNvbG9yIiwibm9ybWFsaXplZFNsdWciLCJ0b0xvd2VyQ2FzZSIsInRlc3QiLCJleGlzdGluZ1RlbmFudCIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImV4aXN0aW5nRG9tYWluIiwidGVuYW50RG9tYWluIiwiZG9tYWluIiwiZXhpc3RpbmdDdXN0b21Eb21haW4iLCJjcmVhdGUiLCJkYXRhIiwiaWQiLCJ0eXBlIiwiaXNQcmltYXJ5IiwidmVyaWZpZWRBdCIsIkRhdGUiLCJ2ZXJpZmljYXRpb25Ub2tlbiIsInJlc3BvbnNlIiwiYnJhbmRpbmciLCJ0ZW5hbnRJZCIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenants/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxDQUFDO0lBQy9ESSxLQUFLQyxLQUF5QixHQUFnQjtRQUFDO1FBQVM7S0FBTyxHQUFHLENBQVM7QUFDN0UsR0FBRTtBQUVGLElBQUlBLElBQXlCLEVBQWNKLGdCQUFnQkUsTUFBTSxHQUFHQTtBQUVwRSx1Q0FBdUM7QUFjWiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9saWIvcHJpc21hLnRzPzAxZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoe1xuICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gWydlcnJvcicsICd3YXJuJ10gOiBbJ2Vycm9yJ10sXG59KVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuXG4vLyBSZS1leHBvcnQgdGVuYW50IGlzb2xhdGlvbiB1dGlsaXRpZXNcbmV4cG9ydCB7XG4gIHZhbGlkYXRlVGVuYW50QWNjZXNzLFxuICBjcmVhdGVUZW5hbnRDb250ZXh0LFxuICB3aXRoVGVuYW50RmlsdGVyLFxuICB3aXRoVGVuYW50RGF0YSxcbiAgVGVuYW50SXNvbGF0aW9uRXJyb3IsXG4gIGlzVGVuYW50U2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgdHlwZSBUZW5hbnRDb250ZXh0LFxuICB0eXBlIFRlbmFudFNjb3BlZE1vZGVsXG59IGZyb20gJy4vdGVuYW50LWlzb2xhdGlvbidcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwiY3JlYXRlVGVuYW50Q29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImdldFZpb2xhdGlvbkxvZ3MiLCJjbGVhclZpb2xhdGlvbkxvZ3MiLCJsb2dWaW9sYXRpb24iLCJURU5BTlRfU0NPUEVEX01PREVMUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxZQUFxQixFQUNyQkQsa0JBQTJCLEtBQUs7SUFFaEMsT0FBTztRQUNMSTtRQUNBRTtRQUNBTDtRQUNBRDtJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNPLGlCQUNkQyxLQUFRLEVBQ1JKLFFBQWdCO0lBRWhCLE9BQU87UUFDTCxHQUFHSSxLQUFLO1FBQ1JKO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0ssZUFDZEMsSUFBTyxFQUNQTixRQUFnQjtJQUVoQixPQUFPO1FBQ0wsR0FBR00sSUFBSTtRQUNQTjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3RlbmFudC1pc29sYXRpb24udHM/ZjI1MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlbmFudCBJc29sYXRpb24gRW5mb3JjZW1lbnRcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgc3RyaWN0IHRlbmFudCBkYXRhIGlzb2xhdGlvbiBhdCB0aGUgZGF0YWJhc2UgbGV2ZWwuXG4gKiBJbnN0ZWFkIG9mIFByaXNtYSBtaWRkbGV3YXJlICh3aGljaCBoYXMgYXN5bmMgY29udGV4dCBpc3N1ZXMpLCB0aGlzIHVzZXNcbiAqIGFwcGxpY2F0aW9uLWxldmVsIHZhbGlkYXRpb24gYmVmb3JlIHF1ZXJpZXMgYXJlIGV4ZWN1dGVkLlxuICogXG4gKiBGZWF0dXJlczpcbiAqIC0gUHJlLXF1ZXJ5IHZhbGlkYXRpb24gZnVuY3Rpb25zXG4gKiAtIFNVUEVSX0FETUlOIGJ5cGFzcyB3aXRoIGV4cGxpY2l0IGZsYWdcbiAqIC0gVmlvbGF0aW9uIGxvZ2dpbmcgYW5kIGhhcmQgZmFpbHVyZVxuICogLSBTYWZlIHF1ZXJ5IGJ1aWxkZXJzIHRoYXQgZW5mb3JjZSB0ZW5hbnQgc2NvcGluZ1xuICovXG5cbi8vIE1vZGVscyB0aGF0IHJlcXVpcmUgdGVuYW50IGlzb2xhdGlvblxuZXhwb3J0IGNvbnN0IFRFTkFOVF9TQ09QRURfTU9ERUxTID0gW1xuICAnVGVuYW50TWVtYmVyc2hpcCcsXG4gICdUZW5hbnREb21haW4nLCBcbiAgJ0F1ZGl0TG9nJyxcbiAgLy8gQWRkIGZ1dHVyZSB0ZW5hbnQtc2NvcGVkIG1vZGVscyBoZXJlXG5dIGFzIGNvbnN0XG5cbmV4cG9ydCB0eXBlIFRlbmFudFNjb3BlZE1vZGVsID0gdHlwZW9mIFRFTkFOVF9TQ09QRURfTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbi8qKlxuICogVmlvbGF0aW9uIGxvZ2dlclxuICovXG5pbnRlcmZhY2UgVmlvbGF0aW9uTG9nIHtcbiAgdGltZXN0YW1wOiBEYXRlXG4gIG1vZGVsOiBzdHJpbmdcbiAgYWN0aW9uOiBzdHJpbmdcbiAgY29udGV4dDogVGVuYW50Q29udGV4dCB8IG51bGxcbiAgcXVlcnk6IGFueVxuICByZWFzb246IHN0cmluZ1xufVxuXG5jb25zdCB2aW9sYXRpb25zOiBWaW9sYXRpb25Mb2dbXSA9IFtdXG5jb25zdCBNQVhfVklPTEFUSU9OX0xPR1MgPSAxMDAwXG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dWaW9sYXRpb24odmlvbGF0aW9uOiBPbWl0PFZpb2xhdGlvbkxvZywgJ3RpbWVzdGFtcCc+KTogdm9pZCB7XG4gIGNvbnN0IGxvZzogVmlvbGF0aW9uTG9nID0ge1xuICAgIC4uLnZpb2xhdGlvbixcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgfVxuICBcbiAgdmlvbGF0aW9ucy5wdXNoKGxvZylcbiAgXG4gIGlmICh2aW9sYXRpb25zLmxlbmd0aCA+IE1BWF9WSU9MQVRJT05fTE9HUykge1xuICAgIHZpb2xhdGlvbnMuc2hpZnQoKVxuICB9XG4gIFxuICBjb25zb2xlLmVycm9yKCdbVEVOQU5UIElTT0xBVElPTiBWSU9MQVRJT05dJywgSlNPTi5zdHJpbmdpZnkobG9nLCBudWxsLCAyKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZpb2xhdGlvbkxvZ3MoKTogVmlvbGF0aW9uTG9nW10ge1xuICByZXR1cm4gWy4uLnZpb2xhdGlvbnNdXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclZpb2xhdGlvbkxvZ3MoKTogdm9pZCB7XG4gIHZpb2xhdGlvbnMubGVuZ3RoID0gMFxufVxuXG4vKipcbiAqIFRlbmFudCBJc29sYXRpb24gRXJyb3JcbiAqL1xuZXhwb3J0IGNsYXNzIFRlbmFudElzb2xhdGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgcHVibGljIG1vZGVsOiBzdHJpbmcsXG4gICAgcHVibGljIGFjdGlvbjogc3RyaW5nLFxuICAgIHB1YmxpYyBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdUZW5hbnRJc29sYXRpb25FcnJvcidcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIGEgbW9kZWwgaXMgdGVuYW50LXNjb3BlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUZW5hbnRTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgVGVuYW50U2NvcGVkTW9kZWwge1xuICByZXR1cm4gVEVOQU5UX1NDT1BFRF9NT0RFTFMuaW5jbHVkZXMobW9kZWwgYXMgYW55KVxufVxuXG4vKipcbiAqIFZhbGlkYXRlIHRlbmFudCBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgdGVuYW50LXNjb3BlZCBkYXRhYmFzZSBvcGVyYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVGVuYW50QWNjZXNzKFxuICBtb2RlbDogc3RyaW5nLFxuICBhY3Rpb246IHN0cmluZyxcbiAgY29udGV4dDogVGVuYW50Q29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5VGVuYW50SWQ/OiBzdHJpbmcgfCBudWxsXG4pOiB2b2lkIHtcbiAgLy8gU2tpcCB2YWxpZGF0aW9uIGZvciBnbG9iYWwgbW9kZWxzXG4gIGlmICghaXNUZW5hbnRTY29wZWRNb2RlbChtb2RlbCkpIHtcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gQWxsb3cgZXhwbGljaXQgYnlwYXNzIChmb3IgbWlncmF0aW9ucywgYWRtaW4gdG9vbHMsIGV0Yy4pXG4gIGlmIChjb250ZXh0Py5ieXBhc3NJc29sYXRpb24gPT09IHRydWUpIHtcbiAgICBpZiAoIWNvbnRleHQuaXNTdXBlckFkbWluKSB7XG4gICAgICBjb25zdCByZWFzb24gPSAnQnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBkYXRhXG4gIGlmIChjb250ZXh0Py5pc1N1cGVyQWRtaW4pIHtcbiAgICByZXR1cm5cbiAgfVxuICBcbiAgLy8gTm8gY29udGV4dCA9IHZpb2xhdGlvblxuICBpZiAoIWNvbnRleHQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gdGVuYW50IGNvbnRleHQgcHJvdmlkZWQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBObyB0ZW5hbnRJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC50ZW5hbnRJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnRJZCBpbiBjb250ZXh0IGZvciB0ZW5hbnQtc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgdGVuYW50SWQsIGl0IG11c3QgbWF0Y2ggY29udGV4dFxuICBpZiAocXVlcnlUZW5hbnRJZCAmJiBxdWVyeVRlbmFudElkICE9PSBjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gYENyb3NzLXRlbmFudCBhY2Nlc3MgYXR0ZW1wdDogcXVlcnkgdGVuYW50SWQgKCR7cXVlcnlUZW5hbnRJZH0pICE9IGNvbnRleHQgdGVuYW50SWQgKCR7Y29udGV4dC50ZW5hbnRJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQsIHF1ZXJ5OiB7IHF1ZXJ5VGVuYW50SWQgfSwgcmVhc29uIH0pXG4gICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHRlbmFudCBjb250ZXh0IGZyb20gdXNlciBzZXNzaW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUZW5hbnRDb250ZXh0KFxuICB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsLFxuICBpc1N1cGVyQWRtaW46IGJvb2xlYW4sXG4gIGJ5cGFzc0lzb2xhdGlvbjogYm9vbGVhbiA9IGZhbHNlXG4pOiBUZW5hbnRDb250ZXh0IHtcbiAgcmV0dXJuIHtcbiAgICB0ZW5hbnRJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJURU5BTlRfU0NPUEVEX01PREVMUyIsInZpb2xhdGlvbnMiLCJNQVhfVklPTEFUSU9OX0xPR1MiLCJsb2dWaW9sYXRpb24iLCJ2aW9sYXRpb24iLCJsb2ciLCJ0aW1lc3RhbXAiLCJEYXRlIiwicHVzaCIsImxlbmd0aCIsInNoaWZ0IiwiY29uc29sZSIsImVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFZpb2xhdGlvbkxvZ3MiLCJjbGVhclZpb2xhdGlvbkxvZ3MiLCJUZW5hbnRJc29sYXRpb25FcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwibW9kZWwiLCJhY3Rpb24iLCJjb250ZXh0IiwibmFtZSIsImlzVGVuYW50U2NvcGVkTW9kZWwiLCJpbmNsdWRlcyIsInZhbGlkYXRlVGVuYW50QWNjZXNzIiwicXVlcnlUZW5hbnRJZCIsImJ5cGFzc0lzb2xhdGlvbiIsImlzU3VwZXJBZG1pbiIsInJlYXNvbiIsInF1ZXJ5IiwidGVuYW50SWQiLCJjcmVhdGVUZW5hbnRDb250ZXh0IiwidXNlcklkIiwid2l0aFRlbmFudEZpbHRlciIsIndoZXJlIiwid2l0aFRlbmFudERhdGEiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftenants%2Froute&page=%2Fapi%2Ftenants%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenants%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();