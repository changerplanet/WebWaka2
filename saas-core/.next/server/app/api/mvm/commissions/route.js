"use strict";(()=>{var e={};e.id=3652,e.ids=[3652],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},82720:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>v});var r={};t.r(r),t.d(r,{GET:()=>m,POST:()=>d});var o=t(49303),n=t(88716),a=t(60670),i=t(87070);let u=new Map;function c(e){return u.has(e)||u.set(e,[]),u.get(e)}async function m(e){try{let{searchParams:s}=new URL(e.url),t=s.get("tenantId"),r=s.get("vendorId"),o=s.get("status"),n=parseInt(s.get("limit")||"50",10),a=parseInt(s.get("offset")||"0",10);if(!t)return i.NextResponse.json({success:!1,error:"tenantId is required"},{status:400});let u=c(t);r&&(u=u.filter(e=>e.vendorId===r)),o&&(u=u.filter(e=>e.status===o));let m=u.length,d=(u=u.slice(a,a+n)).reduce((e,s)=>e+s.commissionAmount,0),l=u.filter(e=>"PENDING"===e.status).reduce((e,s)=>e+s.commissionAmount,0);return i.NextResponse.json({success:!0,commissions:u,summary:{total:m,totalCommission:d,totalPending:l,filtered:r?`vendor:${r}`:"all"},hasMore:a+u.length<m,module:"MVM"})}catch(e){return console.error("[MVM] Error listing commissions:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function d(e){try{let{tenantId:s,subOrderId:t,vendorId:r,saleAmount:o,commissionRate:n}=await e.json();if(!s||!t||!r||void 0===o||void 0===n)return i.NextResponse.json({success:!1,error:"tenantId, subOrderId, vendorId, saleAmount, and commissionRate are required"},{status:400});let a=c(s);if(a.some(e=>e.subOrderId===t))return i.NextResponse.json({success:!1,error:"Commission already recorded for this sub-order"},{status:400});let u=o*n/100,m={id:`comm_${Date.now().toString(36)}`,tenantId:s,subOrderId:t,vendorId:r,saleAmount:o,commissionRate:n,commissionAmount:u,vendorPayout:o-u,status:"PENDING",calculatedAt:new Date().toISOString()};return a.push(m),i.NextResponse.json({success:!0,commission:m,message:"Commission calculated and recorded (no payout executed)",module:"MVM"},{status:201})}catch(e){return console.error("[MVM] Error calculating commission:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/mvm/commissions/route",pathname:"/api/mvm/commissions",filename:"route",bundlePath:"app/api/mvm/commissions/route"},resolvedPagePath:"/app/saas-core/src/app/api/mvm/commissions/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:v,serverHooks:g}=l,f="/api/mvm/commissions/route";function x(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:v})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9380,5972],()=>t(82720));module.exports=r})();