"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/mvm/catalog/route";
exports.ids = ["app/api/mvm/catalog/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmvm%2Fcatalog%2Froute&page=%2Fapi%2Fmvm%2Fcatalog%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmvm%2Fcatalog%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmvm%2Fcatalog%2Froute&page=%2Fapi%2Fmvm%2Fcatalog%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmvm%2Fcatalog%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_mvm_catalog_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/mvm/catalog/route.ts */ \"(rsc)/./src/app/api/mvm/catalog/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/mvm/catalog/route\",\n        pathname: \"/api/mvm/catalog\",\n        filename: \"route\",\n        bundlePath: \"app/api/mvm/catalog/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/mvm/catalog/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_mvm_catalog_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/mvm/catalog/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtdm0lMkZjYXRhbG9nJTJGcm91dGUmcGFnZT0lMkZhcGklMkZtdm0lMkZjYXRhbG9nJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbXZtJTJGY2F0YWxvZyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDRDtBQUM1RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/MzVhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9tdm0vY2F0YWxvZy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbXZtL2NhdGFsb2cvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tdm0vY2F0YWxvZ1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbXZtL2NhdGFsb2cvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9tdm0vY2F0YWxvZy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbXZtL2NhdGFsb2cvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmvm%2Fcatalog%2Froute&page=%2Fapi%2Fmvm%2Fcatalog%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmvm%2Fcatalog%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/mvm/catalog/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/mvm/catalog/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * MVM Catalog API\n * \n * READ-ONLY endpoints for MVM module to access Core product catalog.\n * MVM does NOT modify products - vendors map to Core products.\n * \n * IMPORTANT:\n * - Products are owned by Core (master catalog)\n * - Vendors create MAPPINGS to Core products\n * - No product duplication occurs\n */ \n\n// ============================================================================\n// HELPERS\n// ============================================================================\nfunction decimalToNumber(val) {\n    return val ? Number(val) : 0;\n}\nfunction mapProductToResponse(product) {\n    return {\n        id: product.id,\n        tenantId: product.tenantId,\n        name: product.name,\n        slug: product.slug,\n        description: product.description,\n        shortDescription: product.shortDescription,\n        categoryId: product.categoryId,\n        categoryName: product.category?.name,\n        tags: product.tags || [],\n        basePrice: decimalToNumber(product.price),\n        compareAtPrice: product.compareAtPrice ? decimalToNumber(product.compareAtPrice) : null,\n        currency: \"USD\",\n        images: product.images?.map((img)=>({\n                id: img.id,\n                url: img.url,\n                altText: img.altText,\n                position: img.position,\n                isDefault: img.isDefault\n            })) || [],\n        status: product.status,\n        hasVariants: product.variants?.length > 1,\n        variants: product.variants?.map((v)=>({\n                id: v.id,\n                productId: v.productId,\n                name: v.name,\n                sku: v.sku,\n                barcode: v.barcode,\n                price: decimalToNumber(v.price || product.price),\n                options: v.optionValues || {},\n                isActive: v.isActive ?? true\n            })) || [],\n        weight: product.weight ? decimalToNumber(product.weight) : null,\n        weightUnit: product.weightUnit || \"lb\",\n        createdAt: product.createdAt?.toISOString(),\n        updatedAt: product.updatedAt?.toISOString()\n    };\n}\n// ============================================================================\n// API HANDLERS\n// ============================================================================\n/**\n * GET /api/mvm/catalog\n * List products available for vendor mapping\n */ async function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const tenantId = searchParams.get(\"tenantId\");\n        const productId = searchParams.get(\"productId\");\n        const categoryId = searchParams.get(\"categoryId\");\n        const query = searchParams.get(\"query\");\n        const vendorId = searchParams.get(\"vendorId\") // To check existing mappings\n        ;\n        const unmappedOnly = searchParams.get(\"unmappedOnly\") === \"true\";\n        const limit = parseInt(searchParams.get(\"limit\") || \"24\", 10);\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\", 10);\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Get single product by ID\n        if (productId) {\n            const product = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.product.findFirst({\n                where: {\n                    id: productId,\n                    tenantId\n                },\n                include: {\n                    category: true,\n                    variants: true\n                }\n            });\n            if (!product) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Product not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                product: mapProductToResponse(product),\n                source: \"CORE\"\n            });\n        }\n        // Build where clause\n        const where = {\n            tenantId,\n            status: \"ACTIVE\"\n        };\n        if (categoryId) {\n            where.categoryId = categoryId;\n        }\n        if (query) {\n            where.OR = [\n                {\n                    name: {\n                        contains: query,\n                        mode: \"insensitive\"\n                    }\n                },\n                {\n                    description: {\n                        contains: query,\n                        mode: \"insensitive\"\n                    }\n                },\n                {\n                    sku: {\n                        contains: query,\n                        mode: \"insensitive\"\n                    }\n                }\n            ];\n        }\n        // Get total count\n        const total = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.product.count({\n            where\n        });\n        // Get products\n        const products = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.product.findMany({\n            where,\n            include: {\n                category: true,\n                variants: true\n            },\n            orderBy: {\n                name: \"asc\"\n            },\n            take: limit,\n            skip: offset\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            products: products.map((p)=>mapProductToResponse(p)),\n            total,\n            hasMore: offset + products.length < total,\n            source: \"CORE\"\n        });\n    } catch (error) {\n        console.error(\"[MVM] Error fetching catalog:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * POST /api/mvm/catalog\n * Batch get products by IDs (for vendor product mappings)\n */ async function POST(request) {\n    try {\n        const body = await request.json();\n        const { tenantId, productIds } = body;\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!productIds || !Array.isArray(productIds)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"productIds array is required\"\n            }, {\n                status: 400\n            });\n        }\n        const products = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.product.findMany({\n            where: {\n                id: {\n                    in: productIds\n                },\n                tenantId\n            },\n            include: {\n                category: true,\n                variants: true\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            products: products.map((p)=>mapProductToResponse(p)),\n            count: products.length,\n            source: \"CORE\"\n        });\n    } catch (error) {\n        console.error(\"[MVM] Error batch fetching products:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VyxNQUFNbEUsK0NBQU1BLENBQUNLLE9BQU8sQ0FBQzhELFFBQVEsQ0FBQztZQUM3Q1QsT0FBTztnQkFDTHBELElBQUk7b0JBQUV5RSxJQUFJSDtnQkFBVztnQkFDckJyRTtZQUNGO1lBQ0FvRCxTQUFTO2dCQUNQN0MsVUFBVTtnQkFDVmUsVUFBVTtZQUNaO1FBQ0Y7UUFFQSxPQUFPOUIscURBQVlBLENBQUN1RCxJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVFcsVUFBVUEsU0FBUzdDLEdBQUcsQ0FBQ2tELENBQUFBLElBQUtuRSxxQkFBcUJtRTtZQUNqRE4sT0FBT0MsU0FBU3BDLE1BQU07WUFDdEI4QixRQUFRO1FBQ1Y7SUFFRixFQUFFLE9BQU9KLE9BQU87UUFDZGlCLFFBQVFqQixLQUFLLENBQUMsd0NBQXdDQTtRQUN0RCxPQUFPekQscURBQVlBLENBQUN1RCxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT0MsT0FBTztRQUF3QixHQUNqRDtZQUFFN0IsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvYXBwL2FwaS9tdm0vY2F0YWxvZy9yb3V0ZS50cz85NTRjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTVZNIENhdGFsb2cgQVBJXG4gKiBcbiAqIFJFQUQtT05MWSBlbmRwb2ludHMgZm9yIE1WTSBtb2R1bGUgdG8gYWNjZXNzIENvcmUgcHJvZHVjdCBjYXRhbG9nLlxuICogTVZNIGRvZXMgTk9UIG1vZGlmeSBwcm9kdWN0cyAtIHZlbmRvcnMgbWFwIHRvIENvcmUgcHJvZHVjdHMuXG4gKiBcbiAqIElNUE9SVEFOVDpcbiAqIC0gUHJvZHVjdHMgYXJlIG93bmVkIGJ5IENvcmUgKG1hc3RlciBjYXRhbG9nKVxuICogLSBWZW5kb3JzIGNyZWF0ZSBNQVBQSU5HUyB0byBDb3JlIHByb2R1Y3RzXG4gKiAtIE5vIHByb2R1Y3QgZHVwbGljYXRpb24gb2NjdXJzXG4gKi9cblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvcHJpc21hJ1xuaW1wb3J0IHsgUHJpc21hIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEhFTFBFUlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gZGVjaW1hbFRvTnVtYmVyKHZhbDogUHJpc21hLkRlY2ltYWwgfCBudWxsKTogbnVtYmVyIHtcbiAgcmV0dXJuIHZhbCA/IE51bWJlcih2YWwpIDogMFxufVxuXG5mdW5jdGlvbiBtYXBQcm9kdWN0VG9SZXNwb25zZShwcm9kdWN0OiBhbnkpIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogcHJvZHVjdC5pZCxcbiAgICB0ZW5hbnRJZDogcHJvZHVjdC50ZW5hbnRJZCxcbiAgICBuYW1lOiBwcm9kdWN0Lm5hbWUsXG4gICAgc2x1ZzogcHJvZHVjdC5zbHVnLFxuICAgIGRlc2NyaXB0aW9uOiBwcm9kdWN0LmRlc2NyaXB0aW9uLFxuICAgIHNob3J0RGVzY3JpcHRpb246IHByb2R1Y3Quc2hvcnREZXNjcmlwdGlvbixcbiAgICBcbiAgICBjYXRlZ29yeUlkOiBwcm9kdWN0LmNhdGVnb3J5SWQsXG4gICAgY2F0ZWdvcnlOYW1lOiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxuICAgIHRhZ3M6IHByb2R1Y3QudGFncyB8fCBbXSxcbiAgICBcbiAgICBiYXNlUHJpY2U6IGRlY2ltYWxUb051bWJlcihwcm9kdWN0LnByaWNlKSxcbiAgICBjb21wYXJlQXRQcmljZTogcHJvZHVjdC5jb21wYXJlQXRQcmljZSA/IGRlY2ltYWxUb051bWJlcihwcm9kdWN0LmNvbXBhcmVBdFByaWNlKSA6IG51bGwsXG4gICAgY3VycmVuY3k6ICdVU0QnLFxuICAgIFxuICAgIGltYWdlczogcHJvZHVjdC5pbWFnZXM/Lm1hcCgoaW1nOiBhbnkpID0+ICh7XG4gICAgICBpZDogaW1nLmlkLFxuICAgICAgdXJsOiBpbWcudXJsLFxuICAgICAgYWx0VGV4dDogaW1nLmFsdFRleHQsXG4gICAgICBwb3NpdGlvbjogaW1nLnBvc2l0aW9uLFxuICAgICAgaXNEZWZhdWx0OiBpbWcuaXNEZWZhdWx0XG4gICAgfSkpIHx8IFtdLFxuICAgIFxuICAgIHN0YXR1czogcHJvZHVjdC5zdGF0dXMsXG4gICAgXG4gICAgaGFzVmFyaWFudHM6IHByb2R1Y3QudmFyaWFudHM/Lmxlbmd0aCA+IDEsXG4gICAgdmFyaWFudHM6IHByb2R1Y3QudmFyaWFudHM/Lm1hcCgodjogYW55KSA9PiAoe1xuICAgICAgaWQ6IHYuaWQsXG4gICAgICBwcm9kdWN0SWQ6IHYucHJvZHVjdElkLFxuICAgICAgbmFtZTogdi5uYW1lLFxuICAgICAgc2t1OiB2LnNrdSxcbiAgICAgIGJhcmNvZGU6IHYuYmFyY29kZSxcbiAgICAgIHByaWNlOiBkZWNpbWFsVG9OdW1iZXIodi5wcmljZSB8fCBwcm9kdWN0LnByaWNlKSxcbiAgICAgIG9wdGlvbnM6IHYub3B0aW9uVmFsdWVzIHx8IHt9LFxuICAgICAgaXNBY3RpdmU6IHYuaXNBY3RpdmUgPz8gdHJ1ZVxuICAgIH0pKSB8fCBbXSxcbiAgICBcbiAgICB3ZWlnaHQ6IHByb2R1Y3Qud2VpZ2h0ID8gZGVjaW1hbFRvTnVtYmVyKHByb2R1Y3Qud2VpZ2h0KSA6IG51bGwsXG4gICAgd2VpZ2h0VW5pdDogcHJvZHVjdC53ZWlnaHRVbml0IHx8ICdsYicsXG4gICAgXG4gICAgY3JlYXRlZEF0OiBwcm9kdWN0LmNyZWF0ZWRBdD8udG9JU09TdHJpbmcoKSxcbiAgICB1cGRhdGVkQXQ6IHByb2R1Y3QudXBkYXRlZEF0Py50b0lTT1N0cmluZygpXG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQVBJIEhBTkRMRVJTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogR0VUIC9hcGkvbXZtL2NhdGFsb2dcbiAqIExpc3QgcHJvZHVjdHMgYXZhaWxhYmxlIGZvciB2ZW5kb3IgbWFwcGluZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgdGVuYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW5hbnRJZCcpXG4gICAgY29uc3QgcHJvZHVjdElkID0gc2VhcmNoUGFyYW1zLmdldCgncHJvZHVjdElkJylcbiAgICBjb25zdCBjYXRlZ29yeUlkID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnlJZCcpXG4gICAgY29uc3QgcXVlcnkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdxdWVyeScpXG4gICAgY29uc3QgdmVuZG9ySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd2ZW5kb3JJZCcpIC8vIFRvIGNoZWNrIGV4aXN0aW5nIG1hcHBpbmdzXG4gICAgY29uc3QgdW5tYXBwZWRPbmx5ID0gc2VhcmNoUGFyYW1zLmdldCgndW5tYXBwZWRPbmx5JykgPT09ICd0cnVlJ1xuICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSB8fCAnMjQnLCAxMClcbiAgICBjb25zdCBvZmZzZXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdvZmZzZXQnKSB8fCAnMCcsIDEwKVxuICAgIFxuICAgIGlmICghdGVuYW50SWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICd0ZW5hbnRJZCBpcyByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBzaW5nbGUgcHJvZHVjdCBieSBJRFxuICAgIGlmIChwcm9kdWN0SWQpIHtcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBwcmlzbWEucHJvZHVjdC5maW5kRmlyc3Qoe1xuICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkLCB0ZW5hbnRJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXG4gICAgICAgICAgdmFyaWFudHM6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgICApXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHByb2R1Y3Q6IG1hcFByb2R1Y3RUb1Jlc3BvbnNlKHByb2R1Y3QpLFxuICAgICAgICBzb3VyY2U6ICdDT1JFJ1xuICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gQnVpbGQgd2hlcmUgY2xhdXNlXG4gICAgY29uc3Qgd2hlcmU6IFByaXNtYS5Qcm9kdWN0V2hlcmVJbnB1dCA9IHtcbiAgICAgIHRlbmFudElkLFxuICAgICAgc3RhdHVzOiAnQUNUSVZFJ1xuICAgIH1cbiAgICBcbiAgICBpZiAoY2F0ZWdvcnlJZCkge1xuICAgICAgd2hlcmUuY2F0ZWdvcnlJZCA9IGNhdGVnb3J5SWRcbiAgICB9XG4gICAgXG4gICAgaWYgKHF1ZXJ5KSB7XG4gICAgICB3aGVyZS5PUiA9IFtcbiAgICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBxdWVyeSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHF1ZXJ5LCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IHF1ZXJ5LCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfVxuICAgICAgXVxuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgdG90YWwgY291bnRcbiAgICBjb25zdCB0b3RhbCA9IGF3YWl0IHByaXNtYS5wcm9kdWN0LmNvdW50KHsgd2hlcmUgfSlcbiAgICBcbiAgICAvLyBHZXQgcHJvZHVjdHNcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHByaXNtYS5wcm9kdWN0LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlLFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcbiAgICAgICAgdmFyaWFudHM6IHRydWVcbiAgICAgIH0sXG4gICAgICBvcmRlckJ5OiB7IG5hbWU6ICdhc2MnIH0sXG4gICAgICB0YWtlOiBsaW1pdCxcbiAgICAgIHNraXA6IG9mZnNldFxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwcm9kdWN0czogcHJvZHVjdHMubWFwKHAgPT4gbWFwUHJvZHVjdFRvUmVzcG9uc2UocCkpLFxuICAgICAgdG90YWwsXG4gICAgICBoYXNNb3JlOiBvZmZzZXQgKyBwcm9kdWN0cy5sZW5ndGggPCB0b3RhbCxcbiAgICAgIHNvdXJjZTogJ0NPUkUnXG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTVZNXSBFcnJvciBmZXRjaGluZyBjYXRhbG9nOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbi8qKlxuICogUE9TVCAvYXBpL212bS9jYXRhbG9nXG4gKiBCYXRjaCBnZXQgcHJvZHVjdHMgYnkgSURzIChmb3IgdmVuZG9yIHByb2R1Y3QgbWFwcGluZ3MpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyB0ZW5hbnRJZCwgcHJvZHVjdElkcyB9ID0gYm9keVxuICAgIFxuICAgIGlmICghdGVuYW50SWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICd0ZW5hbnRJZCBpcyByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGlmICghcHJvZHVjdElkcyB8fCAhQXJyYXkuaXNBcnJheShwcm9kdWN0SWRzKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3Byb2R1Y3RJZHMgYXJyYXkgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHByaXNtYS5wcm9kdWN0LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGlkOiB7IGluOiBwcm9kdWN0SWRzIH0sXG4gICAgICAgIHRlbmFudElkXG4gICAgICB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcbiAgICAgICAgdmFyaWFudHM6IHRydWVcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzLm1hcChwID0+IG1hcFByb2R1Y3RUb1Jlc3BvbnNlKHApKSxcbiAgICAgIGNvdW50OiBwcm9kdWN0cy5sZW5ndGgsXG4gICAgICBzb3VyY2U6ICdDT1JFJ1xuICAgIH0pXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW01WTV0gRXJyb3IgYmF0Y2ggZmV0Y2hpbmcgcHJvZHVjdHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJkZWNpbWFsVG9OdW1iZXIiLCJ2YWwiLCJOdW1iZXIiLCJtYXBQcm9kdWN0VG9SZXNwb25zZSIsInByb2R1Y3QiLCJpZCIsInRlbmFudElkIiwibmFtZSIsInNsdWciLCJkZXNjcmlwdGlvbiIsInNob3J0RGVzY3JpcHRpb24iLCJjYXRlZ29yeUlkIiwiY2F0ZWdvcnlOYW1lIiwiY2F0ZWdvcnkiLCJ0YWdzIiwiYmFzZVByaWNlIiwicHJpY2UiLCJjb21wYXJlQXRQcmljZSIsImN1cnJlbmN5IiwiaW1hZ2VzIiwibWFwIiwiaW1nIiwidXJsIiwiYWx0VGV4dCIsInBvc2l0aW9uIiwiaXNEZWZhdWx0Iiwic3RhdHVzIiwiaGFzVmFyaWFudHMiLCJ2YXJpYW50cyIsImxlbmd0aCIsInYiLCJwcm9kdWN0SWQiLCJza3UiLCJiYXJjb2RlIiwib3B0aW9ucyIsIm9wdGlvblZhbHVlcyIsImlzQWN0aXZlIiwid2VpZ2h0Iiwid2VpZ2h0VW5pdCIsImNyZWF0ZWRBdCIsInRvSVNPU3RyaW5nIiwidXBkYXRlZEF0IiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsImdldCIsInF1ZXJ5IiwidmVuZG9ySWQiLCJ1bm1hcHBlZE9ubHkiLCJsaW1pdCIsInBhcnNlSW50Iiwib2Zmc2V0IiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsImZpbmRGaXJzdCIsIndoZXJlIiwiaW5jbHVkZSIsInNvdXJjZSIsIk9SIiwiY29udGFpbnMiLCJtb2RlIiwidG90YWwiLCJjb3VudCIsInByb2R1Y3RzIiwiZmluZE1hbnkiLCJvcmRlckJ5IiwidGFrZSIsInNraXAiLCJwIiwiaGFzTW9yZSIsImNvbnNvbGUiLCJQT1NUIiwiYm9keSIsInByb2R1Y3RJZHMiLCJBcnJheSIsImlzQXJyYXkiLCJpbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/mvm/catalog/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmvm%2Fcatalog%2Froute&page=%2Fapi%2Fmvm%2Fcatalog%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmvm%2Fcatalog%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();