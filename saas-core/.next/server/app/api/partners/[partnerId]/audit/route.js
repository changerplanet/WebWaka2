"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/partners/[partnerId]/audit/route";
exports.ids = ["app/api/partners/[partnerId]/audit/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_partners_partnerId_audit_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/partners/[partnerId]/audit/route.ts */ \"(rsc)/./src/app/api/partners/[partnerId]/audit/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/partners/[partnerId]/audit/route\",\n        pathname: \"/api/partners/[partnerId]/audit\",\n        filename: \"route\",\n        bundlePath: \"app/api/partners/[partnerId]/audit/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/partners/[partnerId]/audit/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_partners_partnerId_audit_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/partners/[partnerId]/audit/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwYXJ0bmVycyUyRiU1QnBhcnRuZXJJZCU1RCUyRmF1ZGl0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZwYXJ0bmVycyUyRiU1QnBhcnRuZXJJZCU1RCUyRmF1ZGl0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcGFydG5lcnMlMkYlNUJwYXJ0bmVySWQlNUQlMkZhdWRpdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDYztBQUMzRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/YmEwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9hdWRpdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vYXVkaXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9hdWRpdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vYXVkaXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9hdWRpdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vYXVkaXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/partners/[partnerId]/audit/route.ts":
/*!*********************************************************!*\
  !*** ./src/app/api/partners/[partnerId]/audit/route.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_partner_authorization__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/partner-authorization */ \"(rsc)/./src/lib/partner-authorization.ts\");\n/* harmony import */ var _lib_partner_audit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/partner-audit */ \"(rsc)/./src/lib/partner-audit.ts\");\n/**\n * Partner Audit Log API\n * \n * GET /api/partners/[partnerId]/audit - Get audit logs for a partner\n * \n * Only returns partner-related audit entries.\n * Super Admins can see all entries, Partner Owners can see their own partner's logs.\n */ \n\n\nasync function GET(request, { params }) {\n    try {\n        const { partnerId } = await params;\n        // Require owner access for audit logs\n        const authResult = await (0,_lib_partner_authorization__WEBPACK_IMPORTED_MODULE_1__.requirePartnerOwnerAccess)(partnerId);\n        if (!authResult.authorized) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: authResult.error\n            }, {\n                status: authResult.status\n            });\n        }\n        // Parse query params\n        const { searchParams } = new URL(request.url);\n        const startDate = searchParams.get(\"start\");\n        const endDate = searchParams.get(\"end\");\n        const reportType = searchParams.get(\"report\") // 'activity' for activity report\n        ;\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        // Generate activity report if requested\n        if (reportType === \"activity\") {\n            const start = startDate ? new Date(startDate) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000) // 30 days default\n            ;\n            const end = endDate ? new Date(endDate) : new Date();\n            const report = await (0,_lib_partner_audit__WEBPACK_IMPORTED_MODULE_2__.generatePartnerActivityReport)(partnerId, start, end);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(report);\n        }\n        // Default: return audit logs\n        const result = await (0,_lib_partner_audit__WEBPACK_IMPORTED_MODULE_2__.getPartnerAuditLogs)(partnerId, {\n            startDate: startDate ? new Date(startDate) : undefined,\n            endDate: endDate ? new Date(endDate) : undefined,\n            limit,\n            offset\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            entries: result.entries,\n            total: result.total,\n            limit,\n            offset\n        });\n    } catch (error) {\n        console.error(\"Error fetching audit logs:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9hdWRpdC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7Ozs7Q0FPQyxHQUVzRDtBQUNnQjtBQUNpQjtBQUVqRixlQUFlSSxJQUNwQkMsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUE4QztJQUV0RCxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxTQUFTLEVBQUUsR0FBRyxNQUFNRDtRQUU1QixzQ0FBc0M7UUFDdEMsTUFBTUUsYUFBYSxNQUFNUCxxRkFBeUJBLENBQUNNO1FBQ25ELElBQUksQ0FBQ0MsV0FBV0MsVUFBVSxFQUFFO1lBQzFCLE9BQU9ULHFEQUFZQSxDQUFDVSxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPSCxXQUFXRyxLQUFLO1lBQUMsR0FDMUI7Z0JBQUVDLFFBQVFKLFdBQVdJLE1BQU07WUFBQztRQUVoQztRQUVBLHFCQUFxQjtRQUNyQixNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlULFFBQVFVLEdBQUc7UUFDNUMsTUFBTUMsWUFBWUgsYUFBYUksR0FBRyxDQUFDO1FBQ25DLE1BQU1DLFVBQVVMLGFBQWFJLEdBQUcsQ0FBQztRQUNqQyxNQUFNRSxhQUFhTixhQUFhSSxHQUFHLENBQUMsVUFBVSxpQ0FBaUM7O1FBQy9FLE1BQU1HLFFBQVFDLFNBQVNSLGFBQWFJLEdBQUcsQ0FBQyxZQUFZO1FBQ3BELE1BQU1LLFNBQVNELFNBQVNSLGFBQWFJLEdBQUcsQ0FBQyxhQUFhO1FBRXRELHdDQUF3QztRQUN4QyxJQUFJRSxlQUFlLFlBQVk7WUFDN0IsTUFBTUksUUFBUVAsWUFBWSxJQUFJUSxLQUFLUixhQUFhLElBQUlRLEtBQUtBLEtBQUtDLEdBQUcsS0FBSyxLQUFLLEtBQUssS0FBSyxLQUFLLE1BQU0sa0JBQWtCOztZQUNsSCxNQUFNQyxNQUFNUixVQUFVLElBQUlNLEtBQUtOLFdBQVcsSUFBSU07WUFFOUMsTUFBTUcsU0FBUyxNQUFNeEIsaUZBQTZCQSxDQUFDSSxXQUFXZ0IsT0FBT0c7WUFDckUsT0FBTzFCLHFEQUFZQSxDQUFDVSxJQUFJLENBQUNpQjtRQUMzQjtRQUVBLDZCQUE2QjtRQUM3QixNQUFNQyxTQUFTLE1BQU0xQix1RUFBbUJBLENBQUNLLFdBQVc7WUFDbERTLFdBQVdBLFlBQVksSUFBSVEsS0FBS1IsYUFBYWE7WUFDN0NYLFNBQVNBLFVBQVUsSUFBSU0sS0FBS04sV0FBV1c7WUFDdkNUO1lBQ0FFO1FBQ0Y7UUFFQSxPQUFPdEIscURBQVlBLENBQUNVLElBQUksQ0FBQztZQUN2Qm9CLFNBQVNGLE9BQU9FLE9BQU87WUFDdkJDLE9BQU9ILE9BQU9HLEtBQUs7WUFDbkJYO1lBQ0FFO1FBQ0Y7SUFFRixFQUFFLE9BQU9YLE9BQU87UUFDZHFCLFFBQVFyQixLQUFLLENBQUMsOEJBQThCQTtRQUM1QyxPQUFPWCxxREFBWUEsQ0FBQ1UsSUFBSSxDQUN0QjtZQUFFQyxPQUFPO1FBQXdCLEdBQ2pDO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2FwcC9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vYXVkaXQvcm91dGUudHM/NmFlMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBhcnRuZXIgQXVkaXQgTG9nIEFQSVxuICogXG4gKiBHRVQgL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9hdWRpdCAtIEdldCBhdWRpdCBsb2dzIGZvciBhIHBhcnRuZXJcbiAqIFxuICogT25seSByZXR1cm5zIHBhcnRuZXItcmVsYXRlZCBhdWRpdCBlbnRyaWVzLlxuICogU3VwZXIgQWRtaW5zIGNhbiBzZWUgYWxsIGVudHJpZXMsIFBhcnRuZXIgT3duZXJzIGNhbiBzZWUgdGhlaXIgb3duIHBhcnRuZXIncyBsb2dzLlxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IHJlcXVpcmVQYXJ0bmVyT3duZXJBY2Nlc3MgfSBmcm9tICdAL2xpYi9wYXJ0bmVyLWF1dGhvcml6YXRpb24nXG5pbXBvcnQgeyBnZXRQYXJ0bmVyQXVkaXRMb2dzLCBnZW5lcmF0ZVBhcnRuZXJBY3Rpdml0eVJlcG9ydCB9IGZyb20gJ0AvbGliL3BhcnRuZXItYXVkaXQnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogUHJvbWlzZTx7IHBhcnRuZXJJZDogc3RyaW5nIH0+IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcGFydG5lcklkIH0gPSBhd2FpdCBwYXJhbXNcbiAgICBcbiAgICAvLyBSZXF1aXJlIG93bmVyIGFjY2VzcyBmb3IgYXVkaXQgbG9nc1xuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlUGFydG5lck93bmVyQWNjZXNzKHBhcnRuZXJJZClcbiAgICBpZiAoIWF1dGhSZXN1bHQuYXV0aG9yaXplZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiBhdXRoUmVzdWx0LmVycm9yIH0sXG4gICAgICAgIHsgc3RhdHVzOiBhdXRoUmVzdWx0LnN0YXR1cyB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIC8vIFBhcnNlIHF1ZXJ5IHBhcmFtc1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ3N0YXJ0JylcbiAgICBjb25zdCBlbmREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnZW5kJylcbiAgICBjb25zdCByZXBvcnRUeXBlID0gc2VhcmNoUGFyYW1zLmdldCgncmVwb3J0JykgLy8gJ2FjdGl2aXR5JyBmb3IgYWN0aXZpdHkgcmVwb3J0XG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc1MCcpXG4gICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnb2Zmc2V0JykgfHwgJzAnKVxuICAgIFxuICAgIC8vIEdlbmVyYXRlIGFjdGl2aXR5IHJlcG9ydCBpZiByZXF1ZXN0ZWRcbiAgICBpZiAocmVwb3J0VHlwZSA9PT0gJ2FjdGl2aXR5Jykge1xuICAgICAgY29uc3Qgc3RhcnQgPSBzdGFydERhdGUgPyBuZXcgRGF0ZShzdGFydERhdGUpIDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gMzAgZGF5cyBkZWZhdWx0XG4gICAgICBjb25zdCBlbmQgPSBlbmREYXRlID8gbmV3IERhdGUoZW5kRGF0ZSkgOiBuZXcgRGF0ZSgpXG4gICAgICBcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IGdlbmVyYXRlUGFydG5lckFjdGl2aXR5UmVwb3J0KHBhcnRuZXJJZCwgc3RhcnQsIGVuZClcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXBvcnQpXG4gICAgfVxuICAgIFxuICAgIC8vIERlZmF1bHQ6IHJldHVybiBhdWRpdCBsb2dzXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UGFydG5lckF1ZGl0TG9ncyhwYXJ0bmVySWQsIHtcbiAgICAgIHN0YXJ0RGF0ZTogc3RhcnREYXRlID8gbmV3IERhdGUoc3RhcnREYXRlKSA6IHVuZGVmaW5lZCxcbiAgICAgIGVuZERhdGU6IGVuZERhdGUgPyBuZXcgRGF0ZShlbmREYXRlKSA6IHVuZGVmaW5lZCxcbiAgICAgIGxpbWl0LFxuICAgICAgb2Zmc2V0XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgZW50cmllczogcmVzdWx0LmVudHJpZXMsXG4gICAgICB0b3RhbDogcmVzdWx0LnRvdGFsLFxuICAgICAgbGltaXQsXG4gICAgICBvZmZzZXRcbiAgICB9KVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGF1ZGl0IGxvZ3M6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJlcXVpcmVQYXJ0bmVyT3duZXJBY2Nlc3MiLCJnZXRQYXJ0bmVyQXVkaXRMb2dzIiwiZ2VuZXJhdGVQYXJ0bmVyQWN0aXZpdHlSZXBvcnQiLCJHRVQiLCJyZXF1ZXN0IiwicGFyYW1zIiwicGFydG5lcklkIiwiYXV0aFJlc3VsdCIsImF1dGhvcml6ZWQiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJzdGFydERhdGUiLCJnZXQiLCJlbmREYXRlIiwicmVwb3J0VHlwZSIsImxpbWl0IiwicGFyc2VJbnQiLCJvZmZzZXQiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJlbmQiLCJyZXBvcnQiLCJyZXN1bHQiLCJ1bmRlZmluZWQiLCJlbnRyaWVzIiwidG90YWwiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/partners/[partnerId]/audit/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMagicLink: () => (/* binding */ createMagicLink),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getCurrentSession: () => (/* binding */ getCurrentSession),\n/* harmony export */   getSessionByToken: () => (/* binding */ getSessionByToken),\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   isTenantAdmin: () => (/* binding */ isTenantAdmin),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   switchTenant: () => (/* binding */ switchTenant),\n/* harmony export */   verifyMagicLink: () => (/* binding */ verifyMagicLink)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n// Token expiration times\nconst MAGIC_LINK_EXPIRY_MINUTES = 15;\nconst SESSION_EXPIRY_DAYS = 7;\n/**\n * Generate a secure random token\n */ function generateToken() {\n    return (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])() + \"-\" + (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n}\n/**\n * Create a magic link for a user\n * If user doesn't exist, creates them\n */ async function createMagicLink(email, tenantId) {\n    const normalizedEmail = email.toLowerCase().trim();\n    // Find or create user\n    let user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email: normalizedEmail\n        }\n    });\n    if (!user) {\n        user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                email: normalizedEmail,\n                globalRole: \"USER\"\n            }\n        });\n    }\n    // Generate token\n    const token = generateToken();\n    const expiresAt = new Date();\n    expiresAt.setMinutes(expiresAt.getMinutes() + MAGIC_LINK_EXPIRY_MINUTES);\n    // Create magic link record\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            token,\n            userId: user.id,\n            tenantId: tenantId || null,\n            expiresAt\n        }\n    });\n    return {\n        token,\n        user\n    };\n}\n/**\n * Verify and consume a magic link\n * Returns user and creates session if valid\n */ async function verifyMagicLink(token) {\n    // Find the magic link\n    const magicLink = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: true\n        }\n    });\n    if (!magicLink) {\n        return null;\n    }\n    // Check if expired\n    if (magicLink.expiresAt < new Date()) {\n        // Delete expired token\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.delete({\n            where: {\n                id: magicLink.id\n            }\n        });\n        return null;\n    }\n    // Check if already used\n    if (magicLink.usedAt) {\n        return null;\n    }\n    // Mark as used\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.update({\n        where: {\n            id: magicLink.id\n        },\n        data: {\n            usedAt: new Date()\n        }\n    });\n    // Update user's last login\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n        where: {\n            id: magicLink.userId\n        },\n        data: {\n            lastLoginAt: new Date()\n        }\n    });\n    // Create session\n    const sessionToken = generateToken();\n    const sessionExpiresAt = new Date();\n    sessionExpiresAt.setDate(sessionExpiresAt.getDate() + SESSION_EXPIRY_DAYS);\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            userId: magicLink.userId,\n            token: sessionToken,\n            activeTenant: magicLink.tenantId,\n            expiresAt: sessionExpiresAt\n        }\n    });\n    // Get user with memberships\n    const user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            id: magicLink.userId\n        },\n        include: {\n            memberships: {\n                where: {\n                    isActive: true\n                },\n                include: {\n                    tenant: true\n                }\n            }\n        }\n    });\n    return {\n        user: user,\n        session: {\n            id: session.id,\n            token: sessionToken\n        },\n        tenantId: magicLink.tenantId\n    };\n}\n/**\n * Get session from token\n */ async function getSessionByToken(token) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: {\n                        where: {\n                            isActive: true\n                        },\n                        include: {\n                            tenant: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    // Check if expired\n    if (session.expiresAt < new Date()) {\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.delete({\n            where: {\n                id: session.id\n            }\n        });\n        return null;\n    }\n    // Update last active\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            lastActiveAt: new Date()\n        }\n    });\n    return {\n        user: session.user,\n        sessionId: session.id,\n        activeTenantId: session.activeTenant\n    };\n}\n/**\n * Get current session from cookies\n */ async function getCurrentSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (!sessionToken) {\n        return null;\n    }\n    return getSessionByToken(sessionToken);\n}\n/**\n * Set session cookie\n */ async function setSessionCookie(token) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    cookieStore.set(\"session_token\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: SESSION_EXPIRY_DAYS * 24 * 60 * 60,\n        path: \"/\"\n    });\n}\n/**\n * Clear session cookie and delete session\n */ async function logout() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (sessionToken) {\n        // Delete session from database\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.deleteMany({\n            where: {\n                token: sessionToken\n            }\n        });\n    }\n    // Clear cookie\n    cookieStore.delete(\"session_token\");\n}\n/**\n * Switch active tenant for a session\n */ async function switchTenant(sessionToken, tenantId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token: sessionToken\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: true\n                }\n            }\n        }\n    });\n    if (!session) return false;\n    // Check if user has access to this tenant\n    const hasMembership = session.user.memberships.some((m)=>m.tenantId === tenantId && m.isActive);\n    // Super admins can access any tenant\n    const isSuperAdmin = session.user.globalRole === \"SUPER_ADMIN\";\n    if (!hasMembership && !isSuperAdmin) {\n        return false;\n    }\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            activeTenant: tenantId\n        }\n    });\n    return true;\n}\n/**\n * Check if user is Super Admin\n */ function isSuperAdmin(user) {\n    return user.globalRole === \"SUPER_ADMIN\";\n}\n/**\n * Check if user is Tenant Admin for a specific tenant\n */ async function isTenantAdmin(userId, tenantId) {\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.tenantMembership.findUnique({\n        where: {\n            userId_tenantId: {\n                userId,\n                tenantId\n            }\n        }\n    });\n    return membership?.role === \"TENANT_ADMIN\" && membership.isActive;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YTtRQUFhO1FBQzdCTCxTQUFTO1lBQUVmLE1BQU07Z0JBQUVlLFNBQVM7b0JBQUVXLGFBQWE7Z0JBQUs7WUFBRTtRQUFFO0lBQ3REO0lBRUEsSUFBSSxDQUFDRixTQUFTLE9BQU87SUFFckIsMENBQTBDO0lBQzFDLE1BQU13QixnQkFBZ0J4QixRQUFReEIsSUFBSSxDQUFDMEIsV0FBVyxDQUFDdUIsSUFBSSxDQUNqREMsQ0FBQUEsSUFBS0EsRUFBRXRELFFBQVEsS0FBS0EsWUFBWXNELEVBQUV2QixRQUFRO0lBRzVDLHFDQUFxQztJQUNyQyxNQUFNd0IsZUFBZTNCLFFBQVF4QixJQUFJLENBQUNNLFVBQVUsS0FBSztJQUVqRCxJQUFJLENBQUMwQyxpQkFBaUIsQ0FBQ0csY0FBYztRQUNuQyxPQUFPO0lBQ1Q7SUFFQSxNQUFNaEUsMkNBQU1BLENBQUNxQyxPQUFPLENBQUNOLE1BQU0sQ0FBQztRQUMxQmhCLE9BQU87WUFBRUcsSUFBSW1CLFFBQVFuQixFQUFFO1FBQUM7UUFDeEJELE1BQU07WUFBRXFCLGNBQWM3QjtRQUFTO0lBQ2pDO0lBRUEsT0FBTztBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTdUQsYUFBYW5ELElBQVU7SUFDckMsT0FBT0EsS0FBS00sVUFBVSxLQUFLO0FBQzdCO0FBRUE7O0NBRUMsR0FDTSxlQUFlOEMsY0FBY3ZDLE1BQWMsRUFBRWpCLFFBQWdCO0lBQ2xFLE1BQU15RCxhQUFhLE1BQU1sRSwyQ0FBTUEsQ0FBQ21FLGdCQUFnQixDQUFDckQsVUFBVSxDQUFDO1FBQzFEQyxPQUFPO1lBQ0xxRCxpQkFBaUI7Z0JBQUUxQztnQkFBUWpCO1lBQVM7UUFDdEM7SUFDRjtJQUVBLE9BQU95RCxZQUFZRyxTQUFTLGtCQUFrQkgsV0FBVzFCLFFBQVE7QUFDbkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgVXNlciwgR2xvYmFsUm9sZSwgVGVuYW50Um9sZSwgVGVuYW50LCBUZW5hbnRNZW1iZXJzaGlwIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vIFRva2VuIGV4cGlyYXRpb24gdGltZXNcbmNvbnN0IE1BR0lDX0xJTktfRVhQSVJZX01JTlVURVMgPSAxNVxuY29uc3QgU0VTU0lPTl9FWFBJUllfREFZUyA9IDdcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIFNlc3Npb25Vc2VyID0gVXNlciAmIHtcbiAgbWVtYmVyc2hpcHM6IChUZW5hbnRNZW1iZXJzaGlwICYge1xuICAgIHRlbmFudDogVGVuYW50XG4gIH0pW11cbn1cblxuZXhwb3J0IHR5cGUgQXV0aFNlc3Npb24gPSB7XG4gIHVzZXI6IFNlc3Npb25Vc2VyXG4gIHNlc3Npb25JZDogc3RyaW5nXG4gIGFjdGl2ZVRlbmFudElkOiBzdHJpbmcgfCBudWxsXG59XG5cbi8qKlxuICogR2VuZXJhdGUgYSBzZWN1cmUgcmFuZG9tIHRva2VuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKCk6IHN0cmluZyB7XG4gIHJldHVybiB1dWlkdjQoKSArICctJyArIHV1aWR2NCgpXG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbWFnaWMgbGluayBmb3IgYSB1c2VyXG4gKiBJZiB1c2VyIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZXMgdGhlbVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTWFnaWNMaW5rKGVtYWlsOiBzdHJpbmcsIHRlbmFudElkPzogc3RyaW5nKTogUHJvbWlzZTx7IHRva2VuOiBzdHJpbmc7IHVzZXI6IFVzZXIgfT4ge1xuICBjb25zdCBub3JtYWxpemVkRW1haWwgPSBlbWFpbC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICBcbiAgLy8gRmluZCBvciBjcmVhdGUgdXNlclxuICBsZXQgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGVtYWlsOiBub3JtYWxpemVkRW1haWwgfVxuICB9KVxuICBcbiAgaWYgKCF1c2VyKSB7XG4gICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgZW1haWw6IG5vcm1hbGl6ZWRFbWFpbCxcbiAgICAgICAgZ2xvYmFsUm9sZTogJ1VTRVInXG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gR2VuZXJhdGUgdG9rZW5cbiAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZVRva2VuKClcbiAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoKVxuICBleHBpcmVzQXQuc2V0TWludXRlcyhleHBpcmVzQXQuZ2V0TWludXRlcygpICsgTUFHSUNfTElOS19FWFBJUllfTUlOVVRFUylcbiAgXG4gIC8vIENyZWF0ZSBtYWdpYyBsaW5rIHJlY29yZFxuICBhd2FpdCBwcmlzbWEubWFnaWNMaW5rLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgdG9rZW4sXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICB0ZW5hbnRJZDogdGVuYW50SWQgfHwgbnVsbCxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH1cbiAgfSlcbiAgXG4gIHJldHVybiB7IHRva2VuLCB1c2VyIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgYW5kIGNvbnN1bWUgYSBtYWdpYyBsaW5rXG4gKiBSZXR1cm5zIHVzZXIgYW5kIGNyZWF0ZXMgc2Vzc2lvbiBpZiB2YWxpZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWFnaWNMaW5rKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHsgdXNlcjogU2Vzc2lvblVzZXI7IHNlc3Npb246IHsgaWQ6IHN0cmluZzsgdG9rZW46IHN0cmluZyB9OyB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCB9IHwgbnVsbD4ge1xuICAvLyBGaW5kIHRoZSBtYWdpYyBsaW5rXG4gIGNvbnN0IG1hZ2ljTGluayA9IGF3YWl0IHByaXNtYS5tYWdpY0xpbmsuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7IHVzZXI6IHRydWUgfVxuICB9KVxuICBcbiAgaWYgKCFtYWdpY0xpbmspIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChtYWdpY0xpbmsuZXhwaXJlc0F0IDwgbmV3IERhdGUoKSkge1xuICAgIC8vIERlbGV0ZSBleHBpcmVkIHRva2VuXG4gICAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay5kZWxldGUoeyB3aGVyZTogeyBpZDogbWFnaWNMaW5rLmlkIH0gfSlcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBhbHJlYWR5IHVzZWRcbiAgaWYgKG1hZ2ljTGluay51c2VkQXQpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBNYXJrIGFzIHVzZWRcbiAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay51cGRhdGUoe1xuICAgIHdoZXJlOiB7IGlkOiBtYWdpY0xpbmsuaWQgfSxcbiAgICBkYXRhOiB7IHVzZWRBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICAvLyBVcGRhdGUgdXNlcidzIGxhc3QgbG9naW5cbiAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGRhdGE6IHsgbGFzdExvZ2luQXQ6IG5ldyBEYXRlKCkgfVxuICB9KVxuICBcbiAgLy8gQ3JlYXRlIHNlc3Npb25cbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2VuZXJhdGVUb2tlbigpXG4gIGNvbnN0IHNlc3Npb25FeHBpcmVzQXQgPSBuZXcgRGF0ZSgpXG4gIHNlc3Npb25FeHBpcmVzQXQuc2V0RGF0ZShzZXNzaW9uRXhwaXJlc0F0LmdldERhdGUoKSArIFNFU1NJT05fRVhQSVJZX0RBWVMpXG4gIFxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBpZDogdXVpZHY0KCksXG4gICAgICB1c2VySWQ6IG1hZ2ljTGluay51c2VySWQsXG4gICAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxuICAgICAgYWN0aXZlVGVuYW50OiBtYWdpY0xpbmsudGVuYW50SWQsXG4gICAgICBleHBpcmVzQXQ6IHNlc3Npb25FeHBpcmVzQXRcbiAgICB9XG4gIH0pXG4gIFxuICAvLyBHZXQgdXNlciB3aXRoIG1lbWJlcnNoaXBzXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHVzZXIgYXMgU2Vzc2lvblVzZXIsXG4gICAgc2Vzc2lvbjogeyBpZDogc2Vzc2lvbi5pZCwgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIHRlbmFudElkOiBtYWdpY0xpbmsudGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEdldCBzZXNzaW9uIGZyb20gdG9rZW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25CeVRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPEF1dGhTZXNzaW9uIHwgbnVsbD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBtZW1iZXJzaGlwczoge1xuICAgICAgICAgICAgd2hlcmU6IHsgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChzZXNzaW9uLmV4cGlyZXNBdCA8IG5ldyBEYXRlKCkpIHtcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGUoeyB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9IH0pXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuICBcbiAgLy8gVXBkYXRlIGxhc3QgYWN0aXZlXG4gIGF3YWl0IHByaXNtYS5zZXNzaW9uLnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHNlc3Npb24uaWQgfSxcbiAgICBkYXRhOiB7IGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHNlc3Npb24udXNlciBhcyBTZXNzaW9uVXNlcixcbiAgICBzZXNzaW9uSWQ6IHNlc3Npb24uaWQsXG4gICAgYWN0aXZlVGVuYW50SWQ6IHNlc3Npb24uYWN0aXZlVGVuYW50XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCBzZXNzaW9uIGZyb20gY29va2llc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFNlc3Npb24oKTogUHJvbWlzZTxBdXRoU2Vzc2lvbiB8IG51bGw+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gY29va2llU3RvcmUuZ2V0KCdzZXNzaW9uX3Rva2VuJyk/LnZhbHVlXG4gIFxuICBpZiAoIXNlc3Npb25Ub2tlbikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgXG4gIHJldHVybiBnZXRTZXNzaW9uQnlUb2tlbihzZXNzaW9uVG9rZW4pXG59XG5cbi8qKlxuICogU2V0IHNlc3Npb24gY29va2llXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29va2llU3RvcmUuc2V0KCdzZXNzaW9uX3Rva2VuJywgdG9rZW4sIHtcbiAgICBodHRwT25seTogdHJ1ZSxcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgIG1heEFnZTogU0VTU0lPTl9FWFBJUllfREFZUyAqIDI0ICogNjAgKiA2MCwgLy8gZGF5cyB0byBzZWNvbmRzXG4gICAgcGF0aDogJy8nXG4gIH0pXG59XG5cbi8qKlxuICogQ2xlYXIgc2Vzc2lvbiBjb29raWUgYW5kIGRlbGV0ZSBzZXNzaW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dvdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGNvb2tpZVN0b3JlLmdldCgnc2Vzc2lvbl90b2tlbicpPy52YWx1ZVxuICBcbiAgaWYgKHNlc3Npb25Ub2tlbikge1xuICAgIC8vIERlbGV0ZSBzZXNzaW9uIGZyb20gZGF0YWJhc2VcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGVNYW55KHtcbiAgICAgIHdoZXJlOiB7IHRva2VuOiBzZXNzaW9uVG9rZW4gfVxuICAgIH0pXG4gIH1cbiAgXG4gIC8vIENsZWFyIGNvb2tpZVxuICBjb29raWVTdG9yZS5kZWxldGUoJ3Nlc3Npb25fdG9rZW4nKVxufVxuXG4vKipcbiAqIFN3aXRjaCBhY3RpdmUgdGVuYW50IGZvciBhIHNlc3Npb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN3aXRjaFRlbmFudChzZXNzaW9uVG9rZW46IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIGluY2x1ZGU6IHsgdXNlcjogeyBpbmNsdWRlOiB7IG1lbWJlcnNoaXBzOiB0cnVlIH0gfSB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHJldHVybiBmYWxzZVxuICBcbiAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWNjZXNzIHRvIHRoaXMgdGVuYW50XG4gIGNvbnN0IGhhc01lbWJlcnNoaXAgPSBzZXNzaW9uLnVzZXIubWVtYmVyc2hpcHMuc29tZShcbiAgICBtID0+IG0udGVuYW50SWQgPT09IHRlbmFudElkICYmIG0uaXNBY3RpdmVcbiAgKVxuICBcbiAgLy8gU3VwZXIgYWRtaW5zIGNhbiBhY2Nlc3MgYW55IHRlbmFudFxuICBjb25zdCBpc1N1cGVyQWRtaW4gPSBzZXNzaW9uLnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJ1xuICBcbiAgaWYgKCFoYXNNZW1iZXJzaGlwICYmICFpc1N1cGVyQWRtaW4pIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBcbiAgYXdhaXQgcHJpc21hLnNlc3Npb24udXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9LFxuICAgIGRhdGE6IHsgYWN0aXZlVGVuYW50OiB0ZW5hbnRJZCB9XG4gIH0pXG4gIFxuICByZXR1cm4gdHJ1ZVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgU3VwZXIgQWRtaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU3VwZXJBZG1pbih1c2VyOiBVc2VyKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VyLmdsb2JhbFJvbGUgPT09ICdTVVBFUl9BRE1JTidcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB1c2VyIGlzIFRlbmFudCBBZG1pbiBmb3IgYSBzcGVjaWZpYyB0ZW5hbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzVGVuYW50QWRtaW4odXNlcklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF3YWl0IHByaXNtYS50ZW5hbnRNZW1iZXJzaGlwLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7XG4gICAgICB1c2VySWRfdGVuYW50SWQ6IHsgdXNlcklkLCB0ZW5hbnRJZCB9XG4gICAgfVxuICB9KVxuICBcbiAgcmV0dXJuIG1lbWJlcnNoaXA/LnJvbGUgPT09ICdURU5BTlRfQURNSU4nICYmIG1lbWJlcnNoaXAuaXNBY3RpdmVcbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJ2NCIsInV1aWR2NCIsImNvb2tpZXMiLCJNQUdJQ19MSU5LX0VYUElSWV9NSU5VVEVTIiwiU0VTU0lPTl9FWFBJUllfREFZUyIsImdlbmVyYXRlVG9rZW4iLCJjcmVhdGVNYWdpY0xpbmsiLCJlbWFpbCIsInRlbmFudElkIiwibm9ybWFsaXplZEVtYWlsIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImNyZWF0ZSIsImRhdGEiLCJpZCIsImdsb2JhbFJvbGUiLCJ0b2tlbiIsImV4cGlyZXNBdCIsIkRhdGUiLCJzZXRNaW51dGVzIiwiZ2V0TWludXRlcyIsIm1hZ2ljTGluayIsInVzZXJJZCIsInZlcmlmeU1hZ2ljTGluayIsImluY2x1ZGUiLCJkZWxldGUiLCJ1c2VkQXQiLCJ1cGRhdGUiLCJsYXN0TG9naW5BdCIsInNlc3Npb25Ub2tlbiIsInNlc3Npb25FeHBpcmVzQXQiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNlc3Npb24iLCJhY3RpdmVUZW5hbnQiLCJtZW1iZXJzaGlwcyIsImlzQWN0aXZlIiwidGVuYW50IiwiZ2V0U2Vzc2lvbkJ5VG9rZW4iLCJsYXN0QWN0aXZlQXQiLCJzZXNzaW9uSWQiLCJhY3RpdmVUZW5hbnRJZCIsImdldEN1cnJlbnRTZXNzaW9uIiwiY29va2llU3RvcmUiLCJnZXQiLCJ2YWx1ZSIsInNldFNlc3Npb25Db29raWUiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJsb2dvdXQiLCJkZWxldGVNYW55Iiwic3dpdGNoVGVuYW50IiwiaGFzTWVtYmVyc2hpcCIsInNvbWUiLCJtIiwiaXNTdXBlckFkbWluIiwiaXNUZW5hbnRBZG1pbiIsIm1lbWJlcnNoaXAiLCJ0ZW5hbnRNZW1iZXJzaGlwIiwidXNlcklkX3RlbmFudElkIiwicm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/partner-audit.ts":
/*!**********************************!*\
  !*** ./src/lib/partner-audit.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AUDIT_RULES: () => (/* binding */ AUDIT_RULES),\n/* harmony export */   PARTNER_AUDIT_ACTIONS: () => (/* binding */ PARTNER_AUDIT_ACTIONS),\n/* harmony export */   RETENTION_POLICY: () => (/* binding */ RETENTION_POLICY),\n/* harmony export */   auditEarningAction: () => (/* binding */ auditEarningAction),\n/* harmony export */   auditPartnerAction: () => (/* binding */ auditPartnerAction),\n/* harmony export */   auditPayoutAction: () => (/* binding */ auditPayoutAction),\n/* harmony export */   createAuditEntry: () => (/* binding */ createAuditEntry),\n/* harmony export */   generateAuditReport: () => (/* binding */ generateAuditReport),\n/* harmony export */   generatePartnerActivityReport: () => (/* binding */ generatePartnerActivityReport),\n/* harmony export */   getEarningAuditLogs: () => (/* binding */ getEarningAuditLogs),\n/* harmony export */   getEntriesDueForArchival: () => (/* binding */ getEntriesDueForArchival),\n/* harmony export */   getPartnerAuditLogs: () => (/* binding */ getPartnerAuditLogs),\n/* harmony export */   getPayoutAuditLogs: () => (/* binding */ getPayoutAuditLogs),\n/* harmony export */   isWithinRetention: () => (/* binding */ isWithinRetention),\n/* harmony export */   queryAuditLogs: () => (/* binding */ queryAuditLogs)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * Partner Audit Service\n * \n * Comprehensive audit logging for Partner-related actions.\n * \n * KEY PRINCIPLES:\n * 1. Audits are IMMUTABLE - no updates or deletes\n * 2. Full context captured at time of action\n * 3. Suitable for compliance reporting\n * 4. Retention policy enforcement\n * \n * TRACKED ACTIONS:\n * - Partner creation/updates\n * - Agreement changes\n * - Attribution events\n * - Earnings generation/status changes\n * - Payout events\n */ \n// ============================================================================\n// PARTNER-SPECIFIC AUDIT ACTIONS\n// ============================================================================\nconst PARTNER_AUDIT_ACTIONS = [\n    // Partner lifecycle\n    \"PARTNER_CREATED\",\n    \"PARTNER_UPDATED\",\n    \"PARTNER_APPROVED\",\n    \"PARTNER_SUSPENDED\",\n    \"PARTNER_TERMINATED\",\n    \"PARTNER_USER_ADDED\",\n    \"PARTNER_USER_REMOVED\",\n    // Agreements\n    \"PARTNER_AGREEMENT_CREATED\",\n    \"PARTNER_AGREEMENT_SIGNED\",\n    \"PARTNER_AGREEMENT_APPROVED\",\n    // Attribution\n    \"ATTRIBUTION_CREATED\",\n    \"ATTRIBUTION_LOCKED\",\n    \"ATTRIBUTION_LOCK_ATTEMPTED\",\n    \"ATTRIBUTION_REASSIGN_BLOCKED\",\n    \"PARTNER_REFERRAL_CREATED\",\n    \"PARTNER_REFERRAL_LOCKED\",\n    // Partner tenant creation\n    \"PARTNER_TENANT_CREATED\",\n    \"PARTNER_TENANT_ACTIVATED\",\n    // Earnings\n    \"COMMISSION_CALCULATED\",\n    \"EARNING_CREATED\",\n    \"EARNING_CLEARED\",\n    \"EARNING_APPROVED\",\n    \"EARNING_PAID\",\n    \"EARNING_DISPUTED\",\n    \"EARNING_REVERSED\",\n    \"EARNING_VOIDED\",\n    \"PARTNER_EARNING_CREATED\",\n    \"PARTNER_EARNING_APPROVED\",\n    \"PARTNER_EARNING_PAID\",\n    // Payouts\n    \"PAYOUT_BATCH_CREATED\",\n    \"PAYOUT_BATCH_APPROVED\",\n    \"PAYOUT_BATCH_PROCESSED\",\n    \"PAYOUT_BATCH_FAILED\",\n    \"PAYOUT_BATCH_CANCELLED\",\n    \"PAYOUT_READINESS_CHECKED\",\n    \"PAYOUT_HOLD_APPLIED\",\n    \"PAYOUT_HOLD_RELEASED\",\n    \"PAYOUT_SETTINGS_UPDATED\",\n    \"TAX_DOCUMENT_SUBMITTED\",\n    \"TAX_DOCUMENT_VERIFIED\"\n];\n// ============================================================================\n// AUDIT ENTRY CREATION\n// ============================================================================\n/**\n * Create an audit log entry\n * \n * Entries are IMMUTABLE once created\n */ async function createAuditEntry(input) {\n    return _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n        data: {\n            action: input.action,\n            actorId: input.actorId,\n            actorEmail: input.actorEmail,\n            tenantId: input.tenantId,\n            targetType: input.targetType,\n            targetId: input.targetId,\n            metadata: {\n                ...input.metadata,\n                ipAddress: input.ipAddress,\n                userAgent: input.userAgent,\n                timestamp: new Date().toISOString()\n            }\n        }\n    });\n}\n/**\n * Create audit entry with full context\n */ async function auditPartnerAction(action, partnerId, actorId, actorEmail, details) {\n    return createAuditEntry({\n        action,\n        actorId,\n        actorEmail,\n        targetType: \"Partner\",\n        targetId: partnerId,\n        metadata: {\n            partnerId,\n            ...details\n        }\n    });\n}\n/**\n * Audit earning action\n */ async function auditEarningAction(action, earningId, partnerId, actorId, details) {\n    return createAuditEntry({\n        action,\n        actorId,\n        actorEmail: \"system\",\n        targetType: \"PartnerEarning\",\n        targetId: earningId,\n        metadata: {\n            partnerId,\n            earningId,\n            ...details\n        }\n    });\n}\n/**\n * Audit payout action\n */ async function auditPayoutAction(action, batchId, partnerId, actorId, details) {\n    return createAuditEntry({\n        action,\n        actorId,\n        actorEmail: \"admin\",\n        targetType: \"PayoutBatch\",\n        targetId: batchId,\n        metadata: {\n            partnerId,\n            batchId,\n            ...details\n        }\n    });\n}\n// ============================================================================\n// AUDIT QUERIES\n// ============================================================================\n/**\n * Query audit logs\n */ async function queryAuditLogs(options) {\n    const where = {};\n    if (options.actions && options.actions.length > 0) {\n        where.action = {\n            in: options.actions\n        };\n    }\n    if (options.actorId) {\n        where.actorId = options.actorId;\n    }\n    if (options.targetType) {\n        where.targetType = options.targetType;\n    }\n    if (options.targetId) {\n        where.targetId = options.targetId;\n    }\n    if (options.tenantId) {\n        where.tenantId = options.tenantId;\n    }\n    if (options.startDate || options.endDate) {\n        where.createdAt = {};\n        if (options.startDate) where.createdAt.gte = options.startDate;\n        if (options.endDate) where.createdAt.lte = options.endDate;\n    }\n    const [entries, total] = await Promise.all([\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n            where,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: options.limit || 100,\n            skip: options.offset || 0\n        }),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.count({\n            where\n        })\n    ]);\n    return {\n        entries,\n        total\n    };\n}\n/**\n * Get audit logs for a specific partner\n */ async function getPartnerAuditLogs(partnerId, options) {\n    return queryAuditLogs({\n        actions: PARTNER_AUDIT_ACTIONS,\n        targetId: partnerId,\n        ...options\n    });\n}\n/**\n * Get audit logs for a specific earning\n */ async function getEarningAuditLogs(earningId) {\n    const { entries } = await queryAuditLogs({\n        targetType: \"PartnerEarning\",\n        targetId: earningId\n    });\n    return entries;\n}\n/**\n * Get audit logs for a payout batch\n */ async function getPayoutAuditLogs(batchId) {\n    const { entries } = await queryAuditLogs({\n        targetType: \"PayoutBatch\",\n        targetId: batchId\n    });\n    return entries;\n}\n// ============================================================================\n// COMPLIANCE REPORTS\n// ============================================================================\n/**\n * Generate audit report for compliance\n */ async function generateAuditReport(periodStart, periodEnd, options) {\n    const where = {\n        createdAt: {\n            gte: periodStart,\n            lte: periodEnd\n        }\n    };\n    if (options?.partnerId) {\n        where.targetId = options.partnerId;\n    }\n    if (options?.actions && options.actions.length > 0) {\n        where.action = {\n            in: options.actions\n        };\n    } else {\n        where.action = {\n            in: PARTNER_AUDIT_ACTIONS\n        };\n    }\n    // Get all entries\n    const entries = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n        where,\n        orderBy: {\n            createdAt: \"desc\"\n        }\n    });\n    // Aggregate by action\n    const byAction = {};\n    const byTargetType = {};\n    for (const entry of entries){\n        byAction[entry.action] = (byAction[entry.action] || 0) + 1;\n        if (entry.targetType) {\n            byTargetType[entry.targetType] = (byTargetType[entry.targetType] || 0) + 1;\n        }\n    }\n    return {\n        period: {\n            start: periodStart,\n            end: periodEnd\n        },\n        totalEntries: entries.length,\n        byAction,\n        byTargetType,\n        entries\n    };\n}\n/**\n * Generate partner activity report\n */ async function generatePartnerActivityReport(partnerId, periodStart, periodEnd) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            id: partnerId\n        },\n        select: {\n            id: true,\n            name: true\n        }\n    });\n    const { entries } = await queryAuditLogs({\n        actions: PARTNER_AUDIT_ACTIONS,\n        startDate: periodStart,\n        endDate: periodEnd\n    });\n    // Filter entries related to this partner\n    const partnerEntries = entries.filter((e)=>{\n        const metadata = e.metadata;\n        return e.targetId === partnerId || metadata?.partnerId === partnerId;\n    });\n    // Calculate summary\n    const summary = {\n        totalActions: partnerEntries.length,\n        earningsCreated: partnerEntries.filter((e)=>e.action === \"EARNING_CREATED\").length,\n        earningsPaid: partnerEntries.filter((e)=>e.action === \"EARNING_PAID\").length,\n        payoutBatches: partnerEntries.filter((e)=>e.action === \"PAYOUT_BATCH_CREATED\").length,\n        referralsAdded: partnerEntries.filter((e)=>e.action === \"ATTRIBUTION_CREATED\" || e.action === \"PARTNER_REFERRAL_CREATED\").length\n    };\n    return {\n        partner,\n        period: {\n            start: periodStart,\n            end: periodEnd\n        },\n        summary,\n        timeline: partnerEntries\n    };\n}\n// ============================================================================\n// RETENTION POLICY\n// ============================================================================\n/**\n * Retention policy configuration\n */ const RETENTION_POLICY = {\n    // Partner audit logs - keep for 7 years (compliance requirement)\n    PARTNER_LOGS_YEARS: 7,\n    // Earnings audit logs - keep for 7 years (tax/financial compliance)\n    EARNINGS_LOGS_YEARS: 7,\n    // Payout audit logs - keep for 7 years (financial compliance)\n    PAYOUT_LOGS_YEARS: 7,\n    // General audit logs - keep for 3 years\n    GENERAL_LOGS_YEARS: 3,\n    // Actions that require extended retention\n    EXTENDED_RETENTION_ACTIONS: [\n        \"EARNING_CREATED\",\n        \"EARNING_PAID\",\n        \"EARNING_REVERSED\",\n        \"PAYOUT_BATCH_CREATED\",\n        \"PAYOUT_BATCH_PROCESSED\",\n        \"PARTNER_AGREEMENT_SIGNED\",\n        \"TAX_DOCUMENT_VERIFIED\"\n    ]\n};\n/**\n * Check if an audit entry is within retention period\n */ function isWithinRetention(entry) {\n    const now = new Date();\n    const entryAge = (now.getTime() - entry.createdAt.getTime()) / (1000 * 60 * 60 * 24 * 365);\n    // Extended retention for financial actions\n    if (RETENTION_POLICY.EXTENDED_RETENTION_ACTIONS.includes(entry.action)) {\n        return entryAge < RETENTION_POLICY.EARNINGS_LOGS_YEARS;\n    }\n    // Partner actions\n    if (PARTNER_AUDIT_ACTIONS.includes(entry.action)) {\n        return entryAge < RETENTION_POLICY.PARTNER_LOGS_YEARS;\n    }\n    // General logs\n    return entryAge < RETENTION_POLICY.GENERAL_LOGS_YEARS;\n}\n/**\n * Get entries due for archival (outside retention but not deleted)\n * \n * NOTE: Actual archival/deletion should be done via a scheduled job\n * and may require legal/compliance approval\n */ async function getEntriesDueForArchival() {\n    const now = new Date();\n    const generalCutoff = new Date(now);\n    generalCutoff.setFullYear(generalCutoff.getFullYear() - RETENTION_POLICY.GENERAL_LOGS_YEARS);\n    const extendedCutoff = new Date(now);\n    extendedCutoff.setFullYear(extendedCutoff.getFullYear() - RETENTION_POLICY.EARNINGS_LOGS_YEARS);\n    // Get entries outside general retention that are NOT in extended retention category\n    const generalExpired = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n        where: {\n            createdAt: {\n                lt: generalCutoff\n            },\n            action: {\n                notIn: RETENTION_POLICY.EXTENDED_RETENTION_ACTIONS\n            }\n        }\n    });\n    // Get entries outside extended retention\n    const extendedExpired = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n        where: {\n            createdAt: {\n                lt: extendedCutoff\n            },\n            action: {\n                in: RETENTION_POLICY.EXTENDED_RETENTION_ACTIONS\n            }\n        }\n    });\n    const allExpired = [\n        ...generalExpired,\n        ...extendedExpired\n    ];\n    const byAction = {};\n    let oldestEntry = null;\n    for (const entry of allExpired){\n        byAction[entry.action] = (byAction[entry.action] || 0) + 1;\n        if (!oldestEntry || entry.createdAt < oldestEntry) {\n            oldestEntry = entry.createdAt;\n        }\n    }\n    return {\n        count: allExpired.length,\n        oldestEntry,\n        byAction\n    };\n}\n// ============================================================================\n// CONSTANTS\n// ============================================================================\nconst AUDIT_RULES = {\n    // Audits are immutable\n    IMMUTABLE: true,\n    // No updates allowed\n    NO_UPDATES: true,\n    // No deletes allowed (except via retention policy)\n    NO_DELETES: true,\n    // Full context required\n    FULL_CONTEXT: true,\n    // Timestamp auto-generated\n    AUTO_TIMESTAMP: true\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZO0FBQ1osK0VBQStFO0FBRXhFLE1BQU02QyxjQUFjO0lBQ3pCLHVCQUF1QjtJQUN2QkMsV0FBVztJQUVYLHFCQUFxQjtJQUNyQkMsWUFBWTtJQUVaLG1EQUFtRDtJQUNuREMsWUFBWTtJQUVaLHdCQUF3QjtJQUN4QkMsY0FBYztJQUVkLDJCQUEyQjtJQUMzQkMsZ0JBQWdCO0FBQ2xCLEVBQVUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3BhcnRuZXItYXVkaXQudHM/ZGM4YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBhcnRuZXIgQXVkaXQgU2VydmljZVxuICogXG4gKiBDb21wcmVoZW5zaXZlIGF1ZGl0IGxvZ2dpbmcgZm9yIFBhcnRuZXItcmVsYXRlZCBhY3Rpb25zLlxuICogXG4gKiBLRVkgUFJJTkNJUExFUzpcbiAqIDEuIEF1ZGl0cyBhcmUgSU1NVVRBQkxFIC0gbm8gdXBkYXRlcyBvciBkZWxldGVzXG4gKiAyLiBGdWxsIGNvbnRleHQgY2FwdHVyZWQgYXQgdGltZSBvZiBhY3Rpb25cbiAqIDMuIFN1aXRhYmxlIGZvciBjb21wbGlhbmNlIHJlcG9ydGluZ1xuICogNC4gUmV0ZW50aW9uIHBvbGljeSBlbmZvcmNlbWVudFxuICogXG4gKiBUUkFDS0VEIEFDVElPTlM6XG4gKiAtIFBhcnRuZXIgY3JlYXRpb24vdXBkYXRlc1xuICogLSBBZ3JlZW1lbnQgY2hhbmdlc1xuICogLSBBdHRyaWJ1dGlvbiBldmVudHNcbiAqIC0gRWFybmluZ3MgZ2VuZXJhdGlvbi9zdGF0dXMgY2hhbmdlc1xuICogLSBQYXlvdXQgZXZlbnRzXG4gKi9cblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnXG5pbXBvcnQgeyBBdWRpdEFjdGlvbiwgQXVkaXRMb2cgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVFlQRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBBdWRpdCBlbnRyeSBpbnB1dFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0RW50cnlJbnB1dCB7XG4gIGFjdGlvbjogQXVkaXRBY3Rpb25cbiAgYWN0b3JJZDogc3RyaW5nXG4gIGFjdG9yRW1haWw6IHN0cmluZ1xuICB0ZW5hbnRJZD86IHN0cmluZ1xuICB0YXJnZXRUeXBlOiBzdHJpbmdcbiAgdGFyZ2V0SWQ6IHN0cmluZ1xuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgaXBBZGRyZXNzPzogc3RyaW5nXG4gIHVzZXJBZ2VudD86IHN0cmluZ1xufVxuXG4vKipcbiAqIEF1ZGl0IHF1ZXJ5IG9wdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBdWRpdFF1ZXJ5T3B0aW9ucyB7XG4gIGFjdGlvbnM/OiBBdWRpdEFjdGlvbltdXG4gIGFjdG9ySWQ/OiBzdHJpbmdcbiAgdGFyZ2V0VHlwZT86IHN0cmluZ1xuICB0YXJnZXRJZD86IHN0cmluZ1xuICB0ZW5hbnRJZD86IHN0cmluZ1xuICBzdGFydERhdGU/OiBEYXRlXG4gIGVuZERhdGU/OiBEYXRlXG4gIGxpbWl0PzogbnVtYmVyXG4gIG9mZnNldD86IG51bWJlclxufVxuXG4vKipcbiAqIEF1ZGl0IHJlcG9ydFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0UmVwb3J0IHtcbiAgcGVyaW9kOiB7IHN0YXJ0OiBEYXRlOyBlbmQ6IERhdGUgfVxuICB0b3RhbEVudHJpZXM6IG51bWJlclxuICBieUFjdGlvbjogUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuICBieVRhcmdldFR5cGU6IFJlY29yZDxzdHJpbmcsIG51bWJlcj5cbiAgZW50cmllczogQXVkaXRMb2dbXVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQQVJUTkVSLVNQRUNJRklDIEFVRElUIEFDVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IFBBUlRORVJfQVVESVRfQUNUSU9OUzogQXVkaXRBY3Rpb25bXSA9IFtcbiAgLy8gUGFydG5lciBsaWZlY3ljbGVcbiAgJ1BBUlRORVJfQ1JFQVRFRCcsXG4gICdQQVJUTkVSX1VQREFURUQnLFxuICAnUEFSVE5FUl9BUFBST1ZFRCcsXG4gICdQQVJUTkVSX1NVU1BFTkRFRCcsXG4gICdQQVJUTkVSX1RFUk1JTkFURUQnLFxuICAnUEFSVE5FUl9VU0VSX0FEREVEJyxcbiAgJ1BBUlRORVJfVVNFUl9SRU1PVkVEJyxcbiAgXG4gIC8vIEFncmVlbWVudHNcbiAgJ1BBUlRORVJfQUdSRUVNRU5UX0NSRUFURUQnLFxuICAnUEFSVE5FUl9BR1JFRU1FTlRfU0lHTkVEJyxcbiAgJ1BBUlRORVJfQUdSRUVNRU5UX0FQUFJPVkVEJyxcbiAgXG4gIC8vIEF0dHJpYnV0aW9uXG4gICdBVFRSSUJVVElPTl9DUkVBVEVEJyxcbiAgJ0FUVFJJQlVUSU9OX0xPQ0tFRCcsXG4gICdBVFRSSUJVVElPTl9MT0NLX0FUVEVNUFRFRCcsXG4gICdBVFRSSUJVVElPTl9SRUFTU0lHTl9CTE9DS0VEJyxcbiAgJ1BBUlRORVJfUkVGRVJSQUxfQ1JFQVRFRCcsXG4gICdQQVJUTkVSX1JFRkVSUkFMX0xPQ0tFRCcsXG4gIFxuICAvLyBQYXJ0bmVyIHRlbmFudCBjcmVhdGlvblxuICAnUEFSVE5FUl9URU5BTlRfQ1JFQVRFRCcsXG4gICdQQVJUTkVSX1RFTkFOVF9BQ1RJVkFURUQnLFxuICBcbiAgLy8gRWFybmluZ3NcbiAgJ0NPTU1JU1NJT05fQ0FMQ1VMQVRFRCcsXG4gICdFQVJOSU5HX0NSRUFURUQnLFxuICAnRUFSTklOR19DTEVBUkVEJyxcbiAgJ0VBUk5JTkdfQVBQUk9WRUQnLFxuICAnRUFSTklOR19QQUlEJyxcbiAgJ0VBUk5JTkdfRElTUFVURUQnLFxuICAnRUFSTklOR19SRVZFUlNFRCcsXG4gICdFQVJOSU5HX1ZPSURFRCcsXG4gICdQQVJUTkVSX0VBUk5JTkdfQ1JFQVRFRCcsXG4gICdQQVJUTkVSX0VBUk5JTkdfQVBQUk9WRUQnLFxuICAnUEFSVE5FUl9FQVJOSU5HX1BBSUQnLFxuICBcbiAgLy8gUGF5b3V0c1xuICAnUEFZT1VUX0JBVENIX0NSRUFURUQnLFxuICAnUEFZT1VUX0JBVENIX0FQUFJPVkVEJyxcbiAgJ1BBWU9VVF9CQVRDSF9QUk9DRVNTRUQnLFxuICAnUEFZT1VUX0JBVENIX0ZBSUxFRCcsXG4gICdQQVlPVVRfQkFUQ0hfQ0FOQ0VMTEVEJyxcbiAgJ1BBWU9VVF9SRUFESU5FU1NfQ0hFQ0tFRCcsXG4gICdQQVlPVVRfSE9MRF9BUFBMSUVEJyxcbiAgJ1BBWU9VVF9IT0xEX1JFTEVBU0VEJyxcbiAgJ1BBWU9VVF9TRVRUSU5HU19VUERBVEVEJyxcbiAgJ1RBWF9ET0NVTUVOVF9TVUJNSVRURUQnLFxuICAnVEFYX0RPQ1VNRU5UX1ZFUklGSUVEJ1xuXVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBVURJVCBFTlRSWSBDUkVBVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENyZWF0ZSBhbiBhdWRpdCBsb2cgZW50cnlcbiAqIFxuICogRW50cmllcyBhcmUgSU1NVVRBQkxFIG9uY2UgY3JlYXRlZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXVkaXRFbnRyeShpbnB1dDogQXVkaXRFbnRyeUlucHV0KTogUHJvbWlzZTxBdWRpdExvZz4ge1xuICByZXR1cm4gcHJpc21hLmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgYWN0aW9uOiBpbnB1dC5hY3Rpb24sXG4gICAgICBhY3RvcklkOiBpbnB1dC5hY3RvcklkLFxuICAgICAgYWN0b3JFbWFpbDogaW5wdXQuYWN0b3JFbWFpbCxcbiAgICAgIHRlbmFudElkOiBpbnB1dC50ZW5hbnRJZCxcbiAgICAgIHRhcmdldFR5cGU6IGlucHV0LnRhcmdldFR5cGUsXG4gICAgICB0YXJnZXRJZDogaW5wdXQudGFyZ2V0SWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICAuLi5pbnB1dC5tZXRhZGF0YSxcbiAgICAgICAgaXBBZGRyZXNzOiBpbnB1dC5pcEFkZHJlc3MsXG4gICAgICAgIHVzZXJBZ2VudDogaW5wdXQudXNlckFnZW50LFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgIH1cbiAgfSlcbn1cblxuLyoqXG4gKiBDcmVhdGUgYXVkaXQgZW50cnkgd2l0aCBmdWxsIGNvbnRleHRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1ZGl0UGFydG5lckFjdGlvbihcbiAgYWN0aW9uOiBBdWRpdEFjdGlvbixcbiAgcGFydG5lcklkOiBzdHJpbmcsXG4gIGFjdG9ySWQ6IHN0cmluZyxcbiAgYWN0b3JFbWFpbDogc3RyaW5nLFxuICBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBQcm9taXNlPEF1ZGl0TG9nPiB7XG4gIHJldHVybiBjcmVhdGVBdWRpdEVudHJ5KHtcbiAgICBhY3Rpb24sXG4gICAgYWN0b3JJZCxcbiAgICBhY3RvckVtYWlsLFxuICAgIHRhcmdldFR5cGU6ICdQYXJ0bmVyJyxcbiAgICB0YXJnZXRJZDogcGFydG5lcklkLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICAuLi5kZXRhaWxzXG4gICAgfVxuICB9KVxufVxuXG4vKipcbiAqIEF1ZGl0IGVhcm5pbmcgYWN0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpdEVhcm5pbmdBY3Rpb24oXG4gIGFjdGlvbjogQXVkaXRBY3Rpb24sXG4gIGVhcm5pbmdJZDogc3RyaW5nLFxuICBwYXJ0bmVySWQ6IHN0cmluZyxcbiAgYWN0b3JJZDogc3RyaW5nLFxuICBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBQcm9taXNlPEF1ZGl0TG9nPiB7XG4gIHJldHVybiBjcmVhdGVBdWRpdEVudHJ5KHtcbiAgICBhY3Rpb24sXG4gICAgYWN0b3JJZCxcbiAgICBhY3RvckVtYWlsOiAnc3lzdGVtJyxcbiAgICB0YXJnZXRUeXBlOiAnUGFydG5lckVhcm5pbmcnLFxuICAgIHRhcmdldElkOiBlYXJuaW5nSWQsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIGVhcm5pbmdJZCxcbiAgICAgIC4uLmRldGFpbHNcbiAgICB9XG4gIH0pXG59XG5cbi8qKlxuICogQXVkaXQgcGF5b3V0IGFjdGlvblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaXRQYXlvdXRBY3Rpb24oXG4gIGFjdGlvbjogQXVkaXRBY3Rpb24sXG4gIGJhdGNoSWQ6IHN0cmluZyxcbiAgcGFydG5lcklkOiBzdHJpbmcsXG4gIGFjdG9ySWQ6IHN0cmluZyxcbiAgZGV0YWlsczogUmVjb3JkPHN0cmluZywgYW55PlxuKTogUHJvbWlzZTxBdWRpdExvZz4ge1xuICByZXR1cm4gY3JlYXRlQXVkaXRFbnRyeSh7XG4gICAgYWN0aW9uLFxuICAgIGFjdG9ySWQsXG4gICAgYWN0b3JFbWFpbDogJ2FkbWluJyxcbiAgICB0YXJnZXRUeXBlOiAnUGF5b3V0QmF0Y2gnLFxuICAgIHRhcmdldElkOiBiYXRjaElkLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICBiYXRjaElkLFxuICAgICAgLi4uZGV0YWlsc1xuICAgIH1cbiAgfSlcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQVVESVQgUVVFUklFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFF1ZXJ5IGF1ZGl0IGxvZ3NcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5QXVkaXRMb2dzKFxuICBvcHRpb25zOiBBdWRpdFF1ZXJ5T3B0aW9uc1xuKTogUHJvbWlzZTx7IGVudHJpZXM6IEF1ZGl0TG9nW107IHRvdGFsOiBudW1iZXIgfT4ge1xuICBjb25zdCB3aGVyZTogYW55ID0ge31cbiAgXG4gIGlmIChvcHRpb25zLmFjdGlvbnMgJiYgb3B0aW9ucy5hY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICB3aGVyZS5hY3Rpb24gPSB7IGluOiBvcHRpb25zLmFjdGlvbnMgfVxuICB9XG4gIFxuICBpZiAob3B0aW9ucy5hY3RvcklkKSB7XG4gICAgd2hlcmUuYWN0b3JJZCA9IG9wdGlvbnMuYWN0b3JJZFxuICB9XG4gIFxuICBpZiAob3B0aW9ucy50YXJnZXRUeXBlKSB7XG4gICAgd2hlcmUudGFyZ2V0VHlwZSA9IG9wdGlvbnMudGFyZ2V0VHlwZVxuICB9XG4gIFxuICBpZiAob3B0aW9ucy50YXJnZXRJZCkge1xuICAgIHdoZXJlLnRhcmdldElkID0gb3B0aW9ucy50YXJnZXRJZFxuICB9XG4gIFxuICBpZiAob3B0aW9ucy50ZW5hbnRJZCkge1xuICAgIHdoZXJlLnRlbmFudElkID0gb3B0aW9ucy50ZW5hbnRJZFxuICB9XG4gIFxuICBpZiAob3B0aW9ucy5zdGFydERhdGUgfHwgb3B0aW9ucy5lbmREYXRlKSB7XG4gICAgd2hlcmUuY3JlYXRlZEF0ID0ge31cbiAgICBpZiAob3B0aW9ucy5zdGFydERhdGUpIHdoZXJlLmNyZWF0ZWRBdC5ndGUgPSBvcHRpb25zLnN0YXJ0RGF0ZVxuICAgIGlmIChvcHRpb25zLmVuZERhdGUpIHdoZXJlLmNyZWF0ZWRBdC5sdGUgPSBvcHRpb25zLmVuZERhdGVcbiAgfVxuICBcbiAgY29uc3QgW2VudHJpZXMsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBwcmlzbWEuYXVkaXRMb2cuZmluZE1hbnkoe1xuICAgICAgd2hlcmUsXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiBvcHRpb25zLmxpbWl0IHx8IDEwMCxcbiAgICAgIHNraXA6IG9wdGlvbnMub2Zmc2V0IHx8IDBcbiAgICB9KSxcbiAgICBwcmlzbWEuYXVkaXRMb2cuY291bnQoeyB3aGVyZSB9KVxuICBdKVxuICBcbiAgcmV0dXJuIHsgZW50cmllcywgdG90YWwgfVxufVxuXG4vKipcbiAqIEdldCBhdWRpdCBsb2dzIGZvciBhIHNwZWNpZmljIHBhcnRuZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBhcnRuZXJBdWRpdExvZ3MoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIHN0YXJ0RGF0ZT86IERhdGVcbiAgICBlbmREYXRlPzogRGF0ZVxuICAgIGxpbWl0PzogbnVtYmVyXG4gICAgb2Zmc2V0PzogbnVtYmVyXG4gIH1cbik6IFByb21pc2U8eyBlbnRyaWVzOiBBdWRpdExvZ1tdOyB0b3RhbDogbnVtYmVyIH0+IHtcbiAgcmV0dXJuIHF1ZXJ5QXVkaXRMb2dzKHtcbiAgICBhY3Rpb25zOiBQQVJUTkVSX0FVRElUX0FDVElPTlMsXG4gICAgdGFyZ2V0SWQ6IHBhcnRuZXJJZCxcbiAgICAuLi5vcHRpb25zXG4gIH0pXG59XG5cbi8qKlxuICogR2V0IGF1ZGl0IGxvZ3MgZm9yIGEgc3BlY2lmaWMgZWFybmluZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RWFybmluZ0F1ZGl0TG9ncyhlYXJuaW5nSWQ6IHN0cmluZyk6IFByb21pc2U8QXVkaXRMb2dbXT4ge1xuICBjb25zdCB7IGVudHJpZXMgfSA9IGF3YWl0IHF1ZXJ5QXVkaXRMb2dzKHtcbiAgICB0YXJnZXRUeXBlOiAnUGFydG5lckVhcm5pbmcnLFxuICAgIHRhcmdldElkOiBlYXJuaW5nSWRcbiAgfSlcbiAgcmV0dXJuIGVudHJpZXNcbn1cblxuLyoqXG4gKiBHZXQgYXVkaXQgbG9ncyBmb3IgYSBwYXlvdXQgYmF0Y2hcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBheW91dEF1ZGl0TG9ncyhiYXRjaElkOiBzdHJpbmcpOiBQcm9taXNlPEF1ZGl0TG9nW10+IHtcbiAgY29uc3QgeyBlbnRyaWVzIH0gPSBhd2FpdCBxdWVyeUF1ZGl0TG9ncyh7XG4gICAgdGFyZ2V0VHlwZTogJ1BheW91dEJhdGNoJyxcbiAgICB0YXJnZXRJZDogYmF0Y2hJZFxuICB9KVxuICByZXR1cm4gZW50cmllc1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT01QTElBTkNFIFJFUE9SVFNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZW5lcmF0ZSBhdWRpdCByZXBvcnQgZm9yIGNvbXBsaWFuY2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQXVkaXRSZXBvcnQoXG4gIHBlcmlvZFN0YXJ0OiBEYXRlLFxuICBwZXJpb2RFbmQ6IERhdGUsXG4gIG9wdGlvbnM/OiB7XG4gICAgcGFydG5lcklkPzogc3RyaW5nXG4gICAgYWN0aW9ucz86IEF1ZGl0QWN0aW9uW11cbiAgfVxuKTogUHJvbWlzZTxBdWRpdFJlcG9ydD4ge1xuICBjb25zdCB3aGVyZTogYW55ID0ge1xuICAgIGNyZWF0ZWRBdDogeyBndGU6IHBlcmlvZFN0YXJ0LCBsdGU6IHBlcmlvZEVuZCB9XG4gIH1cbiAgXG4gIGlmIChvcHRpb25zPy5wYXJ0bmVySWQpIHtcbiAgICB3aGVyZS50YXJnZXRJZCA9IG9wdGlvbnMucGFydG5lcklkXG4gIH1cbiAgXG4gIGlmIChvcHRpb25zPy5hY3Rpb25zICYmIG9wdGlvbnMuYWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgd2hlcmUuYWN0aW9uID0geyBpbjogb3B0aW9ucy5hY3Rpb25zIH1cbiAgfSBlbHNlIHtcbiAgICB3aGVyZS5hY3Rpb24gPSB7IGluOiBQQVJUTkVSX0FVRElUX0FDVElPTlMgfVxuICB9XG4gIFxuICAvLyBHZXQgYWxsIGVudHJpZXNcbiAgY29uc3QgZW50cmllcyA9IGF3YWl0IHByaXNtYS5hdWRpdExvZy5maW5kTWFueSh7XG4gICAgd2hlcmUsXG4gICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XG4gIH0pXG4gIFxuICAvLyBBZ2dyZWdhdGUgYnkgYWN0aW9uXG4gIGNvbnN0IGJ5QWN0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge31cbiAgY29uc3QgYnlUYXJnZXRUeXBlOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge31cbiAgXG4gIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgIGJ5QWN0aW9uW2VudHJ5LmFjdGlvbl0gPSAoYnlBY3Rpb25bZW50cnkuYWN0aW9uXSB8fCAwKSArIDFcbiAgICBpZiAoZW50cnkudGFyZ2V0VHlwZSkge1xuICAgICAgYnlUYXJnZXRUeXBlW2VudHJ5LnRhcmdldFR5cGVdID0gKGJ5VGFyZ2V0VHlwZVtlbnRyeS50YXJnZXRUeXBlXSB8fCAwKSArIDFcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgcGVyaW9kOiB7IHN0YXJ0OiBwZXJpb2RTdGFydCwgZW5kOiBwZXJpb2RFbmQgfSxcbiAgICB0b3RhbEVudHJpZXM6IGVudHJpZXMubGVuZ3RoLFxuICAgIGJ5QWN0aW9uLFxuICAgIGJ5VGFyZ2V0VHlwZSxcbiAgICBlbnRyaWVzXG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBwYXJ0bmVyIGFjdGl2aXR5IHJlcG9ydFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVQYXJ0bmVyQWN0aXZpdHlSZXBvcnQoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBwZXJpb2RTdGFydDogRGF0ZSxcbiAgcGVyaW9kRW5kOiBEYXRlXG4pOiBQcm9taXNlPHtcbiAgcGFydG5lcjogeyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmcgfSB8IG51bGxcbiAgcGVyaW9kOiB7IHN0YXJ0OiBEYXRlOyBlbmQ6IERhdGUgfVxuICBzdW1tYXJ5OiB7XG4gICAgdG90YWxBY3Rpb25zOiBudW1iZXJcbiAgICBlYXJuaW5nc0NyZWF0ZWQ6IG51bWJlclxuICAgIGVhcm5pbmdzUGFpZDogbnVtYmVyXG4gICAgcGF5b3V0QmF0Y2hlczogbnVtYmVyXG4gICAgcmVmZXJyYWxzQWRkZWQ6IG51bWJlclxuICB9XG4gIHRpbWVsaW5lOiBBdWRpdExvZ1tdXG59PiB7XG4gIGNvbnN0IHBhcnRuZXIgPSBhd2FpdCBwcmlzbWEucGFydG5lci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogcGFydG5lcklkIH0sXG4gICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGNvbnN0IHsgZW50cmllcyB9ID0gYXdhaXQgcXVlcnlBdWRpdExvZ3Moe1xuICAgIGFjdGlvbnM6IFBBUlRORVJfQVVESVRfQUNUSU9OUyxcbiAgICBzdGFydERhdGU6IHBlcmlvZFN0YXJ0LFxuICAgIGVuZERhdGU6IHBlcmlvZEVuZFxuICB9KVxuICBcbiAgLy8gRmlsdGVyIGVudHJpZXMgcmVsYXRlZCB0byB0aGlzIHBhcnRuZXJcbiAgY29uc3QgcGFydG5lckVudHJpZXMgPSBlbnRyaWVzLmZpbHRlcihlID0+IHtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGUubWV0YWRhdGEgYXMgUmVjb3JkPHN0cmluZywgYW55PlxuICAgIHJldHVybiBlLnRhcmdldElkID09PSBwYXJ0bmVySWQgfHwgbWV0YWRhdGE/LnBhcnRuZXJJZCA9PT0gcGFydG5lcklkXG4gIH0pXG4gIFxuICAvLyBDYWxjdWxhdGUgc3VtbWFyeVxuICBjb25zdCBzdW1tYXJ5ID0ge1xuICAgIHRvdGFsQWN0aW9uczogcGFydG5lckVudHJpZXMubGVuZ3RoLFxuICAgIGVhcm5pbmdzQ3JlYXRlZDogcGFydG5lckVudHJpZXMuZmlsdGVyKGUgPT4gZS5hY3Rpb24gPT09ICdFQVJOSU5HX0NSRUFURUQnKS5sZW5ndGgsXG4gICAgZWFybmluZ3NQYWlkOiBwYXJ0bmVyRW50cmllcy5maWx0ZXIoZSA9PiBlLmFjdGlvbiA9PT0gJ0VBUk5JTkdfUEFJRCcpLmxlbmd0aCxcbiAgICBwYXlvdXRCYXRjaGVzOiBwYXJ0bmVyRW50cmllcy5maWx0ZXIoZSA9PiBlLmFjdGlvbiA9PT0gJ1BBWU9VVF9CQVRDSF9DUkVBVEVEJykubGVuZ3RoLFxuICAgIHJlZmVycmFsc0FkZGVkOiBwYXJ0bmVyRW50cmllcy5maWx0ZXIoZSA9PiBcbiAgICAgIGUuYWN0aW9uID09PSAnQVRUUklCVVRJT05fQ1JFQVRFRCcgfHwgZS5hY3Rpb24gPT09ICdQQVJUTkVSX1JFRkVSUkFMX0NSRUFURUQnXG4gICAgKS5sZW5ndGhcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBwYXJ0bmVyLFxuICAgIHBlcmlvZDogeyBzdGFydDogcGVyaW9kU3RhcnQsIGVuZDogcGVyaW9kRW5kIH0sXG4gICAgc3VtbWFyeSxcbiAgICB0aW1lbGluZTogcGFydG5lckVudHJpZXNcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSRVRFTlRJT04gUE9MSUNZXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogUmV0ZW50aW9uIHBvbGljeSBjb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBSRVRFTlRJT05fUE9MSUNZID0ge1xuICAvLyBQYXJ0bmVyIGF1ZGl0IGxvZ3MgLSBrZWVwIGZvciA3IHllYXJzIChjb21wbGlhbmNlIHJlcXVpcmVtZW50KVxuICBQQVJUTkVSX0xPR1NfWUVBUlM6IDcsXG4gIFxuICAvLyBFYXJuaW5ncyBhdWRpdCBsb2dzIC0ga2VlcCBmb3IgNyB5ZWFycyAodGF4L2ZpbmFuY2lhbCBjb21wbGlhbmNlKVxuICBFQVJOSU5HU19MT0dTX1lFQVJTOiA3LFxuICBcbiAgLy8gUGF5b3V0IGF1ZGl0IGxvZ3MgLSBrZWVwIGZvciA3IHllYXJzIChmaW5hbmNpYWwgY29tcGxpYW5jZSlcbiAgUEFZT1VUX0xPR1NfWUVBUlM6IDcsXG4gIFxuICAvLyBHZW5lcmFsIGF1ZGl0IGxvZ3MgLSBrZWVwIGZvciAzIHllYXJzXG4gIEdFTkVSQUxfTE9HU19ZRUFSUzogMyxcbiAgXG4gIC8vIEFjdGlvbnMgdGhhdCByZXF1aXJlIGV4dGVuZGVkIHJldGVudGlvblxuICBFWFRFTkRFRF9SRVRFTlRJT05fQUNUSU9OUzogW1xuICAgICdFQVJOSU5HX0NSRUFURUQnLFxuICAgICdFQVJOSU5HX1BBSUQnLFxuICAgICdFQVJOSU5HX1JFVkVSU0VEJyxcbiAgICAnUEFZT1VUX0JBVENIX0NSRUFURUQnLFxuICAgICdQQVlPVVRfQkFUQ0hfUFJPQ0VTU0VEJyxcbiAgICAnUEFSVE5FUl9BR1JFRU1FTlRfU0lHTkVEJyxcbiAgICAnVEFYX0RPQ1VNRU5UX1ZFUklGSUVEJ1xuICBdIGFzIEF1ZGl0QWN0aW9uW11cbn0gYXMgY29uc3RcblxuLyoqXG4gKiBDaGVjayBpZiBhbiBhdWRpdCBlbnRyeSBpcyB3aXRoaW4gcmV0ZW50aW9uIHBlcmlvZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNXaXRoaW5SZXRlbnRpb24oZW50cnk6IEF1ZGl0TG9nKTogYm9vbGVhbiB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgY29uc3QgZW50cnlBZ2UgPSAobm93LmdldFRpbWUoKSAtIGVudHJ5LmNyZWF0ZWRBdC5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQgKiAzNjUpXG4gIFxuICAvLyBFeHRlbmRlZCByZXRlbnRpb24gZm9yIGZpbmFuY2lhbCBhY3Rpb25zXG4gIGlmIChSRVRFTlRJT05fUE9MSUNZLkVYVEVOREVEX1JFVEVOVElPTl9BQ1RJT05TLmluY2x1ZGVzKGVudHJ5LmFjdGlvbikpIHtcbiAgICByZXR1cm4gZW50cnlBZ2UgPCBSRVRFTlRJT05fUE9MSUNZLkVBUk5JTkdTX0xPR1NfWUVBUlNcbiAgfVxuICBcbiAgLy8gUGFydG5lciBhY3Rpb25zXG4gIGlmIChQQVJUTkVSX0FVRElUX0FDVElPTlMuaW5jbHVkZXMoZW50cnkuYWN0aW9uKSkge1xuICAgIHJldHVybiBlbnRyeUFnZSA8IFJFVEVOVElPTl9QT0xJQ1kuUEFSVE5FUl9MT0dTX1lFQVJTXG4gIH1cbiAgXG4gIC8vIEdlbmVyYWwgbG9nc1xuICByZXR1cm4gZW50cnlBZ2UgPCBSRVRFTlRJT05fUE9MSUNZLkdFTkVSQUxfTE9HU19ZRUFSU1xufVxuXG4vKipcbiAqIEdldCBlbnRyaWVzIGR1ZSBmb3IgYXJjaGl2YWwgKG91dHNpZGUgcmV0ZW50aW9uIGJ1dCBub3QgZGVsZXRlZClcbiAqIFxuICogTk9URTogQWN0dWFsIGFyY2hpdmFsL2RlbGV0aW9uIHNob3VsZCBiZSBkb25lIHZpYSBhIHNjaGVkdWxlZCBqb2JcbiAqIGFuZCBtYXkgcmVxdWlyZSBsZWdhbC9jb21wbGlhbmNlIGFwcHJvdmFsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbnRyaWVzRHVlRm9yQXJjaGl2YWwoKTogUHJvbWlzZTx7XG4gIGNvdW50OiBudW1iZXJcbiAgb2xkZXN0RW50cnk6IERhdGUgfCBudWxsXG4gIGJ5QWN0aW9uOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+XG59PiB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgY29uc3QgZ2VuZXJhbEN1dG9mZiA9IG5ldyBEYXRlKG5vdylcbiAgZ2VuZXJhbEN1dG9mZi5zZXRGdWxsWWVhcihnZW5lcmFsQ3V0b2ZmLmdldEZ1bGxZZWFyKCkgLSBSRVRFTlRJT05fUE9MSUNZLkdFTkVSQUxfTE9HU19ZRUFSUylcbiAgXG4gIGNvbnN0IGV4dGVuZGVkQ3V0b2ZmID0gbmV3IERhdGUobm93KVxuICBleHRlbmRlZEN1dG9mZi5zZXRGdWxsWWVhcihleHRlbmRlZEN1dG9mZi5nZXRGdWxsWWVhcigpIC0gUkVURU5USU9OX1BPTElDWS5FQVJOSU5HU19MT0dTX1lFQVJTKVxuICBcbiAgLy8gR2V0IGVudHJpZXMgb3V0c2lkZSBnZW5lcmFsIHJldGVudGlvbiB0aGF0IGFyZSBOT1QgaW4gZXh0ZW5kZWQgcmV0ZW50aW9uIGNhdGVnb3J5XG4gIGNvbnN0IGdlbmVyYWxFeHBpcmVkID0gYXdhaXQgcHJpc21hLmF1ZGl0TG9nLmZpbmRNYW55KHtcbiAgICB3aGVyZToge1xuICAgICAgY3JlYXRlZEF0OiB7IGx0OiBnZW5lcmFsQ3V0b2ZmIH0sXG4gICAgICBhY3Rpb246IHsgbm90SW46IFJFVEVOVElPTl9QT0xJQ1kuRVhURU5ERURfUkVURU5USU9OX0FDVElPTlMgfVxuICAgIH1cbiAgfSlcbiAgXG4gIC8vIEdldCBlbnRyaWVzIG91dHNpZGUgZXh0ZW5kZWQgcmV0ZW50aW9uXG4gIGNvbnN0IGV4dGVuZGVkRXhwaXJlZCA9IGF3YWl0IHByaXNtYS5hdWRpdExvZy5maW5kTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIGNyZWF0ZWRBdDogeyBsdDogZXh0ZW5kZWRDdXRvZmYgfSxcbiAgICAgIGFjdGlvbjogeyBpbjogUkVURU5USU9OX1BPTElDWS5FWFRFTkRFRF9SRVRFTlRJT05fQUNUSU9OUyB9XG4gICAgfVxuICB9KVxuICBcbiAgY29uc3QgYWxsRXhwaXJlZCA9IFsuLi5nZW5lcmFsRXhwaXJlZCwgLi4uZXh0ZW5kZWRFeHBpcmVkXVxuICBcbiAgY29uc3QgYnlBY3Rpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fVxuICBsZXQgb2xkZXN0RW50cnk6IERhdGUgfCBudWxsID0gbnVsbFxuICBcbiAgZm9yIChjb25zdCBlbnRyeSBvZiBhbGxFeHBpcmVkKSB7XG4gICAgYnlBY3Rpb25bZW50cnkuYWN0aW9uXSA9IChieUFjdGlvbltlbnRyeS5hY3Rpb25dIHx8IDApICsgMVxuICAgIGlmICghb2xkZXN0RW50cnkgfHwgZW50cnkuY3JlYXRlZEF0IDwgb2xkZXN0RW50cnkpIHtcbiAgICAgIG9sZGVzdEVudHJ5ID0gZW50cnkuY3JlYXRlZEF0XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGNvdW50OiBhbGxFeHBpcmVkLmxlbmd0aCxcbiAgICBvbGRlc3RFbnRyeSxcbiAgICBieUFjdGlvblxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUQU5UU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgQVVESVRfUlVMRVMgPSB7XG4gIC8vIEF1ZGl0cyBhcmUgaW1tdXRhYmxlXG4gIElNTVVUQUJMRTogdHJ1ZSxcbiAgXG4gIC8vIE5vIHVwZGF0ZXMgYWxsb3dlZFxuICBOT19VUERBVEVTOiB0cnVlLFxuICBcbiAgLy8gTm8gZGVsZXRlcyBhbGxvd2VkIChleGNlcHQgdmlhIHJldGVudGlvbiBwb2xpY3kpXG4gIE5PX0RFTEVURVM6IHRydWUsXG4gIFxuICAvLyBGdWxsIGNvbnRleHQgcmVxdWlyZWRcbiAgRlVMTF9DT05URVhUOiB0cnVlLFxuICBcbiAgLy8gVGltZXN0YW1wIGF1dG8tZ2VuZXJhdGVkXG4gIEFVVE9fVElNRVNUQU1QOiB0cnVlXG59IGFzIGNvbnN0XG4iXSwibmFtZXMiOlsicHJpc21hIiwiUEFSVE5FUl9BVURJVF9BQ1RJT05TIiwiY3JlYXRlQXVkaXRFbnRyeSIsImlucHV0IiwiYXVkaXRMb2ciLCJjcmVhdGUiLCJkYXRhIiwiYWN0aW9uIiwiYWN0b3JJZCIsImFjdG9yRW1haWwiLCJ0ZW5hbnRJZCIsInRhcmdldFR5cGUiLCJ0YXJnZXRJZCIsIm1ldGFkYXRhIiwiaXBBZGRyZXNzIiwidXNlckFnZW50IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiYXVkaXRQYXJ0bmVyQWN0aW9uIiwicGFydG5lcklkIiwiZGV0YWlscyIsImF1ZGl0RWFybmluZ0FjdGlvbiIsImVhcm5pbmdJZCIsImF1ZGl0UGF5b3V0QWN0aW9uIiwiYmF0Y2hJZCIsInF1ZXJ5QXVkaXRMb2dzIiwib3B0aW9ucyIsIndoZXJlIiwiYWN0aW9ucyIsImxlbmd0aCIsImluIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImNyZWF0ZWRBdCIsImd0ZSIsImx0ZSIsImVudHJpZXMiLCJ0b3RhbCIsIlByb21pc2UiLCJhbGwiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJ0YWtlIiwibGltaXQiLCJza2lwIiwib2Zmc2V0IiwiY291bnQiLCJnZXRQYXJ0bmVyQXVkaXRMb2dzIiwiZ2V0RWFybmluZ0F1ZGl0TG9ncyIsImdldFBheW91dEF1ZGl0TG9ncyIsImdlbmVyYXRlQXVkaXRSZXBvcnQiLCJwZXJpb2RTdGFydCIsInBlcmlvZEVuZCIsImJ5QWN0aW9uIiwiYnlUYXJnZXRUeXBlIiwiZW50cnkiLCJwZXJpb2QiLCJzdGFydCIsImVuZCIsInRvdGFsRW50cmllcyIsImdlbmVyYXRlUGFydG5lckFjdGl2aXR5UmVwb3J0IiwicGFydG5lciIsImZpbmRVbmlxdWUiLCJpZCIsInNlbGVjdCIsIm5hbWUiLCJwYXJ0bmVyRW50cmllcyIsImZpbHRlciIsImUiLCJzdW1tYXJ5IiwidG90YWxBY3Rpb25zIiwiZWFybmluZ3NDcmVhdGVkIiwiZWFybmluZ3NQYWlkIiwicGF5b3V0QmF0Y2hlcyIsInJlZmVycmFsc0FkZGVkIiwidGltZWxpbmUiLCJSRVRFTlRJT05fUE9MSUNZIiwiUEFSVE5FUl9MT0dTX1lFQVJTIiwiRUFSTklOR1NfTE9HU19ZRUFSUyIsIlBBWU9VVF9MT0dTX1lFQVJTIiwiR0VORVJBTF9MT0dTX1lFQVJTIiwiRVhURU5ERURfUkVURU5USU9OX0FDVElPTlMiLCJpc1dpdGhpblJldGVudGlvbiIsIm5vdyIsImVudHJ5QWdlIiwiZ2V0VGltZSIsImluY2x1ZGVzIiwiZ2V0RW50cmllc0R1ZUZvckFyY2hpdmFsIiwiZ2VuZXJhbEN1dG9mZiIsInNldEZ1bGxZZWFyIiwiZ2V0RnVsbFllYXIiLCJleHRlbmRlZEN1dG9mZiIsImdlbmVyYWxFeHBpcmVkIiwibHQiLCJub3RJbiIsImV4dGVuZGVkRXhwaXJlZCIsImFsbEV4cGlyZWQiLCJvbGRlc3RFbnRyeSIsIkFVRElUX1JVTEVTIiwiSU1NVVRBQkxFIiwiTk9fVVBEQVRFUyIsIk5PX0RFTEVURVMiLCJGVUxMX0NPTlRFWFQiLCJBVVRPX1RJTUVTVEFNUCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/partner-audit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/partner-authorization.ts":
/*!******************************************!*\
  !*** ./src/lib/partner-authorization.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertPartnerPermission: () => (/* binding */ assertPartnerPermission),\n/* harmony export */   canAccessReferral: () => (/* binding */ canAccessReferral),\n/* harmony export */   canPartnerAccessTenantInternals: () => (/* binding */ canPartnerAccessTenantInternals),\n/* harmony export */   getPartnerAccessLevel: () => (/* binding */ getPartnerAccessLevel),\n/* harmony export */   getPartnerMembership: () => (/* binding */ getPartnerMembership),\n/* harmony export */   getPartnerPermissions: () => (/* binding */ getPartnerPermissions),\n/* harmony export */   getPartnerVisibleTenantData: () => (/* binding */ getPartnerVisibleTenantData),\n/* harmony export */   hasPartnerPermission: () => (/* binding */ hasPartnerPermission),\n/* harmony export */   isPartnerUser: () => (/* binding */ isPartnerUser),\n/* harmony export */   requirePartnerAccess: () => (/* binding */ requirePartnerAccess),\n/* harmony export */   requirePartnerAccessBySlug: () => (/* binding */ requirePartnerAccessBySlug),\n/* harmony export */   requirePartnerOwner: () => (/* binding */ requirePartnerOwner),\n/* harmony export */   requirePartnerOwnerAccess: () => (/* binding */ requirePartnerOwnerAccess),\n/* harmony export */   requirePartnerUser: () => (/* binding */ requirePartnerUser)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/auth.ts\");\n/**\n * Partner Authorization\n * \n * Access control for Partner domain - completely separate from Tenant authorization.\n * Partner users CANNOT access tenant internals.\n * Partner users can ONLY see their own partner's data.\n * \n * Role Hierarchy:\n * - SUPER_ADMIN: Platform-wide access to all partners\n * - PARTNER_OWNER: Full control within their partner organization\n * - PARTNER_STAFF: Limited access within their partner organization\n */ \n\n// ============================================================================\n// ROLE DEFINITIONS\n// ============================================================================\n/**\n * PARTNER_OWNER Permissions\n * - Full control over partner organization\n * - Can manage users, sign agreements, view all data\n * - CANNOT access tenant internals\n */ const PARTNER_OWNER_PERMISSIONS = {\n    // Partner Management\n    canViewPartner: true,\n    canEditPartner: true,\n    canManagePartnerUsers: true,\n    canSignAgreement: true,\n    // Referral Management\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: true,\n    // Earnings\n    canViewEarnings: true,\n    canViewAllEarnings: true,\n    canExportEarnings: true,\n    // Agreement\n    canViewAgreement: true,\n    canViewAgreementHistory: true\n};\n/**\n * PARTNER_STAFF Permissions\n * - Limited access within partner organization\n * - Can view referrals and earnings, create codes\n * - CANNOT manage users or sign agreements\n * - CANNOT access tenant internals\n */ const PARTNER_STAFF_PERMISSIONS = {\n    // Partner Management\n    canViewPartner: true,\n    canEditPartner: false,\n    canManagePartnerUsers: false,\n    canSignAgreement: false,\n    // Referral Management\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: false,\n    // Earnings\n    canViewEarnings: true,\n    canViewAllEarnings: false,\n    canExportEarnings: false,\n    // Agreement\n    canViewAgreement: true,\n    canViewAgreementHistory: false\n};\n/**\n * SUPER_ADMIN Permissions (platform-wide)\n * - Can access all partners\n * - Full permissions on any partner\n */ const SUPER_ADMIN_PERMISSIONS = {\n    canViewPartner: true,\n    canEditPartner: true,\n    canManagePartnerUsers: true,\n    canSignAgreement: false,\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: true,\n    canViewEarnings: true,\n    canViewAllEarnings: true,\n    canExportEarnings: true,\n    canViewAgreement: true,\n    canViewAgreementHistory: true\n};\n/**\n * Get permissions for a role\n */ function getPartnerPermissions(role) {\n    switch(role){\n        case \"SUPER_ADMIN\":\n            return SUPER_ADMIN_PERMISSIONS;\n        case \"PARTNER_OWNER\":\n            return PARTNER_OWNER_PERMISSIONS;\n        case \"PARTNER_STAFF\":\n            return PARTNER_STAFF_PERMISSIONS;\n        default:\n            // No permissions for unknown roles\n            return {\n                canViewPartner: false,\n                canEditPartner: false,\n                canManagePartnerUsers: false,\n                canSignAgreement: false,\n                canViewReferrals: false,\n                canCreateReferralCodes: false,\n                canViewAllReferrals: false,\n                canViewEarnings: false,\n                canViewAllEarnings: false,\n                canExportEarnings: false,\n                canViewAgreement: false,\n                canViewAgreementHistory: false\n            };\n    }\n}\n// ============================================================================\n// ACCESS BOUNDARY ENFORCEMENT\n// ============================================================================\n/**\n * Get user's partner membership (if any)\n */ async function getPartnerMembership(userId) {\n    return _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        },\n        include: {\n            partner: true\n        }\n    });\n}\n/**\n * Check if user is a partner user\n */ async function isPartnerUser(userId) {\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        }\n    });\n    return !!membership;\n}\n/**\n * Get user's access level for a specific partner\n */ async function getPartnerAccessLevel(userId, partnerId, globalRole) {\n    // Super Admin has full access\n    if (globalRole === \"SUPER_ADMIN\") {\n        return \"SUPER_ADMIN\";\n    }\n    // Check partner membership\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        },\n        select: {\n            partnerId: true,\n            role: true,\n            isActive: true\n        }\n    });\n    // Not a partner user or not active\n    if (!membership || !membership.isActive) {\n        return \"NONE\";\n    }\n    // Not a member of this specific partner\n    if (membership.partnerId !== partnerId) {\n        return \"NONE\";\n    }\n    // Return role-based access level\n    return membership.role === \"PARTNER_OWNER\" ? \"OWNER\" : \"STAFF\";\n}\n// ============================================================================\n// AUTHORIZATION FUNCTIONS\n// ============================================================================\n/**\n * Require any authenticated user who is a partner user\n */ async function requirePartnerUser() {\n    const session = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getCurrentSession)();\n    if (!session) {\n        return {\n            authorized: false,\n            error: \"Authentication required\",\n            status: 401\n        };\n    }\n    if (!session.user.isActive) {\n        return {\n            authorized: false,\n            error: \"Account is disabled\",\n            status: 403\n        };\n    }\n    // Get partner membership\n    const partnerUser = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId: session.user.id\n        },\n        include: {\n            partner: true\n        }\n    });\n    if (!partnerUser) {\n        return {\n            authorized: false,\n            error: \"Not a partner user\",\n            status: 403\n        };\n    }\n    if (!partnerUser.isActive) {\n        return {\n            authorized: false,\n            error: \"Partner membership is disabled\",\n            status: 403\n        };\n    }\n    if (partnerUser.partner.status !== \"ACTIVE\") {\n        return {\n            authorized: false,\n            error: \"Partner organization is not active\",\n            status: 403\n        };\n    }\n    return {\n        authorized: true,\n        user: session.user,\n        session,\n        partner: partnerUser.partner,\n        partnerUser,\n        role: partnerUser.role\n    };\n}\n/**\n * Require PARTNER_OWNER role\n */ async function requirePartnerOwner() {\n    const authResult = await requirePartnerUser();\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    if (authResult.role !== \"PARTNER_OWNER\") {\n        return {\n            authorized: false,\n            error: \"Partner Owner access required\",\n            status: 403\n        };\n    }\n    return authResult;\n}\n/**\n * Require access to a specific partner by ID\n */ async function requirePartnerAccess(partnerId) {\n    const session = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getCurrentSession)();\n    if (!session) {\n        return {\n            authorized: false,\n            error: \"Authentication required\",\n            status: 401\n        };\n    }\n    if (!session.user.isActive) {\n        return {\n            authorized: false,\n            error: \"Account is disabled\",\n            status: 403\n        };\n    }\n    // Super Admin can access any partner\n    if (session.user.globalRole === \"SUPER_ADMIN\") {\n        const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n            where: {\n                id: partnerId\n            }\n        });\n        if (!partner) {\n            return {\n                authorized: false,\n                error: \"Partner not found\",\n                status: 404\n            };\n        }\n        return {\n            authorized: true,\n            user: session.user,\n            session,\n            partner,\n            partnerUser: null,\n            role: \"PARTNER_OWNER\" // Treat as owner for permissions\n        };\n    }\n    // Regular user must be a partner user of this specific partner\n    const partnerUser = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId: session.user.id\n        },\n        include: {\n            partner: true\n        }\n    });\n    if (!partnerUser) {\n        return {\n            authorized: false,\n            error: \"Not a partner user\",\n            status: 403\n        };\n    }\n    // Must be a member of THIS partner\n    if (partnerUser.partnerId !== partnerId) {\n        return {\n            authorized: false,\n            error: \"Access denied to this partner\",\n            status: 403\n        };\n    }\n    if (!partnerUser.isActive) {\n        return {\n            authorized: false,\n            error: \"Partner membership is disabled\",\n            status: 403\n        };\n    }\n    if (partnerUser.partner.status !== \"ACTIVE\") {\n        return {\n            authorized: false,\n            error: \"Partner organization is not active\",\n            status: 403\n        };\n    }\n    return {\n        authorized: true,\n        user: session.user,\n        session,\n        partner: partnerUser.partner,\n        partnerUser,\n        role: partnerUser.role\n    };\n}\n/**\n * Require PARTNER_OWNER access to a specific partner\n */ async function requirePartnerOwnerAccess(partnerId) {\n    const authResult = await requirePartnerAccess(partnerId);\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    // Super Admin is treated as owner\n    if (authResult.session.user.globalRole === \"SUPER_ADMIN\") {\n        return authResult;\n    }\n    if (authResult.role !== \"PARTNER_OWNER\") {\n        return {\n            authorized: false,\n            error: \"Partner Owner access required\",\n            status: 403\n        };\n    }\n    return authResult;\n}\n/**\n * Require access to a specific partner by slug\n */ async function requirePartnerAccessBySlug(slug) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            slug\n        }\n    });\n    if (!partner) {\n        return {\n            authorized: false,\n            error: \"Partner not found\",\n            status: 404\n        };\n    }\n    return requirePartnerAccess(partner.id);\n}\n// ============================================================================\n// ACCESS BOUNDARY CHECKS\n// ============================================================================\n/**\n * Check if a partner user can access a specific referral\n * Staff can only see referrals from codes they created\n */ async function canAccessReferral(partnerUserId, referralId, role) {\n    // Owners can see all referrals\n    if (role === \"PARTNER_OWNER\") {\n        return true;\n    }\n    // Staff can only see referrals from their codes\n    const referral = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findUnique({\n        where: {\n            id: referralId\n        },\n        include: {\n            referralCode: {\n                select: {\n                    metadata: true\n                }\n            }\n        }\n    });\n    if (!referral) {\n        return false;\n    }\n    // Check if this staff member created the referral code\n    // (This would require tracking who created the code - simplified for now)\n    // For now, staff can see all referrals in their partner\n    return true;\n}\n/**\n * Check if user can access a tenant's data\n * Partner users CANNOT access tenant internals - this always returns false\n */ function canPartnerAccessTenantInternals() {\n    // Partner users can NEVER access tenant internals\n    // This is a hard boundary\n    return false;\n}\nasync function getPartnerVisibleTenantData(partnerId, tenantId) {\n    // First verify this partner has a referral for this tenant\n    const referral = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findFirst({\n        where: {\n            partnerId,\n            tenantId\n        }\n    });\n    if (!referral) {\n        return null // Partner cannot see this tenant\n        ;\n    }\n    // Get limited tenant data\n    const tenant = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.tenant.findUnique({\n        where: {\n            id: tenantId\n        },\n        select: {\n            id: true,\n            name: true,\n            slug: true,\n            status: true,\n            createdAt: true\n        }\n    });\n    if (!tenant) {\n        return null;\n    }\n    return {\n        id: tenant.id,\n        name: tenant.name,\n        slug: tenant.slug,\n        status: tenant.status,\n        createdAt: tenant.createdAt\n    };\n}\n// ============================================================================\n// HELPER FUNCTIONS\n// ============================================================================\n/**\n * Check if user has a specific permission\n */ function hasPartnerPermission(role, permission) {\n    const permissions = getPartnerPermissions(role);\n    return permissions[permission];\n}\n/**\n * Assert a permission or throw\n */ function assertPartnerPermission(role, permission, errorMessage) {\n    if (!hasPartnerPermission(role, permission)) {\n        throw new Error(errorMessage || `Permission denied: ${permission}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3BhcnRuZXItYXV0aG9yaXphdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0NBV0MsR0FFZ0M7QUFDc0I7QUFtQ3ZELCtFQUErRTtBQUMvRSxtQkFBbUI7QUFDbkIsK0VBQStFO0FBRS9FOzs7OztDQUtDLEdBQ0QsTUFBTUUsNEJBQWdEO0lBQ3BELHFCQUFxQjtJQUNyQkMsZ0JBQWdCO0lBQ2hCQyxnQkFBZ0I7SUFDaEJDLHVCQUF1QjtJQUN2QkMsa0JBQWtCO0lBRWxCLHNCQUFzQjtJQUN0QkMsa0JBQWtCO0lBQ2xCQyx3QkFBd0I7SUFDeEJDLHFCQUFxQjtJQUVyQixXQUFXO0lBQ1hDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxtQkFBbUI7SUFFbkIsWUFBWTtJQUNaQyxrQkFBa0I7SUFDbEJDLHlCQUF5QjtBQUMzQjtBQUVBOzs7Ozs7Q0FNQyxHQUNELE1BQU1DLDRCQUFnRDtJQUNwRCxxQkFBcUI7SUFDckJaLGdCQUFnQjtJQUNoQkMsZ0JBQWdCO0lBQ2hCQyx1QkFBdUI7SUFDdkJDLGtCQUFrQjtJQUVsQixzQkFBc0I7SUFDdEJDLGtCQUFrQjtJQUNsQkMsd0JBQXdCO0lBQ3hCQyxxQkFBcUI7SUFFckIsV0FBVztJQUNYQyxpQkFBaUI7SUFDakJDLG9CQUFvQjtJQUNwQkMsbUJBQW1CO0lBRW5CLFlBQVk7SUFDWkMsa0JBQWtCO0lBQ2xCQyx5QkFBeUI7QUFDM0I7QUFFQTs7OztDQUlDLEdBQ0QsTUFBTUUsMEJBQThDO0lBQ2xEYixnQkFBZ0I7SUFDaEJDLGdCQUFnQjtJQUNoQkMsdUJBQXVCO0lBQ3ZCQyxrQkFBa0I7SUFDbEJDLGtCQUFrQjtJQUNsQkMsd0JBQXdCO0lBQ3hCQyxxQkFBcUI7SUFDckJDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxtQkFBbUI7SUFDbkJDLGtCQUFrQjtJQUNsQkMseUJBQXlCO0FBQzNCO0FBRUE7O0NBRUMsR0FDTSxTQUFTRyxzQkFBc0JDLElBQWlDO0lBQ3JFLE9BQVFBO1FBQ04sS0FBSztZQUNILE9BQU9GO1FBQ1QsS0FBSztZQUNILE9BQU9kO1FBQ1QsS0FBSztZQUNILE9BQU9hO1FBQ1Q7WUFDRSxtQ0FBbUM7WUFDbkMsT0FBTztnQkFDTFosZ0JBQWdCO2dCQUNoQkMsZ0JBQWdCO2dCQUNoQkMsdUJBQXVCO2dCQUN2QkMsa0JBQWtCO2dCQUNsQkMsa0JBQWtCO2dCQUNsQkMsd0JBQXdCO2dCQUN4QkMscUJBQXFCO2dCQUNyQkMsaUJBQWlCO2dCQUNqQkMsb0JBQW9CO2dCQUNwQkMsbUJBQW1CO2dCQUNuQkMsa0JBQWtCO2dCQUNsQkMseUJBQXlCO1lBQzNCO0lBQ0o7QUFDRjtBQUVBLCtFQUErRTtBQUMvRSw4QkFBOEI7QUFDOUIsK0VBQStFO0FBRS9FOztDQUVDLEdBQ00sZUFBZUsscUJBQXFCQyxNQUFjO0lBQ3ZELE9BQU9wQiwyQ0FBTUEsQ0FBQ3FCLFdBQVcsQ0FBQ0MsVUFBVSxDQUFDO1FBQ25DQyxPQUFPO1lBQUVIO1FBQU87UUFDaEJJLFNBQVM7WUFBRUMsU0FBUztRQUFLO0lBQzNCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLGNBQWNOLE1BQWM7SUFDaEQsTUFBTU8sYUFBYSxNQUFNM0IsMkNBQU1BLENBQUNxQixXQUFXLENBQUNDLFVBQVUsQ0FBQztRQUNyREMsT0FBTztZQUFFSDtRQUFPO0lBQ2xCO0lBQ0EsT0FBTyxDQUFDLENBQUNPO0FBQ1g7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLHNCQUNwQlIsTUFBYyxFQUNkUyxTQUFpQixFQUNqQkMsVUFBa0I7SUFFbEIsOEJBQThCO0lBQzlCLElBQUlBLGVBQWUsZUFBZTtRQUNoQyxPQUFPO0lBQ1Q7SUFFQSwyQkFBMkI7SUFDM0IsTUFBTUgsYUFBYSxNQUFNM0IsMkNBQU1BLENBQUNxQixXQUFXLENBQUNDLFVBQVUsQ0FBQztRQUNyREMsT0FBTztZQUFFSDtRQUFPO1FBQ2hCVyxRQUFRO1lBQUVGLFdBQVc7WUFBTVgsTUFBTTtZQUFNYyxVQUFVO1FBQUs7SUFDeEQ7SUFFQSxtQ0FBbUM7SUFDbkMsSUFBSSxDQUFDTCxjQUFjLENBQUNBLFdBQVdLLFFBQVEsRUFBRTtRQUN2QyxPQUFPO0lBQ1Q7SUFFQSx3Q0FBd0M7SUFDeEMsSUFBSUwsV0FBV0UsU0FBUyxLQUFLQSxXQUFXO1FBQ3RDLE9BQU87SUFDVDtJQUVBLGlDQUFpQztJQUNqQyxPQUFPRixXQUFXVCxJQUFJLEtBQUssa0JBQWtCLFVBQVU7QUFDekQ7QUFFQSwrRUFBK0U7QUFDL0UsMEJBQTBCO0FBQzFCLCtFQUErRTtBQUUvRTs7Q0FFQyxHQUNNLGVBQWVlO0lBQ3BCLE1BQU1DLFVBQVUsTUFBTWpDLHdEQUFpQkE7SUFFdkMsSUFBSSxDQUFDaUMsU0FBUztRQUNaLE9BQU87WUFDTEMsWUFBWTtZQUNaQyxPQUFPO1lBQ1BDLFFBQVE7UUFDVjtJQUNGO0lBRUEsSUFBSSxDQUFDSCxRQUFRSSxJQUFJLENBQUNOLFFBQVEsRUFBRTtRQUMxQixPQUFPO1lBQ0xHLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLHlCQUF5QjtJQUN6QixNQUFNaEIsY0FBYyxNQUFNckIsMkNBQU1BLENBQUNxQixXQUFXLENBQUNDLFVBQVUsQ0FBQztRQUN0REMsT0FBTztZQUFFSCxRQUFRYyxRQUFRSSxJQUFJLENBQUNDLEVBQUU7UUFBQztRQUNqQ2YsU0FBUztZQUFFQyxTQUFTO1FBQUs7SUFDM0I7SUFFQSxJQUFJLENBQUNKLGFBQWE7UUFDaEIsT0FBTztZQUNMYyxZQUFZO1lBQ1pDLE9BQU87WUFDUEMsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxJQUFJLENBQUNoQixZQUFZVyxRQUFRLEVBQUU7UUFDekIsT0FBTztZQUNMRyxZQUFZO1lBQ1pDLE9BQU87WUFDUEMsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxJQUFJaEIsWUFBWUksT0FBTyxDQUFDWSxNQUFNLEtBQUssVUFBVTtRQUMzQyxPQUFPO1lBQ0xGLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLE9BQU87UUFDTEYsWUFBWTtRQUNaRyxNQUFNSixRQUFRSSxJQUFJO1FBQ2xCSjtRQUNBVCxTQUFTSixZQUFZSSxPQUFPO1FBQzVCSjtRQUNBSCxNQUFNRyxZQUFZSCxJQUFJO0lBQ3hCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVzQjtJQUNwQixNQUFNQyxhQUFhLE1BQU1SO0lBRXpCLElBQUksQ0FBQ1EsV0FBV04sVUFBVSxFQUFFO1FBQzFCLE9BQU9NO0lBQ1Q7SUFFQSxJQUFJQSxXQUFXdkIsSUFBSSxLQUFLLGlCQUFpQjtRQUN2QyxPQUFPO1lBQ0xpQixZQUFZO1lBQ1pDLE9BQU87WUFDUEMsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxPQUFPSTtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlQyxxQkFBcUJiLFNBQWlCO0lBQzFELE1BQU1LLFVBQVUsTUFBTWpDLHdEQUFpQkE7SUFFdkMsSUFBSSxDQUFDaUMsU0FBUztRQUNaLE9BQU87WUFDTEMsWUFBWTtZQUNaQyxPQUFPO1lBQ1BDLFFBQVE7UUFDVjtJQUNGO0lBRUEsSUFBSSxDQUFDSCxRQUFRSSxJQUFJLENBQUNOLFFBQVEsRUFBRTtRQUMxQixPQUFPO1lBQ0xHLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLHFDQUFxQztJQUNyQyxJQUFJSCxRQUFRSSxJQUFJLENBQUNSLFVBQVUsS0FBSyxlQUFlO1FBQzdDLE1BQU1MLFVBQVUsTUFBTXpCLDJDQUFNQSxDQUFDeUIsT0FBTyxDQUFDSCxVQUFVLENBQUM7WUFDOUNDLE9BQU87Z0JBQUVnQixJQUFJVjtZQUFVO1FBQ3pCO1FBRUEsSUFBSSxDQUFDSixTQUFTO1lBQ1osT0FBTztnQkFDTFUsWUFBWTtnQkFDWkMsT0FBTztnQkFDUEMsUUFBUTtZQUNWO1FBQ0Y7UUFFQSxPQUFPO1lBQ0xGLFlBQVk7WUFDWkcsTUFBTUosUUFBUUksSUFBSTtZQUNsQko7WUFDQVQ7WUFDQUosYUFBYTtZQUNiSCxNQUFNLGdCQUFnQixpQ0FBaUM7UUFDekQ7SUFDRjtJQUVBLCtEQUErRDtJQUMvRCxNQUFNRyxjQUFjLE1BQU1yQiwyQ0FBTUEsQ0FBQ3FCLFdBQVcsQ0FBQ0MsVUFBVSxDQUFDO1FBQ3REQyxPQUFPO1lBQUVILFFBQVFjLFFBQVFJLElBQUksQ0FBQ0MsRUFBRTtRQUFDO1FBQ2pDZixTQUFTO1lBQUVDLFNBQVM7UUFBSztJQUMzQjtJQUVBLElBQUksQ0FBQ0osYUFBYTtRQUNoQixPQUFPO1lBQ0xjLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLG1DQUFtQztJQUNuQyxJQUFJaEIsWUFBWVEsU0FBUyxLQUFLQSxXQUFXO1FBQ3ZDLE9BQU87WUFDTE0sWUFBWTtZQUNaQyxPQUFPO1lBQ1BDLFFBQVE7UUFDVjtJQUNGO0lBRUEsSUFBSSxDQUFDaEIsWUFBWVcsUUFBUSxFQUFFO1FBQ3pCLE9BQU87WUFDTEcsWUFBWTtZQUNaQyxPQUFPO1lBQ1BDLFFBQVE7UUFDVjtJQUNGO0lBRUEsSUFBSWhCLFlBQVlJLE9BQU8sQ0FBQ1ksTUFBTSxLQUFLLFVBQVU7UUFDM0MsT0FBTztZQUNMRixZQUFZO1lBQ1pDLE9BQU87WUFDUEMsUUFBUTtRQUNWO0lBQ0Y7SUFFQSxPQUFPO1FBQ0xGLFlBQVk7UUFDWkcsTUFBTUosUUFBUUksSUFBSTtRQUNsQko7UUFDQVQsU0FBU0osWUFBWUksT0FBTztRQUM1Qko7UUFDQUgsTUFBTUcsWUFBWUgsSUFBSTtJQUN4QjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFleUIsMEJBQTBCZCxTQUFpQjtJQUMvRCxNQUFNWSxhQUFhLE1BQU1DLHFCQUFxQmI7SUFFOUMsSUFBSSxDQUFDWSxXQUFXTixVQUFVLEVBQUU7UUFDMUIsT0FBT007SUFDVDtJQUVBLGtDQUFrQztJQUNsQyxJQUFJQSxXQUFXUCxPQUFPLENBQUNJLElBQUksQ0FBQ1IsVUFBVSxLQUFLLGVBQWU7UUFDeEQsT0FBT1c7SUFDVDtJQUVBLElBQUlBLFdBQVd2QixJQUFJLEtBQUssaUJBQWlCO1FBQ3ZDLE9BQU87WUFDTGlCLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLE9BQU9JO0FBQ1Q7QUFFQTs7Q0FFQyxHQUNNLGVBQWVHLDJCQUEyQkMsSUFBWTtJQUMzRCxNQUFNcEIsVUFBVSxNQUFNekIsMkNBQU1BLENBQUN5QixPQUFPLENBQUNILFVBQVUsQ0FBQztRQUM5Q0MsT0FBTztZQUFFc0I7UUFBSztJQUNoQjtJQUVBLElBQUksQ0FBQ3BCLFNBQVM7UUFDWixPQUFPO1lBQ0xVLFlBQVk7WUFDWkMsT0FBTztZQUNQQyxRQUFRO1FBQ1Y7SUFDRjtJQUVBLE9BQU9LLHFCQUFxQmpCLFFBQVFjLEVBQUU7QUFDeEM7QUFFQSwrRUFBK0U7QUFDL0UseUJBQXlCO0FBQ3pCLCtFQUErRTtBQUUvRTs7O0NBR0MsR0FDTSxlQUFlTyxrQkFDcEJDLGFBQXFCLEVBQ3JCQyxVQUFrQixFQUNsQjlCLElBQWlCO0lBRWpCLCtCQUErQjtJQUMvQixJQUFJQSxTQUFTLGlCQUFpQjtRQUM1QixPQUFPO0lBQ1Q7SUFFQSxnREFBZ0Q7SUFDaEQsTUFBTStCLFdBQVcsTUFBTWpELDJDQUFNQSxDQUFDa0QsZUFBZSxDQUFDNUIsVUFBVSxDQUFDO1FBQ3ZEQyxPQUFPO1lBQUVnQixJQUFJUztRQUFXO1FBQ3hCeEIsU0FBUztZQUNQMkIsY0FBYztnQkFDWnBCLFFBQVE7b0JBQUVxQixVQUFVO2dCQUFLO1lBQzNCO1FBQ0Y7SUFDRjtJQUVBLElBQUksQ0FBQ0gsVUFBVTtRQUNiLE9BQU87SUFDVDtJQUVBLHVEQUF1RDtJQUN2RCwwRUFBMEU7SUFDMUUsd0RBQXdEO0lBQ3hELE9BQU87QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNJO0lBQ2Qsa0RBQWtEO0lBQ2xELDBCQUEwQjtJQUMxQixPQUFPO0FBQ1Q7QUFpQk8sZUFBZUMsNEJBQ3BCekIsU0FBaUIsRUFDakIwQixRQUFnQjtJQUVoQiwyREFBMkQ7SUFDM0QsTUFBTU4sV0FBVyxNQUFNakQsMkNBQU1BLENBQUNrRCxlQUFlLENBQUNNLFNBQVMsQ0FBQztRQUN0RGpDLE9BQU87WUFDTE07WUFDQTBCO1FBQ0Y7SUFDRjtJQUVBLElBQUksQ0FBQ04sVUFBVTtRQUNiLE9BQU8sS0FBSyxpQ0FBaUM7O0lBQy9DO0lBRUEsMEJBQTBCO0lBQzFCLE1BQU1RLFNBQVMsTUFBTXpELDJDQUFNQSxDQUFDeUQsTUFBTSxDQUFDbkMsVUFBVSxDQUFDO1FBQzVDQyxPQUFPO1lBQUVnQixJQUFJZ0I7UUFBUztRQUN0QnhCLFFBQVE7WUFDTlEsSUFBSTtZQUNKbUIsTUFBTTtZQUNOYixNQUFNO1lBQ05SLFFBQVE7WUFDUnNCLFdBQVc7UUFFYjtJQUNGO0lBRUEsSUFBSSxDQUFDRixRQUFRO1FBQ1gsT0FBTztJQUNUO0lBRUEsT0FBTztRQUNMbEIsSUFBSWtCLE9BQU9sQixFQUFFO1FBQ2JtQixNQUFNRCxPQUFPQyxJQUFJO1FBQ2pCYixNQUFNWSxPQUFPWixJQUFJO1FBQ2pCUixRQUFRb0IsT0FBT3BCLE1BQU07UUFDckJzQixXQUFXRixPQUFPRSxTQUFTO0lBQzdCO0FBQ0Y7QUFFQSwrRUFBK0U7QUFDL0UsbUJBQW1CO0FBQ25CLCtFQUErRTtBQUUvRTs7Q0FFQyxHQUNNLFNBQVNDLHFCQUNkMUMsSUFBaUMsRUFDakMyQyxVQUFvQztJQUVwQyxNQUFNQyxjQUFjN0Msc0JBQXNCQztJQUMxQyxPQUFPNEMsV0FBVyxDQUFDRCxXQUFXO0FBQ2hDO0FBRUE7O0NBRUMsR0FDTSxTQUFTRSx3QkFDZDdDLElBQWlDLEVBQ2pDMkMsVUFBb0MsRUFDcENHLFlBQXFCO0lBRXJCLElBQUksQ0FBQ0oscUJBQXFCMUMsTUFBTTJDLGFBQWE7UUFDM0MsTUFBTSxJQUFJSSxNQUFNRCxnQkFBZ0IsQ0FBQyxtQkFBbUIsRUFBRUgsV0FBVyxDQUFDO0lBQ3BFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3BhcnRuZXItYXV0aG9yaXphdGlvbi50cz8wNTY1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGFydG5lciBBdXRob3JpemF0aW9uXG4gKiBcbiAqIEFjY2VzcyBjb250cm9sIGZvciBQYXJ0bmVyIGRvbWFpbiAtIGNvbXBsZXRlbHkgc2VwYXJhdGUgZnJvbSBUZW5hbnQgYXV0aG9yaXphdGlvbi5cbiAqIFBhcnRuZXIgdXNlcnMgQ0FOTk9UIGFjY2VzcyB0ZW5hbnQgaW50ZXJuYWxzLlxuICogUGFydG5lciB1c2VycyBjYW4gT05MWSBzZWUgdGhlaXIgb3duIHBhcnRuZXIncyBkYXRhLlxuICogXG4gKiBSb2xlIEhpZXJhcmNoeTpcbiAqIC0gU1VQRVJfQURNSU46IFBsYXRmb3JtLXdpZGUgYWNjZXNzIHRvIGFsbCBwYXJ0bmVyc1xuICogLSBQQVJUTkVSX09XTkVSOiBGdWxsIGNvbnRyb2wgd2l0aGluIHRoZWlyIHBhcnRuZXIgb3JnYW5pemF0aW9uXG4gKiAtIFBBUlRORVJfU1RBRkY6IExpbWl0ZWQgYWNjZXNzIHdpdGhpbiB0aGVpciBwYXJ0bmVyIG9yZ2FuaXphdGlvblxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgZ2V0Q3VycmVudFNlc3Npb24sIEF1dGhTZXNzaW9uIH0gZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IHsgVXNlciwgUGFydG5lciwgUGFydG5lclVzZXIsIFBhcnRuZXJSb2xlIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCB0eXBlIFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0ID0gXG4gIHwgeyBhdXRob3JpemVkOiB0cnVlOyB1c2VyOiBVc2VyOyBzZXNzaW9uOiBBdXRoU2Vzc2lvbjsgcGFydG5lcjogUGFydG5lcjsgcGFydG5lclVzZXI6IFBhcnRuZXJVc2VyOyByb2xlOiBQYXJ0bmVyUm9sZSB9XG4gIHwgeyBhdXRob3JpemVkOiBmYWxzZTsgZXJyb3I6IHN0cmluZzsgc3RhdHVzOiBudW1iZXIgfVxuXG5leHBvcnQgdHlwZSBQYXJ0bmVyQWNjZXNzTGV2ZWwgPSAnTk9ORScgfCAnU1RBRkYnIHwgJ09XTkVSJyB8ICdTVVBFUl9BRE1JTidcblxuZXhwb3J0IGludGVyZmFjZSBQYXJ0bmVyUGVybWlzc2lvbnMge1xuICAvLyBQYXJ0bmVyIE1hbmFnZW1lbnRcbiAgY2FuVmlld1BhcnRuZXI6IGJvb2xlYW5cbiAgY2FuRWRpdFBhcnRuZXI6IGJvb2xlYW5cbiAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiBib29sZWFuXG4gIGNhblNpZ25BZ3JlZW1lbnQ6IGJvb2xlYW5cbiAgXG4gIC8vIFJlZmVycmFsIE1hbmFnZW1lbnRcbiAgY2FuVmlld1JlZmVycmFsczogYm9vbGVhblxuICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiBib29sZWFuXG4gIGNhblZpZXdBbGxSZWZlcnJhbHM6IGJvb2xlYW4gIC8vIHZzIG9ubHkgb3duIHJlZmVycmFsc1xuICBcbiAgLy8gRWFybmluZ3NcbiAgY2FuVmlld0Vhcm5pbmdzOiBib29sZWFuXG4gIGNhblZpZXdBbGxFYXJuaW5nczogYm9vbGVhbiAgIC8vIHZzIG9ubHkgc3VtbWFyeVxuICBjYW5FeHBvcnRFYXJuaW5nczogYm9vbGVhblxuICBcbiAgLy8gQWdyZWVtZW50XG4gIGNhblZpZXdBZ3JlZW1lbnQ6IGJvb2xlYW5cbiAgY2FuVmlld0FncmVlbWVudEhpc3Rvcnk6IGJvb2xlYW5cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUk9MRSBERUZJTklUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFBBUlRORVJfT1dORVIgUGVybWlzc2lvbnNcbiAqIC0gRnVsbCBjb250cm9sIG92ZXIgcGFydG5lciBvcmdhbml6YXRpb25cbiAqIC0gQ2FuIG1hbmFnZSB1c2Vycywgc2lnbiBhZ3JlZW1lbnRzLCB2aWV3IGFsbCBkYXRhXG4gKiAtIENBTk5PVCBhY2Nlc3MgdGVuYW50IGludGVybmFsc1xuICovXG5jb25zdCBQQVJUTkVSX09XTkVSX1BFUk1JU1NJT05TOiBQYXJ0bmVyUGVybWlzc2lvbnMgPSB7XG4gIC8vIFBhcnRuZXIgTWFuYWdlbWVudFxuICBjYW5WaWV3UGFydG5lcjogdHJ1ZSxcbiAgY2FuRWRpdFBhcnRuZXI6IHRydWUsXG4gIGNhbk1hbmFnZVBhcnRuZXJVc2VyczogdHJ1ZSxcbiAgY2FuU2lnbkFncmVlbWVudDogdHJ1ZSxcbiAgXG4gIC8vIFJlZmVycmFsIE1hbmFnZW1lbnRcbiAgY2FuVmlld1JlZmVycmFsczogdHJ1ZSxcbiAgY2FuQ3JlYXRlUmVmZXJyYWxDb2RlczogdHJ1ZSxcbiAgY2FuVmlld0FsbFJlZmVycmFsczogdHJ1ZSxcbiAgXG4gIC8vIEVhcm5pbmdzXG4gIGNhblZpZXdFYXJuaW5nczogdHJ1ZSxcbiAgY2FuVmlld0FsbEVhcm5pbmdzOiB0cnVlLFxuICBjYW5FeHBvcnRFYXJuaW5nczogdHJ1ZSxcbiAgXG4gIC8vIEFncmVlbWVudFxuICBjYW5WaWV3QWdyZWVtZW50OiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50SGlzdG9yeTogdHJ1ZSxcbn1cblxuLyoqXG4gKiBQQVJUTkVSX1NUQUZGIFBlcm1pc3Npb25zXG4gKiAtIExpbWl0ZWQgYWNjZXNzIHdpdGhpbiBwYXJ0bmVyIG9yZ2FuaXphdGlvblxuICogLSBDYW4gdmlldyByZWZlcnJhbHMgYW5kIGVhcm5pbmdzLCBjcmVhdGUgY29kZXNcbiAqIC0gQ0FOTk9UIG1hbmFnZSB1c2VycyBvciBzaWduIGFncmVlbWVudHNcbiAqIC0gQ0FOTk9UIGFjY2VzcyB0ZW5hbnQgaW50ZXJuYWxzXG4gKi9cbmNvbnN0IFBBUlRORVJfU1RBRkZfUEVSTUlTU0lPTlM6IFBhcnRuZXJQZXJtaXNzaW9ucyA9IHtcbiAgLy8gUGFydG5lciBNYW5hZ2VtZW50XG4gIGNhblZpZXdQYXJ0bmVyOiB0cnVlLFxuICBjYW5FZGl0UGFydG5lcjogZmFsc2UsXG4gIGNhbk1hbmFnZVBhcnRuZXJVc2VyczogZmFsc2UsXG4gIGNhblNpZ25BZ3JlZW1lbnQ6IGZhbHNlLFxuICBcbiAgLy8gUmVmZXJyYWwgTWFuYWdlbWVudFxuICBjYW5WaWV3UmVmZXJyYWxzOiB0cnVlLFxuICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiB0cnVlLFxuICBjYW5WaWV3QWxsUmVmZXJyYWxzOiBmYWxzZSwgIC8vIE9ubHkgc2VlIHJlZmVycmFscyB0aGV5IGNyZWF0ZWRcbiAgXG4gIC8vIEVhcm5pbmdzXG4gIGNhblZpZXdFYXJuaW5nczogdHJ1ZSxcbiAgY2FuVmlld0FsbEVhcm5pbmdzOiBmYWxzZSwgICAvLyBPbmx5IHNlZSBzdW1tYXJ5LCBub3QgbGluZSBpdGVtc1xuICBjYW5FeHBvcnRFYXJuaW5nczogZmFsc2UsXG4gIFxuICAvLyBBZ3JlZW1lbnRcbiAgY2FuVmlld0FncmVlbWVudDogdHJ1ZSxcbiAgY2FuVmlld0FncmVlbWVudEhpc3Rvcnk6IGZhbHNlLFxufVxuXG4vKipcbiAqIFNVUEVSX0FETUlOIFBlcm1pc3Npb25zIChwbGF0Zm9ybS13aWRlKVxuICogLSBDYW4gYWNjZXNzIGFsbCBwYXJ0bmVyc1xuICogLSBGdWxsIHBlcm1pc3Npb25zIG9uIGFueSBwYXJ0bmVyXG4gKi9cbmNvbnN0IFNVUEVSX0FETUlOX1BFUk1JU1NJT05TOiBQYXJ0bmVyUGVybWlzc2lvbnMgPSB7XG4gIGNhblZpZXdQYXJ0bmVyOiB0cnVlLFxuICBjYW5FZGl0UGFydG5lcjogdHJ1ZSxcbiAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiB0cnVlLFxuICBjYW5TaWduQWdyZWVtZW50OiBmYWxzZSwgIC8vIFN1cGVyIEFkbWluIGFwcHJvdmVzLCBub3Qgc2lnbnNcbiAgY2FuVmlld1JlZmVycmFsczogdHJ1ZSxcbiAgY2FuQ3JlYXRlUmVmZXJyYWxDb2RlczogdHJ1ZSxcbiAgY2FuVmlld0FsbFJlZmVycmFsczogdHJ1ZSxcbiAgY2FuVmlld0Vhcm5pbmdzOiB0cnVlLFxuICBjYW5WaWV3QWxsRWFybmluZ3M6IHRydWUsXG4gIGNhbkV4cG9ydEVhcm5pbmdzOiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50OiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50SGlzdG9yeTogdHJ1ZSxcbn1cblxuLyoqXG4gKiBHZXQgcGVybWlzc2lvbnMgZm9yIGEgcm9sZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFydG5lclBlcm1pc3Npb25zKHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyk6IFBhcnRuZXJQZXJtaXNzaW9ucyB7XG4gIHN3aXRjaCAocm9sZSkge1xuICAgIGNhc2UgJ1NVUEVSX0FETUlOJzpcbiAgICAgIHJldHVybiBTVVBFUl9BRE1JTl9QRVJNSVNTSU9OU1xuICAgIGNhc2UgJ1BBUlRORVJfT1dORVInOlxuICAgICAgcmV0dXJuIFBBUlRORVJfT1dORVJfUEVSTUlTU0lPTlNcbiAgICBjYXNlICdQQVJUTkVSX1NUQUZGJzpcbiAgICAgIHJldHVybiBQQVJUTkVSX1NUQUZGX1BFUk1JU1NJT05TXG4gICAgZGVmYXVsdDpcbiAgICAgIC8vIE5vIHBlcm1pc3Npb25zIGZvciB1bmtub3duIHJvbGVzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjYW5WaWV3UGFydG5lcjogZmFsc2UsXG4gICAgICAgIGNhbkVkaXRQYXJ0bmVyOiBmYWxzZSxcbiAgICAgICAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiBmYWxzZSxcbiAgICAgICAgY2FuU2lnbkFncmVlbWVudDogZmFsc2UsXG4gICAgICAgIGNhblZpZXdSZWZlcnJhbHM6IGZhbHNlLFxuICAgICAgICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiBmYWxzZSxcbiAgICAgICAgY2FuVmlld0FsbFJlZmVycmFsczogZmFsc2UsXG4gICAgICAgIGNhblZpZXdFYXJuaW5nczogZmFsc2UsXG4gICAgICAgIGNhblZpZXdBbGxFYXJuaW5nczogZmFsc2UsXG4gICAgICAgIGNhbkV4cG9ydEVhcm5pbmdzOiBmYWxzZSxcbiAgICAgICAgY2FuVmlld0FncmVlbWVudDogZmFsc2UsXG4gICAgICAgIGNhblZpZXdBZ3JlZW1lbnRIaXN0b3J5OiBmYWxzZSxcbiAgICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBQ0NFU1MgQk9VTkRBUlkgRU5GT1JDRU1FTlRcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgdXNlcidzIHBhcnRuZXIgbWVtYmVyc2hpcCAoaWYgYW55KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lck1lbWJlcnNoaXAodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPChQYXJ0bmVyVXNlciAmIHsgcGFydG5lcjogUGFydG5lciB9KSB8IG51bGw+IHtcbiAgcmV0dXJuIHByaXNtYS5wYXJ0bmVyVXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICBpbmNsdWRlOiB7IHBhcnRuZXI6IHRydWUgfVxuICB9KVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgYSBwYXJ0bmVyIHVzZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzUGFydG5lclVzZXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyVXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyB1c2VySWQgfVxuICB9KVxuICByZXR1cm4gISFtZW1iZXJzaGlwXG59XG5cbi8qKlxuICogR2V0IHVzZXIncyBhY2Nlc3MgbGV2ZWwgZm9yIGEgc3BlY2lmaWMgcGFydG5lclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lckFjY2Vzc0xldmVsKFxuICB1c2VySWQ6IHN0cmluZywgXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBnbG9iYWxSb2xlOiBzdHJpbmdcbik6IFByb21pc2U8UGFydG5lckFjY2Vzc0xldmVsPiB7XG4gIC8vIFN1cGVyIEFkbWluIGhhcyBmdWxsIGFjY2Vzc1xuICBpZiAoZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiAnU1VQRVJfQURNSU4nXG4gIH1cbiAgXG4gIC8vIENoZWNrIHBhcnRuZXIgbWVtYmVyc2hpcFxuICBjb25zdCBtZW1iZXJzaGlwID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgIHNlbGVjdDogeyBwYXJ0bmVySWQ6IHRydWUsIHJvbGU6IHRydWUsIGlzQWN0aXZlOiB0cnVlIH1cbiAgfSlcbiAgXG4gIC8vIE5vdCBhIHBhcnRuZXIgdXNlciBvciBub3QgYWN0aXZlXG4gIGlmICghbWVtYmVyc2hpcCB8fCAhbWVtYmVyc2hpcC5pc0FjdGl2ZSkge1xuICAgIHJldHVybiAnTk9ORSdcbiAgfVxuICBcbiAgLy8gTm90IGEgbWVtYmVyIG9mIHRoaXMgc3BlY2lmaWMgcGFydG5lclxuICBpZiAobWVtYmVyc2hpcC5wYXJ0bmVySWQgIT09IHBhcnRuZXJJZCkge1xuICAgIHJldHVybiAnTk9ORSdcbiAgfVxuICBcbiAgLy8gUmV0dXJuIHJvbGUtYmFzZWQgYWNjZXNzIGxldmVsXG4gIHJldHVybiBtZW1iZXJzaGlwLnJvbGUgPT09ICdQQVJUTkVSX09XTkVSJyA/ICdPV05FUicgOiAnU1RBRkYnXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFVVEhPUklaQVRJT04gRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogUmVxdWlyZSBhbnkgYXV0aGVudGljYXRlZCB1c2VyIHdobyBpcyBhIHBhcnRuZXIgdXNlclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJVc2VyKCk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQ+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEN1cnJlbnRTZXNzaW9uKClcbiAgXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLFxuICAgICAgc3RhdHVzOiA0MDFcbiAgICB9XG4gIH1cbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyLmlzQWN0aXZlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdBY2NvdW50IGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICAvLyBHZXQgcGFydG5lciBtZW1iZXJzaGlwXG4gIGNvbnN0IHBhcnRuZXJVc2VyID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkIH0sXG4gICAgaW5jbHVkZTogeyBwYXJ0bmVyOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGlmICghcGFydG5lclVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ05vdCBhIHBhcnRuZXIgdXNlcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKCFwYXJ0bmVyVXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBtZW1iZXJzaGlwIGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICBpZiAocGFydG5lclVzZXIucGFydG5lci5zdGF0dXMgIT09ICdBQ1RJVkUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG9yZ2FuaXphdGlvbiBpcyBub3QgYWN0aXZlJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGF1dGhvcml6ZWQ6IHRydWUsXG4gICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgIHNlc3Npb24sXG4gICAgcGFydG5lcjogcGFydG5lclVzZXIucGFydG5lcixcbiAgICBwYXJ0bmVyVXNlcixcbiAgICByb2xlOiBwYXJ0bmVyVXNlci5yb2xlXG4gIH1cbn1cblxuLyoqXG4gKiBSZXF1aXJlIFBBUlRORVJfT1dORVIgcm9sZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJPd25lcigpOiBQcm9taXNlPFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlUGFydG5lclVzZXIoKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICBpZiAoYXV0aFJlc3VsdC5yb2xlICE9PSAnUEFSVE5FUl9PV05FUicpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ1BhcnRuZXIgT3duZXIgYWNjZXNzIHJlcXVpcmVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gYXV0aFJlc3VsdFxufVxuXG4vKipcbiAqIFJlcXVpcmUgYWNjZXNzIHRvIGEgc3BlY2lmaWMgcGFydG5lciBieSBJRFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJBY2Nlc3MocGFydG5lcklkOiBzdHJpbmcpOiBQcm9taXNlPFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRDdXJyZW50U2Vzc2lvbigpXG4gIFxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyxcbiAgICAgIHN0YXR1czogNDAxXG4gICAgfVxuICB9XG4gIFxuICBpZiAoIXNlc3Npb24udXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnQWNjb3VudCBpcyBkaXNhYmxlZCcsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgLy8gU3VwZXIgQWRtaW4gY2FuIGFjY2VzcyBhbnkgcGFydG5lclxuICBpZiAoc2Vzc2lvbi51c2VyLmdsb2JhbFJvbGUgPT09ICdTVVBFUl9BRE1JTicpIHtcbiAgICBjb25zdCBwYXJ0bmVyID0gYXdhaXQgcHJpc21hLnBhcnRuZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogcGFydG5lcklkIH1cbiAgICB9KVxuICAgIFxuICAgIGlmICghcGFydG5lcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnUGFydG5lciBub3QgZm91bmQnLFxuICAgICAgICBzdGF0dXM6IDQwNFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogdHJ1ZSxcbiAgICAgIHVzZXI6IHNlc3Npb24udXNlcixcbiAgICAgIHNlc3Npb24sXG4gICAgICBwYXJ0bmVyLFxuICAgICAgcGFydG5lclVzZXI6IG51bGwgYXMgYW55LCAvLyBTdXBlciBBZG1pbiBkb2Vzbid0IG5lZWQgcGFydG5lciB1c2VyIHJlY29yZFxuICAgICAgcm9sZTogJ1BBUlRORVJfT1dORVInIC8vIFRyZWF0IGFzIG93bmVyIGZvciBwZXJtaXNzaW9uc1xuICAgIH1cbiAgfVxuICBcbiAgLy8gUmVndWxhciB1c2VyIG11c3QgYmUgYSBwYXJ0bmVyIHVzZXIgb2YgdGhpcyBzcGVjaWZpYyBwYXJ0bmVyXG4gIGNvbnN0IHBhcnRuZXJVc2VyID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkIH0sXG4gICAgaW5jbHVkZTogeyBwYXJ0bmVyOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGlmICghcGFydG5lclVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ05vdCBhIHBhcnRuZXIgdXNlcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgLy8gTXVzdCBiZSBhIG1lbWJlciBvZiBUSElTIHBhcnRuZXJcbiAgaWYgKHBhcnRuZXJVc2VyLnBhcnRuZXJJZCAhPT0gcGFydG5lcklkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkIHRvIHRoaXMgcGFydG5lcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKCFwYXJ0bmVyVXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBtZW1iZXJzaGlwIGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICBpZiAocGFydG5lclVzZXIucGFydG5lci5zdGF0dXMgIT09ICdBQ1RJVkUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG9yZ2FuaXphdGlvbiBpcyBub3QgYWN0aXZlJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGF1dGhvcml6ZWQ6IHRydWUsXG4gICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgIHNlc3Npb24sXG4gICAgcGFydG5lcjogcGFydG5lclVzZXIucGFydG5lcixcbiAgICBwYXJ0bmVyVXNlcixcbiAgICByb2xlOiBwYXJ0bmVyVXNlci5yb2xlXG4gIH1cbn1cblxuLyoqXG4gKiBSZXF1aXJlIFBBUlRORVJfT1dORVIgYWNjZXNzIHRvIGEgc3BlY2lmaWMgcGFydG5lclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJPd25lckFjY2VzcyhwYXJ0bmVySWQ6IHN0cmluZyk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQ+IHtcbiAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHJlcXVpcmVQYXJ0bmVyQWNjZXNzKHBhcnRuZXJJZClcbiAgXG4gIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgcmV0dXJuIGF1dGhSZXN1bHRcbiAgfVxuICBcbiAgLy8gU3VwZXIgQWRtaW4gaXMgdHJlYXRlZCBhcyBvd25lclxuICBpZiAoYXV0aFJlc3VsdC5zZXNzaW9uLnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiBhdXRoUmVzdWx0XG4gIH1cbiAgXG4gIGlmIChhdXRoUmVzdWx0LnJvbGUgIT09ICdQQVJUTkVSX09XTkVSJykge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBPd25lciBhY2Nlc3MgcmVxdWlyZWQnLFxuICAgICAgc3RhdHVzOiA0MDNcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBhdXRoUmVzdWx0XG59XG5cbi8qKlxuICogUmVxdWlyZSBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBwYXJ0bmVyIGJ5IHNsdWdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVQYXJ0bmVyQWNjZXNzQnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQgJiB7IHBhcnRuZXI/OiBQYXJ0bmVyIH0+IHtcbiAgY29uc3QgcGFydG5lciA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNsdWcgfVxuICB9KVxuICBcbiAgaWYgKCFwYXJ0bmVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG5vdCBmb3VuZCcsXG4gICAgICBzdGF0dXM6IDQwNFxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHJlcXVpcmVQYXJ0bmVyQWNjZXNzKHBhcnRuZXIuaWQpXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFDQ0VTUyBCT1VOREFSWSBDSEVDS1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDaGVjayBpZiBhIHBhcnRuZXIgdXNlciBjYW4gYWNjZXNzIGEgc3BlY2lmaWMgcmVmZXJyYWxcbiAqIFN0YWZmIGNhbiBvbmx5IHNlZSByZWZlcnJhbHMgZnJvbSBjb2RlcyB0aGV5IGNyZWF0ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbkFjY2Vzc1JlZmVycmFsKFxuICBwYXJ0bmVyVXNlcklkOiBzdHJpbmcsXG4gIHJlZmVycmFsSWQ6IHN0cmluZyxcbiAgcm9sZTogUGFydG5lclJvbGVcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAvLyBPd25lcnMgY2FuIHNlZSBhbGwgcmVmZXJyYWxzXG4gIGlmIChyb2xlID09PSAnUEFSVE5FUl9PV05FUicpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIFxuICAvLyBTdGFmZiBjYW4gb25seSBzZWUgcmVmZXJyYWxzIGZyb20gdGhlaXIgY29kZXNcbiAgY29uc3QgcmVmZXJyYWwgPSBhd2FpdCBwcmlzbWEucGFydG5lclJlZmVycmFsLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGlkOiByZWZlcnJhbElkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgcmVmZXJyYWxDb2RlOiB7XG4gICAgICAgIHNlbGVjdDogeyBtZXRhZGF0YTogdHJ1ZSB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICBcbiAgaWYgKCFyZWZlcnJhbCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIFxuICAvLyBDaGVjayBpZiB0aGlzIHN0YWZmIG1lbWJlciBjcmVhdGVkIHRoZSByZWZlcnJhbCBjb2RlXG4gIC8vIChUaGlzIHdvdWxkIHJlcXVpcmUgdHJhY2tpbmcgd2hvIGNyZWF0ZWQgdGhlIGNvZGUgLSBzaW1wbGlmaWVkIGZvciBub3cpXG4gIC8vIEZvciBub3csIHN0YWZmIGNhbiBzZWUgYWxsIHJlZmVycmFscyBpbiB0aGVpciBwYXJ0bmVyXG4gIHJldHVybiB0cnVlXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBjYW4gYWNjZXNzIGEgdGVuYW50J3MgZGF0YVxuICogUGFydG5lciB1c2VycyBDQU5OT1QgYWNjZXNzIHRlbmFudCBpbnRlcm5hbHMgLSB0aGlzIGFsd2F5cyByZXR1cm5zIGZhbHNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5QYXJ0bmVyQWNjZXNzVGVuYW50SW50ZXJuYWxzKCk6IGJvb2xlYW4ge1xuICAvLyBQYXJ0bmVyIHVzZXJzIGNhbiBORVZFUiBhY2Nlc3MgdGVuYW50IGludGVybmFsc1xuICAvLyBUaGlzIGlzIGEgaGFyZCBib3VuZGFyeVxuICByZXR1cm4gZmFsc2Vcbn1cblxuLyoqXG4gKiBHZXQgdmlzaWJsZSB0ZW5hbnQgZGF0YSBmb3IgYSBwYXJ0bmVyIChsaW1pdGVkIHZpZXcpXG4gKiBQYXJ0bmVycyBjYW4gb25seSBzZWU6IHRlbmFudCBuYW1lLCBzdGF0dXMsIHNpZ251cCBkYXRlXG4gKiBQYXJ0bmVycyBDQU5OT1Qgc2VlOiB0ZW5hbnQgdXNlcnMsIHNldHRpbmdzLCBkb21haW5zLCBvciBhbnkgaW50ZXJuYWwgZGF0YVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRuZXJWaXNpYmxlVGVuYW50RGF0YSB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHNsdWc6IHN0cmluZ1xuICBzdGF0dXM6IHN0cmluZ1xuICBjcmVhdGVkQXQ6IERhdGVcbiAgLy8gU3Vic2NyaXB0aW9uIGluZm8gKHdoZW4gaW1wbGVtZW50ZWQpXG4gIC8vIFJldmVudWUgbWV0cmljcyAoYWdncmVnYXRlZCBvbmx5KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lclZpc2libGVUZW5hbnREYXRhKFxuICBwYXJ0bmVySWQ6IHN0cmluZyxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxQYXJ0bmVyVmlzaWJsZVRlbmFudERhdGEgfCBudWxsPiB7XG4gIC8vIEZpcnN0IHZlcmlmeSB0aGlzIHBhcnRuZXIgaGFzIGEgcmVmZXJyYWwgZm9yIHRoaXMgdGVuYW50XG4gIGNvbnN0IHJlZmVycmFsID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICB0ZW5hbnRJZFxuICAgIH1cbiAgfSlcbiAgXG4gIGlmICghcmVmZXJyYWwpIHtcbiAgICByZXR1cm4gbnVsbCAvLyBQYXJ0bmVyIGNhbm5vdCBzZWUgdGhpcyB0ZW5hbnRcbiAgfVxuICBcbiAgLy8gR2V0IGxpbWl0ZWQgdGVuYW50IGRhdGFcbiAgY29uc3QgdGVuYW50ID0gYXdhaXQgcHJpc21hLnRlbmFudC5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogdGVuYW50SWQgfSxcbiAgICBzZWxlY3Q6IHtcbiAgICAgIGlkOiB0cnVlLFxuICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgIHNsdWc6IHRydWUsXG4gICAgICBzdGF0dXM6IHRydWUsXG4gICAgICBjcmVhdGVkQXQ6IHRydWVcbiAgICAgIC8vIEV4cGxpY2l0bHkgTk9UIGluY2x1ZGluZzogZG9tYWlucywgbWVtYmVyc2hpcHMsIGJyYW5kaW5nIGRldGFpbHNcbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXRlbmFudCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgaWQ6IHRlbmFudC5pZCxcbiAgICBuYW1lOiB0ZW5hbnQubmFtZSxcbiAgICBzbHVnOiB0ZW5hbnQuc2x1ZyxcbiAgICBzdGF0dXM6IHRlbmFudC5zdGF0dXMsXG4gICAgY3JlYXRlZEF0OiB0ZW5hbnQuY3JlYXRlZEF0XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSEVMUEVSIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaGFzIGEgc3BlY2lmaWMgcGVybWlzc2lvblxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzUGFydG5lclBlcm1pc3Npb24oXG4gIHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyxcbiAgcGVybWlzc2lvbjoga2V5b2YgUGFydG5lclBlcm1pc3Npb25zXG4pOiBib29sZWFuIHtcbiAgY29uc3QgcGVybWlzc2lvbnMgPSBnZXRQYXJ0bmVyUGVybWlzc2lvbnMocm9sZSlcbiAgcmV0dXJuIHBlcm1pc3Npb25zW3Blcm1pc3Npb25dXG59XG5cbi8qKlxuICogQXNzZXJ0IGEgcGVybWlzc2lvbiBvciB0aHJvd1xuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0UGFydG5lclBlcm1pc3Npb24oXG4gIHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyxcbiAgcGVybWlzc2lvbjoga2V5b2YgUGFydG5lclBlcm1pc3Npb25zLFxuICBlcnJvck1lc3NhZ2U/OiBzdHJpbmdcbik6IHZvaWQge1xuICBpZiAoIWhhc1BhcnRuZXJQZXJtaXNzaW9uKHJvbGUsIHBlcm1pc3Npb24pKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSB8fCBgUGVybWlzc2lvbiBkZW5pZWQ6ICR7cGVybWlzc2lvbn1gKVxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiZ2V0Q3VycmVudFNlc3Npb24iLCJQQVJUTkVSX09XTkVSX1BFUk1JU1NJT05TIiwiY2FuVmlld1BhcnRuZXIiLCJjYW5FZGl0UGFydG5lciIsImNhbk1hbmFnZVBhcnRuZXJVc2VycyIsImNhblNpZ25BZ3JlZW1lbnQiLCJjYW5WaWV3UmVmZXJyYWxzIiwiY2FuQ3JlYXRlUmVmZXJyYWxDb2RlcyIsImNhblZpZXdBbGxSZWZlcnJhbHMiLCJjYW5WaWV3RWFybmluZ3MiLCJjYW5WaWV3QWxsRWFybmluZ3MiLCJjYW5FeHBvcnRFYXJuaW5ncyIsImNhblZpZXdBZ3JlZW1lbnQiLCJjYW5WaWV3QWdyZWVtZW50SGlzdG9yeSIsIlBBUlRORVJfU1RBRkZfUEVSTUlTU0lPTlMiLCJTVVBFUl9BRE1JTl9QRVJNSVNTSU9OUyIsImdldFBhcnRuZXJQZXJtaXNzaW9ucyIsInJvbGUiLCJnZXRQYXJ0bmVyTWVtYmVyc2hpcCIsInVzZXJJZCIsInBhcnRuZXJVc2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaW5jbHVkZSIsInBhcnRuZXIiLCJpc1BhcnRuZXJVc2VyIiwibWVtYmVyc2hpcCIsImdldFBhcnRuZXJBY2Nlc3NMZXZlbCIsInBhcnRuZXJJZCIsImdsb2JhbFJvbGUiLCJzZWxlY3QiLCJpc0FjdGl2ZSIsInJlcXVpcmVQYXJ0bmVyVXNlciIsInNlc3Npb24iLCJhdXRob3JpemVkIiwiZXJyb3IiLCJzdGF0dXMiLCJ1c2VyIiwiaWQiLCJyZXF1aXJlUGFydG5lck93bmVyIiwiYXV0aFJlc3VsdCIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzIiwicmVxdWlyZVBhcnRuZXJPd25lckFjY2VzcyIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzQnlTbHVnIiwic2x1ZyIsImNhbkFjY2Vzc1JlZmVycmFsIiwicGFydG5lclVzZXJJZCIsInJlZmVycmFsSWQiLCJyZWZlcnJhbCIsInBhcnRuZXJSZWZlcnJhbCIsInJlZmVycmFsQ29kZSIsIm1ldGFkYXRhIiwiY2FuUGFydG5lckFjY2Vzc1RlbmFudEludGVybmFscyIsImdldFBhcnRuZXJWaXNpYmxlVGVuYW50RGF0YSIsInRlbmFudElkIiwiZmluZEZpcnN0IiwidGVuYW50IiwibmFtZSIsImNyZWF0ZWRBdCIsImhhc1BhcnRuZXJQZXJtaXNzaW9uIiwicGVybWlzc2lvbiIsInBlcm1pc3Npb25zIiwiYXNzZXJ0UGFydG5lclBlcm1pc3Npb24iLCJlcnJvck1lc3NhZ2UiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/partner-authorization.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Faudit%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();