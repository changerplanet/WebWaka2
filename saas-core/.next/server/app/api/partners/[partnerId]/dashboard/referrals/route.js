"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/partners/[partnerId]/dashboard/referrals/route";
exports.ids = ["app/api/partners/[partnerId]/dashboard/referrals/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_partners_partnerId_dashboard_referrals_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/partners/[partnerId]/dashboard/referrals/route.ts */ \"(rsc)/./src/app/api/partners/[partnerId]/dashboard/referrals/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/partners/[partnerId]/dashboard/referrals/route\",\n        pathname: \"/api/partners/[partnerId]/dashboard/referrals\",\n        filename: \"route\",\n        bundlePath: \"app/api/partners/[partnerId]/dashboard/referrals/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/partners/[partnerId]/dashboard/referrals/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_partners_partnerId_dashboard_referrals_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/partners/[partnerId]/dashboard/referrals/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwYXJ0bmVycyUyRiU1QnBhcnRuZXJJZCU1RCUyRmRhc2hib2FyZCUyRnJlZmVycmFscyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcGFydG5lcnMlMkYlNUJwYXJ0bmVySWQlNUQlMkZkYXNoYm9hcmQlMkZyZWZlcnJhbHMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwYXJ0bmVycyUyRiU1QnBhcnRuZXJJZCU1RCUyRmRhc2hib2FyZCUyRnJlZmVycmFscyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNEI7QUFDekc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvPzRlOWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2FwcC9zYWFzLWNvcmUvc3JjL2FwcC9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vZGFzaGJvYXJkL3JlZmVycmFscy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vZGFzaGJvYXJkL3JlZmVycmFscy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3BhcnRuZXJzL1twYXJ0bmVySWRdL2Rhc2hib2FyZC9yZWZlcnJhbHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3BhcnRuZXJzL1twYXJ0bmVySWRdL2Rhc2hib2FyZC9yZWZlcnJhbHMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9kYXNoYm9hcmQvcmVmZXJyYWxzL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9kYXNoYm9hcmQvcmVmZXJyYWxzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/partners/[partnerId]/dashboard/referrals/route.ts":
/*!***********************************************************************!*\
  !*** ./src/app/api/partners/[partnerId]/dashboard/referrals/route.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_partner_dashboard__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/partner-dashboard */ \"(rsc)/./src/lib/partner-dashboard.ts\");\n/* harmony import */ var _lib_partner_authorization__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/partner-authorization */ \"(rsc)/./src/lib/partner-authorization.ts\");\n/**\n * Partner Referrals API\n * \n * GET /api/partners/[partnerId]/dashboard/referrals - Get referred tenants list\n * \n * Returns LIMITED tenant data only - no tenant internals.\n */ \n\n\nasync function GET(request, { params }) {\n    try {\n        const { partnerId } = await params;\n        // Verify partner access\n        const authResult = await (0,_lib_partner_authorization__WEBPACK_IMPORTED_MODULE_2__.requirePartnerAccess)(partnerId);\n        if (!authResult.authorized) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: authResult.error\n            }, {\n                status: authResult.status\n            });\n        }\n        // Parse query params\n        const { searchParams } = new URL(request.url);\n        const status = searchParams.get(\"status\")?.split(\",\").filter(Boolean);\n        const limit = parseInt(searchParams.get(\"limit\") || \"20\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        const sortBy = searchParams.get(\"sortBy\");\n        const sortOrder = searchParams.get(\"sortOrder\");\n        const result = await (0,_lib_partner_dashboard__WEBPACK_IMPORTED_MODULE_1__.getReferredTenants)(partnerId, {\n            status,\n            limit,\n            offset,\n            sortBy,\n            sortOrder\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            tenants: result.tenants,\n            total: result.total,\n            limit,\n            offset,\n            _notice: \"Limited tenant data only - no internal details exposed\"\n        });\n    } catch (error) {\n        console.error(\"Error fetching referrals:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9kYXNoYm9hcmQvcmVmZXJyYWxzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7Ozs7O0NBTUMsR0FFc0Q7QUFDSztBQUNNO0FBRTNELGVBQWVHLElBQ3BCQyxPQUFvQixFQUNwQixFQUFFQyxNQUFNLEVBQThDO0lBRXRELElBQUk7UUFDRixNQUFNLEVBQUVDLFNBQVMsRUFBRSxHQUFHLE1BQU1EO1FBRTVCLHdCQUF3QjtRQUN4QixNQUFNRSxhQUFhLE1BQU1MLGdGQUFvQkEsQ0FBQ0k7UUFDOUMsSUFBSSxDQUFDQyxXQUFXQyxVQUFVLEVBQUU7WUFDMUIsT0FBT1IscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU9ILFdBQVdHLEtBQUs7WUFBQyxHQUMxQjtnQkFBRUMsUUFBUUosV0FBV0ksTUFBTTtZQUFDO1FBRWhDO1FBRUEscUJBQXFCO1FBQ3JCLE1BQU0sRUFBRUMsWUFBWSxFQUFFLEdBQUcsSUFBSUMsSUFBSVQsUUFBUVUsR0FBRztRQUM1QyxNQUFNSCxTQUFTQyxhQUFhRyxHQUFHLENBQUMsV0FBV0MsTUFBTSxLQUFLQyxPQUFPQztRQUM3RCxNQUFNQyxRQUFRQyxTQUFTUixhQUFhRyxHQUFHLENBQUMsWUFBWTtRQUNwRCxNQUFNTSxTQUFTRCxTQUFTUixhQUFhRyxHQUFHLENBQUMsYUFBYTtRQUN0RCxNQUFNTyxTQUFTVixhQUFhRyxHQUFHLENBQUM7UUFDaEMsTUFBTVEsWUFBWVgsYUFBYUcsR0FBRyxDQUFDO1FBRW5DLE1BQU1TLFNBQVMsTUFBTXZCLDBFQUFrQkEsQ0FBQ0ssV0FBVztZQUNqREs7WUFDQVE7WUFDQUU7WUFDQUM7WUFDQUM7UUFDRjtRQUVBLE9BQU92QixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQ3ZCZ0IsU0FBU0QsT0FBT0MsT0FBTztZQUN2QkMsT0FBT0YsT0FBT0UsS0FBSztZQUNuQlA7WUFDQUU7WUFDQU0sU0FBUztRQUNYO0lBRUYsRUFBRSxPQUFPakIsT0FBTztRQUNka0IsUUFBUWxCLEtBQUssQ0FBQyw2QkFBNkJBO1FBQzNDLE9BQU9WLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQUVDLE9BQU87UUFBd0IsR0FDakM7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvYXBwL2FwaS9wYXJ0bmVycy9bcGFydG5lcklkXS9kYXNoYm9hcmQvcmVmZXJyYWxzL3JvdXRlLnRzP2U5OGQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQYXJ0bmVyIFJlZmVycmFscyBBUElcbiAqIFxuICogR0VUIC9hcGkvcGFydG5lcnMvW3BhcnRuZXJJZF0vZGFzaGJvYXJkL3JlZmVycmFscyAtIEdldCByZWZlcnJlZCB0ZW5hbnRzIGxpc3RcbiAqIFxuICogUmV0dXJucyBMSU1JVEVEIHRlbmFudCBkYXRhIG9ubHkgLSBubyB0ZW5hbnQgaW50ZXJuYWxzLlxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGdldFJlZmVycmVkVGVuYW50cyB9IGZyb20gJ0AvbGliL3BhcnRuZXItZGFzaGJvYXJkJ1xuaW1wb3J0IHsgcmVxdWlyZVBhcnRuZXJBY2Nlc3MgfSBmcm9tICdAL2xpYi9wYXJ0bmVyLWF1dGhvcml6YXRpb24nXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogUHJvbWlzZTx7IHBhcnRuZXJJZDogc3RyaW5nIH0+IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcGFydG5lcklkIH0gPSBhd2FpdCBwYXJhbXNcbiAgICBcbiAgICAvLyBWZXJpZnkgcGFydG5lciBhY2Nlc3NcbiAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZVBhcnRuZXJBY2Nlc3MocGFydG5lcklkKVxuICAgIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IGF1dGhSZXN1bHQuZXJyb3IgfSxcbiAgICAgICAgeyBzdGF0dXM6IGF1dGhSZXN1bHQuc3RhdHVzIH1cbiAgICAgIClcbiAgICB9XG4gICAgXG4gICAgLy8gUGFyc2UgcXVlcnkgcGFyYW1zXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3Qgc3RhdHVzID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhdHVzJyk/LnNwbGl0KCcsJykuZmlsdGVyKEJvb2xlYW4pXG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICcyMCcpXG4gICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnb2Zmc2V0JykgfHwgJzAnKVxuICAgIGNvbnN0IHNvcnRCeSA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NvcnRCeScpIGFzICdyZWZlcnJlZEF0JyB8ICdyZXZlbnVlJyB8IHVuZGVmaW5lZFxuICAgIGNvbnN0IHNvcnRPcmRlciA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NvcnRPcmRlcicpIGFzICdhc2MnIHwgJ2Rlc2MnIHwgdW5kZWZpbmVkXG4gICAgXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVmZXJyZWRUZW5hbnRzKHBhcnRuZXJJZCwge1xuICAgICAgc3RhdHVzLFxuICAgICAgbGltaXQsXG4gICAgICBvZmZzZXQsXG4gICAgICBzb3J0QnksXG4gICAgICBzb3J0T3JkZXJcbiAgICB9KVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICB0ZW5hbnRzOiByZXN1bHQudGVuYW50cyxcbiAgICAgIHRvdGFsOiByZXN1bHQudG90YWwsXG4gICAgICBsaW1pdCxcbiAgICAgIG9mZnNldCxcbiAgICAgIF9ub3RpY2U6ICdMaW1pdGVkIHRlbmFudCBkYXRhIG9ubHkgLSBubyBpbnRlcm5hbCBkZXRhaWxzIGV4cG9zZWQnXG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyByZWZlcnJhbHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFJlZmVycmVkVGVuYW50cyIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsInBhcnRuZXJJZCIsImF1dGhSZXN1bHQiLCJhdXRob3JpemVkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwiZ2V0Iiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGltaXQiLCJwYXJzZUludCIsIm9mZnNldCIsInNvcnRCeSIsInNvcnRPcmRlciIsInJlc3VsdCIsInRlbmFudHMiLCJ0b3RhbCIsIl9ub3RpY2UiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/partners/[partnerId]/dashboard/referrals/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMagicLink: () => (/* binding */ createMagicLink),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getCurrentSession: () => (/* binding */ getCurrentSession),\n/* harmony export */   getSessionByToken: () => (/* binding */ getSessionByToken),\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   isTenantAdmin: () => (/* binding */ isTenantAdmin),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   switchTenant: () => (/* binding */ switchTenant),\n/* harmony export */   verifyMagicLink: () => (/* binding */ verifyMagicLink)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n// Token expiration times\nconst MAGIC_LINK_EXPIRY_MINUTES = 15;\nconst SESSION_EXPIRY_DAYS = 7;\n/**\n * Generate a secure random token\n */ function generateToken() {\n    return (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])() + \"-\" + (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n}\n/**\n * Create a magic link for a user\n * If user doesn't exist, creates them\n */ async function createMagicLink(email, tenantId) {\n    const normalizedEmail = email.toLowerCase().trim();\n    // Find or create user\n    let user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            email: normalizedEmail\n        }\n    });\n    if (!user) {\n        user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                email: normalizedEmail,\n                globalRole: \"USER\"\n            }\n        });\n    }\n    // Generate token\n    const token = generateToken();\n    const expiresAt = new Date();\n    expiresAt.setMinutes(expiresAt.getMinutes() + MAGIC_LINK_EXPIRY_MINUTES);\n    // Create magic link record\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            token,\n            userId: user.id,\n            tenantId: tenantId || null,\n            expiresAt\n        }\n    });\n    return {\n        token,\n        user\n    };\n}\n/**\n * Verify and consume a magic link\n * Returns user and creates session if valid\n */ async function verifyMagicLink(token) {\n    // Find the magic link\n    const magicLink = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: true\n        }\n    });\n    if (!magicLink) {\n        return null;\n    }\n    // Check if expired\n    if (magicLink.expiresAt < new Date()) {\n        // Delete expired token\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.delete({\n            where: {\n                id: magicLink.id\n            }\n        });\n        return null;\n    }\n    // Check if already used\n    if (magicLink.usedAt) {\n        return null;\n    }\n    // Mark as used\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.magicLink.update({\n        where: {\n            id: magicLink.id\n        },\n        data: {\n            usedAt: new Date()\n        }\n    });\n    // Update user's last login\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n        where: {\n            id: magicLink.userId\n        },\n        data: {\n            lastLoginAt: new Date()\n        }\n    });\n    // Create session\n    const sessionToken = generateToken();\n    const sessionExpiresAt = new Date();\n    sessionExpiresAt.setDate(sessionExpiresAt.getDate() + SESSION_EXPIRY_DAYS);\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.create({\n        data: {\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            userId: magicLink.userId,\n            token: sessionToken,\n            activeTenant: magicLink.tenantId,\n            expiresAt: sessionExpiresAt\n        }\n    });\n    // Get user with memberships\n    const user = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            id: magicLink.userId\n        },\n        include: {\n            memberships: {\n                where: {\n                    isActive: true\n                },\n                include: {\n                    tenant: true\n                }\n            }\n        }\n    });\n    return {\n        user: user,\n        session: {\n            id: session.id,\n            token: sessionToken\n        },\n        tenantId: magicLink.tenantId\n    };\n}\n/**\n * Get session from token\n */ async function getSessionByToken(token) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: {\n                        where: {\n                            isActive: true\n                        },\n                        include: {\n                            tenant: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    // Check if expired\n    if (session.expiresAt < new Date()) {\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.delete({\n            where: {\n                id: session.id\n            }\n        });\n        return null;\n    }\n    // Update last active\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            lastActiveAt: new Date()\n        }\n    });\n    return {\n        user: session.user,\n        sessionId: session.id,\n        activeTenantId: session.activeTenant\n    };\n}\n/**\n * Get current session from cookies\n */ async function getCurrentSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (!sessionToken) {\n        return null;\n    }\n    return getSessionByToken(sessionToken);\n}\n/**\n * Set session cookie\n */ async function setSessionCookie(token) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    cookieStore.set(\"session_token\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: SESSION_EXPIRY_DAYS * 24 * 60 * 60,\n        path: \"/\"\n    });\n}\n/**\n * Clear session cookie and delete session\n */ async function logout() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const sessionToken = cookieStore.get(\"session_token\")?.value;\n    if (sessionToken) {\n        // Delete session from database\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.deleteMany({\n            where: {\n                token: sessionToken\n            }\n        });\n    }\n    // Clear cookie\n    cookieStore.delete(\"session_token\");\n}\n/**\n * Switch active tenant for a session\n */ async function switchTenant(sessionToken, tenantId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            token: sessionToken\n        },\n        include: {\n            user: {\n                include: {\n                    memberships: true\n                }\n            }\n        }\n    });\n    if (!session) return false;\n    // Check if user has access to this tenant\n    const hasMembership = session.user.memberships.some((m)=>m.tenantId === tenantId && m.isActive);\n    // Super admins can access any tenant\n    const isSuperAdmin = session.user.globalRole === \"SUPER_ADMIN\";\n    if (!hasMembership && !isSuperAdmin) {\n        return false;\n    }\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            activeTenant: tenantId\n        }\n    });\n    return true;\n}\n/**\n * Check if user is Super Admin\n */ function isSuperAdmin(user) {\n    return user.globalRole === \"SUPER_ADMIN\";\n}\n/**\n * Check if user is Tenant Admin for a specific tenant\n */ async function isTenantAdmin(userId, tenantId) {\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.tenantMembership.findUnique({\n        where: {\n            userId_tenantId: {\n                userId,\n                tenantId\n            }\n        }\n    });\n    return membership?.role === \"TENANT_ADMIN\" && membership.isActive;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YTtRQUFhO1FBQzdCTCxTQUFTO1lBQUVmLE1BQU07Z0JBQUVlLFNBQVM7b0JBQUVXLGFBQWE7Z0JBQUs7WUFBRTtRQUFFO0lBQ3REO0lBRUEsSUFBSSxDQUFDRixTQUFTLE9BQU87SUFFckIsMENBQTBDO0lBQzFDLE1BQU13QixnQkFBZ0J4QixRQUFReEIsSUFBSSxDQUFDMEIsV0FBVyxDQUFDdUIsSUFBSSxDQUNqREMsQ0FBQUEsSUFBS0EsRUFBRXRELFFBQVEsS0FBS0EsWUFBWXNELEVBQUV2QixRQUFRO0lBRzVDLHFDQUFxQztJQUNyQyxNQUFNd0IsZUFBZTNCLFFBQVF4QixJQUFJLENBQUNNLFVBQVUsS0FBSztJQUVqRCxJQUFJLENBQUMwQyxpQkFBaUIsQ0FBQ0csY0FBYztRQUNuQyxPQUFPO0lBQ1Q7SUFFQSxNQUFNaEUsMkNBQU1BLENBQUNxQyxPQUFPLENBQUNOLE1BQU0sQ0FBQztRQUMxQmhCLE9BQU87WUFBRUcsSUFBSW1CLFFBQVFuQixFQUFFO1FBQUM7UUFDeEJELE1BQU07WUFBRXFCLGNBQWM3QjtRQUFTO0lBQ2pDO0lBRUEsT0FBTztBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTdUQsYUFBYW5ELElBQVU7SUFDckMsT0FBT0EsS0FBS00sVUFBVSxLQUFLO0FBQzdCO0FBRUE7O0NBRUMsR0FDTSxlQUFlOEMsY0FBY3ZDLE1BQWMsRUFBRWpCLFFBQWdCO0lBQ2xFLE1BQU15RCxhQUFhLE1BQU1sRSwyQ0FBTUEsQ0FBQ21FLGdCQUFnQixDQUFDckQsVUFBVSxDQUFDO1FBQzFEQyxPQUFPO1lBQ0xxRCxpQkFBaUI7Z0JBQUUxQztnQkFBUWpCO1lBQVM7UUFDdEM7SUFDRjtJQUVBLE9BQU95RCxZQUFZRyxTQUFTLGtCQUFrQkgsV0FBVzFCLFFBQVE7QUFDbkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSdcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgVXNlciwgR2xvYmFsUm9sZSwgVGVuYW50Um9sZSwgVGVuYW50LCBUZW5hbnRNZW1iZXJzaGlwIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vIFRva2VuIGV4cGlyYXRpb24gdGltZXNcbmNvbnN0IE1BR0lDX0xJTktfRVhQSVJZX01JTlVURVMgPSAxNVxuY29uc3QgU0VTU0lPTl9FWFBJUllfREFZUyA9IDdcblxuLy8gVHlwZXNcbmV4cG9ydCB0eXBlIFNlc3Npb25Vc2VyID0gVXNlciAmIHtcbiAgbWVtYmVyc2hpcHM6IChUZW5hbnRNZW1iZXJzaGlwICYge1xuICAgIHRlbmFudDogVGVuYW50XG4gIH0pW11cbn1cblxuZXhwb3J0IHR5cGUgQXV0aFNlc3Npb24gPSB7XG4gIHVzZXI6IFNlc3Npb25Vc2VyXG4gIHNlc3Npb25JZDogc3RyaW5nXG4gIGFjdGl2ZVRlbmFudElkOiBzdHJpbmcgfCBudWxsXG59XG5cbi8qKlxuICogR2VuZXJhdGUgYSBzZWN1cmUgcmFuZG9tIHRva2VuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKCk6IHN0cmluZyB7XG4gIHJldHVybiB1dWlkdjQoKSArICctJyArIHV1aWR2NCgpXG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbWFnaWMgbGluayBmb3IgYSB1c2VyXG4gKiBJZiB1c2VyIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZXMgdGhlbVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTWFnaWNMaW5rKGVtYWlsOiBzdHJpbmcsIHRlbmFudElkPzogc3RyaW5nKTogUHJvbWlzZTx7IHRva2VuOiBzdHJpbmc7IHVzZXI6IFVzZXIgfT4ge1xuICBjb25zdCBub3JtYWxpemVkRW1haWwgPSBlbWFpbC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICBcbiAgLy8gRmluZCBvciBjcmVhdGUgdXNlclxuICBsZXQgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGVtYWlsOiBub3JtYWxpemVkRW1haWwgfVxuICB9KVxuICBcbiAgaWYgKCF1c2VyKSB7XG4gICAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgZW1haWw6IG5vcm1hbGl6ZWRFbWFpbCxcbiAgICAgICAgZ2xvYmFsUm9sZTogJ1VTRVInXG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gR2VuZXJhdGUgdG9rZW5cbiAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZVRva2VuKClcbiAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoKVxuICBleHBpcmVzQXQuc2V0TWludXRlcyhleHBpcmVzQXQuZ2V0TWludXRlcygpICsgTUFHSUNfTElOS19FWFBJUllfTUlOVVRFUylcbiAgXG4gIC8vIENyZWF0ZSBtYWdpYyBsaW5rIHJlY29yZFxuICBhd2FpdCBwcmlzbWEubWFnaWNMaW5rLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgdG9rZW4sXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICB0ZW5hbnRJZDogdGVuYW50SWQgfHwgbnVsbCxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH1cbiAgfSlcbiAgXG4gIHJldHVybiB7IHRva2VuLCB1c2VyIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgYW5kIGNvbnN1bWUgYSBtYWdpYyBsaW5rXG4gKiBSZXR1cm5zIHVzZXIgYW5kIGNyZWF0ZXMgc2Vzc2lvbiBpZiB2YWxpZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWFnaWNMaW5rKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHsgdXNlcjogU2Vzc2lvblVzZXI7IHNlc3Npb246IHsgaWQ6IHN0cmluZzsgdG9rZW46IHN0cmluZyB9OyB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCB9IHwgbnVsbD4ge1xuICAvLyBGaW5kIHRoZSBtYWdpYyBsaW5rXG4gIGNvbnN0IG1hZ2ljTGluayA9IGF3YWl0IHByaXNtYS5tYWdpY0xpbmsuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7IHVzZXI6IHRydWUgfVxuICB9KVxuICBcbiAgaWYgKCFtYWdpY0xpbmspIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChtYWdpY0xpbmsuZXhwaXJlc0F0IDwgbmV3IERhdGUoKSkge1xuICAgIC8vIERlbGV0ZSBleHBpcmVkIHRva2VuXG4gICAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay5kZWxldGUoeyB3aGVyZTogeyBpZDogbWFnaWNMaW5rLmlkIH0gfSlcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBhbHJlYWR5IHVzZWRcbiAgaWYgKG1hZ2ljTGluay51c2VkQXQpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBNYXJrIGFzIHVzZWRcbiAgYXdhaXQgcHJpc21hLm1hZ2ljTGluay51cGRhdGUoe1xuICAgIHdoZXJlOiB7IGlkOiBtYWdpY0xpbmsuaWQgfSxcbiAgICBkYXRhOiB7IHVzZWRBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICAvLyBVcGRhdGUgdXNlcidzIGxhc3QgbG9naW5cbiAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGRhdGE6IHsgbGFzdExvZ2luQXQ6IG5ldyBEYXRlKCkgfVxuICB9KVxuICBcbiAgLy8gQ3JlYXRlIHNlc3Npb25cbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2VuZXJhdGVUb2tlbigpXG4gIGNvbnN0IHNlc3Npb25FeHBpcmVzQXQgPSBuZXcgRGF0ZSgpXG4gIHNlc3Npb25FeHBpcmVzQXQuc2V0RGF0ZShzZXNzaW9uRXhwaXJlc0F0LmdldERhdGUoKSArIFNFU1NJT05fRVhQSVJZX0RBWVMpXG4gIFxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBpZDogdXVpZHY0KCksXG4gICAgICB1c2VySWQ6IG1hZ2ljTGluay51c2VySWQsXG4gICAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxuICAgICAgYWN0aXZlVGVuYW50OiBtYWdpY0xpbmsudGVuYW50SWQsXG4gICAgICBleHBpcmVzQXQ6IHNlc3Npb25FeHBpcmVzQXRcbiAgICB9XG4gIH0pXG4gIFxuICAvLyBHZXQgdXNlciB3aXRoIG1lbWJlcnNoaXBzXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogbWFnaWNMaW5rLnVzZXJJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHVzZXIgYXMgU2Vzc2lvblVzZXIsXG4gICAgc2Vzc2lvbjogeyBpZDogc2Vzc2lvbi5pZCwgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIHRlbmFudElkOiBtYWdpY0xpbmsudGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEdldCBzZXNzaW9uIGZyb20gdG9rZW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25CeVRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPEF1dGhTZXNzaW9uIHwgbnVsbD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBtZW1iZXJzaGlwczoge1xuICAgICAgICAgICAgd2hlcmU6IHsgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgdGVuYW50OiB0cnVlIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBDaGVjayBpZiBleHBpcmVkXG4gIGlmIChzZXNzaW9uLmV4cGlyZXNBdCA8IG5ldyBEYXRlKCkpIHtcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGUoeyB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9IH0pXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuICBcbiAgLy8gVXBkYXRlIGxhc3QgYWN0aXZlXG4gIGF3YWl0IHByaXNtYS5zZXNzaW9uLnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHNlc3Npb24uaWQgfSxcbiAgICBkYXRhOiB7IGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKSB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHVzZXI6IHNlc3Npb24udXNlciBhcyBTZXNzaW9uVXNlcixcbiAgICBzZXNzaW9uSWQ6IHNlc3Npb24uaWQsXG4gICAgYWN0aXZlVGVuYW50SWQ6IHNlc3Npb24uYWN0aXZlVGVuYW50XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCBzZXNzaW9uIGZyb20gY29va2llc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFNlc3Npb24oKTogUHJvbWlzZTxBdXRoU2Vzc2lvbiB8IG51bGw+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gY29va2llU3RvcmUuZ2V0KCdzZXNzaW9uX3Rva2VuJyk/LnZhbHVlXG4gIFxuICBpZiAoIXNlc3Npb25Ub2tlbikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgXG4gIHJldHVybiBnZXRTZXNzaW9uQnlUb2tlbihzZXNzaW9uVG9rZW4pXG59XG5cbi8qKlxuICogU2V0IHNlc3Npb24gY29va2llXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgY29va2llU3RvcmUuc2V0KCdzZXNzaW9uX3Rva2VuJywgdG9rZW4sIHtcbiAgICBodHRwT25seTogdHJ1ZSxcbiAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgIG1heEFnZTogU0VTU0lPTl9FWFBJUllfREFZUyAqIDI0ICogNjAgKiA2MCwgLy8gZGF5cyB0byBzZWNvbmRzXG4gICAgcGF0aDogJy8nXG4gIH0pXG59XG5cbi8qKlxuICogQ2xlYXIgc2Vzc2lvbiBjb29raWUgYW5kIGRlbGV0ZSBzZXNzaW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dvdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGNvb2tpZVN0b3JlLmdldCgnc2Vzc2lvbl90b2tlbicpPy52YWx1ZVxuICBcbiAgaWYgKHNlc3Npb25Ub2tlbikge1xuICAgIC8vIERlbGV0ZSBzZXNzaW9uIGZyb20gZGF0YWJhc2VcbiAgICBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5kZWxldGVNYW55KHtcbiAgICAgIHdoZXJlOiB7IHRva2VuOiBzZXNzaW9uVG9rZW4gfVxuICAgIH0pXG4gIH1cbiAgXG4gIC8vIENsZWFyIGNvb2tpZVxuICBjb29raWVTdG9yZS5kZWxldGUoJ3Nlc3Npb25fdG9rZW4nKVxufVxuXG4vKipcbiAqIFN3aXRjaCBhY3RpdmUgdGVuYW50IGZvciBhIHNlc3Npb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN3aXRjaFRlbmFudChzZXNzaW9uVG9rZW46IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgdG9rZW46IHNlc3Npb25Ub2tlbiB9LFxuICAgIGluY2x1ZGU6IHsgdXNlcjogeyBpbmNsdWRlOiB7IG1lbWJlcnNoaXBzOiB0cnVlIH0gfSB9XG4gIH0pXG4gIFxuICBpZiAoIXNlc3Npb24pIHJldHVybiBmYWxzZVxuICBcbiAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWNjZXNzIHRvIHRoaXMgdGVuYW50XG4gIGNvbnN0IGhhc01lbWJlcnNoaXAgPSBzZXNzaW9uLnVzZXIubWVtYmVyc2hpcHMuc29tZShcbiAgICBtID0+IG0udGVuYW50SWQgPT09IHRlbmFudElkICYmIG0uaXNBY3RpdmVcbiAgKVxuICBcbiAgLy8gU3VwZXIgYWRtaW5zIGNhbiBhY2Nlc3MgYW55IHRlbmFudFxuICBjb25zdCBpc1N1cGVyQWRtaW4gPSBzZXNzaW9uLnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJ1xuICBcbiAgaWYgKCFoYXNNZW1iZXJzaGlwICYmICFpc1N1cGVyQWRtaW4pIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBcbiAgYXdhaXQgcHJpc21hLnNlc3Npb24udXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogc2Vzc2lvbi5pZCB9LFxuICAgIGRhdGE6IHsgYWN0aXZlVGVuYW50OiB0ZW5hbnRJZCB9XG4gIH0pXG4gIFxuICByZXR1cm4gdHJ1ZVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgU3VwZXIgQWRtaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU3VwZXJBZG1pbih1c2VyOiBVc2VyKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VyLmdsb2JhbFJvbGUgPT09ICdTVVBFUl9BRE1JTidcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB1c2VyIGlzIFRlbmFudCBBZG1pbiBmb3IgYSBzcGVjaWZpYyB0ZW5hbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzVGVuYW50QWRtaW4odXNlcklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF3YWl0IHByaXNtYS50ZW5hbnRNZW1iZXJzaGlwLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7XG4gICAgICB1c2VySWRfdGVuYW50SWQ6IHsgdXNlcklkLCB0ZW5hbnRJZCB9XG4gICAgfVxuICB9KVxuICBcbiAgcmV0dXJuIG1lbWJlcnNoaXA/LnJvbGUgPT09ICdURU5BTlRfQURNSU4nICYmIG1lbWJlcnNoaXAuaXNBY3RpdmVcbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJ2NCIsInV1aWR2NCIsImNvb2tpZXMiLCJNQUdJQ19MSU5LX0VYUElSWV9NSU5VVEVTIiwiU0VTU0lPTl9FWFBJUllfREFZUyIsImdlbmVyYXRlVG9rZW4iLCJjcmVhdGVNYWdpY0xpbmsiLCJlbWFpbCIsInRlbmFudElkIiwibm9ybWFsaXplZEVtYWlsIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImNyZWF0ZSIsImRhdGEiLCJpZCIsImdsb2JhbFJvbGUiLCJ0b2tlbiIsImV4cGlyZXNBdCIsIkRhdGUiLCJzZXRNaW51dGVzIiwiZ2V0TWludXRlcyIsIm1hZ2ljTGluayIsInVzZXJJZCIsInZlcmlmeU1hZ2ljTGluayIsImluY2x1ZGUiLCJkZWxldGUiLCJ1c2VkQXQiLCJ1cGRhdGUiLCJsYXN0TG9naW5BdCIsInNlc3Npb25Ub2tlbiIsInNlc3Npb25FeHBpcmVzQXQiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNlc3Npb24iLCJhY3RpdmVUZW5hbnQiLCJtZW1iZXJzaGlwcyIsImlzQWN0aXZlIiwidGVuYW50IiwiZ2V0U2Vzc2lvbkJ5VG9rZW4iLCJsYXN0QWN0aXZlQXQiLCJzZXNzaW9uSWQiLCJhY3RpdmVUZW5hbnRJZCIsImdldEN1cnJlbnRTZXNzaW9uIiwiY29va2llU3RvcmUiLCJnZXQiLCJ2YWx1ZSIsInNldFNlc3Npb25Db29raWUiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJsb2dvdXQiLCJkZWxldGVNYW55Iiwic3dpdGNoVGVuYW50IiwiaGFzTWVtYmVyc2hpcCIsInNvbWUiLCJtIiwiaXNTdXBlckFkbWluIiwiaXNUZW5hbnRBZG1pbiIsIm1lbWJlcnNoaXAiLCJ0ZW5hbnRNZW1iZXJzaGlwIiwidXNlcklkX3RlbmFudElkIiwicm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/partner-authorization.ts":
/*!******************************************!*\
  !*** ./src/lib/partner-authorization.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertPartnerPermission: () => (/* binding */ assertPartnerPermission),\n/* harmony export */   canAccessReferral: () => (/* binding */ canAccessReferral),\n/* harmony export */   canPartnerAccessTenantInternals: () => (/* binding */ canPartnerAccessTenantInternals),\n/* harmony export */   getPartnerAccessLevel: () => (/* binding */ getPartnerAccessLevel),\n/* harmony export */   getPartnerMembership: () => (/* binding */ getPartnerMembership),\n/* harmony export */   getPartnerPermissions: () => (/* binding */ getPartnerPermissions),\n/* harmony export */   getPartnerVisibleTenantData: () => (/* binding */ getPartnerVisibleTenantData),\n/* harmony export */   hasPartnerPermission: () => (/* binding */ hasPartnerPermission),\n/* harmony export */   isPartnerUser: () => (/* binding */ isPartnerUser),\n/* harmony export */   requirePartnerAccess: () => (/* binding */ requirePartnerAccess),\n/* harmony export */   requirePartnerAccessBySlug: () => (/* binding */ requirePartnerAccessBySlug),\n/* harmony export */   requirePartnerOwner: () => (/* binding */ requirePartnerOwner),\n/* harmony export */   requirePartnerOwnerAccess: () => (/* binding */ requirePartnerOwnerAccess),\n/* harmony export */   requirePartnerUser: () => (/* binding */ requirePartnerUser)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/auth.ts\");\n/**\n * Partner Authorization\n * \n * Access control for Partner domain - completely separate from Tenant authorization.\n * Partner users CANNOT access tenant internals.\n * Partner users can ONLY see their own partner's data.\n * \n * Role Hierarchy:\n * - SUPER_ADMIN: Platform-wide access to all partners\n * - PARTNER_OWNER: Full control within their partner organization\n * - PARTNER_STAFF: Limited access within their partner organization\n */ \n\n// ============================================================================\n// ROLE DEFINITIONS\n// ============================================================================\n/**\n * PARTNER_OWNER Permissions\n * - Full control over partner organization\n * - Can manage users, sign agreements, view all data\n * - CANNOT access tenant internals\n */ const PARTNER_OWNER_PERMISSIONS = {\n    // Partner Management\n    canViewPartner: true,\n    canEditPartner: true,\n    canManagePartnerUsers: true,\n    canSignAgreement: true,\n    // Referral Management\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: true,\n    // Earnings\n    canViewEarnings: true,\n    canViewAllEarnings: true,\n    canExportEarnings: true,\n    // Agreement\n    canViewAgreement: true,\n    canViewAgreementHistory: true\n};\n/**\n * PARTNER_STAFF Permissions\n * - Limited access within partner organization\n * - Can view referrals and earnings, create codes\n * - CANNOT manage users or sign agreements\n * - CANNOT access tenant internals\n */ const PARTNER_STAFF_PERMISSIONS = {\n    // Partner Management\n    canViewPartner: true,\n    canEditPartner: false,\n    canManagePartnerUsers: false,\n    canSignAgreement: false,\n    // Referral Management\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: false,\n    // Earnings\n    canViewEarnings: true,\n    canViewAllEarnings: false,\n    canExportEarnings: false,\n    // Agreement\n    canViewAgreement: true,\n    canViewAgreementHistory: false\n};\n/**\n * SUPER_ADMIN Permissions (platform-wide)\n * - Can access all partners\n * - Full permissions on any partner\n */ const SUPER_ADMIN_PERMISSIONS = {\n    canViewPartner: true,\n    canEditPartner: true,\n    canManagePartnerUsers: true,\n    canSignAgreement: false,\n    canViewReferrals: true,\n    canCreateReferralCodes: true,\n    canViewAllReferrals: true,\n    canViewEarnings: true,\n    canViewAllEarnings: true,\n    canExportEarnings: true,\n    canViewAgreement: true,\n    canViewAgreementHistory: true\n};\n/**\n * Get permissions for a role\n */ function getPartnerPermissions(role) {\n    switch(role){\n        case \"SUPER_ADMIN\":\n            return SUPER_ADMIN_PERMISSIONS;\n        case \"PARTNER_OWNER\":\n            return PARTNER_OWNER_PERMISSIONS;\n        case \"PARTNER_STAFF\":\n            return PARTNER_STAFF_PERMISSIONS;\n        default:\n            // No permissions for unknown roles\n            return {\n                canViewPartner: false,\n                canEditPartner: false,\n                canManagePartnerUsers: false,\n                canSignAgreement: false,\n                canViewReferrals: false,\n                canCreateReferralCodes: false,\n                canViewAllReferrals: false,\n                canViewEarnings: false,\n                canViewAllEarnings: false,\n                canExportEarnings: false,\n                canViewAgreement: false,\n                canViewAgreementHistory: false\n            };\n    }\n}\n// ============================================================================\n// ACCESS BOUNDARY ENFORCEMENT\n// ============================================================================\n/**\n * Get user's partner membership (if any)\n */ async function getPartnerMembership(userId) {\n    return _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        },\n        include: {\n            partner: true\n        }\n    });\n}\n/**\n * Check if user is a partner user\n */ async function isPartnerUser(userId) {\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        }\n    });\n    return !!membership;\n}\n/**\n * Get user's access level for a specific partner\n */ async function getPartnerAccessLevel(userId, partnerId, globalRole) {\n    // Super Admin has full access\n    if (globalRole === \"SUPER_ADMIN\") {\n        return \"SUPER_ADMIN\";\n    }\n    // Check partner membership\n    const membership = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId\n        },\n        select: {\n            partnerId: true,\n            role: true,\n            isActive: true\n        }\n    });\n    // Not a partner user or not active\n    if (!membership || !membership.isActive) {\n        return \"NONE\";\n    }\n    // Not a member of this specific partner\n    if (membership.partnerId !== partnerId) {\n        return \"NONE\";\n    }\n    // Return role-based access level\n    return membership.role === \"PARTNER_OWNER\" ? \"OWNER\" : \"STAFF\";\n}\n// ============================================================================\n// AUTHORIZATION FUNCTIONS\n// ============================================================================\n/**\n * Require any authenticated user who is a partner user\n */ async function requirePartnerUser() {\n    const session = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getCurrentSession)();\n    if (!session) {\n        return {\n            authorized: false,\n            error: \"Authentication required\",\n            status: 401\n        };\n    }\n    if (!session.user.isActive) {\n        return {\n            authorized: false,\n            error: \"Account is disabled\",\n            status: 403\n        };\n    }\n    // Get partner membership\n    const partnerUser = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId: session.user.id\n        },\n        include: {\n            partner: true\n        }\n    });\n    if (!partnerUser) {\n        return {\n            authorized: false,\n            error: \"Not a partner user\",\n            status: 403\n        };\n    }\n    if (!partnerUser.isActive) {\n        return {\n            authorized: false,\n            error: \"Partner membership is disabled\",\n            status: 403\n        };\n    }\n    if (partnerUser.partner.status !== \"ACTIVE\") {\n        return {\n            authorized: false,\n            error: \"Partner organization is not active\",\n            status: 403\n        };\n    }\n    return {\n        authorized: true,\n        user: session.user,\n        session,\n        partner: partnerUser.partner,\n        partnerUser,\n        role: partnerUser.role\n    };\n}\n/**\n * Require PARTNER_OWNER role\n */ async function requirePartnerOwner() {\n    const authResult = await requirePartnerUser();\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    if (authResult.role !== \"PARTNER_OWNER\") {\n        return {\n            authorized: false,\n            error: \"Partner Owner access required\",\n            status: 403\n        };\n    }\n    return authResult;\n}\n/**\n * Require access to a specific partner by ID\n */ async function requirePartnerAccess(partnerId) {\n    const session = await (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getCurrentSession)();\n    if (!session) {\n        return {\n            authorized: false,\n            error: \"Authentication required\",\n            status: 401\n        };\n    }\n    if (!session.user.isActive) {\n        return {\n            authorized: false,\n            error: \"Account is disabled\",\n            status: 403\n        };\n    }\n    // Super Admin can access any partner\n    if (session.user.globalRole === \"SUPER_ADMIN\") {\n        const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n            where: {\n                id: partnerId\n            }\n        });\n        if (!partner) {\n            return {\n                authorized: false,\n                error: \"Partner not found\",\n                status: 404\n            };\n        }\n        return {\n            authorized: true,\n            user: session.user,\n            session,\n            partner,\n            partnerUser: null,\n            role: \"PARTNER_OWNER\" // Treat as owner for permissions\n        };\n    }\n    // Regular user must be a partner user of this specific partner\n    const partnerUser = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerUser.findUnique({\n        where: {\n            userId: session.user.id\n        },\n        include: {\n            partner: true\n        }\n    });\n    if (!partnerUser) {\n        return {\n            authorized: false,\n            error: \"Not a partner user\",\n            status: 403\n        };\n    }\n    // Must be a member of THIS partner\n    if (partnerUser.partnerId !== partnerId) {\n        return {\n            authorized: false,\n            error: \"Access denied to this partner\",\n            status: 403\n        };\n    }\n    if (!partnerUser.isActive) {\n        return {\n            authorized: false,\n            error: \"Partner membership is disabled\",\n            status: 403\n        };\n    }\n    if (partnerUser.partner.status !== \"ACTIVE\") {\n        return {\n            authorized: false,\n            error: \"Partner organization is not active\",\n            status: 403\n        };\n    }\n    return {\n        authorized: true,\n        user: session.user,\n        session,\n        partner: partnerUser.partner,\n        partnerUser,\n        role: partnerUser.role\n    };\n}\n/**\n * Require PARTNER_OWNER access to a specific partner\n */ async function requirePartnerOwnerAccess(partnerId) {\n    const authResult = await requirePartnerAccess(partnerId);\n    if (!authResult.authorized) {\n        return authResult;\n    }\n    // Super Admin is treated as owner\n    if (authResult.session.user.globalRole === \"SUPER_ADMIN\") {\n        return authResult;\n    }\n    if (authResult.role !== \"PARTNER_OWNER\") {\n        return {\n            authorized: false,\n            error: \"Partner Owner access required\",\n            status: 403\n        };\n    }\n    return authResult;\n}\n/**\n * Require access to a specific partner by slug\n */ async function requirePartnerAccessBySlug(slug) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            slug\n        }\n    });\n    if (!partner) {\n        return {\n            authorized: false,\n            error: \"Partner not found\",\n            status: 404\n        };\n    }\n    return requirePartnerAccess(partner.id);\n}\n// ============================================================================\n// ACCESS BOUNDARY CHECKS\n// ============================================================================\n/**\n * Check if a partner user can access a specific referral\n * Staff can only see referrals from codes they created\n */ async function canAccessReferral(partnerUserId, referralId, role) {\n    // Owners can see all referrals\n    if (role === \"PARTNER_OWNER\") {\n        return true;\n    }\n    // Staff can only see referrals from their codes\n    const referral = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findUnique({\n        where: {\n            id: referralId\n        },\n        include: {\n            referralCode: {\n                select: {\n                    metadata: true\n                }\n            }\n        }\n    });\n    if (!referral) {\n        return false;\n    }\n    // Check if this staff member created the referral code\n    // (This would require tracking who created the code - simplified for now)\n    // For now, staff can see all referrals in their partner\n    return true;\n}\n/**\n * Check if user can access a tenant's data\n * Partner users CANNOT access tenant internals - this always returns false\n */ function canPartnerAccessTenantInternals() {\n    // Partner users can NEVER access tenant internals\n    // This is a hard boundary\n    return false;\n}\nasync function getPartnerVisibleTenantData(partnerId, tenantId) {\n    // First verify this partner has a referral for this tenant\n    const referral = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findFirst({\n        where: {\n            partnerId,\n            tenantId\n        }\n    });\n    if (!referral) {\n        return null // Partner cannot see this tenant\n        ;\n    }\n    // Get limited tenant data\n    const tenant = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.tenant.findUnique({\n        where: {\n            id: tenantId\n        },\n        select: {\n            id: true,\n            name: true,\n            slug: true,\n            status: true,\n            createdAt: true\n        }\n    });\n    if (!tenant) {\n        return null;\n    }\n    return {\n        id: tenant.id,\n        name: tenant.name,\n        slug: tenant.slug,\n        status: tenant.status,\n        createdAt: tenant.createdAt\n    };\n}\n// ============================================================================\n// HELPER FUNCTIONS\n// ============================================================================\n/**\n * Check if user has a specific permission\n */ function hasPartnerPermission(role, permission) {\n    const permissions = getPartnerPermissions(role);\n    return permissions[permission];\n}\n/**\n * Assert a permission or throw\n */ function assertPartnerPermission(role, permission, errorMessage) {\n    if (!hasPartnerPermission(role, permission)) {\n        throw new Error(errorMessage || `Permission denied: ${permission}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3BhcnRuZXItYXV0aG9yaXphdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0NBV0MsR0FFZ0M7QUFDc0I7QUFtQ3ZELCtFQUErRTtBQUMvRSxtQkFBbUI7QUFDbkIsK0VBQStFO0FBRS9FOzs7OztDQUtDLEdBQ0QsTUFBTUUsNEJBQWdEO0lBQ3BELHFCQUFxQjtJQUNyQkMsZ0JBQWdCO0lBQ2hCQyxnQkFBZ0I7SUFDaEJDLHVCQUF1QjtJQUN2QkMsa0JBQWtCO0lBRWxCLHNCQUFzQjtJQUN0QkMsa0JBQWtCO0lBQ2xCQyx3QkFBd0I7SUFDeEJDLHFCQUFxQjtJQUVyQixXQUFXO0lBQ1hDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxtQkFBbUI7SUFFbkIsWUFBWTtJQUNaQyxrQkFBa0I7SUFDbEJDLHlCQUF5QjtBQUMzQjtBQUVBOzs7Ozs7Q0FNQyxHQUNELE1BQU1DLDRCQUFnRDtJQUNwRCxxQkFBcUI7SUFDckJaLGdCQUFnQjtJQUNoQkMsZ0JBQWdCO0lBQ2hCQyx1QkFBdUI7SUFDdkJDLGtCQUFrQjtJQUVsQixzQkFBc0I7SUFDdEJDLGtCQUFrQjtJQUNsQkMsd0JBQXdCO0lBQ3hCQyxxQkFBcUI7SUFFckIsV0FBVztJQUNYQyxpQkFBaUI7SUFDakJDLG9CQUFvQjtJQUNwQkMsbUJBQW1CO0lBRW5CLFlBQVk7SUFDWkMsa0JBQWtCO0lBQ2xCQyx5QkFBeUI7QUFDM0I7QUFFQTs7OztDQUlDLEdBQ0QsTUFBTUUsMEJBQThDO0lBQ2xEYixnQkFBZ0I7SUFDaEJDLGdCQUFnQjtJQUNoQkMsdUJBQXVCO0lBQ3ZCQyxrQkFBa0I7SUFDbEJDLGtCQUFrQjtJQUNsQkMsd0JBQXdCO0lBQ3hCQyxxQkFBcUI7SUFDckJDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxtQkFBbUI7SUFDbkJDLGtCQUFrQjtJQUNsQkMseUJBQXlCO0FBQzNCO0FBRUE7O0NBRUMsR0FDTSxTQUFTRyxz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VTtRQUNiLE9BQU8sS0FBSyxpQ0FBaUM7O0lBQy9DO0lBRUEsMEJBQTBCO0lBQzFCLE1BQU1RLFNBQVMsTUFBTXpELDJDQUFNQSxDQUFDeUQsTUFBTSxDQUFDbkMsVUFBVSxDQUFDO1FBQzVDQyxPQUFPO1lBQUVnQixJQUFJZ0I7UUFBUztRQUN0QnhCLFFBQVE7WUFDTlEsSUFBSTtZQUNKbUIsTUFBTTtZQUNOYixNQUFNO1lBQ05SLFFBQVE7WUFDUnNCLFdBQVc7UUFFYjtJQUNGO0lBRUEsSUFBSSxDQUFDRixRQUFRO1FBQ1gsT0FBTztJQUNUO0lBRUEsT0FBTztRQUNMbEIsSUFBSWtCLE9BQU9sQixFQUFFO1FBQ2JtQixNQUFNRCxPQUFPQyxJQUFJO1FBQ2pCYixNQUFNWSxPQUFPWixJQUFJO1FBQ2pCUixRQUFRb0IsT0FBT3BCLE1BQU07UUFDckJzQixXQUFXRixPQUFPRSxTQUFTO0lBQzdCO0FBQ0Y7QUFFQSwrRUFBK0U7QUFDL0UsbUJBQW1CO0FBQ25CLCtFQUErRTtBQUUvRTs7Q0FFQyxHQUNNLFNBQVNDLHFCQUNkMUMsSUFBaUMsRUFDakMyQyxVQUFvQztJQUVwQyxNQUFNQyxjQUFjN0Msc0JBQXNCQztJQUMxQyxPQUFPNEMsV0FBVyxDQUFDRCxXQUFXO0FBQ2hDO0FBRUE7O0NBRUMsR0FDTSxTQUFTRSx3QkFDZDdDLElBQWlDLEVBQ2pDMkMsVUFBb0MsRUFDcENHLFlBQXFCO0lBRXJCLElBQUksQ0FBQ0oscUJBQXFCMUMsTUFBTTJDLGFBQWE7UUFDM0MsTUFBTSxJQUFJSSxNQUFNRCxnQkFBZ0IsQ0FBQyxtQkFBbUIsRUFBRUgsV0FBVyxDQUFDO0lBQ3BFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3BhcnRuZXItYXV0aG9yaXphdGlvbi50cz8wNTY1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGFydG5lciBBdXRob3JpemF0aW9uXG4gKiBcbiAqIEFjY2VzcyBjb250cm9sIGZvciBQYXJ0bmVyIGRvbWFpbiAtIGNvbXBsZXRlbHkgc2VwYXJhdGUgZnJvbSBUZW5hbnQgYXV0aG9yaXphdGlvbi5cbiAqIFBhcnRuZXIgdXNlcnMgQ0FOTk9UIGFjY2VzcyB0ZW5hbnQgaW50ZXJuYWxzLlxuICogUGFydG5lciB1c2VycyBjYW4gT05MWSBzZWUgdGhlaXIgb3duIHBhcnRuZXIncyBkYXRhLlxuICogXG4gKiBSb2xlIEhpZXJhcmNoeTpcbiAqIC0gU1VQRVJfQURNSU46IFBsYXRmb3JtLXdpZGUgYWNjZXNzIHRvIGFsbCBwYXJ0bmVyc1xuICogLSBQQVJUTkVSX09XTkVSOiBGdWxsIGNvbnRyb2wgd2l0aGluIHRoZWlyIHBhcnRuZXIgb3JnYW5pemF0aW9uXG4gKiAtIFBBUlRORVJfU1RBRkY6IExpbWl0ZWQgYWNjZXNzIHdpdGhpbiB0aGVpciBwYXJ0bmVyIG9yZ2FuaXphdGlvblxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgZ2V0Q3VycmVudFNlc3Npb24sIEF1dGhTZXNzaW9uIH0gZnJvbSAnLi9hdXRoJ1xuaW1wb3J0IHsgVXNlciwgUGFydG5lciwgUGFydG5lclVzZXIsIFBhcnRuZXJSb2xlIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCB0eXBlIFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0ID0gXG4gIHwgeyBhdXRob3JpemVkOiB0cnVlOyB1c2VyOiBVc2VyOyBzZXNzaW9uOiBBdXRoU2Vzc2lvbjsgcGFydG5lcjogUGFydG5lcjsgcGFydG5lclVzZXI6IFBhcnRuZXJVc2VyOyByb2xlOiBQYXJ0bmVyUm9sZSB9XG4gIHwgeyBhdXRob3JpemVkOiBmYWxzZTsgZXJyb3I6IHN0cmluZzsgc3RhdHVzOiBudW1iZXIgfVxuXG5leHBvcnQgdHlwZSBQYXJ0bmVyQWNjZXNzTGV2ZWwgPSAnTk9ORScgfCAnU1RBRkYnIHwgJ09XTkVSJyB8ICdTVVBFUl9BRE1JTidcblxuZXhwb3J0IGludGVyZmFjZSBQYXJ0bmVyUGVybWlzc2lvbnMge1xuICAvLyBQYXJ0bmVyIE1hbmFnZW1lbnRcbiAgY2FuVmlld1BhcnRuZXI6IGJvb2xlYW5cbiAgY2FuRWRpdFBhcnRuZXI6IGJvb2xlYW5cbiAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiBib29sZWFuXG4gIGNhblNpZ25BZ3JlZW1lbnQ6IGJvb2xlYW5cbiAgXG4gIC8vIFJlZmVycmFsIE1hbmFnZW1lbnRcbiAgY2FuVmlld1JlZmVycmFsczogYm9vbGVhblxuICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiBib29sZWFuXG4gIGNhblZpZXdBbGxSZWZlcnJhbHM6IGJvb2xlYW4gIC8vIHZzIG9ubHkgb3duIHJlZmVycmFsc1xuICBcbiAgLy8gRWFybmluZ3NcbiAgY2FuVmlld0Vhcm5pbmdzOiBib29sZWFuXG4gIGNhblZpZXdBbGxFYXJuaW5nczogYm9vbGVhbiAgIC8vIHZzIG9ubHkgc3VtbWFyeVxuICBjYW5FeHBvcnRFYXJuaW5nczogYm9vbGVhblxuICBcbiAgLy8gQWdyZWVtZW50XG4gIGNhblZpZXdBZ3JlZW1lbnQ6IGJvb2xlYW5cbiAgY2FuVmlld0FncmVlbWVudEhpc3Rvcnk6IGJvb2xlYW5cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUk9MRSBERUZJTklUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFBBUlRORVJfT1dORVIgUGVybWlzc2lvbnNcbiAqIC0gRnVsbCBjb250cm9sIG92ZXIgcGFydG5lciBvcmdhbml6YXRpb25cbiAqIC0gQ2FuIG1hbmFnZSB1c2Vycywgc2lnbiBhZ3JlZW1lbnRzLCB2aWV3IGFsbCBkYXRhXG4gKiAtIENBTk5PVCBhY2Nlc3MgdGVuYW50IGludGVybmFsc1xuICovXG5jb25zdCBQQVJUTkVSX09XTkVSX1BFUk1JU1NJT05TOiBQYXJ0bmVyUGVybWlzc2lvbnMgPSB7XG4gIC8vIFBhcnRuZXIgTWFuYWdlbWVudFxuICBjYW5WaWV3UGFydG5lcjogdHJ1ZSxcbiAgY2FuRWRpdFBhcnRuZXI6IHRydWUsXG4gIGNhbk1hbmFnZVBhcnRuZXJVc2VyczogdHJ1ZSxcbiAgY2FuU2lnbkFncmVlbWVudDogdHJ1ZSxcbiAgXG4gIC8vIFJlZmVycmFsIE1hbmFnZW1lbnRcbiAgY2FuVmlld1JlZmVycmFsczogdHJ1ZSxcbiAgY2FuQ3JlYXRlUmVmZXJyYWxDb2RlczogdHJ1ZSxcbiAgY2FuVmlld0FsbFJlZmVycmFsczogdHJ1ZSxcbiAgXG4gIC8vIEVhcm5pbmdzXG4gIGNhblZpZXdFYXJuaW5nczogdHJ1ZSxcbiAgY2FuVmlld0FsbEVhcm5pbmdzOiB0cnVlLFxuICBjYW5FeHBvcnRFYXJuaW5nczogdHJ1ZSxcbiAgXG4gIC8vIEFncmVlbWVudFxuICBjYW5WaWV3QWdyZWVtZW50OiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50SGlzdG9yeTogdHJ1ZSxcbn1cblxuLyoqXG4gKiBQQVJUTkVSX1NUQUZGIFBlcm1pc3Npb25zXG4gKiAtIExpbWl0ZWQgYWNjZXNzIHdpdGhpbiBwYXJ0bmVyIG9yZ2FuaXphdGlvblxuICogLSBDYW4gdmlldyByZWZlcnJhbHMgYW5kIGVhcm5pbmdzLCBjcmVhdGUgY29kZXNcbiAqIC0gQ0FOTk9UIG1hbmFnZSB1c2VycyBvciBzaWduIGFncmVlbWVudHNcbiAqIC0gQ0FOTk9UIGFjY2VzcyB0ZW5hbnQgaW50ZXJuYWxzXG4gKi9cbmNvbnN0IFBBUlRORVJfU1RBRkZfUEVSTUlTU0lPTlM6IFBhcnRuZXJQZXJtaXNzaW9ucyA9IHtcbiAgLy8gUGFydG5lciBNYW5hZ2VtZW50XG4gIGNhblZpZXdQYXJ0bmVyOiB0cnVlLFxuICBjYW5FZGl0UGFydG5lcjogZmFsc2UsXG4gIGNhbk1hbmFnZVBhcnRuZXJVc2VyczogZmFsc2UsXG4gIGNhblNpZ25BZ3JlZW1lbnQ6IGZhbHNlLFxuICBcbiAgLy8gUmVmZXJyYWwgTWFuYWdlbWVudFxuICBjYW5WaWV3UmVmZXJyYWxzOiB0cnVlLFxuICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiB0cnVlLFxuICBjYW5WaWV3QWxsUmVmZXJyYWxzOiBmYWxzZSwgIC8vIE9ubHkgc2VlIHJlZmVycmFscyB0aGV5IGNyZWF0ZWRcbiAgXG4gIC8vIEVhcm5pbmdzXG4gIGNhblZpZXdFYXJuaW5nczogdHJ1ZSxcbiAgY2FuVmlld0FsbEVhcm5pbmdzOiBmYWxzZSwgICAvLyBPbmx5IHNlZSBzdW1tYXJ5LCBub3QgbGluZSBpdGVtc1xuICBjYW5FeHBvcnRFYXJuaW5nczogZmFsc2UsXG4gIFxuICAvLyBBZ3JlZW1lbnRcbiAgY2FuVmlld0FncmVlbWVudDogdHJ1ZSxcbiAgY2FuVmlld0FncmVlbWVudEhpc3Rvcnk6IGZhbHNlLFxufVxuXG4vKipcbiAqIFNVUEVSX0FETUlOIFBlcm1pc3Npb25zIChwbGF0Zm9ybS13aWRlKVxuICogLSBDYW4gYWNjZXNzIGFsbCBwYXJ0bmVyc1xuICogLSBGdWxsIHBlcm1pc3Npb25zIG9uIGFueSBwYXJ0bmVyXG4gKi9cbmNvbnN0IFNVUEVSX0FETUlOX1BFUk1JU1NJT05TOiBQYXJ0bmVyUGVybWlzc2lvbnMgPSB7XG4gIGNhblZpZXdQYXJ0bmVyOiB0cnVlLFxuICBjYW5FZGl0UGFydG5lcjogdHJ1ZSxcbiAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiB0cnVlLFxuICBjYW5TaWduQWdyZWVtZW50OiBmYWxzZSwgIC8vIFN1cGVyIEFkbWluIGFwcHJvdmVzLCBub3Qgc2lnbnNcbiAgY2FuVmlld1JlZmVycmFsczogdHJ1ZSxcbiAgY2FuQ3JlYXRlUmVmZXJyYWxDb2RlczogdHJ1ZSxcbiAgY2FuVmlld0FsbFJlZmVycmFsczogdHJ1ZSxcbiAgY2FuVmlld0Vhcm5pbmdzOiB0cnVlLFxuICBjYW5WaWV3QWxsRWFybmluZ3M6IHRydWUsXG4gIGNhbkV4cG9ydEVhcm5pbmdzOiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50OiB0cnVlLFxuICBjYW5WaWV3QWdyZWVtZW50SGlzdG9yeTogdHJ1ZSxcbn1cblxuLyoqXG4gKiBHZXQgcGVybWlzc2lvbnMgZm9yIGEgcm9sZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFydG5lclBlcm1pc3Npb25zKHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyk6IFBhcnRuZXJQZXJtaXNzaW9ucyB7XG4gIHN3aXRjaCAocm9sZSkge1xuICAgIGNhc2UgJ1NVUEVSX0FETUlOJzpcbiAgICAgIHJldHVybiBTVVBFUl9BRE1JTl9QRVJNSVNTSU9OU1xuICAgIGNhc2UgJ1BBUlRORVJfT1dORVInOlxuICAgICAgcmV0dXJuIFBBUlRORVJfT1dORVJfUEVSTUlTU0lPTlNcbiAgICBjYXNlICdQQVJUTkVSX1NUQUZGJzpcbiAgICAgIHJldHVybiBQQVJUTkVSX1NUQUZGX1BFUk1JU1NJT05TXG4gICAgZGVmYXVsdDpcbiAgICAgIC8vIE5vIHBlcm1pc3Npb25zIGZvciB1bmtub3duIHJvbGVzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjYW5WaWV3UGFydG5lcjogZmFsc2UsXG4gICAgICAgIGNhbkVkaXRQYXJ0bmVyOiBmYWxzZSxcbiAgICAgICAgY2FuTWFuYWdlUGFydG5lclVzZXJzOiBmYWxzZSxcbiAgICAgICAgY2FuU2lnbkFncmVlbWVudDogZmFsc2UsXG4gICAgICAgIGNhblZpZXdSZWZlcnJhbHM6IGZhbHNlLFxuICAgICAgICBjYW5DcmVhdGVSZWZlcnJhbENvZGVzOiBmYWxzZSxcbiAgICAgICAgY2FuVmlld0FsbFJlZmVycmFsczogZmFsc2UsXG4gICAgICAgIGNhblZpZXdFYXJuaW5nczogZmFsc2UsXG4gICAgICAgIGNhblZpZXdBbGxFYXJuaW5nczogZmFsc2UsXG4gICAgICAgIGNhbkV4cG9ydEVhcm5pbmdzOiBmYWxzZSxcbiAgICAgICAgY2FuVmlld0FncmVlbWVudDogZmFsc2UsXG4gICAgICAgIGNhblZpZXdBZ3JlZW1lbnRIaXN0b3J5OiBmYWxzZSxcbiAgICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBQ0NFU1MgQk9VTkRBUlkgRU5GT1JDRU1FTlRcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgdXNlcidzIHBhcnRuZXIgbWVtYmVyc2hpcCAoaWYgYW55KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lck1lbWJlcnNoaXAodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPChQYXJ0bmVyVXNlciAmIHsgcGFydG5lcjogUGFydG5lciB9KSB8IG51bGw+IHtcbiAgcmV0dXJuIHByaXNtYS5wYXJ0bmVyVXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICBpbmNsdWRlOiB7IHBhcnRuZXI6IHRydWUgfVxuICB9KVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgYSBwYXJ0bmVyIHVzZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzUGFydG5lclVzZXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgbWVtYmVyc2hpcCA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyVXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyB1c2VySWQgfVxuICB9KVxuICByZXR1cm4gISFtZW1iZXJzaGlwXG59XG5cbi8qKlxuICogR2V0IHVzZXIncyBhY2Nlc3MgbGV2ZWwgZm9yIGEgc3BlY2lmaWMgcGFydG5lclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lckFjY2Vzc0xldmVsKFxuICB1c2VySWQ6IHN0cmluZywgXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBnbG9iYWxSb2xlOiBzdHJpbmdcbik6IFByb21pc2U8UGFydG5lckFjY2Vzc0xldmVsPiB7XG4gIC8vIFN1cGVyIEFkbWluIGhhcyBmdWxsIGFjY2Vzc1xuICBpZiAoZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiAnU1VQRVJfQURNSU4nXG4gIH1cbiAgXG4gIC8vIENoZWNrIHBhcnRuZXIgbWVtYmVyc2hpcFxuICBjb25zdCBtZW1iZXJzaGlwID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgIHNlbGVjdDogeyBwYXJ0bmVySWQ6IHRydWUsIHJvbGU6IHRydWUsIGlzQWN0aXZlOiB0cnVlIH1cbiAgfSlcbiAgXG4gIC8vIE5vdCBhIHBhcnRuZXIgdXNlciBvciBub3QgYWN0aXZlXG4gIGlmICghbWVtYmVyc2hpcCB8fCAhbWVtYmVyc2hpcC5pc0FjdGl2ZSkge1xuICAgIHJldHVybiAnTk9ORSdcbiAgfVxuICBcbiAgLy8gTm90IGEgbWVtYmVyIG9mIHRoaXMgc3BlY2lmaWMgcGFydG5lclxuICBpZiAobWVtYmVyc2hpcC5wYXJ0bmVySWQgIT09IHBhcnRuZXJJZCkge1xuICAgIHJldHVybiAnTk9ORSdcbiAgfVxuICBcbiAgLy8gUmV0dXJuIHJvbGUtYmFzZWQgYWNjZXNzIGxldmVsXG4gIHJldHVybiBtZW1iZXJzaGlwLnJvbGUgPT09ICdQQVJUTkVSX09XTkVSJyA/ICdPV05FUicgOiAnU1RBRkYnXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFVVEhPUklaQVRJT04gRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogUmVxdWlyZSBhbnkgYXV0aGVudGljYXRlZCB1c2VyIHdobyBpcyBhIHBhcnRuZXIgdXNlclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJVc2VyKCk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQ+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldEN1cnJlbnRTZXNzaW9uKClcbiAgXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLFxuICAgICAgc3RhdHVzOiA0MDFcbiAgICB9XG4gIH1cbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyLmlzQWN0aXZlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdBY2NvdW50IGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICAvLyBHZXQgcGFydG5lciBtZW1iZXJzaGlwXG4gIGNvbnN0IHBhcnRuZXJVc2VyID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkIH0sXG4gICAgaW5jbHVkZTogeyBwYXJ0bmVyOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGlmICghcGFydG5lclVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ05vdCBhIHBhcnRuZXIgdXNlcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKCFwYXJ0bmVyVXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBtZW1iZXJzaGlwIGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICBpZiAocGFydG5lclVzZXIucGFydG5lci5zdGF0dXMgIT09ICdBQ1RJVkUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG9yZ2FuaXphdGlvbiBpcyBub3QgYWN0aXZlJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGF1dGhvcml6ZWQ6IHRydWUsXG4gICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgIHNlc3Npb24sXG4gICAgcGFydG5lcjogcGFydG5lclVzZXIucGFydG5lcixcbiAgICBwYXJ0bmVyVXNlcixcbiAgICByb2xlOiBwYXJ0bmVyVXNlci5yb2xlXG4gIH1cbn1cblxuLyoqXG4gKiBSZXF1aXJlIFBBUlRORVJfT1dORVIgcm9sZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJPd25lcigpOiBQcm9taXNlPFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlUGFydG5lclVzZXIoKVxuICBcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gYXV0aFJlc3VsdFxuICB9XG4gIFxuICBpZiAoYXV0aFJlc3VsdC5yb2xlICE9PSAnUEFSVE5FUl9PV05FUicpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ1BhcnRuZXIgT3duZXIgYWNjZXNzIHJlcXVpcmVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gYXV0aFJlc3VsdFxufVxuXG4vKipcbiAqIFJlcXVpcmUgYWNjZXNzIHRvIGEgc3BlY2lmaWMgcGFydG5lciBieSBJRFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJBY2Nlc3MocGFydG5lcklkOiBzdHJpbmcpOiBQcm9taXNlPFBhcnRuZXJBdXRob3JpemF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRDdXJyZW50U2Vzc2lvbigpXG4gIFxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyxcbiAgICAgIHN0YXR1czogNDAxXG4gICAgfVxuICB9XG4gIFxuICBpZiAoIXNlc3Npb24udXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnQWNjb3VudCBpcyBkaXNhYmxlZCcsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgLy8gU3VwZXIgQWRtaW4gY2FuIGFjY2VzcyBhbnkgcGFydG5lclxuICBpZiAoc2Vzc2lvbi51c2VyLmdsb2JhbFJvbGUgPT09ICdTVVBFUl9BRE1JTicpIHtcbiAgICBjb25zdCBwYXJ0bmVyID0gYXdhaXQgcHJpc21hLnBhcnRuZXIuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogcGFydG5lcklkIH1cbiAgICB9KVxuICAgIFxuICAgIGlmICghcGFydG5lcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnUGFydG5lciBub3QgZm91bmQnLFxuICAgICAgICBzdGF0dXM6IDQwNFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogdHJ1ZSxcbiAgICAgIHVzZXI6IHNlc3Npb24udXNlcixcbiAgICAgIHNlc3Npb24sXG4gICAgICBwYXJ0bmVyLFxuICAgICAgcGFydG5lclVzZXI6IG51bGwgYXMgYW55LCAvLyBTdXBlciBBZG1pbiBkb2Vzbid0IG5lZWQgcGFydG5lciB1c2VyIHJlY29yZFxuICAgICAgcm9sZTogJ1BBUlRORVJfT1dORVInIC8vIFRyZWF0IGFzIG93bmVyIGZvciBwZXJtaXNzaW9uc1xuICAgIH1cbiAgfVxuICBcbiAgLy8gUmVndWxhciB1c2VyIG11c3QgYmUgYSBwYXJ0bmVyIHVzZXIgb2YgdGhpcyBzcGVjaWZpYyBwYXJ0bmVyXG4gIGNvbnN0IHBhcnRuZXJVc2VyID0gYXdhaXQgcHJpc21hLnBhcnRuZXJVc2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkIH0sXG4gICAgaW5jbHVkZTogeyBwYXJ0bmVyOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGlmICghcGFydG5lclVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICBlcnJvcjogJ05vdCBhIHBhcnRuZXIgdXNlcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgLy8gTXVzdCBiZSBhIG1lbWJlciBvZiBUSElTIHBhcnRuZXJcbiAgaWYgKHBhcnRuZXJVc2VyLnBhcnRuZXJJZCAhPT0gcGFydG5lcklkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkIHRvIHRoaXMgcGFydG5lcicsXG4gICAgICBzdGF0dXM6IDQwM1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKCFwYXJ0bmVyVXNlci5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBtZW1iZXJzaGlwIGlzIGRpc2FibGVkJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICBpZiAocGFydG5lclVzZXIucGFydG5lci5zdGF0dXMgIT09ICdBQ1RJVkUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG9yZ2FuaXphdGlvbiBpcyBub3QgYWN0aXZlJyxcbiAgICAgIHN0YXR1czogNDAzXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGF1dGhvcml6ZWQ6IHRydWUsXG4gICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgIHNlc3Npb24sXG4gICAgcGFydG5lcjogcGFydG5lclVzZXIucGFydG5lcixcbiAgICBwYXJ0bmVyVXNlcixcbiAgICByb2xlOiBwYXJ0bmVyVXNlci5yb2xlXG4gIH1cbn1cblxuLyoqXG4gKiBSZXF1aXJlIFBBUlRORVJfT1dORVIgYWNjZXNzIHRvIGEgc3BlY2lmaWMgcGFydG5lclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVBhcnRuZXJPd25lckFjY2VzcyhwYXJ0bmVySWQ6IHN0cmluZyk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQ+IHtcbiAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHJlcXVpcmVQYXJ0bmVyQWNjZXNzKHBhcnRuZXJJZClcbiAgXG4gIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgcmV0dXJuIGF1dGhSZXN1bHRcbiAgfVxuICBcbiAgLy8gU3VwZXIgQWRtaW4gaXMgdHJlYXRlZCBhcyBvd25lclxuICBpZiAoYXV0aFJlc3VsdC5zZXNzaW9uLnVzZXIuZ2xvYmFsUm9sZSA9PT0gJ1NVUEVSX0FETUlOJykge1xuICAgIHJldHVybiBhdXRoUmVzdWx0XG4gIH1cbiAgXG4gIGlmIChhdXRoUmVzdWx0LnJvbGUgIT09ICdQQVJUTkVSX09XTkVSJykge1xuICAgIHJldHVybiB7XG4gICAgICBhdXRob3JpemVkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnUGFydG5lciBPd25lciBhY2Nlc3MgcmVxdWlyZWQnLFxuICAgICAgc3RhdHVzOiA0MDNcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBhdXRoUmVzdWx0XG59XG5cbi8qKlxuICogUmVxdWlyZSBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBwYXJ0bmVyIGJ5IHNsdWdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVQYXJ0bmVyQWNjZXNzQnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8UGFydG5lckF1dGhvcml6YXRpb25SZXN1bHQgJiB7IHBhcnRuZXI/OiBQYXJ0bmVyIH0+IHtcbiAgY29uc3QgcGFydG5lciA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNsdWcgfVxuICB9KVxuICBcbiAgaWYgKCFwYXJ0bmVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdQYXJ0bmVyIG5vdCBmb3VuZCcsXG4gICAgICBzdGF0dXM6IDQwNFxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHJlcXVpcmVQYXJ0bmVyQWNjZXNzKHBhcnRuZXIuaWQpXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFDQ0VTUyBCT1VOREFSWSBDSEVDS1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDaGVjayBpZiBhIHBhcnRuZXIgdXNlciBjYW4gYWNjZXNzIGEgc3BlY2lmaWMgcmVmZXJyYWxcbiAqIFN0YWZmIGNhbiBvbmx5IHNlZSByZWZlcnJhbHMgZnJvbSBjb2RlcyB0aGV5IGNyZWF0ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbkFjY2Vzc1JlZmVycmFsKFxuICBwYXJ0bmVyVXNlcklkOiBzdHJpbmcsXG4gIHJlZmVycmFsSWQ6IHN0cmluZyxcbiAgcm9sZTogUGFydG5lclJvbGVcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAvLyBPd25lcnMgY2FuIHNlZSBhbGwgcmVmZXJyYWxzXG4gIGlmIChyb2xlID09PSAnUEFSVE5FUl9PV05FUicpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIFxuICAvLyBTdGFmZiBjYW4gb25seSBzZWUgcmVmZXJyYWxzIGZyb20gdGhlaXIgY29kZXNcbiAgY29uc3QgcmVmZXJyYWwgPSBhd2FpdCBwcmlzbWEucGFydG5lclJlZmVycmFsLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGlkOiByZWZlcnJhbElkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgcmVmZXJyYWxDb2RlOiB7XG4gICAgICAgIHNlbGVjdDogeyBtZXRhZGF0YTogdHJ1ZSB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICBcbiAgaWYgKCFyZWZlcnJhbCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIFxuICAvLyBDaGVjayBpZiB0aGlzIHN0YWZmIG1lbWJlciBjcmVhdGVkIHRoZSByZWZlcnJhbCBjb2RlXG4gIC8vIChUaGlzIHdvdWxkIHJlcXVpcmUgdHJhY2tpbmcgd2hvIGNyZWF0ZWQgdGhlIGNvZGUgLSBzaW1wbGlmaWVkIGZvciBub3cpXG4gIC8vIEZvciBub3csIHN0YWZmIGNhbiBzZWUgYWxsIHJlZmVycmFscyBpbiB0aGVpciBwYXJ0bmVyXG4gIHJldHVybiB0cnVlXG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBjYW4gYWNjZXNzIGEgdGVuYW50J3MgZGF0YVxuICogUGFydG5lciB1c2VycyBDQU5OT1QgYWNjZXNzIHRlbmFudCBpbnRlcm5hbHMgLSB0aGlzIGFsd2F5cyByZXR1cm5zIGZhbHNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5QYXJ0bmVyQWNjZXNzVGVuYW50SW50ZXJuYWxzKCk6IGJvb2xlYW4ge1xuICAvLyBQYXJ0bmVyIHVzZXJzIGNhbiBORVZFUiBhY2Nlc3MgdGVuYW50IGludGVybmFsc1xuICAvLyBUaGlzIGlzIGEgaGFyZCBib3VuZGFyeVxuICByZXR1cm4gZmFsc2Vcbn1cblxuLyoqXG4gKiBHZXQgdmlzaWJsZSB0ZW5hbnQgZGF0YSBmb3IgYSBwYXJ0bmVyIChsaW1pdGVkIHZpZXcpXG4gKiBQYXJ0bmVycyBjYW4gb25seSBzZWU6IHRlbmFudCBuYW1lLCBzdGF0dXMsIHNpZ251cCBkYXRlXG4gKiBQYXJ0bmVycyBDQU5OT1Qgc2VlOiB0ZW5hbnQgdXNlcnMsIHNldHRpbmdzLCBkb21haW5zLCBvciBhbnkgaW50ZXJuYWwgZGF0YVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRuZXJWaXNpYmxlVGVuYW50RGF0YSB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHNsdWc6IHN0cmluZ1xuICBzdGF0dXM6IHN0cmluZ1xuICBjcmVhdGVkQXQ6IERhdGVcbiAgLy8gU3Vic2NyaXB0aW9uIGluZm8gKHdoZW4gaW1wbGVtZW50ZWQpXG4gIC8vIFJldmVudWUgbWV0cmljcyAoYWdncmVnYXRlZCBvbmx5KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lclZpc2libGVUZW5hbnREYXRhKFxuICBwYXJ0bmVySWQ6IHN0cmluZyxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxQYXJ0bmVyVmlzaWJsZVRlbmFudERhdGEgfCBudWxsPiB7XG4gIC8vIEZpcnN0IHZlcmlmeSB0aGlzIHBhcnRuZXIgaGFzIGEgcmVmZXJyYWwgZm9yIHRoaXMgdGVuYW50XG4gIGNvbnN0IHJlZmVycmFsID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICB0ZW5hbnRJZFxuICAgIH1cbiAgfSlcbiAgXG4gIGlmICghcmVmZXJyYWwpIHtcbiAgICByZXR1cm4gbnVsbCAvLyBQYXJ0bmVyIGNhbm5vdCBzZWUgdGhpcyB0ZW5hbnRcbiAgfVxuICBcbiAgLy8gR2V0IGxpbWl0ZWQgdGVuYW50IGRhdGFcbiAgY29uc3QgdGVuYW50ID0gYXdhaXQgcHJpc21hLnRlbmFudC5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogdGVuYW50SWQgfSxcbiAgICBzZWxlY3Q6IHtcbiAgICAgIGlkOiB0cnVlLFxuICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgIHNsdWc6IHRydWUsXG4gICAgICBzdGF0dXM6IHRydWUsXG4gICAgICBjcmVhdGVkQXQ6IHRydWVcbiAgICAgIC8vIEV4cGxpY2l0bHkgTk9UIGluY2x1ZGluZzogZG9tYWlucywgbWVtYmVyc2hpcHMsIGJyYW5kaW5nIGRldGFpbHNcbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXRlbmFudCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgaWQ6IHRlbmFudC5pZCxcbiAgICBuYW1lOiB0ZW5hbnQubmFtZSxcbiAgICBzbHVnOiB0ZW5hbnQuc2x1ZyxcbiAgICBzdGF0dXM6IHRlbmFudC5zdGF0dXMsXG4gICAgY3JlYXRlZEF0OiB0ZW5hbnQuY3JlYXRlZEF0XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSEVMUEVSIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaGFzIGEgc3BlY2lmaWMgcGVybWlzc2lvblxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzUGFydG5lclBlcm1pc3Npb24oXG4gIHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyxcbiAgcGVybWlzc2lvbjoga2V5b2YgUGFydG5lclBlcm1pc3Npb25zXG4pOiBib29sZWFuIHtcbiAgY29uc3QgcGVybWlzc2lvbnMgPSBnZXRQYXJ0bmVyUGVybWlzc2lvbnMocm9sZSlcbiAgcmV0dXJuIHBlcm1pc3Npb25zW3Blcm1pc3Npb25dXG59XG5cbi8qKlxuICogQXNzZXJ0IGEgcGVybWlzc2lvbiBvciB0aHJvd1xuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0UGFydG5lclBlcm1pc3Npb24oXG4gIHJvbGU6IFBhcnRuZXJSb2xlIHwgJ1NVUEVSX0FETUlOJyxcbiAgcGVybWlzc2lvbjoga2V5b2YgUGFydG5lclBlcm1pc3Npb25zLFxuICBlcnJvck1lc3NhZ2U/OiBzdHJpbmdcbik6IHZvaWQge1xuICBpZiAoIWhhc1BhcnRuZXJQZXJtaXNzaW9uKHJvbGUsIHBlcm1pc3Npb24pKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSB8fCBgUGVybWlzc2lvbiBkZW5pZWQ6ICR7cGVybWlzc2lvbn1gKVxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiZ2V0Q3VycmVudFNlc3Npb24iLCJQQVJUTkVSX09XTkVSX1BFUk1JU1NJT05TIiwiY2FuVmlld1BhcnRuZXIiLCJjYW5FZGl0UGFydG5lciIsImNhbk1hbmFnZVBhcnRuZXJVc2VycyIsImNhblNpZ25BZ3JlZW1lbnQiLCJjYW5WaWV3UmVmZXJyYWxzIiwiY2FuQ3JlYXRlUmVmZXJyYWxDb2RlcyIsImNhblZpZXdBbGxSZWZlcnJhbHMiLCJjYW5WaWV3RWFybmluZ3MiLCJjYW5WaWV3QWxsRWFybmluZ3MiLCJjYW5FeHBvcnRFYXJuaW5ncyIsImNhblZpZXdBZ3JlZW1lbnQiLCJjYW5WaWV3QWdyZWVtZW50SGlzdG9yeSIsIlBBUlRORVJfU1RBRkZfUEVSTUlTU0lPTlMiLCJTVVBFUl9BRE1JTl9QRVJNSVNTSU9OUyIsImdldFBhcnRuZXJQZXJtaXNzaW9ucyIsInJvbGUiLCJnZXRQYXJ0bmVyTWVtYmVyc2hpcCIsInVzZXJJZCIsInBhcnRuZXJVc2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaW5jbHVkZSIsInBhcnRuZXIiLCJpc1BhcnRuZXJVc2VyIiwibWVtYmVyc2hpcCIsImdldFBhcnRuZXJBY2Nlc3NMZXZlbCIsInBhcnRuZXJJZCIsImdsb2JhbFJvbGUiLCJzZWxlY3QiLCJpc0FjdGl2ZSIsInJlcXVpcmVQYXJ0bmVyVXNlciIsInNlc3Npb24iLCJhdXRob3JpemVkIiwiZXJyb3IiLCJzdGF0dXMiLCJ1c2VyIiwiaWQiLCJyZXF1aXJlUGFydG5lck93bmVyIiwiYXV0aFJlc3VsdCIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzIiwicmVxdWlyZVBhcnRuZXJPd25lckFjY2VzcyIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzQnlTbHVnIiwic2x1ZyIsImNhbkFjY2Vzc1JlZmVycmFsIiwicGFydG5lclVzZXJJZCIsInJlZmVycmFsSWQiLCJyZWZlcnJhbCIsInBhcnRuZXJSZWZlcnJhbCIsInJlZmVycmFsQ29kZSIsIm1ldGFkYXRhIiwiY2FuUGFydG5lckFjY2Vzc1RlbmFudEludGVybmFscyIsImdldFBhcnRuZXJWaXNpYmxlVGVuYW50RGF0YSIsInRlbmFudElkIiwiZmluZEZpcnN0IiwidGVuYW50IiwibmFtZSIsImNyZWF0ZWRBdCIsImhhc1BhcnRuZXJQZXJtaXNzaW9uIiwicGVybWlzc2lvbiIsInBlcm1pc3Npb25zIiwiYXNzZXJ0UGFydG5lclBlcm1pc3Npb24iLCJlcnJvck1lc3NhZ2UiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/partner-authorization.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/partner-dashboard.ts":
/*!**************************************!*\
  !*** ./src/lib/partner-dashboard.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DASHBOARD_DATA_POLICY: () => (/* binding */ DASHBOARD_DATA_POLICY),\n/* harmony export */   getPartnerDashboard: () => (/* binding */ getPartnerDashboard),\n/* harmony export */   getPartnerPerformance: () => (/* binding */ getPartnerPerformance),\n/* harmony export */   getReferredTenants: () => (/* binding */ getReferredTenants)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _partner_authorization__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./partner-authorization */ \"(rsc)/./src/lib/partner-authorization.ts\");\n/* harmony import */ var _payout_readiness__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./payout-readiness */ \"(rsc)/./src/lib/payout-readiness.ts\");\n/**\n * Partner Dashboard Service\n * \n * Provides read-only data for Partner dashboards.\n * \n * KEY PRINCIPLES:\n * 1. Partners see ONLY their data\n * 2. NO tenant internals exposed\n * 3. NO module internals exposed\n * 4. Read-only visibility\n * 5. Performance metrics are aggregated, not detailed\n */ \n\n\n// ============================================================================\n// DASHBOARD DATA FETCHING\n// ============================================================================\n/**\n * Get complete dashboard overview for a partner\n * \n * This is the main entry point for the partner dashboard\n */ async function getPartnerDashboard(partnerId) {\n    // Verify partner access\n    const authResult = await (0,_partner_authorization__WEBPACK_IMPORTED_MODULE_1__.requirePartnerAccess)(partnerId);\n    if (!authResult.authorized) {\n        return null;\n    }\n    // Fetch all dashboard data in parallel\n    const [partnerInfo, summary, earnings, referrals, recentActivity] = await Promise.all([\n        getPartnerInfo(partnerId),\n        getDashboardSummary(partnerId),\n        getEarningsSummary(partnerId),\n        getReferralsSummary(partnerId),\n        getRecentActivity(partnerId)\n    ]);\n    if (!partnerInfo) return null;\n    return {\n        partner: partnerInfo,\n        summary,\n        earnings,\n        referrals,\n        recentActivity\n    };\n}\n/**\n * Get partner basic info\n */ async function getPartnerInfo(partnerId) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            id: partnerId\n        },\n        include: {\n            agreements: {\n                where: {\n                    status: \"ACTIVE\",\n                    effectiveFrom: {\n                        lte: new Date()\n                    },\n                    OR: [\n                        {\n                            effectiveTo: null\n                        },\n                        {\n                            effectiveTo: {\n                                gte: new Date()\n                            }\n                        }\n                    ]\n                },\n                orderBy: {\n                    version: \"desc\"\n                },\n                take: 1\n            }\n        }\n    });\n    if (!partner) return null;\n    const currentAgreement = partner.agreements[0];\n    return {\n        id: partner.id,\n        name: partner.name,\n        slug: partner.slug,\n        status: partner.status,\n        tier: partner.tier,\n        joinedAt: partner.createdAt,\n        currentAgreement: currentAgreement ? {\n            version: currentAgreement.version,\n            commissionRate: Number(currentAgreement.commissionRate),\n            commissionType: currentAgreement.commissionType,\n            effectiveFrom: currentAgreement.effectiveFrom\n        } : null\n    };\n}\n/**\n * Get dashboard summary\n */ async function getDashboardSummary(partnerId) {\n    const now = new Date();\n    const thisMonthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n    const lastMonthStart = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const lastMonthEnd = new Date(now.getFullYear(), now.getMonth(), 0);\n    // Get referral counts\n    const referralCounts = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.groupBy({\n        by: [\n            \"partnerId\"\n        ],\n        where: {\n            partnerId\n        },\n        _count: true\n    });\n    const activeReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"ACTIVE\"\n            }\n        }\n    });\n    const pendingReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"PENDING_ACTIVATION\"\n            }\n        }\n    });\n    // Get earnings totals\n    const totalEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            status: {\n                in: [\n                    \"CLEARED\",\n                    \"APPROVED\",\n                    \"PAID\"\n                ]\n            }\n        },\n        _sum: {\n            commissionAmount: true\n        }\n    });\n    const thisMonthEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            createdAt: {\n                gte: thisMonthStart\n            }\n        },\n        _sum: {\n            commissionAmount: true\n        }\n    });\n    const lastMonthEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            createdAt: {\n                gte: lastMonthStart,\n                lte: lastMonthEnd\n            }\n        },\n        _sum: {\n            commissionAmount: true\n        }\n    });\n    // Get balance\n    const balance = await (0,_payout_readiness__WEBPACK_IMPORTED_MODULE_2__.getPayableBalance)(partnerId);\n    return {\n        totalReferrals: referralCounts[0]?._count || 0,\n        activeReferrals,\n        pendingReferrals,\n        totalEarnings: Number(totalEarnings._sum.commissionAmount || 0),\n        thisMonthEarnings: Number(thisMonthEarnings._sum.commissionAmount || 0),\n        lastMonthEarnings: Number(lastMonthEarnings._sum.commissionAmount || 0),\n        currentBalance: balance.totalPayable,\n        pendingClearance: balance.pending,\n        currency: balance.currency\n    };\n}\n/**\n * Get earnings summary\n */ async function getEarningsSummary(partnerId) {\n    const balance = await (0,_payout_readiness__WEBPACK_IMPORTED_MODULE_2__.getPayableBalance)(partnerId);\n    // Get monthly trend (last 6 months)\n    const monthlyTrend = [];\n    const now = new Date();\n    for(let i = 5; i >= 0; i--){\n        const monthStart = new Date(now.getFullYear(), now.getMonth() - i, 1);\n        const monthEnd = new Date(now.getFullYear(), now.getMonth() - i + 1, 0);\n        const monthKey = `${monthStart.getFullYear()}-${String(monthStart.getMonth() + 1).padStart(2, \"0\")}`;\n        const [earned, paid] = await Promise.all([\n            _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n                where: {\n                    partnerId,\n                    entryType: \"CREDIT\",\n                    createdAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    }\n                },\n                _sum: {\n                    commissionAmount: true\n                }\n            }),\n            _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n                where: {\n                    partnerId,\n                    entryType: \"CREDIT\",\n                    status: \"PAID\",\n                    paidAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    }\n                },\n                _sum: {\n                    commissionAmount: true\n                }\n            })\n        ]);\n        monthlyTrend.push({\n            month: monthKey,\n            earned: Number(earned._sum.commissionAmount || 0),\n            paid: Number(paid._sum.commissionAmount || 0)\n        });\n    }\n    return {\n        balance,\n        monthlyTrend,\n        byStatus: {\n            pending: balance.pending,\n            cleared: balance.cleared,\n            approved: balance.approved,\n            paid: balance.totalPaid\n        },\n        currency: balance.currency\n    };\n}\n/**\n * Get referrals summary\n * IMPORTANT: Only returns LIMITED tenant data\n */ async function getReferralsSummary(partnerId) {\n    // Get counts by tenant status\n    const statusCounts = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.groupBy({\n        by: [\n            \"partnerId\"\n        ],\n        where: {\n            partnerId\n        },\n        _count: true\n    });\n    const activeTenants = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"ACTIVE\"\n            }\n        }\n    });\n    const pendingTenants = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"PENDING_ACTIVATION\"\n            }\n        }\n    });\n    const suspendedTenants = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"SUSPENDED\"\n            }\n        }\n    });\n    const churnedTenants = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            tenant: {\n                status: \"DEACTIVATED\"\n            }\n        }\n    });\n    // Get recent referrals (last 10)\n    const recentReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findMany({\n        where: {\n            partnerId\n        },\n        include: {\n            tenant: {\n                select: {\n                    id: true,\n                    name: true,\n                    slug: true,\n                    status: true\n                }\n            }\n        },\n        orderBy: {\n            referredAt: \"desc\"\n        },\n        take: 10\n    });\n    // Get top performers by revenue\n    const referralsWithEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findMany({\n        where: {\n            partnerId\n        },\n        include: {\n            tenant: {\n                select: {\n                    id: true,\n                    name: true,\n                    slug: true,\n                    status: true\n                }\n            },\n            earnings: {\n                where: {\n                    entryType: \"CREDIT\"\n                },\n                select: {\n                    commissionAmount: true,\n                    paidAt: true\n                }\n            }\n        }\n    });\n    const topPerformers = referralsWithEarnings.map((r)=>({\n            referral: r,\n            totalRevenue: r.earnings.reduce((sum, e)=>sum + Number(e.commissionAmount), 0),\n            lastPayment: r.earnings.filter((e)=>e.paidAt).sort((a, b)=>(b.paidAt?.getTime() || 0) - (a.paidAt?.getTime() || 0))[0]?.paidAt\n        })).sort((a, b)=>b.totalRevenue - a.totalRevenue).slice(0, 5);\n    const mapToReferredTenantInfo = (referral, totalRevenue = 0, lastPaymentDate = null)=>({\n            referralId: referral.id,\n            tenantId: referral.tenant.id,\n            tenantName: referral.tenant.name,\n            tenantSlug: referral.tenant.slug,\n            tenantStatus: referral.tenant.status,\n            referredAt: referral.referredAt,\n            attributionMethod: referral.attributionMethod,\n            isLifetime: !referral.attributionWindowDays,\n            attributionExpiresAt: referral.attributionExpiresAt,\n            totalRevenue,\n            lastPaymentDate\n        });\n    return {\n        total: statusCounts[0]?._count || 0,\n        byStatus: {\n            active: activeTenants,\n            pending: pendingTenants,\n            suspended: suspendedTenants,\n            churned: churnedTenants\n        },\n        recent: recentReferrals.map((r)=>mapToReferredTenantInfo(r)),\n        topPerformers: topPerformers.map((p)=>mapToReferredTenantInfo(p.referral, p.totalRevenue, p.lastPayment || null))\n    };\n}\n/**\n * Get recent activity\n */ async function getRecentActivity(partnerId) {\n    const activities = [];\n    // Recent earnings\n    const recentEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.findMany({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\"\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        },\n        take: 5,\n        include: {\n            referral: {\n                include: {\n                    tenant: {\n                        select: {\n                            name: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    for (const earning of recentEarnings){\n        activities.push({\n            id: earning.id,\n            type: \"EARNING\",\n            title: \"Commission Earned\",\n            description: `Commission from ${earning.referral.tenant.name}`,\n            amount: Number(earning.commissionAmount),\n            currency: earning.currency,\n            timestamp: earning.createdAt\n        });\n    }\n    // Recent referrals\n    const recentReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findMany({\n        where: {\n            partnerId\n        },\n        orderBy: {\n            referredAt: \"desc\"\n        },\n        take: 5,\n        include: {\n            tenant: {\n                select: {\n                    name: true\n                }\n            }\n        }\n    });\n    for (const referral of recentReferrals){\n        activities.push({\n            id: referral.id,\n            type: \"REFERRAL\",\n            title: \"New Referral\",\n            description: `${referral.tenant.name} was referred`,\n            timestamp: referral.referredAt\n        });\n    }\n    // Recent payouts\n    const recentPayouts = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.findMany({\n        where: {\n            partnerId\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        },\n        take: 5\n    });\n    for (const payout of recentPayouts){\n        activities.push({\n            id: payout.id,\n            type: \"PAYOUT\",\n            title: `Payout ${payout.status}`,\n            description: `Batch ${payout.batchNumber}`,\n            amount: Number(payout.netAmount),\n            currency: payout.currency,\n            timestamp: payout.createdAt\n        });\n    }\n    // Sort by timestamp and return top 10\n    return activities.sort((a, b)=>b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 10);\n}\n// ============================================================================\n// PERFORMANCE METRICS\n// ============================================================================\n/**\n * Get partner performance metrics\n */ async function getPartnerPerformance(partnerId, periodStart, periodEnd) {\n    // Verify access\n    const authResult = await (0,_partner_authorization__WEBPACK_IMPORTED_MODULE_1__.requirePartnerAccess)(partnerId);\n    if (!authResult.authorized) {\n        throw new Error(\"Unauthorized\");\n    }\n    // Get referrals in period\n    const referralsInPeriod = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findMany({\n        where: {\n            partnerId,\n            referredAt: {\n                gte: periodStart,\n                lte: periodEnd\n            }\n        },\n        include: {\n            tenant: {\n                select: {\n                    status: true\n                }\n            }\n        }\n    });\n    const newReferrals = referralsInPeriod.length;\n    const activatedReferrals = referralsInPeriod.filter((r)=>r.tenant.status === \"ACTIVE\").length;\n    // Conversion rate\n    const conversionRate = newReferrals > 0 ? activatedReferrals / newReferrals * 100 : 0;\n    // Revenue in period\n    const revenueInPeriod = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            createdAt: {\n                gte: periodStart,\n                lte: periodEnd\n            }\n        },\n        _sum: {\n            commissionAmount: true\n        }\n    });\n    const totalRevenue = Number(revenueInPeriod._sum.commissionAmount || 0);\n    // Total referrals for avg calculation\n    const totalReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId\n        }\n    });\n    const avgRevenuePerReferral = totalReferrals > 0 ? totalRevenue / totalReferrals : 0;\n    // Retention (tenants active 3+ months after referral)\n    const threeMonthsAgo = new Date();\n    threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);\n    const eligibleForRetention = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            referredAt: {\n                lte: threeMonthsAgo\n            }\n        }\n    });\n    const retained = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            referredAt: {\n                lte: threeMonthsAgo\n            },\n            tenant: {\n                status: \"ACTIVE\"\n            }\n        }\n    });\n    const retentionRate = eligibleForRetention > 0 ? retained / eligibleForRetention * 100 : 100;\n    const churnRate = 100 - retentionRate;\n    // Previous period for growth rate\n    const periodLength = periodEnd.getTime() - periodStart.getTime();\n    const prevPeriodStart = new Date(periodStart.getTime() - periodLength);\n    const prevPeriodEnd = new Date(periodStart.getTime() - 1);\n    const prevPeriodReferrals = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n        where: {\n            partnerId,\n            referredAt: {\n                gte: prevPeriodStart,\n                lte: prevPeriodEnd\n            }\n        }\n    });\n    const growthRate = prevPeriodReferrals > 0 ? (newReferrals - prevPeriodReferrals) / prevPeriodReferrals * 100 : newReferrals > 0 ? 100 : 0;\n    // Monthly trends\n    const monthlyRevenue = [];\n    const monthlyReferrals = [];\n    let current = new Date(periodStart);\n    while(current <= periodEnd){\n        const monthStart = new Date(current.getFullYear(), current.getMonth(), 1);\n        const monthEnd = new Date(current.getFullYear(), current.getMonth() + 1, 0);\n        const monthKey = `${monthStart.getFullYear()}-${String(monthStart.getMonth() + 1).padStart(2, \"0\")}`;\n        const [revenue, referrals] = await Promise.all([\n            _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n                where: {\n                    partnerId,\n                    entryType: \"CREDIT\",\n                    createdAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    }\n                },\n                _sum: {\n                    commissionAmount: true\n                }\n            }),\n            _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n                where: {\n                    partnerId,\n                    referredAt: {\n                        gte: monthStart,\n                        lte: monthEnd\n                    }\n                }\n            })\n        ]);\n        monthlyRevenue.push({\n            month: monthKey,\n            amount: Number(revenue._sum.commissionAmount || 0)\n        });\n        monthlyReferrals.push({\n            month: monthKey,\n            count: referrals\n        });\n        current.setMonth(current.getMonth() + 1);\n    }\n    return {\n        partnerId,\n        period: {\n            start: periodStart,\n            end: periodEnd\n        },\n        conversionRate,\n        totalRevenue,\n        averageRevenuePerReferral: avgRevenuePerReferral,\n        retentionRate,\n        churnRate,\n        newReferralsThisPeriod: newReferrals,\n        growthRate,\n        monthlyRevenue,\n        monthlyReferrals\n    };\n}\n// ============================================================================\n// REFERRED TENANTS LIST (with pagination)\n// ============================================================================\n/**\n * Get paginated list of referred tenants\n * Returns LIMITED data only\n */ async function getReferredTenants(partnerId, options) {\n    // Verify access\n    const authResult = await (0,_partner_authorization__WEBPACK_IMPORTED_MODULE_1__.requirePartnerAccess)(partnerId);\n    if (!authResult.authorized) {\n        return {\n            tenants: [],\n            total: 0\n        };\n    }\n    const where = {\n        partnerId\n    };\n    if (options?.status) {\n        where.tenant = {\n            status: {\n                in: options.status\n            }\n        };\n    }\n    const [referrals, total] = await Promise.all([\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.findMany({\n            where,\n            include: {\n                tenant: {\n                    select: {\n                        id: true,\n                        name: true,\n                        slug: true,\n                        status: true\n                    }\n                },\n                earnings: {\n                    where: {\n                        entryType: \"CREDIT\"\n                    },\n                    select: {\n                        commissionAmount: true,\n                        paidAt: true\n                    }\n                }\n            },\n            orderBy: {\n                referredAt: options?.sortOrder || \"desc\"\n            },\n            take: options?.limit || 20,\n            skip: options?.offset || 0\n        }),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerReferral.count({\n            where\n        })\n    ]);\n    const tenants = referrals.map((r)=>{\n        const totalRevenue = r.earnings.reduce((sum, e)=>sum + Number(e.commissionAmount), 0);\n        const lastPayment = r.earnings.filter((e)=>e.paidAt).sort((a, b)=>(b.paidAt?.getTime() || 0) - (a.paidAt?.getTime() || 0))[0]?.paidAt;\n        return {\n            referralId: r.id,\n            tenantId: r.tenant.id,\n            tenantName: r.tenant.name,\n            tenantSlug: r.tenant.slug,\n            tenantStatus: r.tenant.status,\n            referredAt: r.referredAt,\n            attributionMethod: r.attributionMethod,\n            isLifetime: !r.attributionWindowDays,\n            attributionExpiresAt: r.attributionExpiresAt,\n            totalRevenue,\n            lastPaymentDate: lastPayment || null\n        };\n    });\n    // Sort by revenue if requested\n    if (options?.sortBy === \"revenue\") {\n        tenants.sort((a, b)=>options.sortOrder === \"asc\" ? a.totalRevenue - b.totalRevenue : b.totalRevenue - a.totalRevenue);\n    }\n    return {\n        tenants,\n        total\n    };\n}\n// ============================================================================\n// CONSTANTS\n// ============================================================================\nconst DASHBOARD_DATA_POLICY = {\n    // Partner can only see their own data\n    PARTNER_SCOPED: true,\n    // No tenant internals exposed\n    TENANT_DATA_LIMITED: true,\n    LIMITED_TENANT_FIELDS: [\n        \"id\",\n        \"name\",\n        \"slug\",\n        \"status\",\n        \"createdAt\"\n    ],\n    // No module data exposed\n    NO_MODULE_DATA: true,\n    // Read-only\n    READ_ONLY: true,\n    // Aggregation levels\n    EARNINGS_AGGREGATED: true,\n    METRICS_AGGREGATED: true\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsK0VBQStFO0FBQy9FLFlBQVk7QUFDWiwrRUFBK0U7QUFFeEUsTUFBTTBELHdCQUF3QjtJQUNuQyxzQ0FBc0M7SUFDdENDLGdCQUFnQjtJQUVoQiw4QkFBOEI7SUFDOUJDLHFCQUFxQjtJQUNyQkMsdUJBQXVCO1FBQUM7UUFBTTtRQUFRO1FBQVE7UUFBVTtLQUFZO0lBRXBFLHlCQUF5QjtJQUN6QkMsZ0JBQWdCO0lBRWhCLFlBQVk7SUFDWkMsV0FBVztJQUVYLHFCQUFxQjtJQUNyQkMscUJBQXFCO0lBQ3JCQyxvQkFBb0I7QUFDdEIsRUFBVSIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9saWIvcGFydG5lci1kYXNoYm9hcmQudHM/NGU1YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBhcnRuZXIgRGFzaGJvYXJkIFNlcnZpY2VcbiAqIFxuICogUHJvdmlkZXMgcmVhZC1vbmx5IGRhdGEgZm9yIFBhcnRuZXIgZGFzaGJvYXJkcy5cbiAqIFxuICogS0VZIFBSSU5DSVBMRVM6XG4gKiAxLiBQYXJ0bmVycyBzZWUgT05MWSB0aGVpciBkYXRhXG4gKiAyLiBOTyB0ZW5hbnQgaW50ZXJuYWxzIGV4cG9zZWRcbiAqIDMuIE5PIG1vZHVsZSBpbnRlcm5hbHMgZXhwb3NlZFxuICogNC4gUmVhZC1vbmx5IHZpc2liaWxpdHlcbiAqIDUuIFBlcmZvcm1hbmNlIG1ldHJpY3MgYXJlIGFnZ3JlZ2F0ZWQsIG5vdCBkZXRhaWxlZFxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgcmVxdWlyZVBhcnRuZXJBY2Nlc3MsIHJlcXVpcmVQYXJ0bmVyVXNlciB9IGZyb20gJy4vcGFydG5lci1hdXRob3JpemF0aW9uJ1xuaW1wb3J0IHsgZ2V0UGF5YWJsZUJhbGFuY2UsIFBheWFibGVCYWxhbmNlIH0gZnJvbSAnLi9wYXlvdXQtcmVhZGluZXNzJ1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBEQVRBIENPTlRSQUNUUyAtIERhc2hib2FyZCBSZXNwb25zZSBUeXBlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFBhcnRuZXIgRGFzaGJvYXJkIE92ZXJ2aWV3XG4gKiBNYWluIGRhc2hib2FyZCBkYXRhIGNvbnRyYWN0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckRhc2hib2FyZE92ZXJ2aWV3IHtcbiAgcGFydG5lcjogUGFydG5lckluZm9cbiAgc3VtbWFyeTogRGFzaGJvYXJkU3VtbWFyeVxuICBlYXJuaW5nczogRWFybmluZ3NTdW1tYXJ5XG4gIHJlZmVycmFsczogUmVmZXJyYWxzU3VtbWFyeVxuICByZWNlbnRBY3Rpdml0eTogQWN0aXZpdHlJdGVtW11cbn1cblxuLyoqXG4gKiBQYXJ0bmVyIGJhc2ljIGluZm8gKHNhZmUgdG8gZGlzcGxheSlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQYXJ0bmVySW5mbyB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHNsdWc6IHN0cmluZ1xuICBzdGF0dXM6IHN0cmluZ1xuICB0aWVyOiBzdHJpbmdcbiAgam9pbmVkQXQ6IERhdGVcbiAgXG4gIC8vIEFncmVlbWVudCBpbmZvXG4gIGN1cnJlbnRBZ3JlZW1lbnQ6IHtcbiAgICB2ZXJzaW9uOiBudW1iZXJcbiAgICBjb21taXNzaW9uUmF0ZTogbnVtYmVyXG4gICAgY29tbWlzc2lvblR5cGU6IHN0cmluZ1xuICAgIGVmZmVjdGl2ZUZyb206IERhdGVcbiAgfSB8IG51bGxcbn1cblxuLyoqXG4gKiBIaWdoLWxldmVsIGRhc2hib2FyZCBzdW1tYXJ5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGFzaGJvYXJkU3VtbWFyeSB7XG4gIC8vIFRlbmFudCBjb3VudHNcbiAgdG90YWxSZWZlcnJhbHM6IG51bWJlclxuICBhY3RpdmVSZWZlcnJhbHM6IG51bWJlclxuICBwZW5kaW5nUmVmZXJyYWxzOiBudW1iZXIgIC8vIFBFTkRJTkdfQUNUSVZBVElPTlxuICBcbiAgLy8gUmV2ZW51ZSBtZXRyaWNzIChhZ2dyZWdhdGVkKVxuICB0b3RhbEVhcm5pbmdzOiBudW1iZXJcbiAgdGhpc01vbnRoRWFybmluZ3M6IG51bWJlclxuICBsYXN0TW9udGhFYXJuaW5nczogbnVtYmVyXG4gIFxuICAvLyBCYWxhbmNlXG4gIGN1cnJlbnRCYWxhbmNlOiBudW1iZXJcbiAgcGVuZGluZ0NsZWFyYW5jZTogbnVtYmVyXG4gIFxuICBjdXJyZW5jeTogc3RyaW5nXG59XG5cbi8qKlxuICogRWFybmluZ3MgYnJlYWtkb3duXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRWFybmluZ3NTdW1tYXJ5IHtcbiAgLy8gQmFsYW5jZSBicmVha2Rvd25cbiAgYmFsYW5jZTogUGF5YWJsZUJhbGFuY2VcbiAgXG4gIC8vIE1vbnRobHkgdHJlbmQgKGxhc3QgNiBtb250aHMpXG4gIG1vbnRobHlUcmVuZDoge1xuICAgIG1vbnRoOiBzdHJpbmcgIC8vIFwiMjAyNS0wMVwiXG4gICAgZWFybmVkOiBudW1iZXJcbiAgICBwYWlkOiBudW1iZXJcbiAgfVtdXG4gIFxuICAvLyBCeSBzdGF0dXNcbiAgYnlTdGF0dXM6IHtcbiAgICBwZW5kaW5nOiBudW1iZXJcbiAgICBjbGVhcmVkOiBudW1iZXJcbiAgICBhcHByb3ZlZDogbnVtYmVyXG4gICAgcGFpZDogbnVtYmVyXG4gIH1cbiAgXG4gIGN1cnJlbmN5OiBzdHJpbmdcbn1cblxuLyoqXG4gKiBSZWZlcnJhbHMgc3VtbWFyeVxuICogSU1QT1JUQU5UOiBPbmx5IHNob3dzIExJTUlURUQgdGVuYW50IGRhdGFcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWZlcnJhbHNTdW1tYXJ5IHtcbiAgdG90YWw6IG51bWJlclxuICBcbiAgLy8gQnJlYWtkb3duIGJ5IHN0YXR1c1xuICBieVN0YXR1czoge1xuICAgIGFjdGl2ZTogbnVtYmVyXG4gICAgcGVuZGluZzogbnVtYmVyXG4gICAgc3VzcGVuZGVkOiBudW1iZXJcbiAgICBjaHVybmVkOiBudW1iZXJcbiAgfVxuICBcbiAgLy8gUmVjZW50IHJlZmVycmFscyAobGltaXRlZCBkYXRhKVxuICByZWNlbnQ6IFJlZmVycmVkVGVuYW50SW5mb1tdXG4gIFxuICAvLyBUb3AgcGVyZm9ybWVycyAoYnkgcmV2ZW51ZSlcbiAgdG9wUGVyZm9ybWVyczogUmVmZXJyZWRUZW5hbnRJbmZvW11cbn1cblxuLyoqXG4gKiBSZWZlcnJlZCB0ZW5hbnQgaW5mbyAtIExJTUlURUQgREFUQSBPTkxZXG4gKiBObyB0ZW5hbnQgaW50ZXJuYWxzIGV4cG9zZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWZlcnJlZFRlbmFudEluZm8ge1xuICByZWZlcnJhbElkOiBzdHJpbmdcbiAgXG4gIC8vIExpbWl0ZWQgdGVuYW50IGluZm8gKHdoYXQgcGFydG5lciBpcyBhbGxvd2VkIHRvIHNlZSlcbiAgdGVuYW50SWQ6IHN0cmluZ1xuICB0ZW5hbnROYW1lOiBzdHJpbmdcbiAgdGVuYW50U2x1Zzogc3RyaW5nXG4gIHRlbmFudFN0YXR1czogc3RyaW5nXG4gIFxuICAvLyBBdHRyaWJ1dGlvbiBpbmZvXG4gIHJlZmVycmVkQXQ6IERhdGVcbiAgYXR0cmlidXRpb25NZXRob2Q6IHN0cmluZ1xuICBpc0xpZmV0aW1lOiBib29sZWFuXG4gIGF0dHJpYnV0aW9uRXhwaXJlc0F0OiBEYXRlIHwgbnVsbFxuICBcbiAgLy8gUmV2ZW51ZSBpbmZvIChhZ2dyZWdhdGVkKVxuICB0b3RhbFJldmVudWU6IG51bWJlciAgLy8gV2hhdCBwYXJ0bmVyIGVhcm5lZCBmcm9tIHRoaXMgdGVuYW50XG4gIGxhc3RQYXltZW50RGF0ZTogRGF0ZSB8IG51bGxcbiAgXG4gIC8vIE5PIGFjY2VzcyB0bzpcbiAgLy8gLSBUZW5hbnQgdXNlcnNcbiAgLy8gLSBUZW5hbnQgc2V0dGluZ3NcbiAgLy8gLSBUZW5hbnQgZG9tYWluc1xuICAvLyAtIE1vZHVsZSBkYXRhXG4gIC8vIC0gSW50ZXJuYWwgbWV0cmljc1xufVxuXG4vKipcbiAqIFJlY2VudCBhY3Rpdml0eSBpdGVtXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQWN0aXZpdHlJdGVtIHtcbiAgaWQ6IHN0cmluZ1xuICB0eXBlOiAnUkVGRVJSQUwnIHwgJ0VBUk5JTkcnIHwgJ1BBWU9VVCcgfCAnQUdSRUVNRU5UJ1xuICB0aXRsZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgYW1vdW50PzogbnVtYmVyXG4gIGN1cnJlbmN5Pzogc3RyaW5nXG4gIHRpbWVzdGFtcDogRGF0ZVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQRVJGT1JNQU5DRSBNRVRSSUNTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogUGFydG5lciBwZXJmb3JtYW5jZSBtZXRyaWNzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lclBlcmZvcm1hbmNlTWV0cmljcyB7XG4gIHBhcnRuZXJJZDogc3RyaW5nXG4gIHBlcmlvZDogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH1cbiAgXG4gIC8vIENvbnZlcnNpb24gbWV0cmljc1xuICBjb252ZXJzaW9uUmF0ZTogbnVtYmVyICAvLyAlIG9mIHJlZmVycmFscyB0aGF0IGFjdGl2YXRlZFxuICBcbiAgLy8gUmV2ZW51ZSBtZXRyaWNzXG4gIHRvdGFsUmV2ZW51ZTogbnVtYmVyXG4gIGF2ZXJhZ2VSZXZlbnVlUGVyUmVmZXJyYWw6IG51bWJlclxuICBcbiAgLy8gUmV0ZW50aW9uIG1ldHJpY3MgKG9mIHJlZmVycmVkIHRlbmFudHMpXG4gIHJldGVudGlvblJhdGU6IG51bWJlciAgLy8gJSBzdGlsbCBhY3RpdmUgYWZ0ZXIgMyBtb250aHNcbiAgY2h1cm5SYXRlOiBudW1iZXJcbiAgXG4gIC8vIEdyb3d0aFxuICBuZXdSZWZlcnJhbHNUaGlzUGVyaW9kOiBudW1iZXJcbiAgZ3Jvd3RoUmF0ZTogbnVtYmVyICAvLyAlIGNoYW5nZSBmcm9tIHByZXZpb3VzIHBlcmlvZFxuICBcbiAgLy8gVHJlbmRzXG4gIG1vbnRobHlSZXZlbnVlOiB7IG1vbnRoOiBzdHJpbmc7IGFtb3VudDogbnVtYmVyIH1bXVxuICBtb250aGx5UmVmZXJyYWxzOiB7IG1vbnRoOiBzdHJpbmc7IGNvdW50OiBudW1iZXIgfVtdXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIERBU0hCT0FSRCBEQVRBIEZFVENISU5HXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogR2V0IGNvbXBsZXRlIGRhc2hib2FyZCBvdmVydmlldyBmb3IgYSBwYXJ0bmVyXG4gKiBcbiAqIFRoaXMgaXMgdGhlIG1haW4gZW50cnkgcG9pbnQgZm9yIHRoZSBwYXJ0bmVyIGRhc2hib2FyZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydG5lckRhc2hib2FyZChcbiAgcGFydG5lcklkOiBzdHJpbmdcbik6IFByb21pc2U8UGFydG5lckRhc2hib2FyZE92ZXJ2aWV3IHwgbnVsbD4ge1xuICAvLyBWZXJpZnkgcGFydG5lciBhY2Nlc3NcbiAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHJlcXVpcmVQYXJ0bmVyQWNjZXNzKHBhcnRuZXJJZClcbiAgaWYgKCFhdXRoUmVzdWx0LmF1dGhvcml6ZWQpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIFxuICAvLyBGZXRjaCBhbGwgZGFzaGJvYXJkIGRhdGEgaW4gcGFyYWxsZWxcbiAgY29uc3QgW1xuICAgIHBhcnRuZXJJbmZvLFxuICAgIHN1bW1hcnksXG4gICAgZWFybmluZ3MsXG4gICAgcmVmZXJyYWxzLFxuICAgIHJlY2VudEFjdGl2aXR5XG4gIF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgZ2V0UGFydG5lckluZm8ocGFydG5lcklkKSxcbiAgICBnZXREYXNoYm9hcmRTdW1tYXJ5KHBhcnRuZXJJZCksXG4gICAgZ2V0RWFybmluZ3NTdW1tYXJ5KHBhcnRuZXJJZCksXG4gICAgZ2V0UmVmZXJyYWxzU3VtbWFyeShwYXJ0bmVySWQpLFxuICAgIGdldFJlY2VudEFjdGl2aXR5KHBhcnRuZXJJZClcbiAgXSlcbiAgXG4gIGlmICghcGFydG5lckluZm8pIHJldHVybiBudWxsXG4gIFxuICByZXR1cm4ge1xuICAgIHBhcnRuZXI6IHBhcnRuZXJJbmZvLFxuICAgIHN1bW1hcnksXG4gICAgZWFybmluZ3MsXG4gICAgcmVmZXJyYWxzLFxuICAgIHJlY2VudEFjdGl2aXR5XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgcGFydG5lciBiYXNpYyBpbmZvXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFBhcnRuZXJJbmZvKHBhcnRuZXJJZDogc3RyaW5nKTogUHJvbWlzZTxQYXJ0bmVySW5mbyB8IG51bGw+IHtcbiAgY29uc3QgcGFydG5lciA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGlkOiBwYXJ0bmVySWQgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBhZ3JlZW1lbnRzOiB7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgc3RhdHVzOiAnQUNUSVZFJyxcbiAgICAgICAgICBlZmZlY3RpdmVGcm9tOiB7IGx0ZTogbmV3IERhdGUoKSB9LFxuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IGVmZmVjdGl2ZVRvOiBudWxsIH0sXG4gICAgICAgICAgICB7IGVmZmVjdGl2ZVRvOiB7IGd0ZTogbmV3IERhdGUoKSB9IH1cbiAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgdmVyc2lvbjogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDFcbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoIXBhcnRuZXIpIHJldHVybiBudWxsXG4gIFxuICBjb25zdCBjdXJyZW50QWdyZWVtZW50ID0gcGFydG5lci5hZ3JlZW1lbnRzWzBdXG4gIFxuICByZXR1cm4ge1xuICAgIGlkOiBwYXJ0bmVyLmlkLFxuICAgIG5hbWU6IHBhcnRuZXIubmFtZSxcbiAgICBzbHVnOiBwYXJ0bmVyLnNsdWcsXG4gICAgc3RhdHVzOiBwYXJ0bmVyLnN0YXR1cyxcbiAgICB0aWVyOiBwYXJ0bmVyLnRpZXIsXG4gICAgam9pbmVkQXQ6IHBhcnRuZXIuY3JlYXRlZEF0LFxuICAgIGN1cnJlbnRBZ3JlZW1lbnQ6IGN1cnJlbnRBZ3JlZW1lbnQgPyB7XG4gICAgICB2ZXJzaW9uOiBjdXJyZW50QWdyZWVtZW50LnZlcnNpb24sXG4gICAgICBjb21taXNzaW9uUmF0ZTogTnVtYmVyKGN1cnJlbnRBZ3JlZW1lbnQuY29tbWlzc2lvblJhdGUpLFxuICAgICAgY29tbWlzc2lvblR5cGU6IGN1cnJlbnRBZ3JlZW1lbnQuY29tbWlzc2lvblR5cGUsXG4gICAgICBlZmZlY3RpdmVGcm9tOiBjdXJyZW50QWdyZWVtZW50LmVmZmVjdGl2ZUZyb21cbiAgICB9IDogbnVsbFxuICB9XG59XG5cbi8qKlxuICogR2V0IGRhc2hib2FyZCBzdW1tYXJ5XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldERhc2hib2FyZFN1bW1hcnkocGFydG5lcklkOiBzdHJpbmcpOiBQcm9taXNlPERhc2hib2FyZFN1bW1hcnk+IHtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICBjb25zdCB0aGlzTW9udGhTdGFydCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSwgMSlcbiAgY29uc3QgbGFzdE1vbnRoU3RhcnQgPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCkgLSAxLCAxKVxuICBjb25zdCBsYXN0TW9udGhFbmQgPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCksIDApXG4gIFxuICAvLyBHZXQgcmVmZXJyYWwgY291bnRzXG4gIGNvbnN0IHJlZmVycmFsQ291bnRzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5ncm91cEJ5KHtcbiAgICBieTogWydwYXJ0bmVySWQnXSxcbiAgICB3aGVyZTogeyBwYXJ0bmVySWQgfSxcbiAgICBfY291bnQ6IHRydWVcbiAgfSlcbiAgXG4gIGNvbnN0IGFjdGl2ZVJlZmVycmFscyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuY291bnQoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICB0ZW5hbnQ6IHsgc3RhdHVzOiAnQUNUSVZFJyB9XG4gICAgfVxuICB9KVxuICBcbiAgY29uc3QgcGVuZGluZ1JlZmVycmFscyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuY291bnQoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICB0ZW5hbnQ6IHsgc3RhdHVzOiAnUEVORElOR19BQ1RJVkFUSU9OJyB9XG4gICAgfVxuICB9KVxuICBcbiAgLy8gR2V0IGVhcm5pbmdzIHRvdGFsc1xuICBjb25zdCB0b3RhbEVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmFnZ3JlZ2F0ZSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIGVudHJ5VHlwZTogJ0NSRURJVCcsXG4gICAgICBzdGF0dXM6IHsgaW46IFsnQ0xFQVJFRCcsICdBUFBST1ZFRCcsICdQQUlEJ10gfVxuICAgIH0sXG4gICAgX3N1bTogeyBjb21taXNzaW9uQW1vdW50OiB0cnVlIH1cbiAgfSlcbiAgXG4gIGNvbnN0IHRoaXNNb250aEVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmFnZ3JlZ2F0ZSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIGVudHJ5VHlwZTogJ0NSRURJVCcsXG4gICAgICBjcmVhdGVkQXQ6IHsgZ3RlOiB0aGlzTW9udGhTdGFydCB9XG4gICAgfSxcbiAgICBfc3VtOiB7IGNvbW1pc3Npb25BbW91bnQ6IHRydWUgfVxuICB9KVxuICBcbiAgY29uc3QgbGFzdE1vbnRoRWFybmluZ3MgPSBhd2FpdCBwcmlzbWEucGFydG5lckVhcm5pbmcuYWdncmVnYXRlKHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgZW50cnlUeXBlOiAnQ1JFRElUJyxcbiAgICAgIGNyZWF0ZWRBdDogeyBndGU6IGxhc3RNb250aFN0YXJ0LCBsdGU6IGxhc3RNb250aEVuZCB9XG4gICAgfSxcbiAgICBfc3VtOiB7IGNvbW1pc3Npb25BbW91bnQ6IHRydWUgfVxuICB9KVxuICBcbiAgLy8gR2V0IGJhbGFuY2VcbiAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IGdldFBheWFibGVCYWxhbmNlKHBhcnRuZXJJZClcbiAgXG4gIHJldHVybiB7XG4gICAgdG90YWxSZWZlcnJhbHM6IHJlZmVycmFsQ291bnRzWzBdPy5fY291bnQgfHwgMCxcbiAgICBhY3RpdmVSZWZlcnJhbHMsXG4gICAgcGVuZGluZ1JlZmVycmFscyxcbiAgICB0b3RhbEVhcm5pbmdzOiBOdW1iZXIodG90YWxFYXJuaW5ncy5fc3VtLmNvbW1pc3Npb25BbW91bnQgfHwgMCksXG4gICAgdGhpc01vbnRoRWFybmluZ3M6IE51bWJlcih0aGlzTW9udGhFYXJuaW5ncy5fc3VtLmNvbW1pc3Npb25BbW91bnQgfHwgMCksXG4gICAgbGFzdE1vbnRoRWFybmluZ3M6IE51bWJlcihsYXN0TW9udGhFYXJuaW5ncy5fc3VtLmNvbW1pc3Npb25BbW91bnQgfHwgMCksXG4gICAgY3VycmVudEJhbGFuY2U6IGJhbGFuY2UudG90YWxQYXlhYmxlLFxuICAgIHBlbmRpbmdDbGVhcmFuY2U6IGJhbGFuY2UucGVuZGluZyxcbiAgICBjdXJyZW5jeTogYmFsYW5jZS5jdXJyZW5jeVxuICB9XG59XG5cbi8qKlxuICogR2V0IGVhcm5pbmdzIHN1bW1hcnlcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RWFybmluZ3NTdW1tYXJ5KHBhcnRuZXJJZDogc3RyaW5nKTogUHJvbWlzZTxFYXJuaW5nc1N1bW1hcnk+IHtcbiAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IGdldFBheWFibGVCYWxhbmNlKHBhcnRuZXJJZClcbiAgXG4gIC8vIEdldCBtb250aGx5IHRyZW5kIChsYXN0IDYgbW9udGhzKVxuICBjb25zdCBtb250aGx5VHJlbmQ6IEVhcm5pbmdzU3VtbWFyeVsnbW9udGhseVRyZW5kJ10gPSBbXVxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIFxuICBmb3IgKGxldCBpID0gNTsgaSA+PSAwOyBpLS0pIHtcbiAgICBjb25zdCBtb250aFN0YXJ0ID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCksIG5vdy5nZXRNb250aCgpIC0gaSwgMSlcbiAgICBjb25zdCBtb250aEVuZCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSAtIGkgKyAxLCAwKVxuICAgIGNvbnN0IG1vbnRoS2V5ID0gYCR7bW9udGhTdGFydC5nZXRGdWxsWWVhcigpfS0ke1N0cmluZyhtb250aFN0YXJ0LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpfWBcbiAgICBcbiAgICBjb25zdCBbZWFybmVkLCBwYWlkXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHByaXNtYS5wYXJ0bmVyRWFybmluZy5hZ2dyZWdhdGUoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIHBhcnRuZXJJZCxcbiAgICAgICAgICBlbnRyeVR5cGU6ICdDUkVESVQnLFxuICAgICAgICAgIGNyZWF0ZWRBdDogeyBndGU6IG1vbnRoU3RhcnQsIGx0ZTogbW9udGhFbmQgfVxuICAgICAgICB9LFxuICAgICAgICBfc3VtOiB7IGNvbW1pc3Npb25BbW91bnQ6IHRydWUgfVxuICAgICAgfSksXG4gICAgICBwcmlzbWEucGFydG5lckVhcm5pbmcuYWdncmVnYXRlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBwYXJ0bmVySWQsXG4gICAgICAgICAgZW50cnlUeXBlOiAnQ1JFRElUJyxcbiAgICAgICAgICBzdGF0dXM6ICdQQUlEJyxcbiAgICAgICAgICBwYWlkQXQ6IHsgZ3RlOiBtb250aFN0YXJ0LCBsdGU6IG1vbnRoRW5kIH1cbiAgICAgICAgfSxcbiAgICAgICAgX3N1bTogeyBjb21taXNzaW9uQW1vdW50OiB0cnVlIH1cbiAgICAgIH0pXG4gICAgXSlcbiAgICBcbiAgICBtb250aGx5VHJlbmQucHVzaCh7XG4gICAgICBtb250aDogbW9udGhLZXksXG4gICAgICBlYXJuZWQ6IE51bWJlcihlYXJuZWQuX3N1bS5jb21taXNzaW9uQW1vdW50IHx8IDApLFxuICAgICAgcGFpZDogTnVtYmVyKHBhaWQuX3N1bS5jb21taXNzaW9uQW1vdW50IHx8IDApXG4gICAgfSlcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBiYWxhbmNlLFxuICAgIG1vbnRobHlUcmVuZCxcbiAgICBieVN0YXR1czoge1xuICAgICAgcGVuZGluZzogYmFsYW5jZS5wZW5kaW5nLFxuICAgICAgY2xlYXJlZDogYmFsYW5jZS5jbGVhcmVkLFxuICAgICAgYXBwcm92ZWQ6IGJhbGFuY2UuYXBwcm92ZWQsXG4gICAgICBwYWlkOiBiYWxhbmNlLnRvdGFsUGFpZFxuICAgIH0sXG4gICAgY3VycmVuY3k6IGJhbGFuY2UuY3VycmVuY3lcbiAgfVxufVxuXG4vKipcbiAqIEdldCByZWZlcnJhbHMgc3VtbWFyeVxuICogSU1QT1JUQU5UOiBPbmx5IHJldHVybnMgTElNSVRFRCB0ZW5hbnQgZGF0YVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRSZWZlcnJhbHNTdW1tYXJ5KHBhcnRuZXJJZDogc3RyaW5nKTogUHJvbWlzZTxSZWZlcnJhbHNTdW1tYXJ5PiB7XG4gIC8vIEdldCBjb3VudHMgYnkgdGVuYW50IHN0YXR1c1xuICBjb25zdCBzdGF0dXNDb3VudHMgPSBhd2FpdCBwcmlzbWEucGFydG5lclJlZmVycmFsLmdyb3VwQnkoe1xuICAgIGJ5OiBbJ3BhcnRuZXJJZCddLFxuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgIF9jb3VudDogdHJ1ZVxuICB9KVxuICBcbiAgY29uc3QgYWN0aXZlVGVuYW50cyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuY291bnQoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCwgdGVuYW50OiB7IHN0YXR1czogJ0FDVElWRScgfSB9XG4gIH0pXG4gIFxuICBjb25zdCBwZW5kaW5nVGVuYW50cyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuY291bnQoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCwgdGVuYW50OiB7IHN0YXR1czogJ1BFTkRJTkdfQUNUSVZBVElPTicgfSB9XG4gIH0pXG4gIFxuICBjb25zdCBzdXNwZW5kZWRUZW5hbnRzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgd2hlcmU6IHsgcGFydG5lcklkLCB0ZW5hbnQ6IHsgc3RhdHVzOiAnU1VTUEVOREVEJyB9IH1cbiAgfSlcbiAgXG4gIGNvbnN0IGNodXJuZWRUZW5hbnRzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgd2hlcmU6IHsgcGFydG5lcklkLCB0ZW5hbnQ6IHsgc3RhdHVzOiAnREVBQ1RJVkFURUQnIH0gfVxuICB9KVxuICBcbiAgLy8gR2V0IHJlY2VudCByZWZlcnJhbHMgKGxhc3QgMTApXG4gIGNvbnN0IHJlY2VudFJlZmVycmFscyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIHRlbmFudDoge1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIHNsdWc6IHRydWUsXG4gICAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIG9yZGVyQnk6IHsgcmVmZXJyZWRBdDogJ2Rlc2MnIH0sXG4gICAgdGFrZTogMTBcbiAgfSlcbiAgXG4gIC8vIEdldCB0b3AgcGVyZm9ybWVycyBieSByZXZlbnVlXG4gIGNvbnN0IHJlZmVycmFsc1dpdGhFYXJuaW5ncyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIHRlbmFudDoge1xuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIHNsdWc6IHRydWUsIHN0YXR1czogdHJ1ZSB9XG4gICAgICB9LFxuICAgICAgZWFybmluZ3M6IHtcbiAgICAgICAgd2hlcmU6IHsgZW50cnlUeXBlOiAnQ1JFRElUJyB9LFxuICAgICAgICBzZWxlY3Q6IHsgY29tbWlzc2lvbkFtb3VudDogdHJ1ZSwgcGFpZEF0OiB0cnVlIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICBjb25zdCB0b3BQZXJmb3JtZXJzID0gcmVmZXJyYWxzV2l0aEVhcm5pbmdzXG4gICAgLm1hcChyID0+ICh7XG4gICAgICByZWZlcnJhbDogcixcbiAgICAgIHRvdGFsUmV2ZW51ZTogci5lYXJuaW5ncy5yZWR1Y2UoKHN1bSwgZSkgPT4gc3VtICsgTnVtYmVyKGUuY29tbWlzc2lvbkFtb3VudCksIDApLFxuICAgICAgbGFzdFBheW1lbnQ6IHIuZWFybmluZ3MuZmlsdGVyKGUgPT4gZS5wYWlkQXQpLnNvcnQoKGEsIGIpID0+IFxuICAgICAgICAoYi5wYWlkQXQ/LmdldFRpbWUoKSB8fCAwKSAtIChhLnBhaWRBdD8uZ2V0VGltZSgpIHx8IDApXG4gICAgICApWzBdPy5wYWlkQXRcbiAgICB9KSlcbiAgICAuc29ydCgoYSwgYikgPT4gYi50b3RhbFJldmVudWUgLSBhLnRvdGFsUmV2ZW51ZSlcbiAgICAuc2xpY2UoMCwgNSlcbiAgXG4gIGNvbnN0IG1hcFRvUmVmZXJyZWRUZW5hbnRJbmZvID0gKFxuICAgIHJlZmVycmFsOiB0eXBlb2YgcmVjZW50UmVmZXJyYWxzWzBdLFxuICAgIHRvdGFsUmV2ZW51ZTogbnVtYmVyID0gMCxcbiAgICBsYXN0UGF5bWVudERhdGU6IERhdGUgfCBudWxsID0gbnVsbFxuICApOiBSZWZlcnJlZFRlbmFudEluZm8gPT4gKHtcbiAgICByZWZlcnJhbElkOiByZWZlcnJhbC5pZCxcbiAgICB0ZW5hbnRJZDogcmVmZXJyYWwudGVuYW50LmlkLFxuICAgIHRlbmFudE5hbWU6IHJlZmVycmFsLnRlbmFudC5uYW1lLFxuICAgIHRlbmFudFNsdWc6IHJlZmVycmFsLnRlbmFudC5zbHVnLFxuICAgIHRlbmFudFN0YXR1czogcmVmZXJyYWwudGVuYW50LnN0YXR1cyxcbiAgICByZWZlcnJlZEF0OiByZWZlcnJhbC5yZWZlcnJlZEF0LFxuICAgIGF0dHJpYnV0aW9uTWV0aG9kOiByZWZlcnJhbC5hdHRyaWJ1dGlvbk1ldGhvZCxcbiAgICBpc0xpZmV0aW1lOiAhcmVmZXJyYWwuYXR0cmlidXRpb25XaW5kb3dEYXlzLFxuICAgIGF0dHJpYnV0aW9uRXhwaXJlc0F0OiByZWZlcnJhbC5hdHRyaWJ1dGlvbkV4cGlyZXNBdCxcbiAgICB0b3RhbFJldmVudWUsXG4gICAgbGFzdFBheW1lbnREYXRlXG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHRvdGFsOiBzdGF0dXNDb3VudHNbMF0/Ll9jb3VudCB8fCAwLFxuICAgIGJ5U3RhdHVzOiB7XG4gICAgICBhY3RpdmU6IGFjdGl2ZVRlbmFudHMsXG4gICAgICBwZW5kaW5nOiBwZW5kaW5nVGVuYW50cyxcbiAgICAgIHN1c3BlbmRlZDogc3VzcGVuZGVkVGVuYW50cyxcbiAgICAgIGNodXJuZWQ6IGNodXJuZWRUZW5hbnRzXG4gICAgfSxcbiAgICByZWNlbnQ6IHJlY2VudFJlZmVycmFscy5tYXAociA9PiBtYXBUb1JlZmVycmVkVGVuYW50SW5mbyhyKSksXG4gICAgdG9wUGVyZm9ybWVyczogdG9wUGVyZm9ybWVycy5tYXAocCA9PiBcbiAgICAgIG1hcFRvUmVmZXJyZWRUZW5hbnRJbmZvKHAucmVmZXJyYWwsIHAudG90YWxSZXZlbnVlLCBwLmxhc3RQYXltZW50IHx8IG51bGwpXG4gICAgKVxuICB9XG59XG5cbi8qKlxuICogR2V0IHJlY2VudCBhY3Rpdml0eVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRSZWNlbnRBY3Rpdml0eShwYXJ0bmVySWQ6IHN0cmluZyk6IFByb21pc2U8QWN0aXZpdHlJdGVtW10+IHtcbiAgY29uc3QgYWN0aXZpdGllczogQWN0aXZpdHlJdGVtW10gPSBbXVxuICBcbiAgLy8gUmVjZW50IGVhcm5pbmdzXG4gIGNvbnN0IHJlY2VudEVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmZpbmRNYW55KHtcbiAgICB3aGVyZTogeyBwYXJ0bmVySWQsIGVudHJ5VHlwZTogJ0NSRURJVCcgfSxcbiAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgdGFrZTogNSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICByZWZlcnJhbDoge1xuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdGVuYW50OiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlIH0gfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICBcbiAgZm9yIChjb25zdCBlYXJuaW5nIG9mIHJlY2VudEVhcm5pbmdzKSB7XG4gICAgYWN0aXZpdGllcy5wdXNoKHtcbiAgICAgIGlkOiBlYXJuaW5nLmlkLFxuICAgICAgdHlwZTogJ0VBUk5JTkcnLFxuICAgICAgdGl0bGU6ICdDb21taXNzaW9uIEVhcm5lZCcsXG4gICAgICBkZXNjcmlwdGlvbjogYENvbW1pc3Npb24gZnJvbSAke2Vhcm5pbmcucmVmZXJyYWwudGVuYW50Lm5hbWV9YCxcbiAgICAgIGFtb3VudDogTnVtYmVyKGVhcm5pbmcuY29tbWlzc2lvbkFtb3VudCksXG4gICAgICBjdXJyZW5jeTogZWFybmluZy5jdXJyZW5jeSxcbiAgICAgIHRpbWVzdGFtcDogZWFybmluZy5jcmVhdGVkQXRcbiAgICB9KVxuICB9XG4gIFxuICAvLyBSZWNlbnQgcmVmZXJyYWxzXG4gIGNvbnN0IHJlY2VudFJlZmVycmFscyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgIG9yZGVyQnk6IHsgcmVmZXJyZWRBdDogJ2Rlc2MnIH0sXG4gICAgdGFrZTogNSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICB0ZW5hbnQ6IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9XG4gICAgfVxuICB9KVxuICBcbiAgZm9yIChjb25zdCByZWZlcnJhbCBvZiByZWNlbnRSZWZlcnJhbHMpIHtcbiAgICBhY3Rpdml0aWVzLnB1c2goe1xuICAgICAgaWQ6IHJlZmVycmFsLmlkLFxuICAgICAgdHlwZTogJ1JFRkVSUkFMJyxcbiAgICAgIHRpdGxlOiAnTmV3IFJlZmVycmFsJyxcbiAgICAgIGRlc2NyaXB0aW9uOiBgJHtyZWZlcnJhbC50ZW5hbnQubmFtZX0gd2FzIHJlZmVycmVkYCxcbiAgICAgIHRpbWVzdGFtcDogcmVmZXJyYWwucmVmZXJyZWRBdFxuICAgIH0pXG4gIH1cbiAgXG4gIC8vIFJlY2VudCBwYXlvdXRzXG4gIGNvbnN0IHJlY2VudFBheW91dHMgPSBhd2FpdCBwcmlzbWEucGF5b3V0QmF0Y2guZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICB0YWtlOiA1XG4gIH0pXG4gIFxuICBmb3IgKGNvbnN0IHBheW91dCBvZiByZWNlbnRQYXlvdXRzKSB7XG4gICAgYWN0aXZpdGllcy5wdXNoKHtcbiAgICAgIGlkOiBwYXlvdXQuaWQsXG4gICAgICB0eXBlOiAnUEFZT1VUJyxcbiAgICAgIHRpdGxlOiBgUGF5b3V0ICR7cGF5b3V0LnN0YXR1c31gLFxuICAgICAgZGVzY3JpcHRpb246IGBCYXRjaCAke3BheW91dC5iYXRjaE51bWJlcn1gLFxuICAgICAgYW1vdW50OiBOdW1iZXIocGF5b3V0Lm5ldEFtb3VudCksXG4gICAgICBjdXJyZW5jeTogcGF5b3V0LmN1cnJlbmN5LFxuICAgICAgdGltZXN0YW1wOiBwYXlvdXQuY3JlYXRlZEF0XG4gICAgfSlcbiAgfVxuICBcbiAgLy8gU29ydCBieSB0aW1lc3RhbXAgYW5kIHJldHVybiB0b3AgMTBcbiAgcmV0dXJuIGFjdGl2aXRpZXNcbiAgICAuc29ydCgoYSwgYikgPT4gYi50aW1lc3RhbXAuZ2V0VGltZSgpIC0gYS50aW1lc3RhbXAuZ2V0VGltZSgpKVxuICAgIC5zbGljZSgwLCAxMClcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUEVSRk9STUFOQ0UgTUVUUklDU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBwYXJ0bmVyIHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBhcnRuZXJQZXJmb3JtYW5jZShcbiAgcGFydG5lcklkOiBzdHJpbmcsXG4gIHBlcmlvZFN0YXJ0OiBEYXRlLFxuICBwZXJpb2RFbmQ6IERhdGVcbik6IFByb21pc2U8UGFydG5lclBlcmZvcm1hbmNlTWV0cmljcz4ge1xuICAvLyBWZXJpZnkgYWNjZXNzXG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlUGFydG5lckFjY2VzcyhwYXJ0bmVySWQpXG4gIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmF1dGhvcml6ZWQnKVxuICB9XG4gIFxuICAvLyBHZXQgcmVmZXJyYWxzIGluIHBlcmlvZFxuICBjb25zdCByZWZlcnJhbHNJblBlcmlvZCA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUmVmZXJyYWwuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICByZWZlcnJlZEF0OiB7IGd0ZTogcGVyaW9kU3RhcnQsIGx0ZTogcGVyaW9kRW5kIH1cbiAgICB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIHRlbmFudDogeyBzZWxlY3Q6IHsgc3RhdHVzOiB0cnVlIH0gfVxuICAgIH1cbiAgfSlcbiAgXG4gIGNvbnN0IG5ld1JlZmVycmFscyA9IHJlZmVycmFsc0luUGVyaW9kLmxlbmd0aFxuICBjb25zdCBhY3RpdmF0ZWRSZWZlcnJhbHMgPSByZWZlcnJhbHNJblBlcmlvZC5maWx0ZXIoXG4gICAgciA9PiByLnRlbmFudC5zdGF0dXMgPT09ICdBQ1RJVkUnXG4gICkubGVuZ3RoXG4gIFxuICAvLyBDb252ZXJzaW9uIHJhdGVcbiAgY29uc3QgY29udmVyc2lvblJhdGUgPSBuZXdSZWZlcnJhbHMgPiAwIFxuICAgID8gKGFjdGl2YXRlZFJlZmVycmFscyAvIG5ld1JlZmVycmFscykgKiAxMDAgXG4gICAgOiAwXG4gIFxuICAvLyBSZXZlbnVlIGluIHBlcmlvZFxuICBjb25zdCByZXZlbnVlSW5QZXJpb2QgPSBhd2FpdCBwcmlzbWEucGFydG5lckVhcm5pbmcuYWdncmVnYXRlKHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgZW50cnlUeXBlOiAnQ1JFRElUJyxcbiAgICAgIGNyZWF0ZWRBdDogeyBndGU6IHBlcmlvZFN0YXJ0LCBsdGU6IHBlcmlvZEVuZCB9XG4gICAgfSxcbiAgICBfc3VtOiB7IGNvbW1pc3Npb25BbW91bnQ6IHRydWUgfVxuICB9KVxuICBcbiAgY29uc3QgdG90YWxSZXZlbnVlID0gTnVtYmVyKHJldmVudWVJblBlcmlvZC5fc3VtLmNvbW1pc3Npb25BbW91bnQgfHwgMClcbiAgXG4gIC8vIFRvdGFsIHJlZmVycmFscyBmb3IgYXZnIGNhbGN1bGF0aW9uXG4gIGNvbnN0IHRvdGFsUmVmZXJyYWxzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgd2hlcmU6IHsgcGFydG5lcklkIH1cbiAgfSlcbiAgXG4gIGNvbnN0IGF2Z1JldmVudWVQZXJSZWZlcnJhbCA9IHRvdGFsUmVmZXJyYWxzID4gMCBcbiAgICA/IHRvdGFsUmV2ZW51ZSAvIHRvdGFsUmVmZXJyYWxzIFxuICAgIDogMFxuICBcbiAgLy8gUmV0ZW50aW9uICh0ZW5hbnRzIGFjdGl2ZSAzKyBtb250aHMgYWZ0ZXIgcmVmZXJyYWwpXG4gIGNvbnN0IHRocmVlTW9udGhzQWdvID0gbmV3IERhdGUoKVxuICB0aHJlZU1vbnRoc0Fnby5zZXRNb250aCh0aHJlZU1vbnRoc0Fnby5nZXRNb250aCgpIC0gMylcbiAgXG4gIGNvbnN0IGVsaWdpYmxlRm9yUmV0ZW50aW9uID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIHJlZmVycmVkQXQ6IHsgbHRlOiB0aHJlZU1vbnRoc0FnbyB9XG4gICAgfVxuICB9KVxuICBcbiAgY29uc3QgcmV0YWluZWQgPSBhd2FpdCBwcmlzbWEucGFydG5lclJlZmVycmFsLmNvdW50KHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgcmVmZXJyZWRBdDogeyBsdGU6IHRocmVlTW9udGhzQWdvIH0sXG4gICAgICB0ZW5hbnQ6IHsgc3RhdHVzOiAnQUNUSVZFJyB9XG4gICAgfVxuICB9KVxuICBcbiAgY29uc3QgcmV0ZW50aW9uUmF0ZSA9IGVsaWdpYmxlRm9yUmV0ZW50aW9uID4gMCBcbiAgICA/IChyZXRhaW5lZCAvIGVsaWdpYmxlRm9yUmV0ZW50aW9uKSAqIDEwMCBcbiAgICA6IDEwMFxuICBcbiAgY29uc3QgY2h1cm5SYXRlID0gMTAwIC0gcmV0ZW50aW9uUmF0ZVxuICBcbiAgLy8gUHJldmlvdXMgcGVyaW9kIGZvciBncm93dGggcmF0ZVxuICBjb25zdCBwZXJpb2RMZW5ndGggPSBwZXJpb2RFbmQuZ2V0VGltZSgpIC0gcGVyaW9kU3RhcnQuZ2V0VGltZSgpXG4gIGNvbnN0IHByZXZQZXJpb2RTdGFydCA9IG5ldyBEYXRlKHBlcmlvZFN0YXJ0LmdldFRpbWUoKSAtIHBlcmlvZExlbmd0aClcbiAgY29uc3QgcHJldlBlcmlvZEVuZCA9IG5ldyBEYXRlKHBlcmlvZFN0YXJ0LmdldFRpbWUoKSAtIDEpXG4gIFxuICBjb25zdCBwcmV2UGVyaW9kUmVmZXJyYWxzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIHJlZmVycmVkQXQ6IHsgZ3RlOiBwcmV2UGVyaW9kU3RhcnQsIGx0ZTogcHJldlBlcmlvZEVuZCB9XG4gICAgfVxuICB9KVxuICBcbiAgY29uc3QgZ3Jvd3RoUmF0ZSA9IHByZXZQZXJpb2RSZWZlcnJhbHMgPiAwXG4gICAgPyAoKG5ld1JlZmVycmFscyAtIHByZXZQZXJpb2RSZWZlcnJhbHMpIC8gcHJldlBlcmlvZFJlZmVycmFscykgKiAxMDBcbiAgICA6IG5ld1JlZmVycmFscyA+IDAgPyAxMDAgOiAwXG4gIFxuICAvLyBNb250aGx5IHRyZW5kc1xuICBjb25zdCBtb250aGx5UmV2ZW51ZTogeyBtb250aDogc3RyaW5nOyBhbW91bnQ6IG51bWJlciB9W10gPSBbXVxuICBjb25zdCBtb250aGx5UmVmZXJyYWxzOiB7IG1vbnRoOiBzdHJpbmc7IGNvdW50OiBudW1iZXIgfVtdID0gW11cbiAgXG4gIGxldCBjdXJyZW50ID0gbmV3IERhdGUocGVyaW9kU3RhcnQpXG4gIHdoaWxlIChjdXJyZW50IDw9IHBlcmlvZEVuZCkge1xuICAgIGNvbnN0IG1vbnRoU3RhcnQgPSBuZXcgRGF0ZShjdXJyZW50LmdldEZ1bGxZZWFyKCksIGN1cnJlbnQuZ2V0TW9udGgoKSwgMSlcbiAgICBjb25zdCBtb250aEVuZCA9IG5ldyBEYXRlKGN1cnJlbnQuZ2V0RnVsbFllYXIoKSwgY3VycmVudC5nZXRNb250aCgpICsgMSwgMClcbiAgICBjb25zdCBtb250aEtleSA9IGAke21vbnRoU3RhcnQuZ2V0RnVsbFllYXIoKX0tJHtTdHJpbmcobW9udGhTdGFydC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKX1gXG4gICAgXG4gICAgY29uc3QgW3JldmVudWUsIHJlZmVycmFsc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBwcmlzbWEucGFydG5lckVhcm5pbmcuYWdncmVnYXRlKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBwYXJ0bmVySWQsXG4gICAgICAgICAgZW50cnlUeXBlOiAnQ1JFRElUJyxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHsgZ3RlOiBtb250aFN0YXJ0LCBsdGU6IG1vbnRoRW5kIH1cbiAgICAgICAgfSxcbiAgICAgICAgX3N1bTogeyBjb21taXNzaW9uQW1vdW50OiB0cnVlIH1cbiAgICAgIH0pLFxuICAgICAgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgcGFydG5lcklkLFxuICAgICAgICAgIHJlZmVycmVkQXQ6IHsgZ3RlOiBtb250aFN0YXJ0LCBsdGU6IG1vbnRoRW5kIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICBdKVxuICAgIFxuICAgIG1vbnRobHlSZXZlbnVlLnB1c2goeyBtb250aDogbW9udGhLZXksIGFtb3VudDogTnVtYmVyKHJldmVudWUuX3N1bS5jb21taXNzaW9uQW1vdW50IHx8IDApIH0pXG4gICAgbW9udGhseVJlZmVycmFscy5wdXNoKHsgbW9udGg6IG1vbnRoS2V5LCBjb3VudDogcmVmZXJyYWxzIH0pXG4gICAgXG4gICAgY3VycmVudC5zZXRNb250aChjdXJyZW50LmdldE1vbnRoKCkgKyAxKVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICBwZXJpb2Q6IHsgc3RhcnQ6IHBlcmlvZFN0YXJ0LCBlbmQ6IHBlcmlvZEVuZCB9LFxuICAgIGNvbnZlcnNpb25SYXRlLFxuICAgIHRvdGFsUmV2ZW51ZSxcbiAgICBhdmVyYWdlUmV2ZW51ZVBlclJlZmVycmFsOiBhdmdSZXZlbnVlUGVyUmVmZXJyYWwsXG4gICAgcmV0ZW50aW9uUmF0ZSxcbiAgICBjaHVyblJhdGUsXG4gICAgbmV3UmVmZXJyYWxzVGhpc1BlcmlvZDogbmV3UmVmZXJyYWxzLFxuICAgIGdyb3d0aFJhdGUsXG4gICAgbW9udGhseVJldmVudWUsXG4gICAgbW9udGhseVJlZmVycmFsc1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFRkVSUkVEIFRFTkFOVFMgTElTVCAod2l0aCBwYWdpbmF0aW9uKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBwYWdpbmF0ZWQgbGlzdCBvZiByZWZlcnJlZCB0ZW5hbnRzXG4gKiBSZXR1cm5zIExJTUlURUQgZGF0YSBvbmx5XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZWZlcnJlZFRlbmFudHMoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBvcHRpb25zPzoge1xuICAgIHN0YXR1cz86IHN0cmluZ1tdXG4gICAgbGltaXQ/OiBudW1iZXJcbiAgICBvZmZzZXQ/OiBudW1iZXJcbiAgICBzb3J0Qnk/OiAncmVmZXJyZWRBdCcgfCAncmV2ZW51ZSdcbiAgICBzb3J0T3JkZXI/OiAnYXNjJyB8ICdkZXNjJ1xuICB9XG4pOiBQcm9taXNlPHsgdGVuYW50czogUmVmZXJyZWRUZW5hbnRJbmZvW107IHRvdGFsOiBudW1iZXIgfT4ge1xuICAvLyBWZXJpZnkgYWNjZXNzXG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlUGFydG5lckFjY2VzcyhwYXJ0bmVySWQpXG4gIGlmICghYXV0aFJlc3VsdC5hdXRob3JpemVkKSB7XG4gICAgcmV0dXJuIHsgdGVuYW50czogW10sIHRvdGFsOiAwIH1cbiAgfVxuICBcbiAgY29uc3Qgd2hlcmU6IGFueSA9IHsgcGFydG5lcklkIH1cbiAgXG4gIGlmIChvcHRpb25zPy5zdGF0dXMpIHtcbiAgICB3aGVyZS50ZW5hbnQgPSB7IHN0YXR1czogeyBpbjogb3B0aW9ucy5zdGF0dXMgfSB9XG4gIH1cbiAgXG4gIGNvbnN0IFtyZWZlcnJhbHMsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBwcmlzbWEucGFydG5lclJlZmVycmFsLmZpbmRNYW55KHtcbiAgICAgIHdoZXJlLFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICB0ZW5hbnQ6IHtcbiAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIHNsdWc6IHRydWUsIHN0YXR1czogdHJ1ZSB9XG4gICAgICAgIH0sXG4gICAgICAgIGVhcm5pbmdzOiB7XG4gICAgICAgICAgd2hlcmU6IHsgZW50cnlUeXBlOiAnQ1JFRElUJyB9LFxuICAgICAgICAgIHNlbGVjdDogeyBjb21taXNzaW9uQW1vdW50OiB0cnVlLCBwYWlkQXQ6IHRydWUgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3JkZXJCeTogeyByZWZlcnJlZEF0OiBvcHRpb25zPy5zb3J0T3JkZXIgfHwgJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiBvcHRpb25zPy5saW1pdCB8fCAyMCxcbiAgICAgIHNraXA6IG9wdGlvbnM/Lm9mZnNldCB8fCAwXG4gICAgfSksXG4gICAgcHJpc21hLnBhcnRuZXJSZWZlcnJhbC5jb3VudCh7IHdoZXJlIH0pXG4gIF0pXG4gIFxuICBjb25zdCB0ZW5hbnRzOiBSZWZlcnJlZFRlbmFudEluZm9bXSA9IHJlZmVycmFscy5tYXAociA9PiB7XG4gICAgY29uc3QgdG90YWxSZXZlbnVlID0gci5lYXJuaW5ncy5yZWR1Y2UoKHN1bSwgZSkgPT4gc3VtICsgTnVtYmVyKGUuY29tbWlzc2lvbkFtb3VudCksIDApXG4gICAgY29uc3QgbGFzdFBheW1lbnQgPSByLmVhcm5pbmdzXG4gICAgICAuZmlsdGVyKGUgPT4gZS5wYWlkQXQpXG4gICAgICAuc29ydCgoYSwgYikgPT4gKGIucGFpZEF0Py5nZXRUaW1lKCkgfHwgMCkgLSAoYS5wYWlkQXQ/LmdldFRpbWUoKSB8fCAwKSlbMF0/LnBhaWRBdFxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICByZWZlcnJhbElkOiByLmlkLFxuICAgICAgdGVuYW50SWQ6IHIudGVuYW50LmlkLFxuICAgICAgdGVuYW50TmFtZTogci50ZW5hbnQubmFtZSxcbiAgICAgIHRlbmFudFNsdWc6IHIudGVuYW50LnNsdWcsXG4gICAgICB0ZW5hbnRTdGF0dXM6IHIudGVuYW50LnN0YXR1cyxcbiAgICAgIHJlZmVycmVkQXQ6IHIucmVmZXJyZWRBdCxcbiAgICAgIGF0dHJpYnV0aW9uTWV0aG9kOiByLmF0dHJpYnV0aW9uTWV0aG9kLFxuICAgICAgaXNMaWZldGltZTogIXIuYXR0cmlidXRpb25XaW5kb3dEYXlzLFxuICAgICAgYXR0cmlidXRpb25FeHBpcmVzQXQ6IHIuYXR0cmlidXRpb25FeHBpcmVzQXQsXG4gICAgICB0b3RhbFJldmVudWUsXG4gICAgICBsYXN0UGF5bWVudERhdGU6IGxhc3RQYXltZW50IHx8IG51bGxcbiAgICB9XG4gIH0pXG4gIFxuICAvLyBTb3J0IGJ5IHJldmVudWUgaWYgcmVxdWVzdGVkXG4gIGlmIChvcHRpb25zPy5zb3J0QnkgPT09ICdyZXZlbnVlJykge1xuICAgIHRlbmFudHMuc29ydCgoYSwgYikgPT4gXG4gICAgICBvcHRpb25zLnNvcnRPcmRlciA9PT0gJ2FzYycgXG4gICAgICAgID8gYS50b3RhbFJldmVudWUgLSBiLnRvdGFsUmV2ZW51ZSBcbiAgICAgICAgOiBiLnRvdGFsUmV2ZW51ZSAtIGEudG90YWxSZXZlbnVlXG4gICAgKVxuICB9XG4gIFxuICByZXR1cm4geyB0ZW5hbnRzLCB0b3RhbCB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUQU5UU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgREFTSEJPQVJEX0RBVEFfUE9MSUNZID0ge1xuICAvLyBQYXJ0bmVyIGNhbiBvbmx5IHNlZSB0aGVpciBvd24gZGF0YVxuICBQQVJUTkVSX1NDT1BFRDogdHJ1ZSxcbiAgXG4gIC8vIE5vIHRlbmFudCBpbnRlcm5hbHMgZXhwb3NlZFxuICBURU5BTlRfREFUQV9MSU1JVEVEOiB0cnVlLFxuICBMSU1JVEVEX1RFTkFOVF9GSUVMRFM6IFsnaWQnLCAnbmFtZScsICdzbHVnJywgJ3N0YXR1cycsICdjcmVhdGVkQXQnXSxcbiAgXG4gIC8vIE5vIG1vZHVsZSBkYXRhIGV4cG9zZWRcbiAgTk9fTU9EVUxFX0RBVEE6IHRydWUsXG4gIFxuICAvLyBSZWFkLW9ubHlcbiAgUkVBRF9PTkxZOiB0cnVlLFxuICBcbiAgLy8gQWdncmVnYXRpb24gbGV2ZWxzXG4gIEVBUk5JTkdTX0FHR1JFR0FURUQ6IHRydWUsXG4gIE1FVFJJQ1NfQUdHUkVHQVRFRDogdHJ1ZVxufSBhcyBjb25zdFxuIl0sIm5hbWVzIjpbInByaXNtYSIsInJlcXVpcmVQYXJ0bmVyQWNjZXNzIiwiZ2V0UGF5YWJsZUJhbGFuY2UiLCJnZXRQYXJ0bmVyRGFzaGJvYXJkIiwicGFydG5lcklkIiwiYXV0aFJlc3VsdCIsImF1dGhvcml6ZWQiLCJwYXJ0bmVySW5mbyIsInN1bW1hcnkiLCJlYXJuaW5ncyIsInJlZmVycmFscyIsInJlY2VudEFjdGl2aXR5IiwiUHJvbWlzZSIsImFsbCIsImdldFBhcnRuZXJJbmZvIiwiZ2V0RGFzaGJvYXJkU3VtbWFyeSIsImdldEVhcm5pbmdzU3VtbWFyeSIsImdldFJlZmVycmFsc1N1bW1hcnkiLCJnZXRSZWNlbnRBY3Rpdml0eSIsInBhcnRuZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpZCIsImluY2x1ZGUiLCJhZ3JlZW1lbnRzIiwic3RhdHVzIiwiZWZmZWN0aXZlRnJvbSIsImx0ZSIsIkRhdGUiLCJPUiIsImVmZmVjdGl2ZVRvIiwiZ3RlIiwib3JkZXJCeSIsInZlcnNpb24iLCJ0YWtlIiwiY3VycmVudEFncmVlbWVudCIsIm5hbWUiLCJzbHVnIiwidGllciIsImpvaW5lZEF0IiwiY3JlYXRlZEF0IiwiY29tbWlzc2lvblJhdGUiLCJOdW1iZXIiLCJjb21taXNzaW9uVHlwZSIsIm5vdyIsInRoaXNNb250aFN0YXJ0IiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImxhc3RNb250aFN0YXJ0IiwibGFzdE1vbnRoRW5kIiwicmVmZXJyYWxDb3VudHMiLCJwYXJ0bmVyUmVmZXJyYWwiLCJncm91cEJ5IiwiYnkiLCJfY291bnQiLCJhY3RpdmVSZWZlcnJhbHMiLCJjb3VudCIsInRlbmFudCIsInBlbmRpbmdSZWZlcnJhbHMiLCJ0b3RhbEVhcm5pbmdzIiwicGFydG5lckVhcm5pbmciLCJhZ2dyZWdhdGUiLCJlbnRyeVR5cGUiLCJpbiIsIl9zdW0iLCJjb21taXNzaW9uQW1vdW50IiwidGhpc01vbnRoRWFybmluZ3MiLCJsYXN0TW9udGhFYXJuaW5ncyIsImJhbGFuY2UiLCJ0b3RhbFJlZmVycmFscyIsImN1cnJlbnRCYWxhbmNlIiwidG90YWxQYXlhYmxlIiwicGVuZGluZ0NsZWFyYW5jZSIsInBlbmRpbmciLCJjdXJyZW5jeSIsIm1vbnRobHlUcmVuZCIsImkiLCJtb250aFN0YXJ0IiwibW9udGhFbmQiLCJtb250aEtleSIsIlN0cmluZyIsInBhZFN0YXJ0IiwiZWFybmVkIiwicGFpZCIsInBhaWRBdCIsInB1c2giLCJtb250aCIsImJ5U3RhdHVzIiwiY2xlYXJlZCIsImFwcHJvdmVkIiwidG90YWxQYWlkIiwic3RhdHVzQ291bnRzIiwiYWN0aXZlVGVuYW50cyIsInBlbmRpbmdUZW5hbnRzIiwic3VzcGVuZGVkVGVuYW50cyIsImNodXJuZWRUZW5hbnRzIiwicmVjZW50UmVmZXJyYWxzIiwiZmluZE1hbnkiLCJzZWxlY3QiLCJyZWZlcnJlZEF0IiwicmVmZXJyYWxzV2l0aEVhcm5pbmdzIiwidG9wUGVyZm9ybWVycyIsIm1hcCIsInIiLCJyZWZlcnJhbCIsInRvdGFsUmV2ZW51ZSIsInJlZHVjZSIsInN1bSIsImUiLCJsYXN0UGF5bWVudCIsImZpbHRlciIsInNvcnQiLCJhIiwiYiIsImdldFRpbWUiLCJzbGljZSIsIm1hcFRvUmVmZXJyZWRUZW5hbnRJbmZvIiwibGFzdFBheW1lbnREYXRlIiwicmVmZXJyYWxJZCIsInRlbmFudElkIiwidGVuYW50TmFtZSIsInRlbmFudFNsdWciLCJ0ZW5hbnRTdGF0dXMiLCJhdHRyaWJ1dGlvbk1ldGhvZCIsImlzTGlmZXRpbWUiLCJhdHRyaWJ1dGlvbldpbmRvd0RheXMiLCJhdHRyaWJ1dGlvbkV4cGlyZXNBdCIsInRvdGFsIiwiYWN0aXZlIiwic3VzcGVuZGVkIiwiY2h1cm5lZCIsInJlY2VudCIsInAiLCJhY3Rpdml0aWVzIiwicmVjZW50RWFybmluZ3MiLCJlYXJuaW5nIiwidHlwZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJhbW91bnQiLCJ0aW1lc3RhbXAiLCJyZWNlbnRQYXlvdXRzIiwicGF5b3V0QmF0Y2giLCJwYXlvdXQiLCJiYXRjaE51bWJlciIsIm5ldEFtb3VudCIsImdldFBhcnRuZXJQZXJmb3JtYW5jZSIsInBlcmlvZFN0YXJ0IiwicGVyaW9kRW5kIiwiRXJyb3IiLCJyZWZlcnJhbHNJblBlcmlvZCIsIm5ld1JlZmVycmFscyIsImxlbmd0aCIsImFjdGl2YXRlZFJlZmVycmFscyIsImNvbnZlcnNpb25SYXRlIiwicmV2ZW51ZUluUGVyaW9kIiwiYXZnUmV2ZW51ZVBlclJlZmVycmFsIiwidGhyZWVNb250aHNBZ28iLCJzZXRNb250aCIsImVsaWdpYmxlRm9yUmV0ZW50aW9uIiwicmV0YWluZWQiLCJyZXRlbnRpb25SYXRlIiwiY2h1cm5SYXRlIiwicGVyaW9kTGVuZ3RoIiwicHJldlBlcmlvZFN0YXJ0IiwicHJldlBlcmlvZEVuZCIsInByZXZQZXJpb2RSZWZlcnJhbHMiLCJncm93dGhSYXRlIiwibW9udGhseVJldmVudWUiLCJtb250aGx5UmVmZXJyYWxzIiwiY3VycmVudCIsInJldmVudWUiLCJwZXJpb2QiLCJzdGFydCIsImVuZCIsImF2ZXJhZ2VSZXZlbnVlUGVyUmVmZXJyYWwiLCJuZXdSZWZlcnJhbHNUaGlzUGVyaW9kIiwiZ2V0UmVmZXJyZWRUZW5hbnRzIiwib3B0aW9ucyIsInRlbmFudHMiLCJzb3J0T3JkZXIiLCJsaW1pdCIsInNraXAiLCJvZmZzZXQiLCJzb3J0QnkiLCJEQVNIQk9BUkRfREFUQV9QT0xJQ1kiLCJQQVJUTkVSX1NDT1BFRCIsIlRFTkFOVF9EQVRBX0xJTUlURUQiLCJMSU1JVEVEX1RFTkFOVF9GSUVMRFMiLCJOT19NT0RVTEVfREFUQSIsIlJFQURfT05MWSIsIkVBUk5JTkdTX0FHR1JFR0FURUQiLCJNRVRSSUNTX0FHR1JFR0FURUQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/partner-dashboard.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/payout-readiness.ts":
/*!*************************************!*\
  !*** ./src/lib/payout-readiness.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PAYOUT_RULES: () => (/* binding */ PAYOUT_RULES),\n/* harmony export */   applyPayoutHold: () => (/* binding */ applyPayoutHold),\n/* harmony export */   approvePayoutBatch: () => (/* binding */ approvePayoutBatch),\n/* harmony export */   calculateTaxWithholding: () => (/* binding */ calculateTaxWithholding),\n/* harmony export */   cancelPayoutBatch: () => (/* binding */ cancelPayoutBatch),\n/* harmony export */   checkPayoutReadiness: () => (/* binding */ checkPayoutReadiness),\n/* harmony export */   createPayoutBatch: () => (/* binding */ createPayoutBatch),\n/* harmony export */   getAllPayableBalances: () => (/* binding */ getAllPayableBalances),\n/* harmony export */   getPayableBalance: () => (/* binding */ getPayableBalance),\n/* harmony export */   getPayoutReport: () => (/* binding */ getPayoutReport),\n/* harmony export */   getPayoutSettings: () => (/* binding */ getPayoutSettings),\n/* harmony export */   getPlatformPayoutSummary: () => (/* binding */ getPlatformPayoutSummary),\n/* harmony export */   releasePayoutHold: () => (/* binding */ releasePayoutHold),\n/* harmony export */   updatePayoutSettings: () => (/* binding */ updatePayoutSettings),\n/* harmony export */   updateTaxDocumentStatus: () => (/* binding */ updateTaxDocumentStatus)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * Payout Readiness Service\n * \n * Prepares partner payouts WITHOUT executing actual payments.\n * \n * KEY PRINCIPLES:\n * 1. Track payable balances per partner\n * 2. Support configurable payout thresholds\n * 3. Support tax withholding hooks\n * 4. NO actual payment gateway integration\n * 5. Only readiness checks and reporting\n * \n * PAYOUT BATCH STATUS:\n * DRAFT  PENDING_APPROVAL  APPROVED  READY\n * (PROCESSING, COMPLETED, FAILED are for Phase 6+)\n */ \n// ============================================================================\n// PAYOUT SETTINGS\n// ============================================================================\n/**\n * Get or create payout settings for a partner\n */ async function getPayoutSettings(partnerId) {\n    let settings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerPayoutSettings.findUnique({\n        where: {\n            partnerId\n        }\n    });\n    if (!settings) {\n        // Create default settings\n        settings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerPayoutSettings.create({\n            data: {\n                partnerId,\n                minimumPayout: 100.00,\n                currency: \"USD\",\n                payoutFrequency: \"MONTHLY\",\n                taxWithholdingEnabled: false,\n                taxDocumentStatus: \"NOT_SUBMITTED\",\n                paymentMethodVerified: false,\n                payoutHold: false\n            }\n        });\n    }\n    return settings;\n}\n/**\n * Update payout settings\n */ async function updatePayoutSettings(partnerId, updates, updatedBy) {\n    const settings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        const updated = await tx.partnerPayoutSettings.upsert({\n            where: {\n                partnerId\n            },\n            create: {\n                partnerId,\n                ...updates,\n                minimumPayout: updates.minimumPayout ?? 100.00\n            },\n            update: updates\n        });\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_SETTINGS_UPDATED\",\n                actorId: updatedBy,\n                actorEmail: \"admin\",\n                targetType: \"PartnerPayoutSettings\",\n                targetId: updated.id,\n                metadata: {\n                    partnerId,\n                    updates\n                }\n            }\n        });\n        return updated;\n    });\n    return settings;\n}\n// ============================================================================\n// PAYABLE BALANCE\n// ============================================================================\n/**\n * Get payable balance for a partner\n */ async function getPayableBalance(partnerId) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            id: partnerId\n        },\n        select: {\n            name: true\n        }\n    });\n    const settings = await getPayoutSettings(partnerId);\n    // Get earnings grouped by status\n    const earnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.groupBy({\n        by: [\n            \"status\"\n        ],\n        where: {\n            partnerId,\n            entryType: \"CREDIT\"\n        },\n        _sum: {\n            commissionAmount: true\n        },\n        _count: true\n    });\n    // Get earnings already in batches\n    const inBatchEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.aggregate({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            payoutBatchId: {\n                not: null\n            },\n            status: {\n                in: [\n                    \"APPROVED\",\n                    \"CLEARED\"\n                ]\n            }\n        },\n        _sum: {\n            commissionAmount: true\n        }\n    });\n    // Build balance object\n    const balance = {\n        partnerId,\n        partnerName: partner?.name || \"Unknown\",\n        pending: 0,\n        cleared: 0,\n        approved: 0,\n        inBatch: Number(inBatchEarnings._sum.commissionAmount || 0),\n        totalPayable: 0,\n        totalPaid: 0,\n        totalReversed: 0,\n        currency: settings.currency,\n        minimumPayout: Number(settings.minimumPayout),\n        meetsMinimum: false\n    };\n    for (const group of earnings){\n        const amount = Number(group._sum.commissionAmount || 0);\n        switch(group.status){\n            case \"PENDING\":\n                balance.pending = amount;\n                break;\n            case \"CLEARED\":\n                balance.cleared = amount;\n                break;\n            case \"APPROVED\":\n                balance.approved = amount;\n                break;\n            case \"PAID\":\n                balance.totalPaid = amount;\n                break;\n            case \"REVERSED\":\n                balance.totalReversed = amount;\n                break;\n        }\n    }\n    // Calculate total payable (cleared + approved not in batch)\n    balance.totalPayable = balance.cleared + balance.approved - balance.inBatch;\n    balance.meetsMinimum = balance.totalPayable >= balance.minimumPayout;\n    return balance;\n}\n/**\n * Get payable balances for all partners\n */ async function getAllPayableBalances(options) {\n    const partners = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findMany({\n        where: {\n            status: \"ACTIVE\"\n        },\n        select: {\n            id: true\n        }\n    });\n    const balances = [];\n    for (const partner of partners){\n        const balance = await getPayableBalance(partner.id);\n        if (options?.onlyMeetsMinimum && !balance.meetsMinimum) continue;\n        if (options?.onlyReady && balance.totalPayable <= 0) continue;\n        balances.push(balance);\n    }\n    return balances.sort((a, b)=>b.totalPayable - a.totalPayable);\n}\n// ============================================================================\n// READINESS CHECKS\n// ============================================================================\n/**\n * Perform comprehensive readiness check for partner payout\n */ async function checkPayoutReadiness(partnerId, amount // Optional specific amount to check\n) {\n    const checks = [];\n    const blockers = [];\n    const warnings = [];\n    // Get partner and settings\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            id: partnerId\n        }\n    });\n    if (!partner) {\n        return {\n            partnerId,\n            isReady: false,\n            checks: [\n                {\n                    check: \"partner_exists\",\n                    status: \"FAIL\",\n                    message: \"Partner not found\"\n                }\n            ],\n            blockers: [\n                \"Partner not found\"\n            ],\n            warnings: [],\n            summary: {\n                grossAmount: 0,\n                taxWithholding: 0,\n                netAmount: 0,\n                earningsCount: 0\n            }\n        };\n    }\n    const settings = await getPayoutSettings(partnerId);\n    const balance = await getPayableBalance(partnerId);\n    const checkAmount = amount ?? balance.totalPayable;\n    // =========================================================================\n    // CHECK 1: Partner Status\n    // =========================================================================\n    if (partner.status === \"ACTIVE\") {\n        checks.push({\n            check: \"partner_status\",\n            status: \"PASS\",\n            message: \"Partner is active\",\n            details: {\n                status: partner.status\n            }\n        });\n    } else {\n        checks.push({\n            check: \"partner_status\",\n            status: \"FAIL\",\n            message: `Partner status is ${partner.status}`,\n            details: {\n                status: partner.status\n            }\n        });\n        blockers.push(`Partner is not active (status: ${partner.status})`);\n    }\n    // =========================================================================\n    // CHECK 2: Minimum Payout Threshold\n    // =========================================================================\n    if (checkAmount >= Number(settings.minimumPayout)) {\n        checks.push({\n            check: \"minimum_threshold\",\n            status: \"PASS\",\n            message: `Amount ${checkAmount} meets minimum ${settings.minimumPayout}`,\n            details: {\n                amount: checkAmount,\n                minimum: Number(settings.minimumPayout)\n            }\n        });\n    } else {\n        checks.push({\n            check: \"minimum_threshold\",\n            status: \"FAIL\",\n            message: `Amount ${checkAmount} below minimum ${settings.minimumPayout}`,\n            details: {\n                amount: checkAmount,\n                minimum: Number(settings.minimumPayout)\n            }\n        });\n        blockers.push(`Balance below minimum payout threshold (${checkAmount} < ${settings.minimumPayout})`);\n    }\n    // =========================================================================\n    // CHECK 3: Payout Hold\n    // =========================================================================\n    if (!settings.payoutHold) {\n        checks.push({\n            check: \"payout_hold\",\n            status: \"PASS\",\n            message: \"No payout hold active\"\n        });\n    } else {\n        const holdExpired = settings.payoutHoldUntil && settings.payoutHoldUntil < new Date();\n        if (holdExpired) {\n            checks.push({\n                check: \"payout_hold\",\n                status: \"WARNING\",\n                message: \"Payout hold has expired but not released\",\n                details: {\n                    reason: settings.payoutHoldReason,\n                    until: settings.payoutHoldUntil\n                }\n            });\n            warnings.push(\"Expired payout hold needs to be released\");\n        } else {\n            checks.push({\n                check: \"payout_hold\",\n                status: \"FAIL\",\n                message: `Payout on hold: ${settings.payoutHoldReason}`,\n                details: {\n                    reason: settings.payoutHoldReason,\n                    until: settings.payoutHoldUntil\n                }\n            });\n            blockers.push(`Payout on hold: ${settings.payoutHoldReason}`);\n        }\n    }\n    // =========================================================================\n    // CHECK 4: Tax Documentation\n    // =========================================================================\n    if (settings.taxWithholdingEnabled) {\n        if (settings.taxDocumentStatus === \"VERIFIED\") {\n            checks.push({\n                check: \"tax_documentation\",\n                status: \"PASS\",\n                message: \"Tax documentation verified\",\n                details: {\n                    documentType: settings.taxDocumentType,\n                    verifiedAt: settings.taxDocumentVerifiedAt\n                }\n            });\n        } else if (settings.taxDocumentStatus === \"PENDING\") {\n            checks.push({\n                check: \"tax_documentation\",\n                status: \"WARNING\",\n                message: \"Tax documentation pending verification\",\n                details: {\n                    status: settings.taxDocumentStatus\n                }\n            });\n            warnings.push(\"Tax documentation pending verification - withholding will apply\");\n        } else {\n            checks.push({\n                check: \"tax_documentation\",\n                status: \"WARNING\",\n                message: `Tax documentation status: ${settings.taxDocumentStatus}`,\n                details: {\n                    status: settings.taxDocumentStatus\n                }\n            });\n            warnings.push(`Tax documentation not verified - full withholding (${Number(settings.taxWithholdingRate || 0.30) * 100}%) will apply`);\n        }\n    } else {\n        checks.push({\n            check: \"tax_documentation\",\n            status: \"PASS\",\n            message: \"Tax withholding not required\"\n        });\n    }\n    // =========================================================================\n    // CHECK 5: Payment Method\n    // =========================================================================\n    if (settings.paymentMethodVerified) {\n        checks.push({\n            check: \"payment_method\",\n            status: \"PASS\",\n            message: \"Payment method verified\",\n            details: {\n                type: settings.paymentMethodType\n            }\n        });\n    } else if (settings.paymentMethodType) {\n        checks.push({\n            check: \"payment_method\",\n            status: \"WARNING\",\n            message: \"Payment method not verified\",\n            details: {\n                type: settings.paymentMethodType\n            }\n        });\n        warnings.push(\"Payment method set but not verified\");\n    } else {\n        checks.push({\n            check: \"payment_method\",\n            status: \"WARNING\",\n            message: \"No payment method configured\"\n        });\n        warnings.push(\"No payment method configured - manual payout required\");\n    }\n    // =========================================================================\n    // CHECK 6: Active Agreement\n    // =========================================================================\n    const activeAgreement = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerAgreement.findFirst({\n        where: {\n            partnerId,\n            status: \"ACTIVE\",\n            effectiveFrom: {\n                lte: new Date()\n            },\n            OR: [\n                {\n                    effectiveTo: null\n                },\n                {\n                    effectiveTo: {\n                        gte: new Date()\n                    }\n                }\n            ]\n        }\n    });\n    if (activeAgreement) {\n        checks.push({\n            check: \"active_agreement\",\n            status: \"PASS\",\n            message: \"Active agreement in place\",\n            details: {\n                agreementId: activeAgreement.id,\n                version: activeAgreement.version\n            }\n        });\n    } else {\n        checks.push({\n            check: \"active_agreement\",\n            status: \"WARNING\",\n            message: \"No active agreement found\"\n        });\n        warnings.push(\"No active agreement - historical earnings can still be paid\");\n    }\n    // =========================================================================\n    // CALCULATE SUMMARY\n    // =========================================================================\n    // Get earnings that would be included\n    const payableEarnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.findMany({\n        where: {\n            partnerId,\n            entryType: \"CREDIT\",\n            status: {\n                in: [\n                    \"CLEARED\",\n                    \"APPROVED\"\n                ]\n            },\n            payoutBatchId: null\n        }\n    });\n    const grossAmount = payableEarnings.reduce((sum, e)=>sum + Number(e.commissionAmount), 0);\n    // Calculate tax withholding\n    let taxWithholding = 0;\n    if (settings.taxWithholdingEnabled && settings.taxWithholdingRate) {\n        // Apply full withholding if docs not verified\n        const rate = settings.taxDocumentStatus !== \"VERIFIED\" ? Number(settings.taxWithholdingRate) : Number(settings.taxWithholdingRate);\n        taxWithholding = grossAmount * rate;\n    }\n    const netAmount = grossAmount - taxWithholding;\n    // =========================================================================\n    // DETERMINE OVERALL READINESS\n    // =========================================================================\n    const isReady = blockers.length === 0 && grossAmount > 0;\n    // Log the readiness check\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n        data: {\n            action: \"PAYOUT_READINESS_CHECKED\",\n            actorId: \"system\",\n            actorEmail: \"payout@saascore.internal\",\n            targetType: \"Partner\",\n            targetId: partnerId,\n            metadata: {\n                isReady,\n                blockers,\n                warnings,\n                grossAmount,\n                netAmount,\n                earningsCount: payableEarnings.length\n            }\n        }\n    });\n    return {\n        partnerId,\n        isReady,\n        checks,\n        blockers,\n        warnings,\n        summary: {\n            grossAmount,\n            taxWithholding,\n            netAmount,\n            earningsCount: payableEarnings.length\n        }\n    };\n}\n// ============================================================================\n// TAX WITHHOLDING\n// ============================================================================\n/**\n * Calculate tax withholding for a payout\n */ function calculateTaxWithholding(grossAmount, settings) {\n    if (!settings.taxWithholdingEnabled) {\n        return {\n            withholdingAmount: 0,\n            rate: 0,\n            reason: null\n        };\n    }\n    const rate = Number(settings.taxWithholdingRate || 0.30) // Default 30% if not specified\n    ;\n    const withholdingAmount = Math.round(grossAmount * rate * 100) / 100;\n    return {\n        withholdingAmount,\n        rate,\n        reason: settings.taxWithholdingReason || \"Tax withholding required\"\n    };\n}\n/**\n * Update tax document status\n */ async function updateTaxDocumentStatus(partnerId, status, documentType, updatedBy) {\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        await tx.partnerPayoutSettings.update({\n            where: {\n                partnerId\n            },\n            data: {\n                taxDocumentStatus: status,\n                taxDocumentType: documentType,\n                taxDocumentVerifiedAt: status === \"VERIFIED\" ? new Date() : undefined\n            }\n        });\n        const action = status === \"VERIFIED\" ? \"TAX_DOCUMENT_VERIFIED\" : \"TAX_DOCUMENT_SUBMITTED\";\n        await tx.auditLog.create({\n            data: {\n                action,\n                actorId: updatedBy || \"system\",\n                actorEmail: \"tax@saascore.internal\",\n                targetType: \"PartnerPayoutSettings\",\n                targetId: partnerId,\n                metadata: {\n                    status,\n                    documentType\n                }\n            }\n        });\n    });\n}\n// ============================================================================\n// PAYOUT HOLD\n// ============================================================================\n/**\n * Apply payout hold on a partner\n */ async function applyPayoutHold(partnerId, reason, holdUntil, appliedBy) {\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        await tx.partnerPayoutSettings.upsert({\n            where: {\n                partnerId\n            },\n            create: {\n                partnerId,\n                payoutHold: true,\n                payoutHoldReason: reason,\n                payoutHoldUntil: holdUntil\n            },\n            update: {\n                payoutHold: true,\n                payoutHoldReason: reason,\n                payoutHoldUntil: holdUntil\n            }\n        });\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_HOLD_APPLIED\",\n                actorId: appliedBy || \"system\",\n                actorEmail: \"admin\",\n                targetType: \"Partner\",\n                targetId: partnerId,\n                metadata: {\n                    reason,\n                    holdUntil\n                }\n            }\n        });\n    });\n}\n/**\n * Release payout hold\n */ async function releasePayoutHold(partnerId, releasedBy) {\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        const settings = await tx.partnerPayoutSettings.findUnique({\n            where: {\n                partnerId\n            }\n        });\n        await tx.partnerPayoutSettings.update({\n            where: {\n                partnerId\n            },\n            data: {\n                payoutHold: false,\n                payoutHoldReason: null,\n                payoutHoldUntil: null\n            }\n        });\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_HOLD_RELEASED\",\n                actorId: releasedBy || \"system\",\n                actorEmail: \"admin\",\n                targetType: \"Partner\",\n                targetId: partnerId,\n                metadata: {\n                    previousReason: settings?.payoutHoldReason\n                }\n            }\n        });\n    });\n}\n// ============================================================================\n// PAYOUT BATCH CREATION (No Execution)\n// ============================================================================\n/**\n * Create a payout batch (DRAFT status)\n * \n * This does NOT execute the payout - only prepares it\n */ async function createPayoutBatch(input) {\n    // Check readiness\n    const readiness = await checkPayoutReadiness(input.partnerId);\n    if (!readiness.isReady) {\n        return {\n            success: false,\n            error: `Payout not ready: ${readiness.blockers.join(\", \")}`,\n            code: \"NOT_READY\"\n        };\n    }\n    const settings = await getPayoutSettings(input.partnerId);\n    // Get eligible earnings\n    const statusFilter = [];\n    if (input.includeCleared !== false) statusFilter.push(\"CLEARED\");\n    if (input.includeApproved !== false) statusFilter.push(\"APPROVED\");\n    const earnings = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerEarning.findMany({\n        where: {\n            partnerId: input.partnerId,\n            entryType: \"CREDIT\",\n            status: {\n                in: statusFilter\n            },\n            payoutBatchId: null,\n            createdAt: {\n                gte: input.periodStart,\n                lte: input.periodEnd\n            }\n        }\n    });\n    if (earnings.length === 0) {\n        return {\n            success: false,\n            error: \"No eligible earnings found for the specified period\",\n            code: \"NO_EARNINGS\"\n        };\n    }\n    // Calculate totals\n    const grossAmount = earnings.reduce((sum, e)=>sum + Number(e.commissionAmount), 0);\n    if (grossAmount < Number(settings.minimumPayout)) {\n        return {\n            success: false,\n            error: `Amount ${grossAmount} below minimum ${settings.minimumPayout}`,\n            code: \"BELOW_MINIMUM\"\n        };\n    }\n    // Calculate tax withholding\n    const taxResult = calculateTaxWithholding(grossAmount, settings);\n    const netAmount = grossAmount - taxResult.withholdingAmount;\n    // Generate batch number\n    const batchNumber = await generateBatchNumber();\n    // Create batch in transaction\n    const batch = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        const newBatch = await tx.payoutBatch.create({\n            data: {\n                partnerId: input.partnerId,\n                batchNumber,\n                status: \"DRAFT\",\n                grossAmount,\n                taxWithholding: taxResult.withholdingAmount,\n                netAmount,\n                currency: settings.currency,\n                earningsCount: earnings.length,\n                periodStart: input.periodStart,\n                periodEnd: input.periodEnd,\n                readinessChecks: JSON.parse(JSON.stringify({\n                    checks: readiness.checks,\n                    checkedAt: new Date().toISOString()\n                })),\n                readinessStatus: \"READY\",\n                internalNotes: input.notes\n            }\n        });\n        // Link earnings to batch\n        await tx.partnerEarning.updateMany({\n            where: {\n                id: {\n                    in: earnings.map((e)=>e.id)\n                }\n            },\n            data: {\n                payoutBatchId: newBatch.id\n            }\n        });\n        // Audit log\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_BATCH_CREATED\",\n                actorId: \"system\",\n                actorEmail: \"payout@saascore.internal\",\n                targetType: \"PayoutBatch\",\n                targetId: newBatch.id,\n                metadata: {\n                    partnerId: input.partnerId,\n                    batchNumber,\n                    grossAmount,\n                    taxWithholding: taxResult.withholdingAmount,\n                    netAmount,\n                    earningsCount: earnings.length\n                }\n            }\n        });\n        return newBatch;\n    });\n    return {\n        success: true,\n        batch\n    };\n}\n/**\n * Generate unique batch number\n */ async function generateBatchNumber() {\n    const year = new Date().getFullYear();\n    const count = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.count({\n        where: {\n            batchNumber: {\n                startsWith: `PO-${year}-`\n            }\n        }\n    });\n    return `PO-${year}-${String(count + 1).padStart(6, \"0\")}`;\n}\n/**\n * Cancel a draft payout batch\n */ async function cancelPayoutBatch(batchId, reason, cancelledBy) {\n    const batch = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.findUnique({\n        where: {\n            id: batchId\n        }\n    });\n    if (!batch) {\n        return {\n            success: false,\n            error: \"Batch not found\",\n            code: \"VALIDATION_ERROR\"\n        };\n    }\n    if (![\n        \"DRAFT\",\n        \"PENDING_APPROVAL\"\n    ].includes(batch.status)) {\n        return {\n            success: false,\n            error: `Cannot cancel batch in ${batch.status} status`,\n            code: \"VALIDATION_ERROR\"\n        };\n    }\n    const updatedBatch = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        // Unlink earnings from batch\n        await tx.partnerEarning.updateMany({\n            where: {\n                payoutBatchId: batchId\n            },\n            data: {\n                payoutBatchId: null\n            }\n        });\n        // Update batch status\n        const updated = await tx.payoutBatch.update({\n            where: {\n                id: batchId\n            },\n            data: {\n                status: \"CANCELLED\",\n                cancelledAt: new Date(),\n                cancelledByUserId: cancelledBy,\n                cancellationReason: reason\n            }\n        });\n        // Audit log\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_BATCH_CANCELLED\",\n                actorId: cancelledBy,\n                actorEmail: \"admin\",\n                targetType: \"PayoutBatch\",\n                targetId: batchId,\n                metadata: {\n                    reason\n                }\n            }\n        });\n        return updated;\n    });\n    return {\n        success: true,\n        batch: updatedBatch\n    };\n}\n/**\n * Approve a payout batch\n */ async function approvePayoutBatch(batchId, approvedBy) {\n    const batch = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.findUnique({\n        where: {\n            id: batchId\n        }\n    });\n    if (!batch) {\n        return {\n            success: false,\n            error: \"Batch not found\",\n            code: \"VALIDATION_ERROR\"\n        };\n    }\n    if (![\n        \"DRAFT\",\n        \"PENDING_APPROVAL\"\n    ].includes(batch.status)) {\n        return {\n            success: false,\n            error: `Cannot approve batch in ${batch.status} status`,\n            code: \"VALIDATION_ERROR\"\n        };\n    }\n    // Re-check readiness\n    const readiness = await checkPayoutReadiness(batch.partnerId, Number(batch.grossAmount));\n    if (!readiness.isReady) {\n        return {\n            success: false,\n            error: `Payout no longer ready: ${readiness.blockers.join(\", \")}`,\n            code: \"NOT_READY\"\n        };\n    }\n    const updatedBatch = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n        const updated = await tx.payoutBatch.update({\n            where: {\n                id: batchId\n            },\n            data: {\n                status: \"APPROVED\",\n                approvedAt: new Date(),\n                approvedByUserId: approvedBy,\n                readinessChecks: JSON.parse(JSON.stringify({\n                    checks: readiness.checks,\n                    checkedAt: new Date().toISOString()\n                })),\n                readinessStatus: \"READY\"\n            }\n        });\n        // Update earnings status to APPROVED\n        await tx.partnerEarning.updateMany({\n            where: {\n                payoutBatchId: batchId,\n                status: \"CLEARED\"\n            },\n            data: {\n                status: \"APPROVED\",\n                approvedAt: new Date(),\n                approvedByUserId: approvedBy\n            }\n        });\n        // Audit log\n        await tx.auditLog.create({\n            data: {\n                action: \"PAYOUT_BATCH_APPROVED\",\n                actorId: approvedBy,\n                actorEmail: \"admin\",\n                targetType: \"PayoutBatch\",\n                targetId: batchId,\n                metadata: {\n                    partnerId: batch.partnerId,\n                    netAmount: Number(batch.netAmount)\n                }\n            }\n        });\n        return updated;\n    });\n    return {\n        success: true,\n        batch: updatedBatch\n    };\n}\nasync function getPayoutReport(partnerId, periodStart, periodEnd) {\n    const partner = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.findUnique({\n        where: {\n            id: partnerId\n        },\n        select: {\n            name: true\n        }\n    });\n    const balance = await getPayableBalance(partnerId);\n    // Get pending batches\n    const pendingBatches = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.findMany({\n        where: {\n            partnerId,\n            status: {\n                in: [\n                    \"DRAFT\",\n                    \"PENDING_APPROVAL\",\n                    \"APPROVED\",\n                    \"READY\"\n                ]\n            }\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        }\n    });\n    // Get paid batches in period\n    const paidBatches = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.findMany({\n        where: {\n            partnerId,\n            status: \"COMPLETED\",\n            processedAt: {\n                gte: periodStart,\n                lte: periodEnd\n            }\n        },\n        orderBy: {\n            processedAt: \"desc\"\n        }\n    });\n    // Get all-time paid total\n    const allTimePaid = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.aggregate({\n        where: {\n            partnerId,\n            status: \"COMPLETED\"\n        },\n        _sum: {\n            netAmount: true\n        }\n    });\n    return {\n        partnerId,\n        partnerName: partner?.name || \"Unknown\",\n        period: {\n            start: periodStart,\n            end: periodEnd\n        },\n        balance,\n        pendingBatches: pendingBatches.map((b)=>({\n                id: b.id,\n                batchNumber: b.batchNumber,\n                status: b.status,\n                netAmount: Number(b.netAmount),\n                earningsCount: b.earningsCount,\n                createdAt: b.createdAt\n            })),\n        paidBatches: paidBatches.map((b)=>({\n                id: b.id,\n                batchNumber: b.batchNumber,\n                netAmount: Number(b.netAmount),\n                paidAt: b.processedAt\n            })),\n        totalPending: pendingBatches.reduce((sum, b)=>sum + Number(b.netAmount), 0),\n        totalPaidThisPeriod: paidBatches.reduce((sum, b)=>sum + Number(b.netAmount), 0),\n        totalPaidAllTime: Number(allTimePaid._sum.netAmount || 0)\n    };\n}\nasync function getPlatformPayoutSummary(periodStart, periodEnd) {\n    const [totalPartners, partnersOnHold, balances, batchCounts] = await Promise.all([\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partner.count({\n            where: {\n                status: \"ACTIVE\"\n            }\n        }),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.partnerPayoutSettings.count({\n            where: {\n                payoutHold: true\n            }\n        }),\n        getAllPayableBalances(),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.payoutBatch.groupBy({\n            by: [\n                \"status\"\n            ],\n            _count: true\n        })\n    ]);\n    const partnersWithBalance = balances.filter((b)=>b.totalPayable > 0).length;\n    const partnersReadyForPayout = balances.filter((b)=>b.meetsMinimum).length;\n    return {\n        period: {\n            start: periodStart,\n            end: periodEnd\n        },\n        totalPartners,\n        partnersWithBalance,\n        partnersReadyForPayout,\n        partnersOnHold,\n        totalPending: balances.reduce((sum, b)=>sum + b.pending, 0),\n        totalCleared: balances.reduce((sum, b)=>sum + b.cleared, 0),\n        totalApproved: balances.reduce((sum, b)=>sum + b.approved, 0),\n        totalInBatches: balances.reduce((sum, b)=>sum + b.inBatch, 0),\n        draftBatches: batchCounts.find((c)=>c.status === \"DRAFT\")?._count || 0,\n        approvedBatches: batchCounts.find((c)=>c.status === \"APPROVED\")?._count || 0,\n        currency: \"USD\"\n    };\n}\n// ============================================================================\n// CONSTANTS\n// ============================================================================\nconst PAYOUT_RULES = {\n    // Default minimum payout threshold\n    DEFAULT_MINIMUM_PAYOUT: 100.00,\n    // Default tax withholding rate (if docs not verified)\n    DEFAULT_TAX_WITHHOLDING_RATE: 0.30,\n    // Payout frequencies\n    PAYOUT_FREQUENCIES: [\n        \"WEEKLY\",\n        \"BIWEEKLY\",\n        \"MONTHLY\",\n        \"QUARTERLY\"\n    ],\n    // Batch statuses\n    BATCH_STATUSES: [\n        \"DRAFT\",\n        \"PENDING_APPROVAL\",\n        \"APPROVED\",\n        \"READY\",\n        \"PROCESSING\",\n        \"COMPLETED\",\n        \"FAILED\",\n        \"CANCELLED\"\n    ],\n    // No actual payout execution in Phase 5\n    EXECUTION_ENABLED: false\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RjtBQUVBLCtFQUErRTtBQUMvRSxZQUFZO0FBQ1osK0VBQStFO0FBRXhFLE1BQU1zTSxlQUFlO0lBQzFCLG1DQUFtQztJQUNuQ0Msd0JBQXdCO0lBRXhCLHNEQUFzRDtJQUN0REMsOEJBQThCO0lBRTlCLHFCQUFxQjtJQUNyQkMsb0JBQW9CO1FBQUM7UUFBVTtRQUFZO1FBQVc7S0FBWTtJQUVsRSxpQkFBaUI7SUFDakJDLGdCQUFnQjtRQUNkO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUVELHdDQUF3QztJQUN4Q0MsbUJBQW1CO0FBQ3JCLEVBQVUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3BheW91dC1yZWFkaW5lc3MudHM/YjhjOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBheW91dCBSZWFkaW5lc3MgU2VydmljZVxuICogXG4gKiBQcmVwYXJlcyBwYXJ0bmVyIHBheW91dHMgV0lUSE9VVCBleGVjdXRpbmcgYWN0dWFsIHBheW1lbnRzLlxuICogXG4gKiBLRVkgUFJJTkNJUExFUzpcbiAqIDEuIFRyYWNrIHBheWFibGUgYmFsYW5jZXMgcGVyIHBhcnRuZXJcbiAqIDIuIFN1cHBvcnQgY29uZmlndXJhYmxlIHBheW91dCB0aHJlc2hvbGRzXG4gKiAzLiBTdXBwb3J0IHRheCB3aXRoaG9sZGluZyBob29rc1xuICogNC4gTk8gYWN0dWFsIHBheW1lbnQgZ2F0ZXdheSBpbnRlZ3JhdGlvblxuICogNS4gT25seSByZWFkaW5lc3MgY2hlY2tzIGFuZCByZXBvcnRpbmdcbiAqIFxuICogUEFZT1VUIEJBVENIIFNUQVRVUzpcbiAqIERSQUZUIOKGkiBQRU5ESU5HX0FQUFJPVkFMIOKGkiBBUFBST1ZFRCDihpIgUkVBRFlcbiAqIChQUk9DRVNTSU5HLCBDT01QTEVURUQsIEZBSUxFRCBhcmUgZm9yIFBoYXNlIDYrKVxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgXG4gIFBheW91dEJhdGNoLCBcbiAgUGFydG5lclBheW91dFNldHRpbmdzLFxuICBQYXJ0bmVyLFxuICBFYXJuaW5nU3RhdHVzXG59IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuaW1wb3J0IHsgRGVjaW1hbCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50L3J1bnRpbWUvbGlicmFyeSdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVFlQRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBQYXlhYmxlIGJhbGFuY2Ugc3VtbWFyeSBmb3IgYSBwYXJ0bmVyXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUGF5YWJsZUJhbGFuY2Uge1xuICBwYXJ0bmVySWQ6IHN0cmluZ1xuICBwYXJ0bmVyTmFtZTogc3RyaW5nXG4gIFxuICAvLyBCYWxhbmNlIGJyZWFrZG93blxuICBwZW5kaW5nOiBudW1iZXIgICAgICAvLyBJbiBjbGVhcmFuY2UgcGVyaW9kXG4gIGNsZWFyZWQ6IG51bWJlciAgICAgIC8vIFJlYWR5IHRvIGJlIGFwcHJvdmVkXG4gIGFwcHJvdmVkOiBudW1iZXIgICAgIC8vIEFwcHJvdmVkLCB3YWl0aW5nIGZvciBiYXRjaFxuICBpbkJhdGNoOiBudW1iZXIgICAgICAvLyBBbHJlYWR5IGluIGEgcGF5b3V0IGJhdGNoXG4gIFxuICAvLyBUb3RhbCBwYXlhYmxlIChjbGVhcmVkICsgYXBwcm92ZWQgbm90IGluIGJhdGNoKVxuICB0b3RhbFBheWFibGU6IG51bWJlclxuICBcbiAgLy8gSGlzdG9yaWNhbFxuICB0b3RhbFBhaWQ6IG51bWJlclxuICB0b3RhbFJldmVyc2VkOiBudW1iZXJcbiAgXG4gIGN1cnJlbmN5OiBzdHJpbmdcbiAgXG4gIC8vIFRocmVzaG9sZHNcbiAgbWluaW11bVBheW91dDogbnVtYmVyXG4gIG1lZXRzTWluaW11bTogYm9vbGVhblxufVxuXG4vKipcbiAqIFJlYWRpbmVzcyBjaGVjayByZXN1bHRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWFkaW5lc3NDaGVjayB7XG4gIGNoZWNrOiBzdHJpbmdcbiAgc3RhdHVzOiAnUEFTUycgfCAnRkFJTCcgfCAnV0FSTklORydcbiAgbWVzc2FnZTogc3RyaW5nXG4gIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGF5b3V0UmVhZGluZXNzUmVzdWx0IHtcbiAgcGFydG5lcklkOiBzdHJpbmdcbiAgaXNSZWFkeTogYm9vbGVhblxuICBjaGVja3M6IFJlYWRpbmVzc0NoZWNrW11cbiAgYmxvY2tlcnM6IHN0cmluZ1tdXG4gIHdhcm5pbmdzOiBzdHJpbmdbXVxuICBzdW1tYXJ5OiB7XG4gICAgZ3Jvc3NBbW91bnQ6IG51bWJlclxuICAgIHRheFdpdGhob2xkaW5nOiBudW1iZXJcbiAgICBuZXRBbW91bnQ6IG51bWJlclxuICAgIGVhcm5pbmdzQ291bnQ6IG51bWJlclxuICB9XG59XG5cbi8qKlxuICogUGF5b3V0IGJhdGNoIGNyZWF0aW9uIGlucHV0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlUGF5b3V0QmF0Y2hJbnB1dCB7XG4gIHBhcnRuZXJJZDogc3RyaW5nXG4gIHBlcmlvZFN0YXJ0OiBEYXRlXG4gIHBlcmlvZEVuZDogRGF0ZVxuICBpbmNsdWRlQ2xlYXJlZD86IGJvb2xlYW4gIC8vIEluY2x1ZGUgQ0xFQVJFRCBlYXJuaW5nc1xuICBpbmNsdWRlQXBwcm92ZWQ/OiBib29sZWFuIC8vIEluY2x1ZGUgQVBQUk9WRUQgZWFybmluZ3NcbiAgbm90ZXM/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXlvdXRCYXRjaFJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgYmF0Y2g/OiBQYXlvdXRCYXRjaFxuICBlcnJvcj86IHN0cmluZ1xuICBjb2RlPzogJ05PVF9SRUFEWScgfCAnTk9fRUFSTklOR1MnIHwgJ0JFTE9XX01JTklNVU0nIHwgJ0hPTERfQUNUSVZFJyB8ICdWQUxJREFUSU9OX0VSUk9SJ1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQQVlPVVQgU0VUVElOR1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgb3IgY3JlYXRlIHBheW91dCBzZXR0aW5ncyBmb3IgYSBwYXJ0bmVyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYXlvdXRTZXR0aW5ncyhwYXJ0bmVySWQ6IHN0cmluZyk6IFByb21pc2U8UGFydG5lclBheW91dFNldHRpbmdzPiB7XG4gIGxldCBzZXR0aW5ncyA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyUGF5b3V0U2V0dGluZ3MuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgcGFydG5lcklkIH1cbiAgfSlcbiAgXG4gIGlmICghc2V0dGluZ3MpIHtcbiAgICAvLyBDcmVhdGUgZGVmYXVsdCBzZXR0aW5nc1xuICAgIHNldHRpbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJQYXlvdXRTZXR0aW5ncy5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICBwYXJ0bmVySWQsXG4gICAgICAgIG1pbmltdW1QYXlvdXQ6IDEwMC4wMCxcbiAgICAgICAgY3VycmVuY3k6ICdVU0QnLFxuICAgICAgICBwYXlvdXRGcmVxdWVuY3k6ICdNT05USExZJyxcbiAgICAgICAgdGF4V2l0aGhvbGRpbmdFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgdGF4RG9jdW1lbnRTdGF0dXM6ICdOT1RfU1VCTUlUVEVEJyxcbiAgICAgICAgcGF5bWVudE1ldGhvZFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgcGF5b3V0SG9sZDogZmFsc2VcbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIFxuICByZXR1cm4gc2V0dGluZ3Ncbn1cblxuLyoqXG4gKiBVcGRhdGUgcGF5b3V0IHNldHRpbmdzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQYXlvdXRTZXR0aW5ncyhcbiAgcGFydG5lcklkOiBzdHJpbmcsXG4gIHVwZGF0ZXM6IFBhcnRpYWw8e1xuICAgIG1pbmltdW1QYXlvdXQ6IG51bWJlclxuICAgIHBheW91dEZyZXF1ZW5jeTogc3RyaW5nXG4gICAgdGF4V2l0aGhvbGRpbmdFbmFibGVkOiBib29sZWFuXG4gICAgdGF4V2l0aGhvbGRpbmdSYXRlOiBudW1iZXJcbiAgICB0YXhXaXRoaG9sZGluZ1JlYXNvbjogc3RyaW5nXG4gICAgcGF5bWVudE1ldGhvZFR5cGU6IHN0cmluZ1xuICB9PixcbiAgdXBkYXRlZEJ5OiBzdHJpbmdcbik6IFByb21pc2U8UGFydG5lclBheW91dFNldHRpbmdzPiB7XG4gIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgcHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcbiAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHgucGFydG5lclBheW91dFNldHRpbmdzLnVwc2VydCh7XG4gICAgICB3aGVyZTogeyBwYXJ0bmVySWQgfSxcbiAgICAgIGNyZWF0ZToge1xuICAgICAgICBwYXJ0bmVySWQsXG4gICAgICAgIC4uLnVwZGF0ZXMsXG4gICAgICAgIG1pbmltdW1QYXlvdXQ6IHVwZGF0ZXMubWluaW11bVBheW91dCA/PyAxMDAuMDBcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6IHVwZGF0ZXNcbiAgICB9KVxuICAgIFxuICAgIGF3YWl0IHR4LmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGFjdGlvbjogJ1BBWU9VVF9TRVRUSU5HU19VUERBVEVEJyxcbiAgICAgICAgYWN0b3JJZDogdXBkYXRlZEJ5LFxuICAgICAgICBhY3RvckVtYWlsOiAnYWRtaW4nLFxuICAgICAgICB0YXJnZXRUeXBlOiAnUGFydG5lclBheW91dFNldHRpbmdzJyxcbiAgICAgICAgdGFyZ2V0SWQ6IHVwZGF0ZWQuaWQsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcGFydG5lcklkLFxuICAgICAgICAgIHVwZGF0ZXNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIHVwZGF0ZWRcbiAgfSlcbiAgXG4gIHJldHVybiBzZXR0aW5nc1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQQVlBQkxFIEJBTEFOQ0Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgcGF5YWJsZSBiYWxhbmNlIGZvciBhIHBhcnRuZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBheWFibGVCYWxhbmNlKHBhcnRuZXJJZDogc3RyaW5nKTogUHJvbWlzZTxQYXlhYmxlQmFsYW5jZT4ge1xuICBjb25zdCBwYXJ0bmVyID0gYXdhaXQgcHJpc21hLnBhcnRuZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHBhcnRuZXJJZCB9LFxuICAgIHNlbGVjdDogeyBuYW1lOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZ2V0UGF5b3V0U2V0dGluZ3MocGFydG5lcklkKVxuICBcbiAgLy8gR2V0IGVhcm5pbmdzIGdyb3VwZWQgYnkgc3RhdHVzXG4gIGNvbnN0IGVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmdyb3VwQnkoe1xuICAgIGJ5OiBbJ3N0YXR1cyddLFxuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICBlbnRyeVR5cGU6ICdDUkVESVQnXG4gICAgfSxcbiAgICBfc3VtOiB7XG4gICAgICBjb21taXNzaW9uQW1vdW50OiB0cnVlXG4gICAgfSxcbiAgICBfY291bnQ6IHRydWVcbiAgfSlcbiAgXG4gIC8vIEdldCBlYXJuaW5ncyBhbHJlYWR5IGluIGJhdGNoZXNcbiAgY29uc3QgaW5CYXRjaEVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmFnZ3JlZ2F0ZSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIGVudHJ5VHlwZTogJ0NSRURJVCcsXG4gICAgICBwYXlvdXRCYXRjaElkOiB7IG5vdDogbnVsbCB9LFxuICAgICAgc3RhdHVzOiB7IGluOiBbJ0FQUFJPVkVEJywgJ0NMRUFSRUQnXSB9XG4gICAgfSxcbiAgICBfc3VtOiB7XG4gICAgICBjb21taXNzaW9uQW1vdW50OiB0cnVlXG4gICAgfVxuICB9KVxuICBcbiAgLy8gQnVpbGQgYmFsYW5jZSBvYmplY3RcbiAgY29uc3QgYmFsYW5jZTogUGF5YWJsZUJhbGFuY2UgPSB7XG4gICAgcGFydG5lcklkLFxuICAgIHBhcnRuZXJOYW1lOiBwYXJ0bmVyPy5uYW1lIHx8ICdVbmtub3duJyxcbiAgICBwZW5kaW5nOiAwLFxuICAgIGNsZWFyZWQ6IDAsXG4gICAgYXBwcm92ZWQ6IDAsXG4gICAgaW5CYXRjaDogTnVtYmVyKGluQmF0Y2hFYXJuaW5ncy5fc3VtLmNvbW1pc3Npb25BbW91bnQgfHwgMCksXG4gICAgdG90YWxQYXlhYmxlOiAwLFxuICAgIHRvdGFsUGFpZDogMCxcbiAgICB0b3RhbFJldmVyc2VkOiAwLFxuICAgIGN1cnJlbmN5OiBzZXR0aW5ncy5jdXJyZW5jeSxcbiAgICBtaW5pbXVtUGF5b3V0OiBOdW1iZXIoc2V0dGluZ3MubWluaW11bVBheW91dCksXG4gICAgbWVldHNNaW5pbXVtOiBmYWxzZVxuICB9XG4gIFxuICBmb3IgKGNvbnN0IGdyb3VwIG9mIGVhcm5pbmdzKSB7XG4gICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKGdyb3VwLl9zdW0uY29tbWlzc2lvbkFtb3VudCB8fCAwKVxuICAgIFxuICAgIHN3aXRjaCAoZ3JvdXAuc3RhdHVzKSB7XG4gICAgICBjYXNlICdQRU5ESU5HJzpcbiAgICAgICAgYmFsYW5jZS5wZW5kaW5nID0gYW1vdW50XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdDTEVBUkVEJzpcbiAgICAgICAgYmFsYW5jZS5jbGVhcmVkID0gYW1vdW50XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdBUFBST1ZFRCc6XG4gICAgICAgIGJhbGFuY2UuYXBwcm92ZWQgPSBhbW91bnRcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ1BBSUQnOlxuICAgICAgICBiYWxhbmNlLnRvdGFsUGFpZCA9IGFtb3VudFxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnUkVWRVJTRUQnOlxuICAgICAgICBiYWxhbmNlLnRvdGFsUmV2ZXJzZWQgPSBhbW91bnRcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIENhbGN1bGF0ZSB0b3RhbCBwYXlhYmxlIChjbGVhcmVkICsgYXBwcm92ZWQgbm90IGluIGJhdGNoKVxuICBiYWxhbmNlLnRvdGFsUGF5YWJsZSA9IGJhbGFuY2UuY2xlYXJlZCArIGJhbGFuY2UuYXBwcm92ZWQgLSBiYWxhbmNlLmluQmF0Y2hcbiAgYmFsYW5jZS5tZWV0c01pbmltdW0gPSBiYWxhbmNlLnRvdGFsUGF5YWJsZSA+PSBiYWxhbmNlLm1pbmltdW1QYXlvdXRcbiAgXG4gIHJldHVybiBiYWxhbmNlXG59XG5cbi8qKlxuICogR2V0IHBheWFibGUgYmFsYW5jZXMgZm9yIGFsbCBwYXJ0bmVyc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUGF5YWJsZUJhbGFuY2VzKG9wdGlvbnM/OiB7XG4gIG9ubHlNZWV0c01pbmltdW0/OiBib29sZWFuXG4gIG9ubHlSZWFkeT86IGJvb2xlYW5cbn0pOiBQcm9taXNlPFBheWFibGVCYWxhbmNlW10+IHtcbiAgY29uc3QgcGFydG5lcnMgPSBhd2FpdCBwcmlzbWEucGFydG5lci5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgc3RhdHVzOiAnQUNUSVZFJyB9LFxuICAgIHNlbGVjdDogeyBpZDogdHJ1ZSB9XG4gIH0pXG4gIFxuICBjb25zdCBiYWxhbmNlczogUGF5YWJsZUJhbGFuY2VbXSA9IFtdXG4gIFxuICBmb3IgKGNvbnN0IHBhcnRuZXIgb2YgcGFydG5lcnMpIHtcbiAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgZ2V0UGF5YWJsZUJhbGFuY2UocGFydG5lci5pZClcbiAgICBcbiAgICBpZiAob3B0aW9ucz8ub25seU1lZXRzTWluaW11bSAmJiAhYmFsYW5jZS5tZWV0c01pbmltdW0pIGNvbnRpbnVlXG4gICAgaWYgKG9wdGlvbnM/Lm9ubHlSZWFkeSAmJiBiYWxhbmNlLnRvdGFsUGF5YWJsZSA8PSAwKSBjb250aW51ZVxuICAgIFxuICAgIGJhbGFuY2VzLnB1c2goYmFsYW5jZSlcbiAgfVxuICBcbiAgcmV0dXJuIGJhbGFuY2VzLnNvcnQoKGEsIGIpID0+IGIudG90YWxQYXlhYmxlIC0gYS50b3RhbFBheWFibGUpXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFQURJTkVTUyBDSEVDS1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBQZXJmb3JtIGNvbXByZWhlbnNpdmUgcmVhZGluZXNzIGNoZWNrIGZvciBwYXJ0bmVyIHBheW91dFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tQYXlvdXRSZWFkaW5lc3MoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBhbW91bnQ/OiBudW1iZXIgIC8vIE9wdGlvbmFsIHNwZWNpZmljIGFtb3VudCB0byBjaGVja1xuKTogUHJvbWlzZTxQYXlvdXRSZWFkaW5lc3NSZXN1bHQ+IHtcbiAgY29uc3QgY2hlY2tzOiBSZWFkaW5lc3NDaGVja1tdID0gW11cbiAgY29uc3QgYmxvY2tlcnM6IHN0cmluZ1tdID0gW11cbiAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW11cbiAgXG4gIC8vIEdldCBwYXJ0bmVyIGFuZCBzZXR0aW5nc1xuICBjb25zdCBwYXJ0bmVyID0gYXdhaXQgcHJpc21hLnBhcnRuZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHBhcnRuZXJJZCB9XG4gIH0pXG4gIFxuICBpZiAoIXBhcnRuZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgaXNSZWFkeTogZmFsc2UsXG4gICAgICBjaGVja3M6IFt7IGNoZWNrOiAncGFydG5lcl9leGlzdHMnLCBzdGF0dXM6ICdGQUlMJywgbWVzc2FnZTogJ1BhcnRuZXIgbm90IGZvdW5kJyB9XSxcbiAgICAgIGJsb2NrZXJzOiBbJ1BhcnRuZXIgbm90IGZvdW5kJ10sXG4gICAgICB3YXJuaW5nczogW10sXG4gICAgICBzdW1tYXJ5OiB7IGdyb3NzQW1vdW50OiAwLCB0YXhXaXRoaG9sZGluZzogMCwgbmV0QW1vdW50OiAwLCBlYXJuaW5nc0NvdW50OiAwIH1cbiAgICB9XG4gIH1cbiAgXG4gIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZ2V0UGF5b3V0U2V0dGluZ3MocGFydG5lcklkKVxuICBjb25zdCBiYWxhbmNlID0gYXdhaXQgZ2V0UGF5YWJsZUJhbGFuY2UocGFydG5lcklkKVxuICBcbiAgY29uc3QgY2hlY2tBbW91bnQgPSBhbW91bnQgPz8gYmFsYW5jZS50b3RhbFBheWFibGVcbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0hFQ0sgMTogUGFydG5lciBTdGF0dXNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBpZiAocGFydG5lci5zdGF0dXMgPT09ICdBQ1RJVkUnKSB7XG4gICAgY2hlY2tzLnB1c2goe1xuICAgICAgY2hlY2s6ICdwYXJ0bmVyX3N0YXR1cycsXG4gICAgICBzdGF0dXM6ICdQQVNTJyxcbiAgICAgIG1lc3NhZ2U6ICdQYXJ0bmVyIGlzIGFjdGl2ZScsXG4gICAgICBkZXRhaWxzOiB7IHN0YXR1czogcGFydG5lci5zdGF0dXMgfVxuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgY2hlY2tzLnB1c2goe1xuICAgICAgY2hlY2s6ICdwYXJ0bmVyX3N0YXR1cycsXG4gICAgICBzdGF0dXM6ICdGQUlMJyxcbiAgICAgIG1lc3NhZ2U6IGBQYXJ0bmVyIHN0YXR1cyBpcyAke3BhcnRuZXIuc3RhdHVzfWAsXG4gICAgICBkZXRhaWxzOiB7IHN0YXR1czogcGFydG5lci5zdGF0dXMgfVxuICAgIH0pXG4gICAgYmxvY2tlcnMucHVzaChgUGFydG5lciBpcyBub3QgYWN0aXZlIChzdGF0dXM6ICR7cGFydG5lci5zdGF0dXN9KWApXG4gIH1cbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0hFQ0sgMjogTWluaW11bSBQYXlvdXQgVGhyZXNob2xkXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgaWYgKGNoZWNrQW1vdW50ID49IE51bWJlcihzZXR0aW5ncy5taW5pbXVtUGF5b3V0KSkge1xuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIGNoZWNrOiAnbWluaW11bV90aHJlc2hvbGQnLFxuICAgICAgc3RhdHVzOiAnUEFTUycsXG4gICAgICBtZXNzYWdlOiBgQW1vdW50ICR7Y2hlY2tBbW91bnR9IG1lZXRzIG1pbmltdW0gJHtzZXR0aW5ncy5taW5pbXVtUGF5b3V0fWAsXG4gICAgICBkZXRhaWxzOiB7IGFtb3VudDogY2hlY2tBbW91bnQsIG1pbmltdW06IE51bWJlcihzZXR0aW5ncy5taW5pbXVtUGF5b3V0KSB9XG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBjaGVja3MucHVzaCh7XG4gICAgICBjaGVjazogJ21pbmltdW1fdGhyZXNob2xkJyxcbiAgICAgIHN0YXR1czogJ0ZBSUwnLFxuICAgICAgbWVzc2FnZTogYEFtb3VudCAke2NoZWNrQW1vdW50fSBiZWxvdyBtaW5pbXVtICR7c2V0dGluZ3MubWluaW11bVBheW91dH1gLFxuICAgICAgZGV0YWlsczogeyBhbW91bnQ6IGNoZWNrQW1vdW50LCBtaW5pbXVtOiBOdW1iZXIoc2V0dGluZ3MubWluaW11bVBheW91dCkgfVxuICAgIH0pXG4gICAgYmxvY2tlcnMucHVzaChgQmFsYW5jZSBiZWxvdyBtaW5pbXVtIHBheW91dCB0aHJlc2hvbGQgKCR7Y2hlY2tBbW91bnR9IDwgJHtzZXR0aW5ncy5taW5pbXVtUGF5b3V0fSlgKVxuICB9XG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIENIRUNLIDM6IFBheW91dCBIb2xkXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgaWYgKCFzZXR0aW5ncy5wYXlvdXRIb2xkKSB7XG4gICAgY2hlY2tzLnB1c2goe1xuICAgICAgY2hlY2s6ICdwYXlvdXRfaG9sZCcsXG4gICAgICBzdGF0dXM6ICdQQVNTJyxcbiAgICAgIG1lc3NhZ2U6ICdObyBwYXlvdXQgaG9sZCBhY3RpdmUnXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBob2xkRXhwaXJlZCA9IHNldHRpbmdzLnBheW91dEhvbGRVbnRpbCAmJiBzZXR0aW5ncy5wYXlvdXRIb2xkVW50aWwgPCBuZXcgRGF0ZSgpXG4gICAgaWYgKGhvbGRFeHBpcmVkKSB7XG4gICAgICBjaGVja3MucHVzaCh7XG4gICAgICAgIGNoZWNrOiAncGF5b3V0X2hvbGQnLFxuICAgICAgICBzdGF0dXM6ICdXQVJOSU5HJyxcbiAgICAgICAgbWVzc2FnZTogJ1BheW91dCBob2xkIGhhcyBleHBpcmVkIGJ1dCBub3QgcmVsZWFzZWQnLFxuICAgICAgICBkZXRhaWxzOiB7IFxuICAgICAgICAgIHJlYXNvbjogc2V0dGluZ3MucGF5b3V0SG9sZFJlYXNvbiwgXG4gICAgICAgICAgdW50aWw6IHNldHRpbmdzLnBheW91dEhvbGRVbnRpbCBcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHdhcm5pbmdzLnB1c2goJ0V4cGlyZWQgcGF5b3V0IGhvbGQgbmVlZHMgdG8gYmUgcmVsZWFzZWQnKVxuICAgIH0gZWxzZSB7XG4gICAgICBjaGVja3MucHVzaCh7XG4gICAgICAgIGNoZWNrOiAncGF5b3V0X2hvbGQnLFxuICAgICAgICBzdGF0dXM6ICdGQUlMJyxcbiAgICAgICAgbWVzc2FnZTogYFBheW91dCBvbiBob2xkOiAke3NldHRpbmdzLnBheW91dEhvbGRSZWFzb259YCxcbiAgICAgICAgZGV0YWlsczogeyBcbiAgICAgICAgICByZWFzb246IHNldHRpbmdzLnBheW91dEhvbGRSZWFzb24sIFxuICAgICAgICAgIHVudGlsOiBzZXR0aW5ncy5wYXlvdXRIb2xkVW50aWwgXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBibG9ja2Vycy5wdXNoKGBQYXlvdXQgb24gaG9sZDogJHtzZXR0aW5ncy5wYXlvdXRIb2xkUmVhc29ufWApXG4gICAgfVxuICB9XG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIENIRUNLIDQ6IFRheCBEb2N1bWVudGF0aW9uXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgaWYgKHNldHRpbmdzLnRheFdpdGhob2xkaW5nRW5hYmxlZCkge1xuICAgIGlmIChzZXR0aW5ncy50YXhEb2N1bWVudFN0YXR1cyA9PT0gJ1ZFUklGSUVEJykge1xuICAgICAgY2hlY2tzLnB1c2goe1xuICAgICAgICBjaGVjazogJ3RheF9kb2N1bWVudGF0aW9uJyxcbiAgICAgICAgc3RhdHVzOiAnUEFTUycsXG4gICAgICAgIG1lc3NhZ2U6ICdUYXggZG9jdW1lbnRhdGlvbiB2ZXJpZmllZCcsXG4gICAgICAgIGRldGFpbHM6IHsgXG4gICAgICAgICAgZG9jdW1lbnRUeXBlOiBzZXR0aW5ncy50YXhEb2N1bWVudFR5cGUsXG4gICAgICAgICAgdmVyaWZpZWRBdDogc2V0dGluZ3MudGF4RG9jdW1lbnRWZXJpZmllZEF0IFxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MudGF4RG9jdW1lbnRTdGF0dXMgPT09ICdQRU5ESU5HJykge1xuICAgICAgY2hlY2tzLnB1c2goe1xuICAgICAgICBjaGVjazogJ3RheF9kb2N1bWVudGF0aW9uJyxcbiAgICAgICAgc3RhdHVzOiAnV0FSTklORycsXG4gICAgICAgIG1lc3NhZ2U6ICdUYXggZG9jdW1lbnRhdGlvbiBwZW5kaW5nIHZlcmlmaWNhdGlvbicsXG4gICAgICAgIGRldGFpbHM6IHsgc3RhdHVzOiBzZXR0aW5ncy50YXhEb2N1bWVudFN0YXR1cyB9XG4gICAgICB9KVxuICAgICAgd2FybmluZ3MucHVzaCgnVGF4IGRvY3VtZW50YXRpb24gcGVuZGluZyB2ZXJpZmljYXRpb24gLSB3aXRoaG9sZGluZyB3aWxsIGFwcGx5JylcbiAgICB9IGVsc2Uge1xuICAgICAgY2hlY2tzLnB1c2goe1xuICAgICAgICBjaGVjazogJ3RheF9kb2N1bWVudGF0aW9uJyxcbiAgICAgICAgc3RhdHVzOiAnV0FSTklORycsXG4gICAgICAgIG1lc3NhZ2U6IGBUYXggZG9jdW1lbnRhdGlvbiBzdGF0dXM6ICR7c2V0dGluZ3MudGF4RG9jdW1lbnRTdGF0dXN9YCxcbiAgICAgICAgZGV0YWlsczogeyBzdGF0dXM6IHNldHRpbmdzLnRheERvY3VtZW50U3RhdHVzIH1cbiAgICAgIH0pXG4gICAgICB3YXJuaW5ncy5wdXNoKGBUYXggZG9jdW1lbnRhdGlvbiBub3QgdmVyaWZpZWQgLSBmdWxsIHdpdGhob2xkaW5nICgke051bWJlcihzZXR0aW5ncy50YXhXaXRoaG9sZGluZ1JhdGUgfHwgMC4zMCkgKiAxMDB9JSkgd2lsbCBhcHBseWApXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIGNoZWNrOiAndGF4X2RvY3VtZW50YXRpb24nLFxuICAgICAgc3RhdHVzOiAnUEFTUycsXG4gICAgICBtZXNzYWdlOiAnVGF4IHdpdGhob2xkaW5nIG5vdCByZXF1aXJlZCdcbiAgICB9KVxuICB9XG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIENIRUNLIDU6IFBheW1lbnQgTWV0aG9kXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgaWYgKHNldHRpbmdzLnBheW1lbnRNZXRob2RWZXJpZmllZCkge1xuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIGNoZWNrOiAncGF5bWVudF9tZXRob2QnLFxuICAgICAgc3RhdHVzOiAnUEFTUycsXG4gICAgICBtZXNzYWdlOiAnUGF5bWVudCBtZXRob2QgdmVyaWZpZWQnLFxuICAgICAgZGV0YWlsczogeyB0eXBlOiBzZXR0aW5ncy5wYXltZW50TWV0aG9kVHlwZSB9XG4gICAgfSlcbiAgfSBlbHNlIGlmIChzZXR0aW5ncy5wYXltZW50TWV0aG9kVHlwZSkge1xuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIGNoZWNrOiAncGF5bWVudF9tZXRob2QnLFxuICAgICAgc3RhdHVzOiAnV0FSTklORycsXG4gICAgICBtZXNzYWdlOiAnUGF5bWVudCBtZXRob2Qgbm90IHZlcmlmaWVkJyxcbiAgICAgIGRldGFpbHM6IHsgdHlwZTogc2V0dGluZ3MucGF5bWVudE1ldGhvZFR5cGUgfVxuICAgIH0pXG4gICAgd2FybmluZ3MucHVzaCgnUGF5bWVudCBtZXRob2Qgc2V0IGJ1dCBub3QgdmVyaWZpZWQnKVxuICB9IGVsc2Uge1xuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIGNoZWNrOiAncGF5bWVudF9tZXRob2QnLFxuICAgICAgc3RhdHVzOiAnV0FSTklORycsXG4gICAgICBtZXNzYWdlOiAnTm8gcGF5bWVudCBtZXRob2QgY29uZmlndXJlZCcsXG4gICAgfSlcbiAgICB3YXJuaW5ncy5wdXNoKCdObyBwYXltZW50IG1ldGhvZCBjb25maWd1cmVkIC0gbWFudWFsIHBheW91dCByZXF1aXJlZCcpXG4gIH1cbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0hFQ0sgNjogQWN0aXZlIEFncmVlbWVudFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGFjdGl2ZUFncmVlbWVudCA9IGF3YWl0IHByaXNtYS5wYXJ0bmVyQWdyZWVtZW50LmZpbmRGaXJzdCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHBhcnRuZXJJZCxcbiAgICAgIHN0YXR1czogJ0FDVElWRScsXG4gICAgICBlZmZlY3RpdmVGcm9tOiB7IGx0ZTogbmV3IERhdGUoKSB9LFxuICAgICAgT1I6IFtcbiAgICAgICAgeyBlZmZlY3RpdmVUbzogbnVsbCB9LFxuICAgICAgICB7IGVmZmVjdGl2ZVRvOiB7IGd0ZTogbmV3IERhdGUoKSB9IH1cbiAgICAgIF1cbiAgICB9XG4gIH0pXG4gIFxuICBpZiAoYWN0aXZlQWdyZWVtZW50KSB7XG4gICAgY2hlY2tzLnB1c2goe1xuICAgICAgY2hlY2s6ICdhY3RpdmVfYWdyZWVtZW50JyxcbiAgICAgIHN0YXR1czogJ1BBU1MnLFxuICAgICAgbWVzc2FnZTogJ0FjdGl2ZSBhZ3JlZW1lbnQgaW4gcGxhY2UnLFxuICAgICAgZGV0YWlsczogeyBhZ3JlZW1lbnRJZDogYWN0aXZlQWdyZWVtZW50LmlkLCB2ZXJzaW9uOiBhY3RpdmVBZ3JlZW1lbnQudmVyc2lvbiB9XG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBjaGVja3MucHVzaCh7XG4gICAgICBjaGVjazogJ2FjdGl2ZV9hZ3JlZW1lbnQnLFxuICAgICAgc3RhdHVzOiAnV0FSTklORycsXG4gICAgICBtZXNzYWdlOiAnTm8gYWN0aXZlIGFncmVlbWVudCBmb3VuZCcsXG4gICAgfSlcbiAgICB3YXJuaW5ncy5wdXNoKCdObyBhY3RpdmUgYWdyZWVtZW50IC0gaGlzdG9yaWNhbCBlYXJuaW5ncyBjYW4gc3RpbGwgYmUgcGFpZCcpXG4gIH1cbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0FMQ1VMQVRFIFNVTU1BUllcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgLy8gR2V0IGVhcm5pbmdzIHRoYXQgd291bGQgYmUgaW5jbHVkZWRcbiAgY29uc3QgcGF5YWJsZUVhcm5pbmdzID0gYXdhaXQgcHJpc21hLnBhcnRuZXJFYXJuaW5nLmZpbmRNYW55KHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgZW50cnlUeXBlOiAnQ1JFRElUJyxcbiAgICAgIHN0YXR1czogeyBpbjogWydDTEVBUkVEJywgJ0FQUFJPVkVEJ10gfSxcbiAgICAgIHBheW91dEJhdGNoSWQ6IG51bGxcbiAgICB9XG4gIH0pXG4gIFxuICBjb25zdCBncm9zc0Ftb3VudCA9IHBheWFibGVFYXJuaW5ncy5yZWR1Y2UoXG4gICAgKHN1bSwgZSkgPT4gc3VtICsgTnVtYmVyKGUuY29tbWlzc2lvbkFtb3VudCksIFxuICAgIDBcbiAgKVxuICBcbiAgLy8gQ2FsY3VsYXRlIHRheCB3aXRoaG9sZGluZ1xuICBsZXQgdGF4V2l0aGhvbGRpbmcgPSAwXG4gIGlmIChzZXR0aW5ncy50YXhXaXRoaG9sZGluZ0VuYWJsZWQgJiYgc2V0dGluZ3MudGF4V2l0aGhvbGRpbmdSYXRlKSB7XG4gICAgLy8gQXBwbHkgZnVsbCB3aXRoaG9sZGluZyBpZiBkb2NzIG5vdCB2ZXJpZmllZFxuICAgIGNvbnN0IHJhdGUgPSBzZXR0aW5ncy50YXhEb2N1bWVudFN0YXR1cyAhPT0gJ1ZFUklGSUVEJyBcbiAgICAgID8gTnVtYmVyKHNldHRpbmdzLnRheFdpdGhob2xkaW5nUmF0ZSlcbiAgICAgIDogTnVtYmVyKHNldHRpbmdzLnRheFdpdGhob2xkaW5nUmF0ZSlcbiAgICB0YXhXaXRoaG9sZGluZyA9IGdyb3NzQW1vdW50ICogcmF0ZVxuICB9XG4gIFxuICBjb25zdCBuZXRBbW91bnQgPSBncm9zc0Ftb3VudCAtIHRheFdpdGhob2xkaW5nXG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIERFVEVSTUlORSBPVkVSQUxMIFJFQURJTkVTU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGlzUmVhZHkgPSBibG9ja2Vycy5sZW5ndGggPT09IDAgJiYgZ3Jvc3NBbW91bnQgPiAwXG4gIFxuICAvLyBMb2cgdGhlIHJlYWRpbmVzcyBjaGVja1xuICBhd2FpdCBwcmlzbWEuYXVkaXRMb2cuY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBhY3Rpb246ICdQQVlPVVRfUkVBRElORVNTX0NIRUNLRUQnLFxuICAgICAgYWN0b3JJZDogJ3N5c3RlbScsXG4gICAgICBhY3RvckVtYWlsOiAncGF5b3V0QHNhYXNjb3JlLmludGVybmFsJyxcbiAgICAgIHRhcmdldFR5cGU6ICdQYXJ0bmVyJyxcbiAgICAgIHRhcmdldElkOiBwYXJ0bmVySWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBpc1JlYWR5LFxuICAgICAgICBibG9ja2VycyxcbiAgICAgICAgd2FybmluZ3MsXG4gICAgICAgIGdyb3NzQW1vdW50LFxuICAgICAgICBuZXRBbW91bnQsXG4gICAgICAgIGVhcm5pbmdzQ291bnQ6IHBheWFibGVFYXJuaW5ncy5sZW5ndGhcbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICBpc1JlYWR5LFxuICAgIGNoZWNrcyxcbiAgICBibG9ja2VycyxcbiAgICB3YXJuaW5ncyxcbiAgICBzdW1tYXJ5OiB7XG4gICAgICBncm9zc0Ftb3VudCxcbiAgICAgIHRheFdpdGhob2xkaW5nLFxuICAgICAgbmV0QW1vdW50LFxuICAgICAgZWFybmluZ3NDb3VudDogcGF5YWJsZUVhcm5pbmdzLmxlbmd0aFxuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUQVggV0lUSEhPTERJTkdcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDYWxjdWxhdGUgdGF4IHdpdGhob2xkaW5nIGZvciBhIHBheW91dFxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlVGF4V2l0aGhvbGRpbmcoXG4gIGdyb3NzQW1vdW50OiBudW1iZXIsXG4gIHNldHRpbmdzOiBQYXJ0bmVyUGF5b3V0U2V0dGluZ3Ncbik6IHsgd2l0aGhvbGRpbmdBbW91bnQ6IG51bWJlcjsgcmF0ZTogbnVtYmVyOyByZWFzb246IHN0cmluZyB8IG51bGwgfSB7XG4gIGlmICghc2V0dGluZ3MudGF4V2l0aGhvbGRpbmdFbmFibGVkKSB7XG4gICAgcmV0dXJuIHsgd2l0aGhvbGRpbmdBbW91bnQ6IDAsIHJhdGU6IDAsIHJlYXNvbjogbnVsbCB9XG4gIH1cbiAgXG4gIGNvbnN0IHJhdGUgPSBOdW1iZXIoc2V0dGluZ3MudGF4V2l0aGhvbGRpbmdSYXRlIHx8IDAuMzApIC8vIERlZmF1bHQgMzAlIGlmIG5vdCBzcGVjaWZpZWRcbiAgY29uc3Qgd2l0aGhvbGRpbmdBbW91bnQgPSBNYXRoLnJvdW5kKGdyb3NzQW1vdW50ICogcmF0ZSAqIDEwMCkgLyAxMDBcbiAgXG4gIHJldHVybiB7XG4gICAgd2l0aGhvbGRpbmdBbW91bnQsXG4gICAgcmF0ZSxcbiAgICByZWFzb246IHNldHRpbmdzLnRheFdpdGhob2xkaW5nUmVhc29uIHx8ICdUYXggd2l0aGhvbGRpbmcgcmVxdWlyZWQnXG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGUgdGF4IGRvY3VtZW50IHN0YXR1c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF4RG9jdW1lbnRTdGF0dXMoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBzdGF0dXM6ICdQRU5ESU5HJyB8ICdWRVJJRklFRCcgfCAnRVhQSVJFRCcsXG4gIGRvY3VtZW50VHlwZT86IHN0cmluZyxcbiAgdXBkYXRlZEJ5Pzogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgcHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcbiAgICBhd2FpdCB0eC5wYXJ0bmVyUGF5b3V0U2V0dGluZ3MudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICB0YXhEb2N1bWVudFN0YXR1czogc3RhdHVzLFxuICAgICAgICB0YXhEb2N1bWVudFR5cGU6IGRvY3VtZW50VHlwZSxcbiAgICAgICAgdGF4RG9jdW1lbnRWZXJpZmllZEF0OiBzdGF0dXMgPT09ICdWRVJJRklFRCcgPyBuZXcgRGF0ZSgpIDogdW5kZWZpbmVkXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICBjb25zdCBhY3Rpb24gPSBzdGF0dXMgPT09ICdWRVJJRklFRCcgXG4gICAgICA/ICdUQVhfRE9DVU1FTlRfVkVSSUZJRUQnIFxuICAgICAgOiAnVEFYX0RPQ1VNRU5UX1NVQk1JVFRFRCdcbiAgICBcbiAgICBhd2FpdCB0eC5hdWRpdExvZy5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICBhY3Rpb24sXG4gICAgICAgIGFjdG9ySWQ6IHVwZGF0ZWRCeSB8fCAnc3lzdGVtJyxcbiAgICAgICAgYWN0b3JFbWFpbDogJ3RheEBzYWFzY29yZS5pbnRlcm5hbCcsXG4gICAgICAgIHRhcmdldFR5cGU6ICdQYXJ0bmVyUGF5b3V0U2V0dGluZ3MnLFxuICAgICAgICB0YXJnZXRJZDogcGFydG5lcklkLFxuICAgICAgICBtZXRhZGF0YTogeyBzdGF0dXMsIGRvY3VtZW50VHlwZSB9XG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUEFZT1VUIEhPTERcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBBcHBseSBwYXlvdXQgaG9sZCBvbiBhIHBhcnRuZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGx5UGF5b3V0SG9sZChcbiAgcGFydG5lcklkOiBzdHJpbmcsXG4gIHJlYXNvbjogc3RyaW5nLFxuICBob2xkVW50aWw/OiBEYXRlLFxuICBhcHBsaWVkQnk/OiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgIGF3YWl0IHR4LnBhcnRuZXJQYXlvdXRTZXR0aW5ncy51cHNlcnQoe1xuICAgICAgd2hlcmU6IHsgcGFydG5lcklkIH0sXG4gICAgICBjcmVhdGU6IHtcbiAgICAgICAgcGFydG5lcklkLFxuICAgICAgICBwYXlvdXRIb2xkOiB0cnVlLFxuICAgICAgICBwYXlvdXRIb2xkUmVhc29uOiByZWFzb24sXG4gICAgICAgIHBheW91dEhvbGRVbnRpbDogaG9sZFVudGlsXG4gICAgICB9LFxuICAgICAgdXBkYXRlOiB7XG4gICAgICAgIHBheW91dEhvbGQ6IHRydWUsXG4gICAgICAgIHBheW91dEhvbGRSZWFzb246IHJlYXNvbixcbiAgICAgICAgcGF5b3V0SG9sZFVudGlsOiBob2xkVW50aWxcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIGF3YWl0IHR4LmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGFjdGlvbjogJ1BBWU9VVF9IT0xEX0FQUExJRUQnLFxuICAgICAgICBhY3RvcklkOiBhcHBsaWVkQnkgfHwgJ3N5c3RlbScsXG4gICAgICAgIGFjdG9yRW1haWw6ICdhZG1pbicsXG4gICAgICAgIHRhcmdldFR5cGU6ICdQYXJ0bmVyJyxcbiAgICAgICAgdGFyZ2V0SWQ6IHBhcnRuZXJJZCxcbiAgICAgICAgbWV0YWRhdGE6IHsgcmVhc29uLCBob2xkVW50aWwgfVxuICAgICAgfVxuICAgIH0pXG4gIH0pXG59XG5cbi8qKlxuICogUmVsZWFzZSBwYXlvdXQgaG9sZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVsZWFzZVBheW91dEhvbGQoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICByZWxlYXNlZEJ5Pzogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgcHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IHR4LnBhcnRuZXJQYXlvdXRTZXR0aW5ncy5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9XG4gICAgfSlcbiAgICBcbiAgICBhd2FpdCB0eC5wYXJ0bmVyUGF5b3V0U2V0dGluZ3MudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IHBhcnRuZXJJZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBwYXlvdXRIb2xkOiBmYWxzZSxcbiAgICAgICAgcGF5b3V0SG9sZFJlYXNvbjogbnVsbCxcbiAgICAgICAgcGF5b3V0SG9sZFVudGlsOiBudWxsXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICBhd2FpdCB0eC5hdWRpdExvZy5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICBhY3Rpb246ICdQQVlPVVRfSE9MRF9SRUxFQVNFRCcsXG4gICAgICAgIGFjdG9ySWQ6IHJlbGVhc2VkQnkgfHwgJ3N5c3RlbScsXG4gICAgICAgIGFjdG9yRW1haWw6ICdhZG1pbicsXG4gICAgICAgIHRhcmdldFR5cGU6ICdQYXJ0bmVyJyxcbiAgICAgICAgdGFyZ2V0SWQ6IHBhcnRuZXJJZCxcbiAgICAgICAgbWV0YWRhdGE6IHsgXG4gICAgICAgICAgcHJldmlvdXNSZWFzb246IHNldHRpbmdzPy5wYXlvdXRIb2xkUmVhc29uIFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUEFZT1VUIEJBVENIIENSRUFUSU9OIChObyBFeGVjdXRpb24pXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQ3JlYXRlIGEgcGF5b3V0IGJhdGNoIChEUkFGVCBzdGF0dXMpXG4gKiBcbiAqIFRoaXMgZG9lcyBOT1QgZXhlY3V0ZSB0aGUgcGF5b3V0IC0gb25seSBwcmVwYXJlcyBpdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUGF5b3V0QmF0Y2goXG4gIGlucHV0OiBDcmVhdGVQYXlvdXRCYXRjaElucHV0XG4pOiBQcm9taXNlPFBheW91dEJhdGNoUmVzdWx0PiB7XG4gIC8vIENoZWNrIHJlYWRpbmVzc1xuICBjb25zdCByZWFkaW5lc3MgPSBhd2FpdCBjaGVja1BheW91dFJlYWRpbmVzcyhpbnB1dC5wYXJ0bmVySWQpXG4gIFxuICBpZiAoIXJlYWRpbmVzcy5pc1JlYWR5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGBQYXlvdXQgbm90IHJlYWR5OiAke3JlYWRpbmVzcy5ibG9ja2Vycy5qb2luKCcsICcpfWAsXG4gICAgICBjb2RlOiAnTk9UX1JFQURZJ1xuICAgIH1cbiAgfVxuICBcbiAgY29uc3Qgc2V0dGluZ3MgPSBhd2FpdCBnZXRQYXlvdXRTZXR0aW5ncyhpbnB1dC5wYXJ0bmVySWQpXG4gIFxuICAvLyBHZXQgZWxpZ2libGUgZWFybmluZ3NcbiAgY29uc3Qgc3RhdHVzRmlsdGVyOiBFYXJuaW5nU3RhdHVzW10gPSBbXVxuICBpZiAoaW5wdXQuaW5jbHVkZUNsZWFyZWQgIT09IGZhbHNlKSBzdGF0dXNGaWx0ZXIucHVzaCgnQ0xFQVJFRCcpXG4gIGlmIChpbnB1dC5pbmNsdWRlQXBwcm92ZWQgIT09IGZhbHNlKSBzdGF0dXNGaWx0ZXIucHVzaCgnQVBQUk9WRUQnKVxuICBcbiAgY29uc3QgZWFybmluZ3MgPSBhd2FpdCBwcmlzbWEucGFydG5lckVhcm5pbmcuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQ6IGlucHV0LnBhcnRuZXJJZCxcbiAgICAgIGVudHJ5VHlwZTogJ0NSRURJVCcsXG4gICAgICBzdGF0dXM6IHsgaW46IHN0YXR1c0ZpbHRlciB9LFxuICAgICAgcGF5b3V0QmF0Y2hJZDogbnVsbCxcbiAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICBndGU6IGlucHV0LnBlcmlvZFN0YXJ0LFxuICAgICAgICBsdGU6IGlucHV0LnBlcmlvZEVuZFxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgXG4gIGlmIChlYXJuaW5ncy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogJ05vIGVsaWdpYmxlIGVhcm5pbmdzIGZvdW5kIGZvciB0aGUgc3BlY2lmaWVkIHBlcmlvZCcsXG4gICAgICBjb2RlOiAnTk9fRUFSTklOR1MnXG4gICAgfVxuICB9XG4gIFxuICAvLyBDYWxjdWxhdGUgdG90YWxzXG4gIGNvbnN0IGdyb3NzQW1vdW50ID0gZWFybmluZ3MucmVkdWNlKFxuICAgIChzdW0sIGUpID0+IHN1bSArIE51bWJlcihlLmNvbW1pc3Npb25BbW91bnQpLCBcbiAgICAwXG4gIClcbiAgXG4gIGlmIChncm9zc0Ftb3VudCA8IE51bWJlcihzZXR0aW5ncy5taW5pbXVtUGF5b3V0KSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBgQW1vdW50ICR7Z3Jvc3NBbW91bnR9IGJlbG93IG1pbmltdW0gJHtzZXR0aW5ncy5taW5pbXVtUGF5b3V0fWAsXG4gICAgICBjb2RlOiAnQkVMT1dfTUlOSU1VTSdcbiAgICB9XG4gIH1cbiAgXG4gIC8vIENhbGN1bGF0ZSB0YXggd2l0aGhvbGRpbmdcbiAgY29uc3QgdGF4UmVzdWx0ID0gY2FsY3VsYXRlVGF4V2l0aGhvbGRpbmcoZ3Jvc3NBbW91bnQsIHNldHRpbmdzKVxuICBjb25zdCBuZXRBbW91bnQgPSBncm9zc0Ftb3VudCAtIHRheFJlc3VsdC53aXRoaG9sZGluZ0Ftb3VudFxuICBcbiAgLy8gR2VuZXJhdGUgYmF0Y2ggbnVtYmVyXG4gIGNvbnN0IGJhdGNoTnVtYmVyID0gYXdhaXQgZ2VuZXJhdGVCYXRjaE51bWJlcigpXG4gIFxuICAvLyBDcmVhdGUgYmF0Y2ggaW4gdHJhbnNhY3Rpb25cbiAgY29uc3QgYmF0Y2ggPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgIGNvbnN0IG5ld0JhdGNoID0gYXdhaXQgdHgucGF5b3V0QmF0Y2guY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgcGFydG5lcklkOiBpbnB1dC5wYXJ0bmVySWQsXG4gICAgICAgIGJhdGNoTnVtYmVyLFxuICAgICAgICBzdGF0dXM6ICdEUkFGVCcsXG4gICAgICAgIGdyb3NzQW1vdW50LFxuICAgICAgICB0YXhXaXRoaG9sZGluZzogdGF4UmVzdWx0LndpdGhob2xkaW5nQW1vdW50LFxuICAgICAgICBuZXRBbW91bnQsXG4gICAgICAgIGN1cnJlbmN5OiBzZXR0aW5ncy5jdXJyZW5jeSxcbiAgICAgICAgZWFybmluZ3NDb3VudDogZWFybmluZ3MubGVuZ3RoLFxuICAgICAgICBwZXJpb2RTdGFydDogaW5wdXQucGVyaW9kU3RhcnQsXG4gICAgICAgIHBlcmlvZEVuZDogaW5wdXQucGVyaW9kRW5kLFxuICAgICAgICByZWFkaW5lc3NDaGVja3M6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNoZWNrczogcmVhZGluZXNzLmNoZWNrcyxcbiAgICAgICAgICBjaGVja2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9KSksXG4gICAgICAgIHJlYWRpbmVzc1N0YXR1czogJ1JFQURZJyxcbiAgICAgICAgaW50ZXJuYWxOb3RlczogaW5wdXQubm90ZXNcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIC8vIExpbmsgZWFybmluZ3MgdG8gYmF0Y2hcbiAgICBhd2FpdCB0eC5wYXJ0bmVyRWFybmluZy51cGRhdGVNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGlkOiB7IGluOiBlYXJuaW5ncy5tYXAoZSA9PiBlLmlkKSB9XG4gICAgICB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBwYXlvdXRCYXRjaElkOiBuZXdCYXRjaC5pZFxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgLy8gQXVkaXQgbG9nXG4gICAgYXdhaXQgdHguYXVkaXRMb2cuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYWN0aW9uOiAnUEFZT1VUX0JBVENIX0NSRUFURUQnLFxuICAgICAgICBhY3RvcklkOiAnc3lzdGVtJyxcbiAgICAgICAgYWN0b3JFbWFpbDogJ3BheW91dEBzYWFzY29yZS5pbnRlcm5hbCcsXG4gICAgICAgIHRhcmdldFR5cGU6ICdQYXlvdXRCYXRjaCcsXG4gICAgICAgIHRhcmdldElkOiBuZXdCYXRjaC5pZCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBwYXJ0bmVySWQ6IGlucHV0LnBhcnRuZXJJZCxcbiAgICAgICAgICBiYXRjaE51bWJlcixcbiAgICAgICAgICBncm9zc0Ftb3VudCxcbiAgICAgICAgICB0YXhXaXRoaG9sZGluZzogdGF4UmVzdWx0LndpdGhob2xkaW5nQW1vdW50LFxuICAgICAgICAgIG5ldEFtb3VudCxcbiAgICAgICAgICBlYXJuaW5nc0NvdW50OiBlYXJuaW5ncy5sZW5ndGhcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIG5ld0JhdGNoXG4gIH0pXG4gIFxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBiYXRjaCB9XG59XG5cbi8qKlxuICogR2VuZXJhdGUgdW5pcXVlIGJhdGNoIG51bWJlclxuICovXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUJhdGNoTnVtYmVyKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKClcbiAgY29uc3QgY291bnQgPSBhd2FpdCBwcmlzbWEucGF5b3V0QmF0Y2guY291bnQoe1xuICAgIHdoZXJlOiB7XG4gICAgICBiYXRjaE51bWJlcjogeyBzdGFydHNXaXRoOiBgUE8tJHt5ZWFyfS1gIH1cbiAgICB9XG4gIH0pXG4gIHJldHVybiBgUE8tJHt5ZWFyfS0ke1N0cmluZyhjb3VudCArIDEpLnBhZFN0YXJ0KDYsICcwJyl9YFxufVxuXG4vKipcbiAqIENhbmNlbCBhIGRyYWZ0IHBheW91dCBiYXRjaFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FuY2VsUGF5b3V0QmF0Y2goXG4gIGJhdGNoSWQ6IHN0cmluZyxcbiAgcmVhc29uOiBzdHJpbmcsXG4gIGNhbmNlbGxlZEJ5OiBzdHJpbmdcbik6IFByb21pc2U8UGF5b3V0QmF0Y2hSZXN1bHQ+IHtcbiAgY29uc3QgYmF0Y2ggPSBhd2FpdCBwcmlzbWEucGF5b3V0QmF0Y2guZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IGJhdGNoSWQgfVxuICB9KVxuICBcbiAgaWYgKCFiYXRjaCkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0JhdGNoIG5vdCBmb3VuZCcsIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyB9XG4gIH1cbiAgXG4gIGlmICghWydEUkFGVCcsICdQRU5ESU5HX0FQUFJPVkFMJ10uaW5jbHVkZXMoYmF0Y2guc3RhdHVzKSkge1xuICAgIHJldHVybiB7IFxuICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgZXJyb3I6IGBDYW5ub3QgY2FuY2VsIGJhdGNoIGluICR7YmF0Y2guc3RhdHVzfSBzdGF0dXNgLFxuICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InXG4gICAgfVxuICB9XG4gIFxuICBjb25zdCB1cGRhdGVkQmF0Y2ggPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgIC8vIFVubGluayBlYXJuaW5ncyBmcm9tIGJhdGNoXG4gICAgYXdhaXQgdHgucGFydG5lckVhcm5pbmcudXBkYXRlTWFueSh7XG4gICAgICB3aGVyZTogeyBwYXlvdXRCYXRjaElkOiBiYXRjaElkIH0sXG4gICAgICBkYXRhOiB7IHBheW91dEJhdGNoSWQ6IG51bGwgfVxuICAgIH0pXG4gICAgXG4gICAgLy8gVXBkYXRlIGJhdGNoIHN0YXR1c1xuICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wYXlvdXRCYXRjaC51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IGJhdGNoSWQgfSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc3RhdHVzOiAnQ0FOQ0VMTEVEJyxcbiAgICAgICAgY2FuY2VsbGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGNhbmNlbGxlZEJ5VXNlcklkOiBjYW5jZWxsZWRCeSxcbiAgICAgICAgY2FuY2VsbGF0aW9uUmVhc29uOiByZWFzb25cbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIC8vIEF1ZGl0IGxvZ1xuICAgIGF3YWl0IHR4LmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGFjdGlvbjogJ1BBWU9VVF9CQVRDSF9DQU5DRUxMRUQnLFxuICAgICAgICBhY3RvcklkOiBjYW5jZWxsZWRCeSxcbiAgICAgICAgYWN0b3JFbWFpbDogJ2FkbWluJyxcbiAgICAgICAgdGFyZ2V0VHlwZTogJ1BheW91dEJhdGNoJyxcbiAgICAgICAgdGFyZ2V0SWQ6IGJhdGNoSWQsXG4gICAgICAgIG1ldGFkYXRhOiB7IHJlYXNvbiB9XG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gdXBkYXRlZFxuICB9KVxuICBcbiAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYmF0Y2g6IHVwZGF0ZWRCYXRjaCB9XG59XG5cbi8qKlxuICogQXBwcm92ZSBhIHBheW91dCBiYXRjaFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwcm92ZVBheW91dEJhdGNoKFxuICBiYXRjaElkOiBzdHJpbmcsXG4gIGFwcHJvdmVkQnk6IHN0cmluZ1xuKTogUHJvbWlzZTxQYXlvdXRCYXRjaFJlc3VsdD4ge1xuICBjb25zdCBiYXRjaCA9IGF3YWl0IHByaXNtYS5wYXlvdXRCYXRjaC5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogYmF0Y2hJZCB9XG4gIH0pXG4gIFxuICBpZiAoIWJhdGNoKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQmF0Y2ggbm90IGZvdW5kJywgY29kZTogJ1ZBTElEQVRJT05fRVJST1InIH1cbiAgfVxuICBcbiAgaWYgKCFbJ0RSQUZUJywgJ1BFTkRJTkdfQVBQUk9WQUwnXS5pbmNsdWRlcyhiYXRjaC5zdGF0dXMpKSB7XG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogYENhbm5vdCBhcHByb3ZlIGJhdGNoIGluICR7YmF0Y2guc3RhdHVzfSBzdGF0dXNgLFxuICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InXG4gICAgfVxuICB9XG4gIFxuICAvLyBSZS1jaGVjayByZWFkaW5lc3NcbiAgY29uc3QgcmVhZGluZXNzID0gYXdhaXQgY2hlY2tQYXlvdXRSZWFkaW5lc3MoYmF0Y2gucGFydG5lcklkLCBOdW1iZXIoYmF0Y2guZ3Jvc3NBbW91bnQpKVxuICBcbiAgaWYgKCFyZWFkaW5lc3MuaXNSZWFkeSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBgUGF5b3V0IG5vIGxvbmdlciByZWFkeTogJHtyZWFkaW5lc3MuYmxvY2tlcnMuam9pbignLCAnKX1gLFxuICAgICAgY29kZTogJ05PVF9SRUFEWSdcbiAgICB9XG4gIH1cbiAgXG4gIGNvbnN0IHVwZGF0ZWRCYXRjaCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHR4LnBheW91dEJhdGNoLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogYmF0Y2hJZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBzdGF0dXM6ICdBUFBST1ZFRCcsXG4gICAgICAgIGFwcHJvdmVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGFwcHJvdmVkQnlVc2VySWQ6IGFwcHJvdmVkQnksXG4gICAgICAgIHJlYWRpbmVzc0NoZWNrczogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgY2hlY2tzOiByZWFkaW5lc3MuY2hlY2tzLFxuICAgICAgICAgIGNoZWNrZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pKSxcbiAgICAgICAgcmVhZGluZXNzU3RhdHVzOiAnUkVBRFknXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICAvLyBVcGRhdGUgZWFybmluZ3Mgc3RhdHVzIHRvIEFQUFJPVkVEXG4gICAgYXdhaXQgdHgucGFydG5lckVhcm5pbmcudXBkYXRlTWFueSh7XG4gICAgICB3aGVyZTogeyBcbiAgICAgICAgcGF5b3V0QmF0Y2hJZDogYmF0Y2hJZCxcbiAgICAgICAgc3RhdHVzOiAnQ0xFQVJFRCdcbiAgICAgIH0sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHN0YXR1czogJ0FQUFJPVkVEJyxcbiAgICAgICAgYXBwcm92ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgYXBwcm92ZWRCeVVzZXJJZDogYXBwcm92ZWRCeVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgLy8gQXVkaXQgbG9nXG4gICAgYXdhaXQgdHguYXVkaXRMb2cuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYWN0aW9uOiAnUEFZT1VUX0JBVENIX0FQUFJPVkVEJyxcbiAgICAgICAgYWN0b3JJZDogYXBwcm92ZWRCeSxcbiAgICAgICAgYWN0b3JFbWFpbDogJ2FkbWluJyxcbiAgICAgICAgdGFyZ2V0VHlwZTogJ1BheW91dEJhdGNoJyxcbiAgICAgICAgdGFyZ2V0SWQ6IGJhdGNoSWQsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcGFydG5lcklkOiBiYXRjaC5wYXJ0bmVySWQsXG4gICAgICAgICAgbmV0QW1vdW50OiBOdW1iZXIoYmF0Y2gubmV0QW1vdW50KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gdXBkYXRlZFxuICB9KVxuICBcbiAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYmF0Y2g6IHVwZGF0ZWRCYXRjaCB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFUE9SVElORyBWSUVXU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBwYXlvdXQgcmVwb3J0IGZvciBhIHBhcnRuZXJcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQYXlvdXRSZXBvcnQge1xuICBwYXJ0bmVySWQ6IHN0cmluZ1xuICBwYXJ0bmVyTmFtZTogc3RyaW5nXG4gIHBlcmlvZDogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH1cbiAgXG4gIC8vIEN1cnJlbnQgYmFsYW5jZXNcbiAgYmFsYW5jZTogUGF5YWJsZUJhbGFuY2VcbiAgXG4gIC8vIFBlbmRpbmcgYmF0Y2hlc1xuICBwZW5kaW5nQmF0Y2hlczoge1xuICAgIGlkOiBzdHJpbmdcbiAgICBiYXRjaE51bWJlcjogc3RyaW5nXG4gICAgc3RhdHVzOiBzdHJpbmdcbiAgICBuZXRBbW91bnQ6IG51bWJlclxuICAgIGVhcm5pbmdzQ291bnQ6IG51bWJlclxuICAgIGNyZWF0ZWRBdDogRGF0ZVxuICB9W11cbiAgXG4gIC8vIEhpc3RvcmljYWwgcGF5b3V0c1xuICBwYWlkQmF0Y2hlczoge1xuICAgIGlkOiBzdHJpbmdcbiAgICBiYXRjaE51bWJlcjogc3RyaW5nXG4gICAgbmV0QW1vdW50OiBudW1iZXJcbiAgICBwYWlkQXQ6IERhdGUgfCBudWxsXG4gIH1bXVxuICBcbiAgLy8gU3VtbWFyeVxuICB0b3RhbFBlbmRpbmc6IG51bWJlclxuICB0b3RhbFBhaWRUaGlzUGVyaW9kOiBudW1iZXJcbiAgdG90YWxQYWlkQWxsVGltZTogbnVtYmVyXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYXlvdXRSZXBvcnQoXG4gIHBhcnRuZXJJZDogc3RyaW5nLFxuICBwZXJpb2RTdGFydDogRGF0ZSxcbiAgcGVyaW9kRW5kOiBEYXRlXG4pOiBQcm9taXNlPFBheW91dFJlcG9ydD4ge1xuICBjb25zdCBwYXJ0bmVyID0gYXdhaXQgcHJpc21hLnBhcnRuZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHBhcnRuZXJJZCB9LFxuICAgIHNlbGVjdDogeyBuYW1lOiB0cnVlIH1cbiAgfSlcbiAgXG4gIGNvbnN0IGJhbGFuY2UgPSBhd2FpdCBnZXRQYXlhYmxlQmFsYW5jZShwYXJ0bmVySWQpXG4gIFxuICAvLyBHZXQgcGVuZGluZyBiYXRjaGVzXG4gIGNvbnN0IHBlbmRpbmdCYXRjaGVzID0gYXdhaXQgcHJpc21hLnBheW91dEJhdGNoLmZpbmRNYW55KHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgc3RhdHVzOiB7IGluOiBbJ0RSQUZUJywgJ1BFTkRJTkdfQVBQUk9WQUwnLCAnQVBQUk9WRUQnLCAnUkVBRFknXSB9XG4gICAgfSxcbiAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1cbiAgfSlcbiAgXG4gIC8vIEdldCBwYWlkIGJhdGNoZXMgaW4gcGVyaW9kXG4gIGNvbnN0IHBhaWRCYXRjaGVzID0gYXdhaXQgcHJpc21hLnBheW91dEJhdGNoLmZpbmRNYW55KHtcbiAgICB3aGVyZToge1xuICAgICAgcGFydG5lcklkLFxuICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgIHByb2Nlc3NlZEF0OiB7IGd0ZTogcGVyaW9kU3RhcnQsIGx0ZTogcGVyaW9kRW5kIH1cbiAgICB9LFxuICAgIG9yZGVyQnk6IHsgcHJvY2Vzc2VkQXQ6ICdkZXNjJyB9XG4gIH0pXG4gIFxuICAvLyBHZXQgYWxsLXRpbWUgcGFpZCB0b3RhbFxuICBjb25zdCBhbGxUaW1lUGFpZCA9IGF3YWl0IHByaXNtYS5wYXlvdXRCYXRjaC5hZ2dyZWdhdGUoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwYXJ0bmVySWQsXG4gICAgICBzdGF0dXM6ICdDT01QTEVURUQnXG4gICAgfSxcbiAgICBfc3VtOiB7IG5ldEFtb3VudDogdHJ1ZSB9XG4gIH0pXG4gIFxuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICBwYXJ0bmVyTmFtZTogcGFydG5lcj8ubmFtZSB8fCAnVW5rbm93bicsXG4gICAgcGVyaW9kOiB7IHN0YXJ0OiBwZXJpb2RTdGFydCwgZW5kOiBwZXJpb2RFbmQgfSxcbiAgICBiYWxhbmNlLFxuICAgIHBlbmRpbmdCYXRjaGVzOiBwZW5kaW5nQmF0Y2hlcy5tYXAoYiA9PiAoe1xuICAgICAgaWQ6IGIuaWQsXG4gICAgICBiYXRjaE51bWJlcjogYi5iYXRjaE51bWJlcixcbiAgICAgIHN0YXR1czogYi5zdGF0dXMsXG4gICAgICBuZXRBbW91bnQ6IE51bWJlcihiLm5ldEFtb3VudCksXG4gICAgICBlYXJuaW5nc0NvdW50OiBiLmVhcm5pbmdzQ291bnQsXG4gICAgICBjcmVhdGVkQXQ6IGIuY3JlYXRlZEF0XG4gICAgfSkpLFxuICAgIHBhaWRCYXRjaGVzOiBwYWlkQmF0Y2hlcy5tYXAoYiA9PiAoe1xuICAgICAgaWQ6IGIuaWQsXG4gICAgICBiYXRjaE51bWJlcjogYi5iYXRjaE51bWJlcixcbiAgICAgIG5ldEFtb3VudDogTnVtYmVyKGIubmV0QW1vdW50KSxcbiAgICAgIHBhaWRBdDogYi5wcm9jZXNzZWRBdFxuICAgIH0pKSxcbiAgICB0b3RhbFBlbmRpbmc6IHBlbmRpbmdCYXRjaGVzLnJlZHVjZSgoc3VtLCBiKSA9PiBzdW0gKyBOdW1iZXIoYi5uZXRBbW91bnQpLCAwKSxcbiAgICB0b3RhbFBhaWRUaGlzUGVyaW9kOiBwYWlkQmF0Y2hlcy5yZWR1Y2UoKHN1bSwgYikgPT4gc3VtICsgTnVtYmVyKGIubmV0QW1vdW50KSwgMCksXG4gICAgdG90YWxQYWlkQWxsVGltZTogTnVtYmVyKGFsbFRpbWVQYWlkLl9zdW0ubmV0QW1vdW50IHx8IDApXG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgcGxhdGZvcm0td2lkZSBwYXlvdXQgc3VtbWFyeVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBsYXRmb3JtUGF5b3V0U3VtbWFyeSB7XG4gIHBlcmlvZDogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH1cbiAgXG4gIC8vIFBhcnRuZXIgY291bnRzXG4gIHRvdGFsUGFydG5lcnM6IG51bWJlclxuICBwYXJ0bmVyc1dpdGhCYWxhbmNlOiBudW1iZXJcbiAgcGFydG5lcnNSZWFkeUZvclBheW91dDogbnVtYmVyXG4gIHBhcnRuZXJzT25Ib2xkOiBudW1iZXJcbiAgXG4gIC8vIEFtb3VudHNcbiAgdG90YWxQZW5kaW5nOiBudW1iZXJcbiAgdG90YWxDbGVhcmVkOiBudW1iZXJcbiAgdG90YWxBcHByb3ZlZDogbnVtYmVyXG4gIHRvdGFsSW5CYXRjaGVzOiBudW1iZXJcbiAgXG4gIC8vIEJhdGNoIGNvdW50c1xuICBkcmFmdEJhdGNoZXM6IG51bWJlclxuICBhcHByb3ZlZEJhdGNoZXM6IG51bWJlclxuICBcbiAgY3VycmVuY3k6IHN0cmluZ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGxhdGZvcm1QYXlvdXRTdW1tYXJ5KFxuICBwZXJpb2RTdGFydDogRGF0ZSxcbiAgcGVyaW9kRW5kOiBEYXRlXG4pOiBQcm9taXNlPFBsYXRmb3JtUGF5b3V0U3VtbWFyeT4ge1xuICBjb25zdCBbXG4gICAgdG90YWxQYXJ0bmVycyxcbiAgICBwYXJ0bmVyc09uSG9sZCxcbiAgICBiYWxhbmNlcyxcbiAgICBiYXRjaENvdW50c1xuICBdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgIHByaXNtYS5wYXJ0bmVyLmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiAnQUNUSVZFJyB9IH0pLFxuICAgIHByaXNtYS5wYXJ0bmVyUGF5b3V0U2V0dGluZ3MuY291bnQoeyB3aGVyZTogeyBwYXlvdXRIb2xkOiB0cnVlIH0gfSksXG4gICAgZ2V0QWxsUGF5YWJsZUJhbGFuY2VzKCksXG4gICAgcHJpc21hLnBheW91dEJhdGNoLmdyb3VwQnkoe1xuICAgICAgYnk6IFsnc3RhdHVzJ10sXG4gICAgICBfY291bnQ6IHRydWVcbiAgICB9KVxuICBdKVxuICBcbiAgY29uc3QgcGFydG5lcnNXaXRoQmFsYW5jZSA9IGJhbGFuY2VzLmZpbHRlcihiID0+IGIudG90YWxQYXlhYmxlID4gMCkubGVuZ3RoXG4gIGNvbnN0IHBhcnRuZXJzUmVhZHlGb3JQYXlvdXQgPSBiYWxhbmNlcy5maWx0ZXIoYiA9PiBiLm1lZXRzTWluaW11bSkubGVuZ3RoXG4gIFxuICByZXR1cm4ge1xuICAgIHBlcmlvZDogeyBzdGFydDogcGVyaW9kU3RhcnQsIGVuZDogcGVyaW9kRW5kIH0sXG4gICAgdG90YWxQYXJ0bmVycyxcbiAgICBwYXJ0bmVyc1dpdGhCYWxhbmNlLFxuICAgIHBhcnRuZXJzUmVhZHlGb3JQYXlvdXQsXG4gICAgcGFydG5lcnNPbkhvbGQsXG4gICAgdG90YWxQZW5kaW5nOiBiYWxhbmNlcy5yZWR1Y2UoKHN1bSwgYikgPT4gc3VtICsgYi5wZW5kaW5nLCAwKSxcbiAgICB0b3RhbENsZWFyZWQ6IGJhbGFuY2VzLnJlZHVjZSgoc3VtLCBiKSA9PiBzdW0gKyBiLmNsZWFyZWQsIDApLFxuICAgIHRvdGFsQXBwcm92ZWQ6IGJhbGFuY2VzLnJlZHVjZSgoc3VtLCBiKSA9PiBzdW0gKyBiLmFwcHJvdmVkLCAwKSxcbiAgICB0b3RhbEluQmF0Y2hlczogYmFsYW5jZXMucmVkdWNlKChzdW0sIGIpID0+IHN1bSArIGIuaW5CYXRjaCwgMCksXG4gICAgZHJhZnRCYXRjaGVzOiBiYXRjaENvdW50cy5maW5kKGMgPT4gYy5zdGF0dXMgPT09ICdEUkFGVCcpPy5fY291bnQgfHwgMCxcbiAgICBhcHByb3ZlZEJhdGNoZXM6IGJhdGNoQ291bnRzLmZpbmQoYyA9PiBjLnN0YXR1cyA9PT0gJ0FQUFJPVkVEJyk/Ll9jb3VudCB8fCAwLFxuICAgIGN1cnJlbmN5OiAnVVNEJ1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUQU5UU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgUEFZT1VUX1JVTEVTID0ge1xuICAvLyBEZWZhdWx0IG1pbmltdW0gcGF5b3V0IHRocmVzaG9sZFxuICBERUZBVUxUX01JTklNVU1fUEFZT1VUOiAxMDAuMDAsXG4gIFxuICAvLyBEZWZhdWx0IHRheCB3aXRoaG9sZGluZyByYXRlIChpZiBkb2NzIG5vdCB2ZXJpZmllZClcbiAgREVGQVVMVF9UQVhfV0lUSEhPTERJTkdfUkFURTogMC4zMCxcbiAgXG4gIC8vIFBheW91dCBmcmVxdWVuY2llc1xuICBQQVlPVVRfRlJFUVVFTkNJRVM6IFsnV0VFS0xZJywgJ0JJV0VFS0xZJywgJ01PTlRITFknLCAnUVVBUlRFUkxZJ10gYXMgY29uc3QsXG4gIFxuICAvLyBCYXRjaCBzdGF0dXNlc1xuICBCQVRDSF9TVEFUVVNFUzogW1xuICAgICdEUkFGVCcsXG4gICAgJ1BFTkRJTkdfQVBQUk9WQUwnLCBcbiAgICAnQVBQUk9WRUQnLCBcbiAgICAnUkVBRFknLFxuICAgICdQUk9DRVNTSU5HJywgIC8vIE5vdCB1c2VkIGluIFBoYXNlIDVcbiAgICAnQ09NUExFVEVEJywgICAvLyBOb3QgdXNlZCBpbiBQaGFzZSA1XG4gICAgJ0ZBSUxFRCcsICAgICAgLy8gTm90IHVzZWQgaW4gUGhhc2UgNVxuICAgICdDQU5DRUxMRUQnXG4gIF0gYXMgY29uc3QsXG4gIFxuICAvLyBObyBhY3R1YWwgcGF5b3V0IGV4ZWN1dGlvbiBpbiBQaGFzZSA1XG4gIEVYRUNVVElPTl9FTkFCTEVEOiBmYWxzZVxufSBhcyBjb25zdFxuIl0sIm5hbWVzIjpbInByaXNtYSIsImdldFBheW91dFNldHRpbmdzIiwicGFydG5lcklkIiwic2V0dGluZ3MiLCJwYXJ0bmVyUGF5b3V0U2V0dGluZ3MiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJjcmVhdGUiLCJkYXRhIiwibWluaW11bVBheW91dCIsImN1cnJlbmN5IiwicGF5b3V0RnJlcXVlbmN5IiwidGF4V2l0aGhvbGRpbmdFbmFibGVkIiwidGF4RG9jdW1lbnRTdGF0dXMiLCJwYXltZW50TWV0aG9kVmVyaWZpZWQiLCJwYXlvdXRIb2xkIiwidXBkYXRlUGF5b3V0U2V0dGluZ3MiLCJ1cGRhdGVzIiwidXBkYXRlZEJ5IiwiJHRyYW5zYWN0aW9uIiwidHgiLCJ1cGRhdGVkIiwidXBzZXJ0IiwidXBkYXRlIiwiYXVkaXRMb2ciLCJhY3Rpb24iLCJhY3RvcklkIiwiYWN0b3JFbWFpbCIsInRhcmdldFR5cGUiLCJ0YXJnZXRJZCIsImlkIiwibWV0YWRhdGEiLCJnZXRQYXlhYmxlQmFsYW5jZSIsInBhcnRuZXIiLCJzZWxlY3QiLCJuYW1lIiwiZWFybmluZ3MiLCJwYXJ0bmVyRWFybmluZyIsImdyb3VwQnkiLCJieSIsImVudHJ5VHlwZSIsIl9zdW0iLCJjb21taXNzaW9uQW1vdW50IiwiX2NvdW50IiwiaW5CYXRjaEVhcm5pbmdzIiwiYWdncmVnYXRlIiwicGF5b3V0QmF0Y2hJZCIsIm5vdCIsInN0YXR1cyIsImluIiwiYmFsYW5jZSIsInBhcnRuZXJOYW1lIiwicGVuZGluZyIsImNsZWFyZWQiLCJhcHByb3ZlZCIsImluQmF0Y2giLCJOdW1iZXIiLCJ0b3RhbFBheWFibGUiLCJ0b3RhbFBhaWQiLCJ0b3RhbFJldmVyc2VkIiwibWVldHNNaW5pbXVtIiwiZ3JvdXAiLCJhbW91bnQiLCJnZXRBbGxQYXlhYmxlQmFsYW5jZXMiLCJvcHRpb25zIiwicGFydG5lcnMiLCJmaW5kTWFueSIsImJhbGFuY2VzIiwib25seU1lZXRzTWluaW11bSIsIm9ubHlSZWFkeSIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJjaGVja1BheW91dFJlYWRpbmVzcyIsImNoZWNrcyIsImJsb2NrZXJzIiwid2FybmluZ3MiLCJpc1JlYWR5IiwiY2hlY2siLCJtZXNzYWdlIiwic3VtbWFyeSIsImdyb3NzQW1vdW50IiwidGF4V2l0aGhvbGRpbmciLCJuZXRBbW91bnQiLCJlYXJuaW5nc0NvdW50IiwiY2hlY2tBbW91bnQiLCJkZXRhaWxzIiwibWluaW11bSIsImhvbGRFeHBpcmVkIiwicGF5b3V0SG9sZFVudGlsIiwiRGF0ZSIsInJlYXNvbiIsInBheW91dEhvbGRSZWFzb24iLCJ1bnRpbCIsImRvY3VtZW50VHlwZSIsInRheERvY3VtZW50VHlwZSIsInZlcmlmaWVkQXQiLCJ0YXhEb2N1bWVudFZlcmlmaWVkQXQiLCJ0YXhXaXRoaG9sZGluZ1JhdGUiLCJ0eXBlIiwicGF5bWVudE1ldGhvZFR5cGUiLCJhY3RpdmVBZ3JlZW1lbnQiLCJwYXJ0bmVyQWdyZWVtZW50IiwiZmluZEZpcnN0IiwiZWZmZWN0aXZlRnJvbSIsImx0ZSIsIk9SIiwiZWZmZWN0aXZlVG8iLCJndGUiLCJhZ3JlZW1lbnRJZCIsInZlcnNpb24iLCJwYXlhYmxlRWFybmluZ3MiLCJyZWR1Y2UiLCJzdW0iLCJlIiwicmF0ZSIsImxlbmd0aCIsImNhbGN1bGF0ZVRheFdpdGhob2xkaW5nIiwid2l0aGhvbGRpbmdBbW91bnQiLCJNYXRoIiwicm91bmQiLCJ0YXhXaXRoaG9sZGluZ1JlYXNvbiIsInVwZGF0ZVRheERvY3VtZW50U3RhdHVzIiwidW5kZWZpbmVkIiwiYXBwbHlQYXlvdXRIb2xkIiwiaG9sZFVudGlsIiwiYXBwbGllZEJ5IiwicmVsZWFzZVBheW91dEhvbGQiLCJyZWxlYXNlZEJ5IiwicHJldmlvdXNSZWFzb24iLCJjcmVhdGVQYXlvdXRCYXRjaCIsImlucHV0IiwicmVhZGluZXNzIiwic3VjY2VzcyIsImVycm9yIiwiam9pbiIsImNvZGUiLCJzdGF0dXNGaWx0ZXIiLCJpbmNsdWRlQ2xlYXJlZCIsImluY2x1ZGVBcHByb3ZlZCIsImNyZWF0ZWRBdCIsInBlcmlvZFN0YXJ0IiwicGVyaW9kRW5kIiwidGF4UmVzdWx0IiwiYmF0Y2hOdW1iZXIiLCJnZW5lcmF0ZUJhdGNoTnVtYmVyIiwiYmF0Y2giLCJuZXdCYXRjaCIsInBheW91dEJhdGNoIiwicmVhZGluZXNzQ2hlY2tzIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwiY2hlY2tlZEF0IiwidG9JU09TdHJpbmciLCJyZWFkaW5lc3NTdGF0dXMiLCJpbnRlcm5hbE5vdGVzIiwibm90ZXMiLCJ1cGRhdGVNYW55IiwibWFwIiwieWVhciIsImdldEZ1bGxZZWFyIiwiY291bnQiLCJzdGFydHNXaXRoIiwiU3RyaW5nIiwicGFkU3RhcnQiLCJjYW5jZWxQYXlvdXRCYXRjaCIsImJhdGNoSWQiLCJjYW5jZWxsZWRCeSIsImluY2x1ZGVzIiwidXBkYXRlZEJhdGNoIiwiY2FuY2VsbGVkQXQiLCJjYW5jZWxsZWRCeVVzZXJJZCIsImNhbmNlbGxhdGlvblJlYXNvbiIsImFwcHJvdmVQYXlvdXRCYXRjaCIsImFwcHJvdmVkQnkiLCJhcHByb3ZlZEF0IiwiYXBwcm92ZWRCeVVzZXJJZCIsImdldFBheW91dFJlcG9ydCIsInBlbmRpbmdCYXRjaGVzIiwib3JkZXJCeSIsInBhaWRCYXRjaGVzIiwicHJvY2Vzc2VkQXQiLCJhbGxUaW1lUGFpZCIsInBlcmlvZCIsInN0YXJ0IiwiZW5kIiwicGFpZEF0IiwidG90YWxQZW5kaW5nIiwidG90YWxQYWlkVGhpc1BlcmlvZCIsInRvdGFsUGFpZEFsbFRpbWUiLCJnZXRQbGF0Zm9ybVBheW91dFN1bW1hcnkiLCJ0b3RhbFBhcnRuZXJzIiwicGFydG5lcnNPbkhvbGQiLCJiYXRjaENvdW50cyIsIlByb21pc2UiLCJhbGwiLCJwYXJ0bmVyc1dpdGhCYWxhbmNlIiwiZmlsdGVyIiwicGFydG5lcnNSZWFkeUZvclBheW91dCIsInRvdGFsQ2xlYXJlZCIsInRvdGFsQXBwcm92ZWQiLCJ0b3RhbEluQmF0Y2hlcyIsImRyYWZ0QmF0Y2hlcyIsImZpbmQiLCJjIiwiYXBwcm92ZWRCYXRjaGVzIiwiUEFZT1VUX1JVTEVTIiwiREVGQVVMVF9NSU5JTVVNX1BBWU9VVCIsIkRFRkFVTFRfVEFYX1dJVEhIT0xESU5HX1JBVEUiLCJQQVlPVVRfRlJFUVVFTkNJRVMiLCJCQVRDSF9TVEFUVVNFUyIsIkVYRUNVVElPTl9FTkFCTEVEIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/payout-readiness.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&page=%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpartners%2F%5BpartnerId%5D%2Fdashboard%2Freferrals%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();