"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/svm/promotions/[promotionId]/route";
exports.ids = ["app/api/svm/promotions/[promotionId]/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&page=%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&page=%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_svm_promotions_promotionId_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/svm/promotions/[promotionId]/route.ts */ \"(rsc)/./src/app/api/svm/promotions/[promotionId]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/svm/promotions/[promotionId]/route\",\n        pathname: \"/api/svm/promotions/[promotionId]\",\n        filename: \"route\",\n        bundlePath: \"app/api/svm/promotions/[promotionId]/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/svm/promotions/[promotionId]/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_svm_promotions_promotionId_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/svm/promotions/[promotionId]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdm0lMkZwcm9tb3Rpb25zJTJGJTVCcHJvbW90aW9uSWQlNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN2bSUyRnByb21vdGlvbnMlMkYlNUJwcm9tb3Rpb25JZCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN2bSUyRnByb21vdGlvbnMlMkYlNUJwcm9tb3Rpb25JZCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDZ0I7QUFDN0Y7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvPzFmMmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2FwcC9zYWFzLWNvcmUvc3JjL2FwcC9hcGkvc3ZtL3Byb21vdGlvbnMvW3Byb21vdGlvbklkXS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3ZtL3Byb21vdGlvbnMvW3Byb21vdGlvbklkXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N2bS9wcm9tb3Rpb25zL1twcm9tb3Rpb25JZF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N2bS9wcm9tb3Rpb25zL1twcm9tb3Rpb25JZF0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9zdm0vcHJvbW90aW9ucy9bcHJvbW90aW9uSWRdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdm0vcHJvbW90aW9ucy9bcHJvbW90aW9uSWRdL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&page=%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/svm/promotions/[promotionId]/route.ts":
/*!***********************************************************!*\
  !*** ./src/app/api/svm/promotions/[promotionId]/route.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_promotions_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/promotions-storage */ \"(rsc)/./src/lib/promotions-storage.ts\");\n/**\n * SVM Promotion by ID API\n * \n * GET /api/svm/promotions/:promotionId - Get promotion details\n * PUT /api/svm/promotions/:promotionId - Update promotion\n * DELETE /api/svm/promotions/:promotionId - Delete promotion\n */ \n\n/**\n * GET /api/svm/promotions/:promotionId\n */ async function GET(request, context) {\n    try {\n        const { promotionId } = await context.params;\n        const { searchParams } = new URL(request.url);\n        const tenantId = searchParams.get(\"tenantId\");\n        if (!promotionId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"promotionId is required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId query parameter is required\"\n            }, {\n                status: 400\n            });\n        }\n        const promotion = (0,_lib_promotions_storage__WEBPACK_IMPORTED_MODULE_1__.getPromotion)(tenantId, promotionId);\n        if (!promotion) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: `Promotion ${promotionId} not found`\n            }, {\n                status: 404\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            promotion\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error fetching promotion:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * PUT /api/svm/promotions/:promotionId\n */ async function PUT(request, context) {\n    try {\n        const { promotionId } = await context.params;\n        const body = await request.json();\n        const { tenantId } = body;\n        if (!promotionId || !tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"promotionId and tenantId are required\"\n            }, {\n                status: 400\n            });\n        }\n        const existing = (0,_lib_promotions_storage__WEBPACK_IMPORTED_MODULE_1__.getPromotion)(tenantId, promotionId);\n        if (!existing) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: `Promotion ${promotionId} not found`\n            }, {\n                status: 404\n            });\n        }\n        // Extract updatable fields\n        const updates = {};\n        const updatableFields = [\n            \"name\",\n            \"description\",\n            \"discountValue\",\n            \"maxDiscount\",\n            \"minOrderTotal\",\n            \"minQuantity\",\n            \"productIds\",\n            \"categoryIds\",\n            \"excludeProductIds\",\n            \"customerIds\",\n            \"firstOrderOnly\",\n            \"usageLimit\",\n            \"perCustomerLimit\",\n            \"endsAt\",\n            \"isActive\",\n            \"stackable\",\n            \"priority\",\n            \"buyQuantity\",\n            \"getQuantity\",\n            \"getDiscountPercent\"\n        ];\n        for (const field of updatableFields){\n            if (body[field] !== undefined) {\n                updates[field] = body[field];\n            }\n        }\n        // Handle date fields\n        if (body.startsAt) {\n            updates.startsAt = new Date(body.startsAt);\n        }\n        if (body.endsAt) {\n            updates.endsAt = new Date(body.endsAt);\n        }\n        const updated = (0,_lib_promotions_storage__WEBPACK_IMPORTED_MODULE_1__.updatePromotion)(tenantId, promotionId, updates);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: `Promotion ${promotionId} updated`,\n            promotion: updated\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error updating promotion:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * DELETE /api/svm/promotions/:promotionId\n */ async function DELETE(request, context) {\n    try {\n        const { promotionId } = await context.params;\n        const { searchParams } = new URL(request.url);\n        const tenantId = searchParams.get(\"tenantId\");\n        if (!promotionId || !tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"promotionId and tenantId are required\"\n            }, {\n                status: 400\n            });\n        }\n        const deleted = (0,_lib_promotions_storage__WEBPACK_IMPORTED_MODULE_1__.deletePromotion)(tenantId, promotionId);\n        if (!deleted) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: `Promotion ${promotionId} not found`\n            }, {\n                status: 404\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: `Promotion ${deleted.name} deleted`,\n            deletedPromotionId: promotionId\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error deleting promotion:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdm0vcHJvbW90aW9ucy9bcHJvbW90aW9uSWRdL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7OztDQU1DLEdBRXNEO0FBS3RCO0FBTWpDOztDQUVDLEdBQ00sZUFBZUksSUFBSUMsT0FBb0IsRUFBRUMsT0FBb0I7SUFDbEUsSUFBSTtRQUNGLE1BQU0sRUFBRUMsV0FBVyxFQUFFLEdBQUcsTUFBTUQsUUFBUUUsTUFBTTtRQUM1QyxNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlMLFFBQVFNLEdBQUc7UUFDNUMsTUFBTUMsV0FBV0gsYUFBYUksR0FBRyxDQUFDO1FBRWxDLElBQUksQ0FBQ04sYUFBYTtZQUNoQixPQUFPUCxxREFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUEwQixHQUNuRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSSxDQUFDTCxVQUFVO1lBQ2IsT0FBT1oscURBQVlBLENBQUNjLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9DLE9BQU87WUFBdUMsR0FDaEU7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1DLFlBQVlqQixxRUFBWUEsQ0FBQ1csVUFBVUw7UUFFekMsSUFBSSxDQUFDVyxXQUFXO1lBQ2QsT0FBT2xCLHFEQUFZQSxDQUFDYyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPLENBQUMsVUFBVSxFQUFFVCxZQUFZLFVBQVUsQ0FBQztZQUFDLEdBQzlEO2dCQUFFVSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPakIscURBQVlBLENBQUNjLElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNURztRQUNGO0lBRUYsRUFBRSxPQUFPRixPQUFPO1FBQ2RHLFFBQVFILEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE9BQU9oQixxREFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9D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LENBQUM7WUFBQyxHQUM5RDtnQkFBRVUsUUFBUTtZQUFJO1FBRWxCO1FBRUEsT0FBT2pCLHFEQUFZQSxDQUFDYyxJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVGdCLFNBQVMsQ0FBQyxVQUFVLEVBQUVHLFFBQVFDLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDNUNDLG9CQUFvQjdCO1FBQ3RCO0lBRUYsRUFBRSxPQUFPUyxPQUFPO1FBQ2RHLFFBQVFILEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE9BQU9oQixxREFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9DLE9BQU87UUFBd0IsR0FDakQ7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvYXBwL2FwaS9zdm0vcHJvbW90aW9ucy9bcHJvbW90aW9uSWRdL3JvdXRlLnRzPzM3ZjQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTVk0gUHJvbW90aW9uIGJ5IElEIEFQSVxuICogXG4gKiBHRVQgL2FwaS9zdm0vcHJvbW90aW9ucy86cHJvbW90aW9uSWQgLSBHZXQgcHJvbW90aW9uIGRldGFpbHNcbiAqIFBVVCAvYXBpL3N2bS9wcm9tb3Rpb25zLzpwcm9tb3Rpb25JZCAtIFVwZGF0ZSBwcm9tb3Rpb25cbiAqIERFTEVURSAvYXBpL3N2bS9wcm9tb3Rpb25zLzpwcm9tb3Rpb25JZCAtIERlbGV0ZSBwcm9tb3Rpb25cbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQge1xuICBnZXRQcm9tb3Rpb24sXG4gIHVwZGF0ZVByb21vdGlvbixcbiAgZGVsZXRlUHJvbW90aW9uXG59IGZyb20gJ0AvbGliL3Byb21vdGlvbnMtc3RvcmFnZSdcblxuaW50ZXJmYWNlIFJvdXRlUGFyYW1zIHtcbiAgcGFyYW1zOiBQcm9taXNlPHsgcHJvbW90aW9uSWQ6IHN0cmluZyB9PlxufVxuXG4vKipcbiAqIEdFVCAvYXBpL3N2bS9wcm9tb3Rpb25zLzpwcm9tb3Rpb25JZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCBjb250ZXh0OiBSb3V0ZVBhcmFtcykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvbW90aW9uSWQgfSA9IGF3YWl0IGNvbnRleHQucGFyYW1zXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgdGVuYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW5hbnRJZCcpXG4gICAgXG4gICAgaWYgKCFwcm9tb3Rpb25JZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3Byb21vdGlvbklkIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG4gICAgXG4gICAgaWYgKCF0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3RlbmFudElkIHF1ZXJ5IHBhcmFtZXRlciBpcyByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHByb21vdGlvbiA9IGdldFByb21vdGlvbih0ZW5hbnRJZCwgcHJvbW90aW9uSWQpXG4gICAgXG4gICAgaWYgKCFwcm9tb3Rpb24pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGBQcm9tb3Rpb24gJHtwcm9tb3Rpb25JZH0gbm90IGZvdW5kYCB9LFxuICAgICAgICB7IHN0YXR1czogNDA0IH1cbiAgICAgIClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwcm9tb3Rpb25cbiAgICB9KVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTVk1dIEVycm9yIGZldGNoaW5nIHByb21vdGlvbjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIFBVVCAvYXBpL3N2bS9wcm9tb3Rpb25zLzpwcm9tb3Rpb25JZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCBjb250ZXh0OiBSb3V0ZVBhcmFtcykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvbW90aW9uSWQgfSA9IGF3YWl0IGNvbnRleHQucGFyYW1zXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyB0ZW5hbnRJZCB9ID0gYm9keVxuICAgIFxuICAgIGlmICghcHJvbW90aW9uSWQgfHwgIXRlbmFudElkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAncHJvbW90aW9uSWQgYW5kIHRlbmFudElkIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGV4aXN0aW5nID0gZ2V0UHJvbW90aW9uKHRlbmFudElkLCBwcm9tb3Rpb25JZClcbiAgICBpZiAoIWV4aXN0aW5nKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBgUHJvbW90aW9uICR7cHJvbW90aW9uSWR9IG5vdCBmb3VuZGAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIC8vIEV4dHJhY3QgdXBkYXRhYmxlIGZpZWxkc1xuICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge31cbiAgICBjb25zdCB1cGRhdGFibGVGaWVsZHMgPSBbXG4gICAgICAnbmFtZScsICdkZXNjcmlwdGlvbicsICdkaXNjb3VudFZhbHVlJywgJ21heERpc2NvdW50JyxcbiAgICAgICdtaW5PcmRlclRvdGFsJywgJ21pblF1YW50aXR5JywgJ3Byb2R1Y3RJZHMnLCAnY2F0ZWdvcnlJZHMnLFxuICAgICAgJ2V4Y2x1ZGVQcm9kdWN0SWRzJywgJ2N1c3RvbWVySWRzJywgJ2ZpcnN0T3JkZXJPbmx5JyxcbiAgICAgICd1c2FnZUxpbWl0JywgJ3BlckN1c3RvbWVyTGltaXQnLCAnZW5kc0F0JywgJ2lzQWN0aXZlJyxcbiAgICAgICdzdGFja2FibGUnLCAncHJpb3JpdHknLCAnYnV5UXVhbnRpdHknLCAnZ2V0UXVhbnRpdHknLCAnZ2V0RGlzY291bnRQZXJjZW50J1xuICAgIF1cbiAgICBcbiAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIHVwZGF0YWJsZUZpZWxkcykge1xuICAgICAgaWYgKGJvZHlbZmllbGRdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXBkYXRlc1tmaWVsZF0gPSBib2R5W2ZpZWxkXVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgZGF0ZSBmaWVsZHNcbiAgICBpZiAoYm9keS5zdGFydHNBdCkge1xuICAgICAgdXBkYXRlcy5zdGFydHNBdCA9IG5ldyBEYXRlKGJvZHkuc3RhcnRzQXQpXG4gICAgfVxuICAgIGlmIChib2R5LmVuZHNBdCkge1xuICAgICAgdXBkYXRlcy5lbmRzQXQgPSBuZXcgRGF0ZShib2R5LmVuZHNBdClcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdXBkYXRlZCA9IHVwZGF0ZVByb21vdGlvbih0ZW5hbnRJZCwgcHJvbW90aW9uSWQsIHVwZGF0ZXMpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBgUHJvbW90aW9uICR7cHJvbW90aW9uSWR9IHVwZGF0ZWRgLFxuICAgICAgcHJvbW90aW9uOiB1cGRhdGVkXG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciB1cGRhdGluZyBwcm9tb3Rpb246JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIERFTEVURSAvYXBpL3N2bS9wcm9tb3Rpb25zLzpwcm9tb3Rpb25JZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3Q6IE5leHRSZXF1ZXN0LCBjb250ZXh0OiBSb3V0ZVBhcmFtcykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvbW90aW9uSWQgfSA9IGF3YWl0IGNvbnRleHQucGFyYW1zXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgdGVuYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW5hbnRJZCcpXG4gICAgXG4gICAgaWYgKCFwcm9tb3Rpb25JZCB8fCAhdGVuYW50SWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdwcm9tb3Rpb25JZCBhbmQgdGVuYW50SWQgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZGVsZXRlZCA9IGRlbGV0ZVByb21vdGlvbih0ZW5hbnRJZCwgcHJvbW90aW9uSWQpXG4gICAgXG4gICAgaWYgKCFkZWxldGVkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBgUHJvbW90aW9uICR7cHJvbW90aW9uSWR9IG5vdCBmb3VuZGAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogYFByb21vdGlvbiAke2RlbGV0ZWQubmFtZX0gZGVsZXRlZGAsXG4gICAgICBkZWxldGVkUHJvbW90aW9uSWQ6IHByb21vdGlvbklkXG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBkZWxldGluZyBwcm9tb3Rpb246JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRQcm9tb3Rpb24iLCJ1cGRhdGVQcm9tb3Rpb24iLCJkZWxldGVQcm9tb3Rpb24iLCJHRVQiLCJyZXF1ZXN0IiwiY29udGV4dCIsInByb21vdGlvbklkIiwicGFyYW1zIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwidGVuYW50SWQiLCJnZXQiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwic3RhdHVzIiwicHJvbW90aW9uIiwiY29uc29sZSIsIlBVVCIsImJvZHkiLCJleGlzdGluZyIsInVwZGF0ZXMiLCJ1cGRhdGFibGVGaWVsZHMiLCJmaWVsZCIsInVuZGVmaW5lZCIsInN0YXJ0c0F0IiwiRGF0ZSIsImVuZHNBdCIsInVwZGF0ZWQiLCJtZXNzYWdlIiwiRXJyb3IiLCJERUxFVEUiLCJkZWxldGVkIiwibmFtZSIsImRlbGV0ZWRQcm9tb3Rpb25JZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/svm/promotions/[promotionId]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/promotions-storage.ts":
/*!***************************************!*\
  !*** ./src/lib/promotions-storage.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addPromotion: () => (/* binding */ addPromotion),\n/* harmony export */   calculateDiscount: () => (/* binding */ calculateDiscount),\n/* harmony export */   deletePromotion: () => (/* binding */ deletePromotion),\n/* harmony export */   findByCode: () => (/* binding */ findByCode),\n/* harmony export */   generateId: () => (/* binding */ generateId),\n/* harmony export */   getActivePromotions: () => (/* binding */ getActivePromotions),\n/* harmony export */   getAutomaticPromotions: () => (/* binding */ getAutomaticPromotions),\n/* harmony export */   getCustomerUsageCount: () => (/* binding */ getCustomerUsageCount),\n/* harmony export */   getEligibleItems: () => (/* binding */ getEligibleItems),\n/* harmony export */   getOrCreatePromotions: () => (/* binding */ getOrCreatePromotions),\n/* harmony export */   getPromotion: () => (/* binding */ getPromotion),\n/* harmony export */   getPromotions: () => (/* binding */ getPromotions),\n/* harmony export */   recordUsage: () => (/* binding */ recordUsage),\n/* harmony export */   updatePromotion: () => (/* binding */ updatePromotion),\n/* harmony export */   validatePromotion: () => (/* binding */ validatePromotion)\n/* harmony export */ });\n/* harmony import */ var decimal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! decimal.js */ \"(rsc)/./node_modules/decimal.js/decimal.mjs\");\n/**\n * SVM Promotions Storage\n * \n * Shared in-memory storage for promotions.\n * Using globalThis to ensure single instance across all Next.js API routes.\n * \n * In production, this would be replaced with database queries.\n */ \n// ============================================================================\n// SHARED STORAGE (Singleton using globalThis)\n// ============================================================================\nconst PROMOTIONS_STORAGE_KEY = \"__svm_promotions_storage__\";\nconst USAGE_STORAGE_KEY = \"__svm_promotion_usage_storage__\";\nfunction getPromotionsStorage() {\n    if (!globalThis[PROMOTIONS_STORAGE_KEY]) {\n        globalThis[PROMOTIONS_STORAGE_KEY] = new Map();\n    }\n    return globalThis[PROMOTIONS_STORAGE_KEY];\n}\nfunction getUsageStorage() {\n    if (!globalThis[USAGE_STORAGE_KEY]) {\n        globalThis[USAGE_STORAGE_KEY] = new Map();\n    }\n    return globalThis[USAGE_STORAGE_KEY];\n}\nfunction generateId(prefix = \"promo\") {\n    return `${prefix}_${Date.now().toString(36)}${Math.random().toString(36).substring(2, 9)}`;\n}\n// ============================================================================\n// PROMOTION CRUD\n// ============================================================================\n/**\n * Get or create sample promotions for a tenant\n */ function getOrCreatePromotions(tenantId) {\n    const storage = getPromotionsStorage();\n    if (storage.has(tenantId)) {\n        return storage.get(tenantId);\n    }\n    // Create sample promotions\n    const now = new Date();\n    const samplePromotions = [\n        {\n            id: generateId(\"promo\"),\n            tenantId,\n            name: \"Welcome Discount\",\n            description: \"10% off your first order\",\n            code: \"WELCOME10\",\n            type: \"COUPON\",\n            discountType: \"PERCENTAGE\",\n            discountValue: 10,\n            productIds: [],\n            categoryIds: [],\n            excludeProductIds: [],\n            customerIds: [],\n            firstOrderOnly: true,\n            usageCount: 0,\n            startsAt: now,\n            isActive: true,\n            stackable: false,\n            priority: 0,\n            createdAt: now.toISOString(),\n            updatedAt: now.toISOString()\n        },\n        {\n            id: generateId(\"promo\"),\n            tenantId,\n            name: \"Summer Sale\",\n            description: \"15% off orders over $100 (max $50 discount)\",\n            type: \"AUTOMATIC\",\n            discountType: \"PERCENTAGE\",\n            discountValue: 15,\n            maxDiscount: 50,\n            minOrderTotal: 100,\n            productIds: [],\n            categoryIds: [],\n            excludeProductIds: [],\n            customerIds: [],\n            firstOrderOnly: false,\n            usageCount: 0,\n            startsAt: now,\n            isActive: true,\n            stackable: true,\n            priority: 10,\n            createdAt: now.toISOString(),\n            updatedAt: now.toISOString()\n        },\n        {\n            id: generateId(\"promo\"),\n            tenantId,\n            name: \"Free Shipping\",\n            description: \"Free shipping on orders over $50\",\n            code: \"FREESHIP\",\n            type: \"COUPON\",\n            discountType: \"FREE_SHIPPING\",\n            discountValue: 0,\n            minOrderTotal: 50,\n            productIds: [],\n            categoryIds: [],\n            excludeProductIds: [],\n            customerIds: [],\n            firstOrderOnly: false,\n            usageCount: 0,\n            startsAt: now,\n            isActive: true,\n            stackable: true,\n            priority: 5,\n            createdAt: now.toISOString(),\n            updatedAt: now.toISOString()\n        },\n        {\n            id: generateId(\"promo\"),\n            tenantId,\n            name: \"Buy 2 Get 1 Free\",\n            description: \"Buy any 2 items, get 1 free\",\n            code: \"BOGO\",\n            type: \"COUPON\",\n            discountType: \"BUY_X_GET_Y\",\n            discountValue: 100,\n            buyQuantity: 2,\n            getQuantity: 1,\n            getDiscountPercent: 100,\n            productIds: [],\n            categoryIds: [],\n            excludeProductIds: [],\n            customerIds: [],\n            firstOrderOnly: false,\n            usageCount: 0,\n            startsAt: now,\n            isActive: true,\n            stackable: false,\n            priority: 0,\n            createdAt: now.toISOString(),\n            updatedAt: now.toISOString()\n        },\n        {\n            id: generateId(\"promo\"),\n            tenantId,\n            name: \"$20 Off\",\n            description: \"$20 off orders over $75 (limit 100 uses)\",\n            code: \"SAVE20\",\n            type: \"COUPON\",\n            discountType: \"FIXED_AMOUNT\",\n            discountValue: 20,\n            minOrderTotal: 75,\n            usageLimit: 100,\n            perCustomerLimit: 1,\n            productIds: [],\n            categoryIds: [],\n            excludeProductIds: [],\n            customerIds: [],\n            firstOrderOnly: false,\n            usageCount: 0,\n            startsAt: now,\n            isActive: true,\n            stackable: false,\n            priority: 0,\n            createdAt: now.toISOString(),\n            updatedAt: now.toISOString()\n        }\n    ];\n    storage.set(tenantId, samplePromotions);\n    return samplePromotions;\n}\nfunction getPromotions(tenantId) {\n    return getOrCreatePromotions(tenantId);\n}\nfunction getActivePromotions(tenantId) {\n    const now = new Date();\n    return getPromotions(tenantId).filter((p)=>p.isActive && p.startsAt <= now && (!p.endsAt || p.endsAt > now) && (!p.usageLimit || p.usageCount < p.usageLimit));\n}\nfunction getAutomaticPromotions(tenantId) {\n    return getActivePromotions(tenantId).filter((p)=>p.type === \"AUTOMATIC\" || p.type === \"FLASH_SALE\");\n}\nfunction findByCode(tenantId, code) {\n    const promotions = getActivePromotions(tenantId);\n    return promotions.find((p)=>p.code?.toUpperCase() === code.toUpperCase()) || null;\n}\nfunction getPromotion(tenantId, promotionId) {\n    const promotions = getPromotions(tenantId);\n    return promotions.find((p)=>p.id === promotionId) || null;\n}\nfunction addPromotion(promotion) {\n    const storage = getPromotionsStorage();\n    const promotions = getOrCreatePromotions(promotion.tenantId);\n    promotions.push(promotion);\n}\nfunction updatePromotion(tenantId, promotionId, updates) {\n    const promotions = getPromotions(tenantId);\n    const index = promotions.findIndex((p)=>p.id === promotionId);\n    if (index < 0) return null;\n    promotions[index] = {\n        ...promotions[index],\n        ...updates,\n        updatedAt: new Date().toISOString()\n    };\n    return promotions[index];\n}\nfunction deletePromotion(tenantId, promotionId) {\n    const storage = getPromotionsStorage();\n    const promotions = storage.get(tenantId) || [];\n    const index = promotions.findIndex((p)=>p.id === promotionId);\n    if (index < 0) return null;\n    const [deleted] = promotions.splice(index, 1);\n    return deleted;\n}\n// ============================================================================\n// USAGE TRACKING\n// ============================================================================\nfunction recordUsage(promotionId, orderId, customerId, discountApplied) {\n    const usageStorage = getUsageStorage();\n    const promotionsStorage = getPromotionsStorage();\n    const usage = {\n        id: generateId(\"usage\"),\n        promotionId,\n        orderId,\n        customerId,\n        discountApplied,\n        createdAt: new Date()\n    };\n    // Store usage\n    const usages = usageStorage.get(promotionId) || [];\n    usages.push(usage);\n    usageStorage.set(promotionId, usages);\n    // Increment usage count on promotion\n    for (const [tenantId, promotions] of promotionsStorage){\n        const promotion = promotions.find((p)=>p.id === promotionId);\n        if (promotion) {\n            promotion.usageCount++;\n            break;\n        }\n    }\n    return usage;\n}\nfunction getCustomerUsageCount(promotionId, customerId) {\n    if (!customerId) return 0;\n    const usageStorage = getUsageStorage();\n    const usages = usageStorage.get(promotionId) || [];\n    return usages.filter((u)=>u.customerId === customerId).length;\n}\nfunction validatePromotion(promotion, subtotal, totalQuantity, customerId, isFirstOrder, currentDiscounts = []) {\n    const now = new Date();\n    if (!promotion.isActive) {\n        return {\n            valid: false,\n            error: \"This promotion is no longer active\",\n            errorCode: \"INACTIVE\"\n        };\n    }\n    if (promotion.startsAt > now) {\n        return {\n            valid: false,\n            error: \"This promotion has not started yet\",\n            errorCode: \"NOT_STARTED\"\n        };\n    }\n    if (promotion.endsAt && promotion.endsAt < now) {\n        return {\n            valid: false,\n            error: \"This promotion has expired\",\n            errorCode: \"EXPIRED\"\n        };\n    }\n    if (promotion.usageLimit && promotion.usageCount >= promotion.usageLimit) {\n        return {\n            valid: false,\n            error: \"This promotion has reached its usage limit\",\n            errorCode: \"USAGE_LIMIT_REACHED\"\n        };\n    }\n    const customerUsageCount = getCustomerUsageCount(promotion.id, customerId);\n    if (promotion.perCustomerLimit && customerUsageCount >= promotion.perCustomerLimit) {\n        return {\n            valid: false,\n            error: \"You have already used this promotion the maximum number of times\",\n            errorCode: \"CUSTOMER_LIMIT_REACHED\"\n        };\n    }\n    if (promotion.customerIds.length > 0 && customerId) {\n        if (!promotion.customerIds.includes(customerId)) {\n            return {\n                valid: false,\n                error: \"This promotion is not available for your account\",\n                errorCode: \"CUSTOMER_NOT_ELIGIBLE\"\n            };\n        }\n    }\n    if (promotion.firstOrderOnly && !isFirstOrder) {\n        return {\n            valid: false,\n            error: \"This promotion is only valid for first-time orders\",\n            errorCode: \"FIRST_ORDER_ONLY\"\n        };\n    }\n    if (promotion.minOrderTotal && subtotal < promotion.minOrderTotal) {\n        return {\n            valid: false,\n            error: `Minimum order total of $${promotion.minOrderTotal.toFixed(2)} required`,\n            errorCode: \"MIN_ORDER_NOT_MET\"\n        };\n    }\n    if (promotion.minQuantity && totalQuantity < promotion.minQuantity) {\n        return {\n            valid: false,\n            error: `Minimum of ${promotion.minQuantity} items required`,\n            errorCode: \"MIN_QUANTITY_NOT_MET\"\n        };\n    }\n    if (!promotion.stackable && currentDiscounts.length > 0) {\n        return {\n            valid: false,\n            error: \"This promotion cannot be combined with other discounts\",\n            errorCode: \"NOT_STACKABLE\"\n        };\n    }\n    if (currentDiscounts.some((d)=>d.promotionId === promotion.id)) {\n        return {\n            valid: false,\n            error: \"This promotion is already applied\",\n            errorCode: \"ALREADY_APPLIED\"\n        };\n    }\n    return {\n        valid: true\n    };\n}\nfunction getEligibleItems(promotion, items) {\n    return items.filter((item)=>{\n        if (promotion.excludeProductIds.includes(item.productId)) {\n            return false;\n        }\n        if (promotion.productIds.length === 0 && promotion.categoryIds.length === 0) {\n            return true;\n        }\n        if (promotion.productIds.length > 0 && promotion.productIds.includes(item.productId)) {\n            return true;\n        }\n        if (promotion.categoryIds.length > 0 && item.categoryId && promotion.categoryIds.includes(item.categoryId)) {\n            return true;\n        }\n        return false;\n    });\n}\nfunction calculateDiscount(promotion, items, subtotal, shippingTotal) {\n    const eligibleItems = getEligibleItems(promotion, items);\n    let discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0);\n    let originalAmount;\n    let freeShipping = false;\n    let affectedItems = [];\n    let message = \"\";\n    switch(promotion.discountType){\n        case \"PERCENTAGE\":\n            {\n                const eligibleSubtotal = eligibleItems.reduce((sum, item)=>sum + item.unitPrice * item.quantity, 0);\n                const percentDiscount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](eligibleSubtotal).times(promotion.discountValue).dividedBy(100);\n                originalAmount = percentDiscount.toDecimalPlaces(2).toNumber();\n                if (promotion.maxDiscount && percentDiscount.greaterThan(promotion.maxDiscount)) {\n                    discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](promotion.maxDiscount);\n                } else {\n                    discountAmount = percentDiscount;\n                }\n                affectedItems = eligibleItems.map((i)=>i.productId);\n                message = `${promotion.discountValue}% off${affectedItems.length < items.length ? \" eligible items\" : \"\"}`;\n                break;\n            }\n        case \"FIXED_AMOUNT\":\n            {\n                discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](promotion.discountValue);\n                if (discountAmount.greaterThan(subtotal)) {\n                    discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](subtotal);\n                }\n                message = `$${promotion.discountValue.toFixed(2)} off your order`;\n                break;\n            }\n        case \"FIXED_PER_ITEM\":\n            {\n                const totalEligibleQty = eligibleItems.reduce((sum, item)=>sum + item.quantity, 0);\n                discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](promotion.discountValue).times(totalEligibleQty);\n                const eligibleSubtotal = eligibleItems.reduce((sum, item)=>sum + item.unitPrice * item.quantity, 0);\n                if (discountAmount.greaterThan(eligibleSubtotal)) {\n                    discountAmount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](eligibleSubtotal);\n                }\n                affectedItems = eligibleItems.map((i)=>i.productId);\n                message = `$${promotion.discountValue.toFixed(2)} off each eligible item`;\n                break;\n            }\n        case \"FREE_SHIPPING\":\n            {\n                freeShipping = true;\n                message = \"Free shipping\";\n                break;\n            }\n        case \"BUY_X_GET_Y\":\n            {\n                if (!promotion.buyQuantity || !promotion.getQuantity) {\n                    return null;\n                }\n                const sortedItems = [\n                    ...eligibleItems\n                ].sort((a, b)=>b.unitPrice - a.unitPrice);\n                const totalQty = sortedItems.reduce((sum, item)=>sum + item.quantity, 0);\n                const dealSize = promotion.buyQuantity + promotion.getQuantity;\n                const numDeals = Math.floor(totalQty / dealSize);\n                if (numDeals === 0) {\n                    return null;\n                }\n                const discountPercent = promotion.getDiscountPercent || 100;\n                let discountedItems = 0;\n                let totalDiscount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](0);\n                const reversedItems = [\n                    ...sortedItems\n                ].reverse();\n                for (const item of reversedItems){\n                    const itemsToDiscount = Math.min(item.quantity, numDeals * promotion.getQuantity - discountedItems);\n                    if (itemsToDiscount > 0) {\n                        const itemDiscount = new decimal_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](item.unitPrice).times(itemsToDiscount).times(discountPercent).dividedBy(100);\n                        totalDiscount = totalDiscount.plus(itemDiscount);\n                        discountedItems += itemsToDiscount;\n                    }\n                    if (discountedItems >= numDeals * promotion.getQuantity) {\n                        break;\n                    }\n                }\n                discountAmount = totalDiscount;\n                affectedItems = eligibleItems.map((i)=>i.productId);\n                const getDesc = discountPercent === 100 ? \"free\" : `${discountPercent}% off`;\n                message = `Buy ${promotion.buyQuantity} get ${promotion.getQuantity} ${getDesc}`;\n                break;\n            }\n    }\n    const finalDiscount = discountAmount.toDecimalPlaces(2).toNumber();\n    if (finalDiscount === 0 && !freeShipping) {\n        return null;\n    }\n    return {\n        promotionId: promotion.id,\n        promotionName: promotion.name,\n        code: promotion.code,\n        discountType: promotion.discountType,\n        discountAmount: finalDiscount,\n        originalAmount,\n        cappedAmount: originalAmount && originalAmount > finalDiscount ? finalDiscount : undefined,\n        affectedItems: affectedItems.length > 0 ? affectedItems : undefined,\n        freeShipping,\n        message\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUtjLFNBQVMsRUFDNUNHLEtBQUssQ0FBQ3FCLGlCQUNOckIsS0FBSyxDQUFDZ0IsaUJBQ05mLFNBQVMsQ0FBQzt3QkFFYmlCLGdCQUFnQkEsY0FBY00sSUFBSSxDQUFDRDt3QkFDbkNOLG1CQUFtQkk7b0JBQ3JCO29CQUVBLElBQUlKLG1CQUFtQkgsV0FBV25FLFVBQVVsQixXQUFXLEVBQUU7d0JBQ3ZEO29CQUNGO2dCQUNGO2dCQUVBNEQsaUJBQWlCNkI7Z0JBQ2pCMUIsZ0JBQWdCSixjQUFjaUIsR0FBRyxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFdEIsU0FBUztnQkFFbEQsTUFBTXlDLFVBQVVULG9CQUFvQixNQUFNLFNBQVMsQ0FBQyxFQUFFQSxnQkFBZ0IsS0FBSyxDQUFDO2dCQUM1RXZCLFVBQVUsQ0FBQyxJQUFJLEVBQUU5QyxVQUFVbkIsV0FBVyxDQUFDLEtBQUssRUFBRW1CLFVBQVVsQixXQUFXLENBQUMsQ0FBQyxFQUFFZ0csUUFBUSxDQUFDO2dCQUNoRjtZQUNGO0lBQ0Y7SUFFQSxNQUFNQyxnQkFBZ0JyQyxlQUFlYSxlQUFlLENBQUMsR0FBR0MsUUFBUTtJQUVoRSxJQUFJdUIsa0JBQWtCLEtBQUssQ0FBQ25DLGNBQWM7UUFDeEMsT0FBTztJQUNUO0lBRUEsT0FBTztRQUNMOUMsYUFBYUUsVUFBVXpDLEVBQUU7UUFDekJ5SCxlQUFlaEYsVUFBVXhDLElBQUk7UUFDN0JFLE1BQU1zQyxVQUFVdEMsSUFBSTtRQUNwQkUsY0FBY29DLFVBQVVwQyxZQUFZO1FBQ3BDOEUsZ0JBQWdCcUM7UUFDaEJwQztRQUNBc0MsY0FBY3RDLGtCQUFrQkEsaUJBQWlCb0MsZ0JBQWdCQSxnQkFBZ0JHO1FBQ2pGckMsZUFBZUEsY0FBYzFCLE1BQU0sR0FBRyxJQUFJMEIsZ0JBQWdCcUM7UUFDMUR0QztRQUNBRTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3Byb21vdGlvbnMtc3RvcmFnZS50cz85ZjQ0Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU1ZNIFByb21vdGlvbnMgU3RvcmFnZVxuICogXG4gKiBTaGFyZWQgaW4tbWVtb3J5IHN0b3JhZ2UgZm9yIHByb21vdGlvbnMuXG4gKiBVc2luZyBnbG9iYWxUaGlzIHRvIGVuc3VyZSBzaW5nbGUgaW5zdGFuY2UgYWNyb3NzIGFsbCBOZXh0LmpzIEFQSSByb3V0ZXMuXG4gKiBcbiAqIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgYmUgcmVwbGFjZWQgd2l0aCBkYXRhYmFzZSBxdWVyaWVzLlxuICovXG5cbmltcG9ydCBEZWNpbWFsIGZyb20gJ2RlY2ltYWwuanMnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCB0eXBlIFByb21vdGlvblR5cGUgPSAnQ09VUE9OJyB8ICdBVVRPTUFUSUMnIHwgJ0ZMQVNIX1NBTEUnXG5leHBvcnQgdHlwZSBEaXNjb3VudFR5cGUgPSAnUEVSQ0VOVEFHRScgfCAnRklYRURfQU1PVU5UJyB8ICdGSVhFRF9QRVJfSVRFTScgfCAnRlJFRV9TSElQUElORycgfCAnQlVZX1hfR0VUX1knXG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvbW90aW9uIHtcbiAgaWQ6IHN0cmluZ1xuICB0ZW5hbnRJZDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICBjb2RlPzogc3RyaW5nXG4gIHR5cGU6IFByb21vdGlvblR5cGVcbiAgZGlzY291bnRUeXBlOiBEaXNjb3VudFR5cGVcbiAgZGlzY291bnRWYWx1ZTogbnVtYmVyXG4gIG1heERpc2NvdW50PzogbnVtYmVyXG4gIG1pbk9yZGVyVG90YWw/OiBudW1iZXJcbiAgbWluUXVhbnRpdHk/OiBudW1iZXJcbiAgcHJvZHVjdElkczogc3RyaW5nW11cbiAgY2F0ZWdvcnlJZHM6IHN0cmluZ1tdXG4gIGV4Y2x1ZGVQcm9kdWN0SWRzOiBzdHJpbmdbXVxuICBjdXN0b21lcklkczogc3RyaW5nW11cbiAgZmlyc3RPcmRlck9ubHk6IGJvb2xlYW5cbiAgdXNhZ2VMaW1pdD86IG51bWJlclxuICB1c2FnZUNvdW50OiBudW1iZXJcbiAgcGVyQ3VzdG9tZXJMaW1pdD86IG51bWJlclxuICBzdGFydHNBdDogRGF0ZVxuICBlbmRzQXQ/OiBEYXRlXG4gIGlzQWN0aXZlOiBib29sZWFuXG4gIHN0YWNrYWJsZTogYm9vbGVhblxuICBwcmlvcml0eTogbnVtYmVyXG4gIGJ1eVF1YW50aXR5PzogbnVtYmVyXG4gIGdldFF1YW50aXR5PzogbnVtYmVyXG4gIGdldERpc2NvdW50UGVyY2VudD86IG51bWJlclxuICBjcmVhdGVkQXQ/OiBzdHJpbmdcbiAgdXBkYXRlZEF0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvbW90aW9uVXNhZ2Uge1xuICBpZDogc3RyaW5nXG4gIHByb21vdGlvbklkOiBzdHJpbmdcbiAgb3JkZXJJZDogc3RyaW5nXG4gIGN1c3RvbWVySWQ/OiBzdHJpbmdcbiAgZGlzY291bnRBcHBsaWVkOiBudW1iZXJcbiAgY3JlYXRlZEF0OiBEYXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvbW90aW9uQ2FydEl0ZW0ge1xuICBwcm9kdWN0SWQ6IHN0cmluZ1xuICB2YXJpYW50SWQ/OiBzdHJpbmdcbiAgY2F0ZWdvcnlJZD86IHN0cmluZ1xuICBwcm9kdWN0TmFtZTogc3RyaW5nXG4gIHVuaXRQcmljZTogbnVtYmVyXG4gIHF1YW50aXR5OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcHBsaWVkUHJvbW90aW9uIHtcbiAgcHJvbW90aW9uSWQ6IHN0cmluZ1xuICBwcm9tb3Rpb25OYW1lOiBzdHJpbmdcbiAgY29kZT86IHN0cmluZ1xuICBkaXNjb3VudFR5cGU6IERpc2NvdW50VHlwZVxuICBkaXNjb3VudEFtb3VudDogbnVtYmVyXG4gIG9yaWdpbmFsQW1vdW50PzogbnVtYmVyXG4gIGNhcHBlZEFtb3VudD86IG51bWJlclxuICBhZmZlY3RlZEl0ZW1zPzogc3RyaW5nW11cbiAgZnJlZVNoaXBwaW5nPzogYm9vbGVhblxuICBtZXNzYWdlOiBzdHJpbmdcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU0hBUkVEIFNUT1JBR0UgKFNpbmdsZXRvbiB1c2luZyBnbG9iYWxUaGlzKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBQUk9NT1RJT05TX1NUT1JBR0VfS0VZID0gJ19fc3ZtX3Byb21vdGlvbnNfc3RvcmFnZV9fJ1xuY29uc3QgVVNBR0VfU1RPUkFHRV9LRVkgPSAnX19zdm1fcHJvbW90aW9uX3VzYWdlX3N0b3JhZ2VfXydcblxuZnVuY3Rpb24gZ2V0UHJvbW90aW9uc1N0b3JhZ2UoKTogTWFwPHN0cmluZywgUHJvbW90aW9uW10+IHtcbiAgaWYgKCEoZ2xvYmFsVGhpcyBhcyBhbnkpW1BST01PVElPTlNfU1RPUkFHRV9LRVldKSB7XG4gICAgKGdsb2JhbFRoaXMgYXMgYW55KVtQUk9NT1RJT05TX1NUT1JBR0VfS0VZXSA9IG5ldyBNYXA8c3RyaW5nLCBQcm9tb3Rpb25bXT4oKVxuICB9XG4gIHJldHVybiAoZ2xvYmFsVGhpcyBhcyBhbnkpW1BST01PVElPTlNfU1RPUkFHRV9LRVldXG59XG5cbmZ1bmN0aW9uIGdldFVzYWdlU3RvcmFnZSgpOiBNYXA8c3RyaW5nLCBQcm9tb3Rpb25Vc2FnZVtdPiB7XG4gIGlmICghKGdsb2JhbFRoaXMgYXMgYW55KVtVU0FHRV9TVE9SQUdFX0tFWV0pIHtcbiAgICAoZ2xvYmFsVGhpcyBhcyBhbnkpW1VTQUdFX1NUT1JBR0VfS0VZXSA9IG5ldyBNYXA8c3RyaW5nLCBQcm9tb3Rpb25Vc2FnZVtdPigpXG4gIH1cbiAgcmV0dXJuIChnbG9iYWxUaGlzIGFzIGFueSlbVVNBR0VfU1RPUkFHRV9LRVldXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUlkKHByZWZpeDogc3RyaW5nID0gJ3Byb21vJyk6IHN0cmluZyB7XG4gIHJldHVybiBgJHtwcmVmaXh9XyR7RGF0ZS5ub3coKS50b1N0cmluZygzNil9JHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgOSl9YFxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQUk9NT1RJT04gQ1JVRFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBvciBjcmVhdGUgc2FtcGxlIHByb21vdGlvbnMgZm9yIGEgdGVuYW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRPckNyZWF0ZVByb21vdGlvbnModGVuYW50SWQ6IHN0cmluZyk6IFByb21vdGlvbltdIHtcbiAgY29uc3Qgc3RvcmFnZSA9IGdldFByb21vdGlvbnNTdG9yYWdlKClcbiAgXG4gIGlmIChzdG9yYWdlLmhhcyh0ZW5hbnRJZCkpIHtcbiAgICByZXR1cm4gc3RvcmFnZS5nZXQodGVuYW50SWQpIVxuICB9XG4gIFxuICAvLyBDcmVhdGUgc2FtcGxlIHByb21vdGlvbnNcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICBjb25zdCBzYW1wbGVQcm9tb3Rpb25zOiBQcm9tb3Rpb25bXSA9IFtcbiAgICB7XG4gICAgICBpZDogZ2VuZXJhdGVJZCgncHJvbW8nKSxcbiAgICAgIHRlbmFudElkLFxuICAgICAgbmFtZTogJ1dlbGNvbWUgRGlzY291bnQnLFxuICAgICAgZGVzY3JpcHRpb246ICcxMCUgb2ZmIHlvdXIgZmlyc3Qgb3JkZXInLFxuICAgICAgY29kZTogJ1dFTENPTUUxMCcsXG4gICAgICB0eXBlOiAnQ09VUE9OJyxcbiAgICAgIGRpc2NvdW50VHlwZTogJ1BFUkNFTlRBR0UnLFxuICAgICAgZGlzY291bnRWYWx1ZTogMTAsXG4gICAgICBwcm9kdWN0SWRzOiBbXSxcbiAgICAgIGNhdGVnb3J5SWRzOiBbXSxcbiAgICAgIGV4Y2x1ZGVQcm9kdWN0SWRzOiBbXSxcbiAgICAgIGN1c3RvbWVySWRzOiBbXSxcbiAgICAgIGZpcnN0T3JkZXJPbmx5OiB0cnVlLFxuICAgICAgdXNhZ2VDb3VudDogMCxcbiAgICAgIHN0YXJ0c0F0OiBub3csXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgIHN0YWNrYWJsZTogZmFsc2UsXG4gICAgICBwcmlvcml0eTogMCxcbiAgICAgIGNyZWF0ZWRBdDogbm93LnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkQXQ6IG5vdy50b0lTT1N0cmluZygpXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogZ2VuZXJhdGVJZCgncHJvbW8nKSxcbiAgICAgIHRlbmFudElkLFxuICAgICAgbmFtZTogJ1N1bW1lciBTYWxlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnMTUlIG9mZiBvcmRlcnMgb3ZlciAkMTAwIChtYXggJDUwIGRpc2NvdW50KScsXG4gICAgICB0eXBlOiAnQVVUT01BVElDJyxcbiAgICAgIGRpc2NvdW50VHlwZTogJ1BFUkNFTlRBR0UnLFxuICAgICAgZGlzY291bnRWYWx1ZTogMTUsXG4gICAgICBtYXhEaXNjb3VudDogNTAsXG4gICAgICBtaW5PcmRlclRvdGFsOiAxMDAsXG4gICAgICBwcm9kdWN0SWRzOiBbXSxcbiAgICAgIGNhdGVnb3J5SWRzOiBbXSxcbiAgICAgIGV4Y2x1ZGVQcm9kdWN0SWRzOiBbXSxcbiAgICAgIGN1c3RvbWVySWRzOiBbXSxcbiAgICAgIGZpcnN0T3JkZXJPbmx5OiBmYWxzZSxcbiAgICAgIHVzYWdlQ291bnQ6IDAsXG4gICAgICBzdGFydHNBdDogbm93LFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzdGFja2FibGU6IHRydWUsXG4gICAgICBwcmlvcml0eTogMTAsXG4gICAgICBjcmVhdGVkQXQ6IG5vdy50b0lTT1N0cmluZygpLFxuICAgICAgdXBkYXRlZEF0OiBub3cudG9JU09TdHJpbmcoKVxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6IGdlbmVyYXRlSWQoJ3Byb21vJyksXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIG5hbWU6ICdGcmVlIFNoaXBwaW5nJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnRnJlZSBzaGlwcGluZyBvbiBvcmRlcnMgb3ZlciAkNTAnLFxuICAgICAgY29kZTogJ0ZSRUVTSElQJyxcbiAgICAgIHR5cGU6ICdDT1VQT04nLFxuICAgICAgZGlzY291bnRUeXBlOiAnRlJFRV9TSElQUElORycsXG4gICAgICBkaXNjb3VudFZhbHVlOiAwLFxuICAgICAgbWluT3JkZXJUb3RhbDogNTAsXG4gICAgICBwcm9kdWN0SWRzOiBbXSxcbiAgICAgIGNhdGVnb3J5SWRzOiBbXSxcbiAgICAgIGV4Y2x1ZGVQcm9kdWN0SWRzOiBbXSxcbiAgICAgIGN1c3RvbWVySWRzOiBbXSxcbiAgICAgIGZpcnN0T3JkZXJPbmx5OiBmYWxzZSxcbiAgICAgIHVzYWdlQ291bnQ6IDAsXG4gICAgICBzdGFydHNBdDogbm93LFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzdGFja2FibGU6IHRydWUsXG4gICAgICBwcmlvcml0eTogNSxcbiAgICAgIGNyZWF0ZWRBdDogbm93LnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkQXQ6IG5vdy50b0lTT1N0cmluZygpXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogZ2VuZXJhdGVJZCgncHJvbW8nKSxcbiAgICAgIHRlbmFudElkLFxuICAgICAgbmFtZTogJ0J1eSAyIEdldCAxIEZyZWUnLFxuICAgICAgZGVzY3JpcHRpb246ICdCdXkgYW55IDIgaXRlbXMsIGdldCAxIGZyZWUnLFxuICAgICAgY29kZTogJ0JPR08nLFxuICAgICAgdHlwZTogJ0NPVVBPTicsXG4gICAgICBkaXNjb3VudFR5cGU6ICdCVVlfWF9HRVRfWScsXG4gICAgICBkaXNjb3VudFZhbHVlOiAxMDAsXG4gICAgICBidXlRdWFudGl0eTogMixcbiAgICAgIGdldFF1YW50aXR5OiAxLFxuICAgICAgZ2V0RGlzY291bnRQZXJjZW50OiAxMDAsXG4gICAgICBwcm9kdWN0SWRzOiBbXSxcbiAgICAgIGNhdGVnb3J5SWRzOiBbXSxcbiAgICAgIGV4Y2x1ZGVQcm9kdWN0SWRzOiBbXSxcbiAgICAgIGN1c3RvbWVySWRzOiBbXSxcbiAgICAgIGZpcnN0T3JkZXJPbmx5OiBmYWxzZSxcbiAgICAgIHVzYWdlQ291bnQ6IDAsXG4gICAgICBzdGFydHNBdDogbm93LFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzdGFja2FibGU6IGZhbHNlLFxuICAgICAgcHJpb3JpdHk6IDAsXG4gICAgICBjcmVhdGVkQXQ6IG5vdy50b0lTT1N0cmluZygpLFxuICAgICAgdXBkYXRlZEF0OiBub3cudG9JU09TdHJpbmcoKVxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6IGdlbmVyYXRlSWQoJ3Byb21vJyksXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIG5hbWU6ICckMjAgT2ZmJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnJDIwIG9mZiBvcmRlcnMgb3ZlciAkNzUgKGxpbWl0IDEwMCB1c2VzKScsXG4gICAgICBjb2RlOiAnU0FWRTIwJyxcbiAgICAgIHR5cGU6ICdDT1VQT04nLFxuICAgICAgZGlzY291bnRUeXBlOiAnRklYRURfQU1PVU5UJyxcbiAgICAgIGRpc2NvdW50VmFsdWU6IDIwLFxuICAgICAgbWluT3JkZXJUb3RhbDogNzUsXG4gICAgICB1c2FnZUxpbWl0OiAxMDAsXG4gICAgICBwZXJDdXN0b21lckxpbWl0OiAxLFxuICAgICAgcHJvZHVjdElkczogW10sXG4gICAgICBjYXRlZ29yeUlkczogW10sXG4gICAgICBleGNsdWRlUHJvZHVjdElkczogW10sXG4gICAgICBjdXN0b21lcklkczogW10sXG4gICAgICBmaXJzdE9yZGVyT25seTogZmFsc2UsXG4gICAgICB1c2FnZUNvdW50OiAwLFxuICAgICAgc3RhcnRzQXQ6IG5vdyxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgc3RhY2thYmxlOiBmYWxzZSxcbiAgICAgIHByaW9yaXR5OiAwLFxuICAgICAgY3JlYXRlZEF0OiBub3cudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRBdDogbm93LnRvSVNPU3RyaW5nKClcbiAgICB9XG4gIF1cbiAgXG4gIHN0b3JhZ2Uuc2V0KHRlbmFudElkLCBzYW1wbGVQcm9tb3Rpb25zKVxuICByZXR1cm4gc2FtcGxlUHJvbW90aW9uc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvbW90aW9ucyh0ZW5hbnRJZDogc3RyaW5nKTogUHJvbW90aW9uW10ge1xuICByZXR1cm4gZ2V0T3JDcmVhdGVQcm9tb3Rpb25zKHRlbmFudElkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWN0aXZlUHJvbW90aW9ucyh0ZW5hbnRJZDogc3RyaW5nKTogUHJvbW90aW9uW10ge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIHJldHVybiBnZXRQcm9tb3Rpb25zKHRlbmFudElkKS5maWx0ZXIocCA9PiBcbiAgICBwLmlzQWN0aXZlICYmIFxuICAgIHAuc3RhcnRzQXQgPD0gbm93ICYmIFxuICAgICghcC5lbmRzQXQgfHwgcC5lbmRzQXQgPiBub3cpICYmXG4gICAgKCFwLnVzYWdlTGltaXQgfHwgcC51c2FnZUNvdW50IDwgcC51c2FnZUxpbWl0KVxuICApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdXRvbWF0aWNQcm9tb3Rpb25zKHRlbmFudElkOiBzdHJpbmcpOiBQcm9tb3Rpb25bXSB7XG4gIHJldHVybiBnZXRBY3RpdmVQcm9tb3Rpb25zKHRlbmFudElkKS5maWx0ZXIocCA9PiBcbiAgICBwLnR5cGUgPT09ICdBVVRPTUFUSUMnIHx8IHAudHlwZSA9PT0gJ0ZMQVNIX1NBTEUnXG4gIClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRCeUNvZGUodGVuYW50SWQ6IHN0cmluZywgY29kZTogc3RyaW5nKTogUHJvbW90aW9uIHwgbnVsbCB7XG4gIGNvbnN0IHByb21vdGlvbnMgPSBnZXRBY3RpdmVQcm9tb3Rpb25zKHRlbmFudElkKVxuICByZXR1cm4gcHJvbW90aW9ucy5maW5kKHAgPT4gcC5jb2RlPy50b1VwcGVyQ2FzZSgpID09PSBjb2RlLnRvVXBwZXJDYXNlKCkpIHx8IG51bGxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb21vdGlvbih0ZW5hbnRJZDogc3RyaW5nLCBwcm9tb3Rpb25JZDogc3RyaW5nKTogUHJvbW90aW9uIHwgbnVsbCB7XG4gIGNvbnN0IHByb21vdGlvbnMgPSBnZXRQcm9tb3Rpb25zKHRlbmFudElkKVxuICByZXR1cm4gcHJvbW90aW9ucy5maW5kKHAgPT4gcC5pZCA9PT0gcHJvbW90aW9uSWQpIHx8IG51bGxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFByb21vdGlvbihwcm9tb3Rpb246IFByb21vdGlvbik6IHZvaWQge1xuICBjb25zdCBzdG9yYWdlID0gZ2V0UHJvbW90aW9uc1N0b3JhZ2UoKVxuICBjb25zdCBwcm9tb3Rpb25zID0gZ2V0T3JDcmVhdGVQcm9tb3Rpb25zKHByb21vdGlvbi50ZW5hbnRJZClcbiAgcHJvbW90aW9ucy5wdXNoKHByb21vdGlvbilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVByb21vdGlvbih0ZW5hbnRJZDogc3RyaW5nLCBwcm9tb3Rpb25JZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFByb21vdGlvbj4pOiBQcm9tb3Rpb24gfCBudWxsIHtcbiAgY29uc3QgcHJvbW90aW9ucyA9IGdldFByb21vdGlvbnModGVuYW50SWQpXG4gIGNvbnN0IGluZGV4ID0gcHJvbW90aW9ucy5maW5kSW5kZXgocCA9PiBwLmlkID09PSBwcm9tb3Rpb25JZClcbiAgaWYgKGluZGV4IDwgMCkgcmV0dXJuIG51bGxcbiAgXG4gIHByb21vdGlvbnNbaW5kZXhdID0geyAuLi5wcm9tb3Rpb25zW2luZGV4XSwgLi4udXBkYXRlcywgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfVxuICByZXR1cm4gcHJvbW90aW9uc1tpbmRleF1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVByb21vdGlvbih0ZW5hbnRJZDogc3RyaW5nLCBwcm9tb3Rpb25JZDogc3RyaW5nKTogUHJvbW90aW9uIHwgbnVsbCB7XG4gIGNvbnN0IHN0b3JhZ2UgPSBnZXRQcm9tb3Rpb25zU3RvcmFnZSgpXG4gIGNvbnN0IHByb21vdGlvbnMgPSBzdG9yYWdlLmdldCh0ZW5hbnRJZCkgfHwgW11cbiAgY29uc3QgaW5kZXggPSBwcm9tb3Rpb25zLmZpbmRJbmRleChwID0+IHAuaWQgPT09IHByb21vdGlvbklkKVxuICBpZiAoaW5kZXggPCAwKSByZXR1cm4gbnVsbFxuICBcbiAgY29uc3QgW2RlbGV0ZWRdID0gcHJvbW90aW9ucy5zcGxpY2UoaW5kZXgsIDEpXG4gIHJldHVybiBkZWxldGVkXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVTQUdFIFRSQUNLSU5HXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBmdW5jdGlvbiByZWNvcmRVc2FnZShcbiAgcHJvbW90aW9uSWQ6IHN0cmluZyxcbiAgb3JkZXJJZDogc3RyaW5nLFxuICBjdXN0b21lcklkOiBzdHJpbmcgfCB1bmRlZmluZWQsXG4gIGRpc2NvdW50QXBwbGllZDogbnVtYmVyXG4pOiBQcm9tb3Rpb25Vc2FnZSB7XG4gIGNvbnN0IHVzYWdlU3RvcmFnZSA9IGdldFVzYWdlU3RvcmFnZSgpXG4gIGNvbnN0IHByb21vdGlvbnNTdG9yYWdlID0gZ2V0UHJvbW90aW9uc1N0b3JhZ2UoKVxuICBcbiAgY29uc3QgdXNhZ2U6IFByb21vdGlvblVzYWdlID0ge1xuICAgIGlkOiBnZW5lcmF0ZUlkKCd1c2FnZScpLFxuICAgIHByb21vdGlvbklkLFxuICAgIG9yZGVySWQsXG4gICAgY3VzdG9tZXJJZCxcbiAgICBkaXNjb3VudEFwcGxpZWQsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpXG4gIH1cbiAgXG4gIC8vIFN0b3JlIHVzYWdlXG4gIGNvbnN0IHVzYWdlcyA9IHVzYWdlU3RvcmFnZS5nZXQocHJvbW90aW9uSWQpIHx8IFtdXG4gIHVzYWdlcy5wdXNoKHVzYWdlKVxuICB1c2FnZVN0b3JhZ2Uuc2V0KHByb21vdGlvbklkLCB1c2FnZXMpXG4gIFxuICAvLyBJbmNyZW1lbnQgdXNhZ2UgY291bnQgb24gcHJvbW90aW9uXG4gIGZvciAoY29uc3QgW3RlbmFudElkLCBwcm9tb3Rpb25zXSBvZiBwcm9tb3Rpb25zU3RvcmFnZSkge1xuICAgIGNvbnN0IHByb21vdGlvbiA9IHByb21vdGlvbnMuZmluZChwID0+IHAuaWQgPT09IHByb21vdGlvbklkKVxuICAgIGlmIChwcm9tb3Rpb24pIHtcbiAgICAgIHByb21vdGlvbi51c2FnZUNvdW50KytcbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gdXNhZ2Vcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1c3RvbWVyVXNhZ2VDb3VudChwcm9tb3Rpb25JZDogc3RyaW5nLCBjdXN0b21lcklkPzogc3RyaW5nKTogbnVtYmVyIHtcbiAgaWYgKCFjdXN0b21lcklkKSByZXR1cm4gMFxuICBcbiAgY29uc3QgdXNhZ2VTdG9yYWdlID0gZ2V0VXNhZ2VTdG9yYWdlKClcbiAgY29uc3QgdXNhZ2VzID0gdXNhZ2VTdG9yYWdlLmdldChwcm9tb3Rpb25JZCkgfHwgW11cbiAgcmV0dXJuIHVzYWdlcy5maWx0ZXIodSA9PiB1LmN1c3RvbWVySWQgPT09IGN1c3RvbWVySWQpLmxlbmd0aFxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBWQUxJREFUSU9OICYgQ0FMQ1VMQVRJT05cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgdmFsaWQ6IGJvb2xlYW5cbiAgZXJyb3I/OiBzdHJpbmdcbiAgZXJyb3JDb2RlPzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVByb21vdGlvbihcbiAgcHJvbW90aW9uOiBQcm9tb3Rpb24sXG4gIHN1YnRvdGFsOiBudW1iZXIsXG4gIHRvdGFsUXVhbnRpdHk6IG51bWJlcixcbiAgY3VzdG9tZXJJZD86IHN0cmluZyxcbiAgaXNGaXJzdE9yZGVyPzogYm9vbGVhbixcbiAgY3VycmVudERpc2NvdW50czogQXBwbGllZFByb21vdGlvbltdID0gW11cbik6IFZhbGlkYXRpb25SZXN1bHQge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIFxuICBpZiAoIXByb21vdGlvbi5pc0FjdGl2ZSkge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdUaGlzIHByb21vdGlvbiBpcyBubyBsb25nZXIgYWN0aXZlJywgZXJyb3JDb2RlOiAnSU5BQ1RJVkUnIH1cbiAgfVxuICBcbiAgaWYgKHByb21vdGlvbi5zdGFydHNBdCA+IG5vdykge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdUaGlzIHByb21vdGlvbiBoYXMgbm90IHN0YXJ0ZWQgeWV0JywgZXJyb3JDb2RlOiAnTk9UX1NUQVJURUQnIH1cbiAgfVxuICBcbiAgaWYgKHByb21vdGlvbi5lbmRzQXQgJiYgcHJvbW90aW9uLmVuZHNBdCA8IG5vdykge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdUaGlzIHByb21vdGlvbiBoYXMgZXhwaXJlZCcsIGVycm9yQ29kZTogJ0VYUElSRUQnIH1cbiAgfVxuICBcbiAgaWYgKHByb21vdGlvbi51c2FnZUxpbWl0ICYmIHByb21vdGlvbi51c2FnZUNvdW50ID49IHByb21vdGlvbi51c2FnZUxpbWl0KSB7XG4gICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogJ1RoaXMgcHJvbW90aW9uIGhhcyByZWFjaGVkIGl0cyB1c2FnZSBsaW1pdCcsIGVycm9yQ29kZTogJ1VTQUdFX0xJTUlUX1JFQUNIRUQnIH1cbiAgfVxuICBcbiAgY29uc3QgY3VzdG9tZXJVc2FnZUNvdW50ID0gZ2V0Q3VzdG9tZXJVc2FnZUNvdW50KHByb21vdGlvbi5pZCwgY3VzdG9tZXJJZClcbiAgaWYgKHByb21vdGlvbi5wZXJDdXN0b21lckxpbWl0ICYmIGN1c3RvbWVyVXNhZ2VDb3VudCA+PSBwcm9tb3Rpb24ucGVyQ3VzdG9tZXJMaW1pdCkge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdZb3UgaGF2ZSBhbHJlYWR5IHVzZWQgdGhpcyBwcm9tb3Rpb24gdGhlIG1heGltdW0gbnVtYmVyIG9mIHRpbWVzJywgZXJyb3JDb2RlOiAnQ1VTVE9NRVJfTElNSVRfUkVBQ0hFRCcgfVxuICB9XG4gIFxuICBpZiAocHJvbW90aW9uLmN1c3RvbWVySWRzLmxlbmd0aCA+IDAgJiYgY3VzdG9tZXJJZCkge1xuICAgIGlmICghcHJvbW90aW9uLmN1c3RvbWVySWRzLmluY2x1ZGVzKGN1c3RvbWVySWQpKSB7XG4gICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiAnVGhpcyBwcm9tb3Rpb24gaXMgbm90IGF2YWlsYWJsZSBmb3IgeW91ciBhY2NvdW50JywgZXJyb3JDb2RlOiAnQ1VTVE9NRVJfTk9UX0VMSUdJQkxFJyB9XG4gICAgfVxuICB9XG4gIFxuICBpZiAocHJvbW90aW9uLmZpcnN0T3JkZXJPbmx5ICYmICFpc0ZpcnN0T3JkZXIpIHtcbiAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiAnVGhpcyBwcm9tb3Rpb24gaXMgb25seSB2YWxpZCBmb3IgZmlyc3QtdGltZSBvcmRlcnMnLCBlcnJvckNvZGU6ICdGSVJTVF9PUkRFUl9PTkxZJyB9XG4gIH1cbiAgXG4gIGlmIChwcm9tb3Rpb24ubWluT3JkZXJUb3RhbCAmJiBzdWJ0b3RhbCA8IHByb21vdGlvbi5taW5PcmRlclRvdGFsKSB7XG4gICAgcmV0dXJuIHsgXG4gICAgICB2YWxpZDogZmFsc2UsIFxuICAgICAgZXJyb3I6IGBNaW5pbXVtIG9yZGVyIHRvdGFsIG9mICQke3Byb21vdGlvbi5taW5PcmRlclRvdGFsLnRvRml4ZWQoMil9IHJlcXVpcmVkYCxcbiAgICAgIGVycm9yQ29kZTogJ01JTl9PUkRFUl9OT1RfTUVUJ1xuICAgIH1cbiAgfVxuICBcbiAgaWYgKHByb21vdGlvbi5taW5RdWFudGl0eSAmJiB0b3RhbFF1YW50aXR5IDwgcHJvbW90aW9uLm1pblF1YW50aXR5KSB7XG4gICAgcmV0dXJuIHsgXG4gICAgICB2YWxpZDogZmFsc2UsIFxuICAgICAgZXJyb3I6IGBNaW5pbXVtIG9mICR7cHJvbW90aW9uLm1pblF1YW50aXR5fSBpdGVtcyByZXF1aXJlZGAsXG4gICAgICBlcnJvckNvZGU6ICdNSU5fUVVBTlRJVFlfTk9UX01FVCdcbiAgICB9XG4gIH1cbiAgXG4gIGlmICghcHJvbW90aW9uLnN0YWNrYWJsZSAmJiBjdXJyZW50RGlzY291bnRzLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiAnVGhpcyBwcm9tb3Rpb24gY2Fubm90IGJlIGNvbWJpbmVkIHdpdGggb3RoZXIgZGlzY291bnRzJywgZXJyb3JDb2RlOiAnTk9UX1NUQUNLQUJMRScgfVxuICB9XG4gIFxuICBpZiAoY3VycmVudERpc2NvdW50cy5zb21lKGQgPT4gZC5wcm9tb3Rpb25JZCA9PT0gcHJvbW90aW9uLmlkKSkge1xuICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdUaGlzIHByb21vdGlvbiBpcyBhbHJlYWR5IGFwcGxpZWQnLCBlcnJvckNvZGU6ICdBTFJFQURZX0FQUExJRUQnIH1cbiAgfVxuICBcbiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxpZ2libGVJdGVtcyhwcm9tb3Rpb246IFByb21vdGlvbiwgaXRlbXM6IFByb21vdGlvbkNhcnRJdGVtW10pOiBQcm9tb3Rpb25DYXJ0SXRlbVtdIHtcbiAgcmV0dXJuIGl0ZW1zLmZpbHRlcihpdGVtID0+IHtcbiAgICBpZiAocHJvbW90aW9uLmV4Y2x1ZGVQcm9kdWN0SWRzLmluY2x1ZGVzKGl0ZW0ucHJvZHVjdElkKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIFxuICAgIGlmIChwcm9tb3Rpb24ucHJvZHVjdElkcy5sZW5ndGggPT09IDAgJiYgcHJvbW90aW9uLmNhdGVnb3J5SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgXG4gICAgaWYgKHByb21vdGlvbi5wcm9kdWN0SWRzLmxlbmd0aCA+IDAgJiYgcHJvbW90aW9uLnByb2R1Y3RJZHMuaW5jbHVkZXMoaXRlbS5wcm9kdWN0SWQpKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBcbiAgICBpZiAocHJvbW90aW9uLmNhdGVnb3J5SWRzLmxlbmd0aCA+IDAgJiYgaXRlbS5jYXRlZ29yeUlkICYmIHByb21vdGlvbi5jYXRlZ29yeUlkcy5pbmNsdWRlcyhpdGVtLmNhdGVnb3J5SWQpKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmFsc2VcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZURpc2NvdW50KFxuICBwcm9tb3Rpb246IFByb21vdGlvbixcbiAgaXRlbXM6IFByb21vdGlvbkNhcnRJdGVtW10sXG4gIHN1YnRvdGFsOiBudW1iZXIsXG4gIHNoaXBwaW5nVG90YWw/OiBudW1iZXJcbik6IEFwcGxpZWRQcm9tb3Rpb24gfCBudWxsIHtcbiAgY29uc3QgZWxpZ2libGVJdGVtcyA9IGdldEVsaWdpYmxlSXRlbXMocHJvbW90aW9uLCBpdGVtcylcbiAgXG4gIGxldCBkaXNjb3VudEFtb3VudCA9IG5ldyBEZWNpbWFsKDApXG4gIGxldCBvcmlnaW5hbEFtb3VudDogbnVtYmVyIHwgdW5kZWZpbmVkXG4gIGxldCBmcmVlU2hpcHBpbmcgPSBmYWxzZVxuICBsZXQgYWZmZWN0ZWRJdGVtczogc3RyaW5nW10gPSBbXVxuICBsZXQgbWVzc2FnZSA9ICcnXG4gIFxuICBzd2l0Y2ggKHByb21vdGlvbi5kaXNjb3VudFR5cGUpIHtcbiAgICBjYXNlICdQRVJDRU5UQUdFJzoge1xuICAgICAgY29uc3QgZWxpZ2libGVTdWJ0b3RhbCA9IGVsaWdpYmxlSXRlbXMucmVkdWNlKFxuICAgICAgICAoc3VtLCBpdGVtKSA9PiBzdW0gKyAoaXRlbS51bml0UHJpY2UgKiBpdGVtLnF1YW50aXR5KSwgMFxuICAgICAgKVxuICAgICAgXG4gICAgICBjb25zdCBwZXJjZW50RGlzY291bnQgPSBuZXcgRGVjaW1hbChlbGlnaWJsZVN1YnRvdGFsKVxuICAgICAgICAudGltZXMocHJvbW90aW9uLmRpc2NvdW50VmFsdWUpXG4gICAgICAgIC5kaXZpZGVkQnkoMTAwKVxuICAgICAgXG4gICAgICBvcmlnaW5hbEFtb3VudCA9IHBlcmNlbnREaXNjb3VudC50b0RlY2ltYWxQbGFjZXMoMikudG9OdW1iZXIoKVxuICAgICAgXG4gICAgICBpZiAocHJvbW90aW9uLm1heERpc2NvdW50ICYmIHBlcmNlbnREaXNjb3VudC5ncmVhdGVyVGhhbihwcm9tb3Rpb24ubWF4RGlzY291bnQpKSB7XG4gICAgICAgIGRpc2NvdW50QW1vdW50ID0gbmV3IERlY2ltYWwocHJvbW90aW9uLm1heERpc2NvdW50KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGlzY291bnRBbW91bnQgPSBwZXJjZW50RGlzY291bnRcbiAgICAgIH1cbiAgICAgIFxuICAgICAgYWZmZWN0ZWRJdGVtcyA9IGVsaWdpYmxlSXRlbXMubWFwKGkgPT4gaS5wcm9kdWN0SWQpXG4gICAgICBtZXNzYWdlID0gYCR7cHJvbW90aW9uLmRpc2NvdW50VmFsdWV9JSBvZmYke2FmZmVjdGVkSXRlbXMubGVuZ3RoIDwgaXRlbXMubGVuZ3RoID8gJyBlbGlnaWJsZSBpdGVtcycgOiAnJ31gXG4gICAgICBicmVha1xuICAgIH1cbiAgICBcbiAgICBjYXNlICdGSVhFRF9BTU9VTlQnOiB7XG4gICAgICBkaXNjb3VudEFtb3VudCA9IG5ldyBEZWNpbWFsKHByb21vdGlvbi5kaXNjb3VudFZhbHVlKVxuICAgICAgaWYgKGRpc2NvdW50QW1vdW50LmdyZWF0ZXJUaGFuKHN1YnRvdGFsKSkge1xuICAgICAgICBkaXNjb3VudEFtb3VudCA9IG5ldyBEZWNpbWFsKHN1YnRvdGFsKVxuICAgICAgfVxuICAgICAgbWVzc2FnZSA9IGAkJHtwcm9tb3Rpb24uZGlzY291bnRWYWx1ZS50b0ZpeGVkKDIpfSBvZmYgeW91ciBvcmRlcmBcbiAgICAgIGJyZWFrXG4gICAgfVxuICAgIFxuICAgIGNhc2UgJ0ZJWEVEX1BFUl9JVEVNJzoge1xuICAgICAgY29uc3QgdG90YWxFbGlnaWJsZVF0eSA9IGVsaWdpYmxlSXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIGl0ZW0ucXVhbnRpdHksIDApXG4gICAgICBkaXNjb3VudEFtb3VudCA9IG5ldyBEZWNpbWFsKHByb21vdGlvbi5kaXNjb3VudFZhbHVlKS50aW1lcyh0b3RhbEVsaWdpYmxlUXR5KVxuICAgICAgXG4gICAgICBjb25zdCBlbGlnaWJsZVN1YnRvdGFsID0gZWxpZ2libGVJdGVtcy5yZWR1Y2UoXG4gICAgICAgIChzdW0sIGl0ZW0pID0+IHN1bSArIChpdGVtLnVuaXRQcmljZSAqIGl0ZW0ucXVhbnRpdHkpLCAwXG4gICAgICApXG4gICAgICBpZiAoZGlzY291bnRBbW91bnQuZ3JlYXRlclRoYW4oZWxpZ2libGVTdWJ0b3RhbCkpIHtcbiAgICAgICAgZGlzY291bnRBbW91bnQgPSBuZXcgRGVjaW1hbChlbGlnaWJsZVN1YnRvdGFsKVxuICAgICAgfVxuICAgICAgXG4gICAgICBhZmZlY3RlZEl0ZW1zID0gZWxpZ2libGVJdGVtcy5tYXAoaSA9PiBpLnByb2R1Y3RJZClcbiAgICAgIG1lc3NhZ2UgPSBgJCR7cHJvbW90aW9uLmRpc2NvdW50VmFsdWUudG9GaXhlZCgyKX0gb2ZmIGVhY2ggZWxpZ2libGUgaXRlbWBcbiAgICAgIGJyZWFrXG4gICAgfVxuICAgIFxuICAgIGNhc2UgJ0ZSRUVfU0hJUFBJTkcnOiB7XG4gICAgICBmcmVlU2hpcHBpbmcgPSB0cnVlXG4gICAgICBtZXNzYWdlID0gJ0ZyZWUgc2hpcHBpbmcnXG4gICAgICBicmVha1xuICAgIH1cbiAgICBcbiAgICBjYXNlICdCVVlfWF9HRVRfWSc6IHtcbiAgICAgIGlmICghcHJvbW90aW9uLmJ1eVF1YW50aXR5IHx8ICFwcm9tb3Rpb24uZ2V0UXVhbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3Qgc29ydGVkSXRlbXMgPSBbLi4uZWxpZ2libGVJdGVtc10uc29ydCgoYSwgYikgPT4gYi51bml0UHJpY2UgLSBhLnVuaXRQcmljZSlcbiAgICAgIGNvbnN0IHRvdGFsUXR5ID0gc29ydGVkSXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIGl0ZW0ucXVhbnRpdHksIDApXG4gICAgICBcbiAgICAgIGNvbnN0IGRlYWxTaXplID0gcHJvbW90aW9uLmJ1eVF1YW50aXR5ICsgcHJvbW90aW9uLmdldFF1YW50aXR5XG4gICAgICBjb25zdCBudW1EZWFscyA9IE1hdGguZmxvb3IodG90YWxRdHkgLyBkZWFsU2l6ZSlcbiAgICAgIFxuICAgICAgaWYgKG51bURlYWxzID09PSAwKSB7XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGRpc2NvdW50UGVyY2VudCA9IHByb21vdGlvbi5nZXREaXNjb3VudFBlcmNlbnQgfHwgMTAwXG4gICAgICBsZXQgZGlzY291bnRlZEl0ZW1zID0gMFxuICAgICAgbGV0IHRvdGFsRGlzY291bnQgPSBuZXcgRGVjaW1hbCgwKVxuICAgICAgXG4gICAgICBjb25zdCByZXZlcnNlZEl0ZW1zID0gWy4uLnNvcnRlZEl0ZW1zXS5yZXZlcnNlKClcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiByZXZlcnNlZEl0ZW1zKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zVG9EaXNjb3VudCA9IE1hdGgubWluKFxuICAgICAgICAgIGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgKG51bURlYWxzICogcHJvbW90aW9uLmdldFF1YW50aXR5KSAtIGRpc2NvdW50ZWRJdGVtc1xuICAgICAgICApXG4gICAgICAgIFxuICAgICAgICBpZiAoaXRlbXNUb0Rpc2NvdW50ID4gMCkge1xuICAgICAgICAgIGNvbnN0IGl0ZW1EaXNjb3VudCA9IG5ldyBEZWNpbWFsKGl0ZW0udW5pdFByaWNlKVxuICAgICAgICAgICAgLnRpbWVzKGl0ZW1zVG9EaXNjb3VudClcbiAgICAgICAgICAgIC50aW1lcyhkaXNjb3VudFBlcmNlbnQpXG4gICAgICAgICAgICAuZGl2aWRlZEJ5KDEwMClcbiAgICAgICAgICBcbiAgICAgICAgICB0b3RhbERpc2NvdW50ID0gdG90YWxEaXNjb3VudC5wbHVzKGl0ZW1EaXNjb3VudClcbiAgICAgICAgICBkaXNjb3VudGVkSXRlbXMgKz0gaXRlbXNUb0Rpc2NvdW50XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChkaXNjb3VudGVkSXRlbXMgPj0gbnVtRGVhbHMgKiBwcm9tb3Rpb24uZ2V0UXVhbnRpdHkpIHtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGRpc2NvdW50QW1vdW50ID0gdG90YWxEaXNjb3VudFxuICAgICAgYWZmZWN0ZWRJdGVtcyA9IGVsaWdpYmxlSXRlbXMubWFwKGkgPT4gaS5wcm9kdWN0SWQpXG4gICAgICBcbiAgICAgIGNvbnN0IGdldERlc2MgPSBkaXNjb3VudFBlcmNlbnQgPT09IDEwMCA/ICdmcmVlJyA6IGAke2Rpc2NvdW50UGVyY2VudH0lIG9mZmBcbiAgICAgIG1lc3NhZ2UgPSBgQnV5ICR7cHJvbW90aW9uLmJ1eVF1YW50aXR5fSBnZXQgJHtwcm9tb3Rpb24uZ2V0UXVhbnRpdHl9ICR7Z2V0RGVzY31gXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuICBcbiAgY29uc3QgZmluYWxEaXNjb3VudCA9IGRpc2NvdW50QW1vdW50LnRvRGVjaW1hbFBsYWNlcygyKS50b051bWJlcigpXG4gIFxuICBpZiAoZmluYWxEaXNjb3VudCA9PT0gMCAmJiAhZnJlZVNoaXBwaW5nKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBwcm9tb3Rpb25JZDogcHJvbW90aW9uLmlkLFxuICAgIHByb21vdGlvbk5hbWU6IHByb21vdGlvbi5uYW1lLFxuICAgIGNvZGU6IHByb21vdGlvbi5jb2RlLFxuICAgIGRpc2NvdW50VHlwZTogcHJvbW90aW9uLmRpc2NvdW50VHlwZSxcbiAgICBkaXNjb3VudEFtb3VudDogZmluYWxEaXNjb3VudCxcbiAgICBvcmlnaW5hbEFtb3VudCxcbiAgICBjYXBwZWRBbW91bnQ6IG9yaWdpbmFsQW1vdW50ICYmIG9yaWdpbmFsQW1vdW50ID4gZmluYWxEaXNjb3VudCA/IGZpbmFsRGlzY291bnQgOiB1bmRlZmluZWQsXG4gICAgYWZmZWN0ZWRJdGVtczogYWZmZWN0ZWRJdGVtcy5sZW5ndGggPiAwID8gYWZmZWN0ZWRJdGVtcyA6IHVuZGVmaW5lZCxcbiAgICBmcmVlU2hpcHBpbmcsXG4gICAgbWVzc2FnZVxuICB9XG59XG4iXSwibmFtZXMiOlsiRGVjaW1hbCIsIlBST01PVElPTlNfU1RPUkFHRV9LRVkiLCJVU0FHRV9TVE9SQUdFX0tFWSIsImdldFByb21vdGlvbnNTdG9yYWdlIiwiZ2xvYmFsVGhpcyIsIk1hcCIsImdldFVzYWdlU3RvcmFnZSIsImdlbmVyYXRlSWQiLCJwcmVmaXgiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJNYXRoIiwicmFuZG9tIiwic3Vic3RyaW5nIiwiZ2V0T3JDcmVhdGVQcm9tb3Rpb25zIiwidGVuYW50SWQiLCJzdG9yYWdlIiwiaGFzIiwiZ2V0Iiwic2FtcGxlUHJvbW90aW9ucyIsImlkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwiY29kZSIsInR5cGUiLCJkaXNjb3VudFR5cGUiLCJkaXNjb3VudFZhbHVlIiwicHJvZHVjdElkcyIsImNhdGVnb3J5SWRzIiwiZXhjbHVkZVByb2R1Y3RJZHMiLCJjdXN0b21lcklkcyIsImZpcnN0T3JkZXJPbmx5IiwidXNhZ2VDb3VudCIsInN0YXJ0c0F0IiwiaXNBY3RpdmUiLCJzdGFja2FibGUiLCJwcmlvcml0eSIsImNyZWF0ZWRBdCIsInRvSVNPU3RyaW5nIiwidXBkYXRlZEF0IiwibWF4RGlzY291bnQiLCJtaW5PcmRlclRvdGFsIiwiYnV5UXVhbnRpdHkiLCJnZXRRdWFudGl0eSIsImdldERpc2NvdW50UGVyY2VudCIsInVzYWdlTGltaXQiLCJwZXJDdXN0b21lckxpbWl0Iiwic2V0IiwiZ2V0UHJvbW90aW9ucyIsImdldEFjdGl2ZVByb21vdGlvbnMiLCJmaWx0ZXIiLCJwIiwiZW5kc0F0IiwiZ2V0QXV0b21hdGljUHJvbW90aW9ucyIsImZpbmRCeUNvZGUiLCJwcm9tb3Rpb25zIiwiZmluZCIsInRvVXBwZXJDYXNlIiwiZ2V0UHJvbW90aW9uIiwicHJvbW90aW9uSWQiLCJhZGRQcm9tb3Rpb24iLCJwcm9tb3Rpb24iLCJwdXNoIiwidXBkYXRlUHJvbW90aW9uIiwidXBkYXRlcyIsImluZGV4IiwiZmluZEluZGV4IiwiZGVsZXRlUHJvbW90aW9uIiwiZGVsZXRlZCIsInNwbGljZSIsInJlY29yZFVzYWdlIiwib3JkZXJJZCIsImN1c3RvbWVySWQiLCJkaXNjb3VudEFwcGxpZWQiLCJ1c2FnZVN0b3JhZ2UiLCJwcm9tb3Rpb25zU3RvcmFnZSIsInVzYWdlIiwidXNhZ2VzIiwiZ2V0Q3VzdG9tZXJVc2FnZUNvdW50IiwidSIsImxlbmd0aCIsInZhbGlkYXRlUHJvbW90aW9uIiwic3VidG90YWwiLCJ0b3RhbFF1YW50aXR5IiwiaXNGaXJzdE9yZGVyIiwiY3VycmVudERpc2NvdW50cyIsInZhbGlkIiwiZXJyb3IiLCJlcnJvckNvZGUiLCJjdXN0b21lclVzYWdlQ291bnQiLCJpbmNsdWRlcyIsInRvRml4ZWQiLCJtaW5RdWFudGl0eSIsInNvbWUiLCJkIiwiZ2V0RWxpZ2libGVJdGVtcyIsIml0ZW1zIiwiaXRlbSIsInByb2R1Y3RJZCIsImNhdGVnb3J5SWQiLCJjYWxjdWxhdGVEaXNjb3VudCIsInNoaXBwaW5nVG90YWwiLCJlbGlnaWJsZUl0ZW1zIiwiZGlzY291bnRBbW91bnQiLCJvcmlnaW5hbEFtb3VudCIsImZyZWVTaGlwcGluZyIsImFmZmVjdGVkSXRlbXMiLCJtZXNzYWdlIiwiZWxpZ2libGVTdWJ0b3RhbCIsInJlZHVjZSIsInN1bSIsInVuaXRQcmljZSIsInF1YW50aXR5IiwicGVyY2VudERpc2NvdW50IiwidGltZXMiLCJkaXZpZGVkQnkiLCJ0b0RlY2ltYWxQbGFjZXMiLCJ0b051bWJlciIsImdyZWF0ZXJUaGFuIiwibWFwIiwiaSIsInRvdGFsRWxpZ2libGVRdHkiLCJzb3J0ZWRJdGVtcyIsInNvcnQiLCJhIiwiYiIsInRvdGFsUXR5IiwiZGVhbFNpemUiLCJudW1EZWFscyIsImZsb29yIiwiZGlzY291bnRQZXJjZW50IiwiZGlzY291bnRlZEl0ZW1zIiwidG90YWxEaXNjb3VudCIsInJldmVyc2VkSXRlbXMiLCJyZXZlcnNlIiwiaXRlbXNUb0Rpc2NvdW50IiwibWluIiwiaXRlbURpc2NvdW50IiwicGx1cyIsImdldERlc2MiLCJmaW5hbERpc2NvdW50IiwicHJvbW90aW9uTmFtZSIsImNhcHBlZEFtb3VudCIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/promotions-storage.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/decimal.js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&page=%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fpromotions%2F%5BpromotionId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();