"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/svm/events/route";
exports.ids = ["app/api/svm/events/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fevents%2Froute&page=%2Fapi%2Fsvm%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fevents%2Froute&page=%2Fapi%2Fsvm%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_svm_events_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/svm/events/route.ts */ \"(rsc)/./src/app/api/svm/events/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/svm/events/route\",\n        pathname: \"/api/svm/events\",\n        filename: \"route\",\n        bundlePath: \"app/api/svm/events/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/svm/events/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_svm_events_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/svm/events/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdm0lMkZldmVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN2bSUyRmV2ZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN2bSUyRmV2ZW50cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDRjtBQUMzRTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/MWI0OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9zdm0vZXZlbnRzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zdm0vZXZlbnRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3ZtL2V2ZW50c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc3ZtL2V2ZW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL3N2bS9ldmVudHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3N2bS9ldmVudHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fevents%2Froute&page=%2Fapi%2Fsvm%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/svm/events/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/svm/events/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_svm_event_handlers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/svm-event-handlers */ \"(rsc)/./src/lib/svm-event-handlers.ts\");\n/**\n * SVM Events API\n * \n * POST /api/svm/events - Receive events from SVM module\n * \n * This endpoint receives events from the SVM module and routes them\n * to the appropriate handlers in the Core.\n */ \n\nasync function POST(request) {\n    try {\n        const event = await request.json();\n        // Validate event structure\n        if (!event.eventType || !event.eventId || !event.idempotencyKey || !event.payload) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid event structure. Required: eventType, eventId, idempotencyKey, payload\"\n            }, {\n                status: 400\n            });\n        }\n        // Process the event\n        const result = await (0,_lib_svm_event_handlers__WEBPACK_IMPORTED_MODULE_1__.handleSVMEvent)(event);\n        if (result.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                eventId: event.eventId,\n                processed: true,\n                data: result.data || {}\n            });\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: result.error\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error processing SVM event:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdm0vZXZlbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7O0NBT0MsR0FFc0Q7QUFDRTtBQUVsRCxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsUUFBUSxNQUFNRCxRQUFRRSxJQUFJO1FBRWhDLDJCQUEyQjtRQUMzQixJQUFJLENBQUNELE1BQU1FLFNBQVMsSUFBSSxDQUFDRixNQUFNRyxPQUFPLElBQUksQ0FBQ0gsTUFBTUksY0FBYyxJQUFJLENBQUNKLE1BQU1LLE9BQU8sRUFBRTtZQUNqRixPQUFPVCxxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtnQkFBRUssU0FBUztnQkFBT0MsT0FBTztZQUFpRixHQUMxRztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1DLFNBQVMsTUFBTVosdUVBQWNBLENBQUNHO1FBRXBDLElBQUlTLE9BQU9ILE9BQU8sRUFBRTtZQUNsQixPQUFPVixxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDO2dCQUN2QkssU0FBUztnQkFDVEgsU0FBU0gsTUFBTUcsT0FBTztnQkFDdEJPLFdBQVc7Z0JBQ1hDLE1BQU1GLE9BQU9FLElBQUksSUFBSSxDQUFDO1lBQ3hCO1FBQ0YsT0FBTztZQUNMLE9BQU9mLHFEQUFZQSxDQUFDSyxJQUFJLENBQ3RCO2dCQUFFSyxTQUFTO2dCQUFPQyxPQUFPRSxPQUFPRixLQUFLO1lBQUMsR0FDdEM7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtJQUNGLEVBQUUsT0FBT0QsT0FBTztRQUNkSyxRQUFRTCxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxPQUFPWCxxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtZQUFFSyxTQUFTO1lBQU9DLE9BQU87UUFBd0IsR0FDakQ7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvYXBwL2FwaS9zdm0vZXZlbnRzL3JvdXRlLnRzPzIwNjciXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTVk0gRXZlbnRzIEFQSVxuICogXG4gKiBQT1NUIC9hcGkvc3ZtL2V2ZW50cyAtIFJlY2VpdmUgZXZlbnRzIGZyb20gU1ZNIG1vZHVsZVxuICogXG4gKiBUaGlzIGVuZHBvaW50IHJlY2VpdmVzIGV2ZW50cyBmcm9tIHRoZSBTVk0gbW9kdWxlIGFuZCByb3V0ZXMgdGhlbVxuICogdG8gdGhlIGFwcHJvcHJpYXRlIGhhbmRsZXJzIGluIHRoZSBDb3JlLlxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGhhbmRsZVNWTUV2ZW50IH0gZnJvbSAnQC9saWIvc3ZtLWV2ZW50LWhhbmRsZXJzJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGV2ZW50ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcblxuICAgIC8vIFZhbGlkYXRlIGV2ZW50IHN0cnVjdHVyZVxuICAgIGlmICghZXZlbnQuZXZlbnRUeXBlIHx8ICFldmVudC5ldmVudElkIHx8ICFldmVudC5pZGVtcG90ZW5jeUtleSB8fCAhZXZlbnQucGF5bG9hZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgZXZlbnQgc3RydWN0dXJlLiBSZXF1aXJlZDogZXZlbnRUeXBlLCBldmVudElkLCBpZGVtcG90ZW5jeUtleSwgcGF5bG9hZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyB0aGUgZXZlbnRcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVTVk1FdmVudChldmVudClcblxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZXZlbnRJZDogZXZlbnQuZXZlbnRJZCxcbiAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICBkYXRhOiByZXN1bHQuZGF0YSB8fCB7fVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogcmVzdWx0LmVycm9yIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIFNWTSBldmVudDonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImhhbmRsZVNWTUV2ZW50IiwiUE9TVCIsInJlcXVlc3QiLCJldmVudCIsImpzb24iLCJldmVudFR5cGUiLCJldmVudElkIiwiaWRlbXBvdGVuY3lLZXkiLCJwYXlsb2FkIiwic3VjY2VzcyIsImVycm9yIiwic3RhdHVzIiwicmVzdWx0IiwicHJvY2Vzc2VkIiwiZGF0YSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/svm/events/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/audit.ts":
/*!**************************!*\
  !*** ./src/lib/audit.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuditLog: () => (/* binding */ createAuditLog),\n/* harmony export */   getAuditLogs: () => (/* binding */ getAuditLogs)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist-node/v4.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n/**\n * Create an audit log entry\n */ async function createAuditLog(input) {\n    try {\n        const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.headers)();\n        const ipAddress = headersList.get(\"x-forwarded-for\") || headersList.get(\"x-real-ip\") || \"unknown\";\n        const userAgent = headersList.get(\"user-agent\") || \"unknown\";\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n            data: {\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                action: input.action,\n                actorId: input.actorId,\n                actorEmail: input.actorEmail,\n                tenantId: input.tenantId || null,\n                targetType: input.targetType || null,\n                targetId: input.targetId || null,\n                metadata: input.metadata || undefined,\n                ipAddress,\n                userAgent\n            }\n        });\n    } catch (error) {\n        console.error(\"Failed to create audit log:\", error);\n    // Don't throw - audit logging should not break operations\n    }\n}\n/**\n * Get audit logs for a tenant\n */ async function getAuditLogs(options) {\n    const { tenantId, actorId, action, targetType, limit = 50, offset = 0 } = options;\n    const where = {};\n    if (tenantId) where.tenantId = tenantId;\n    if (actorId) where.actorId = actorId;\n    if (action) where.action = action;\n    if (targetType) where.targetType = targetType;\n    const [logs, total] = await Promise.all([\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findMany({\n            where,\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: limit,\n            skip: offset\n        }),\n        _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.count({\n            where\n        })\n    ]);\n    return {\n        logs,\n        total\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1ZGl0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWlDO0FBRUU7QUFDRztBQVl0Qzs7Q0FFQyxHQUNNLGVBQWVJLGVBQWVDLEtBQW9CO0lBQ3ZELElBQUk7UUFDRixNQUFNQyxjQUFjLE1BQU1ILHFEQUFPQTtRQUNqQyxNQUFNSSxZQUFZRCxZQUFZRSxHQUFHLENBQUMsc0JBQXNCRixZQUFZRSxHQUFHLENBQUMsZ0JBQWdCO1FBQ3hGLE1BQU1DLFlBQVlILFlBQVlFLEdBQUcsQ0FBQyxpQkFBaUI7UUFFbkQsTUFBTVIsMkNBQU1BLENBQUNVLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDO1lBQzNCQyxNQUFNO2dCQUNKQyxJQUFJWCxnREFBTUE7Z0JBQ1ZZLFFBQVFULE1BQU1TLE1BQU07Z0JBQ3BCQyxTQUFTVixNQUFNVSxPQUFPO2dCQUN0QkMsWUFBWVgsTUFBTVcsVUFBVTtnQkFDNUJDLFVBQVVaLE1BQU1ZLFFBQVEsSUFBSTtnQkFDNUJDLFlBQVliLE1BQU1hLFVBQVUsSUFBSTtnQkFDaENDLFVBQVVkLE1BQU1jLFFBQVEsSUFBSTtnQkFDNUJDLFVBQVVmLE1BQU1lLFFBQVEsSUFBSUM7Z0JBQzVCZDtnQkFDQUU7WUFDRjtRQUNGO0lBQ0YsRUFBRSxPQUFPYSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywrQkFBK0JBO0lBQzdDLDBEQUEwRDtJQUM1RDtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlRSxhQUFhQyxPQU9sQztJQUNDLE1BQU0sRUFBRVIsUUFBUSxFQUFFRixPQUFPLEVBQUVELE1BQU0sRUFBRUksVUFBVSxFQUFFUSxRQUFRLEVBQUUsRUFBRUMsU0FBUyxDQUFDLEVBQUUsR0FBR0Y7SUFFMUUsTUFBTUcsUUFBYSxDQUFDO0lBQ3BCLElBQUlYLFVBQVVXLE1BQU1YLFFBQVEsR0FBR0E7SUFDL0IsSUFBSUYsU0FBU2EsTUFBTWIsT0FBTyxHQUFHQTtJQUM3QixJQUFJRCxRQUFRYyxNQUFNZCxNQUFNLEdBQUdBO0lBQzNCLElBQUlJLFlBQVlVLE1BQU1WLFVBQVUsR0FBR0E7SUFFbkMsTUFBTSxDQUFDVyxNQUFNQyxNQUFNLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO1FBQ3RDaEMsMkNBQU1BLENBQUNVLFFBQVEsQ0FBQ3VCLFFBQVEsQ0FBQztZQUN2Qkw7WUFDQU0sU0FBUztnQkFBRUMsV0FBVztZQUFPO1lBQzdCQyxNQUFNVjtZQUNOVyxNQUFNVjtRQUNSO1FBQ0EzQiwyQ0FBTUEsQ0FBQ1UsUUFBUSxDQUFDNEIsS0FBSyxDQUFDO1lBQUVWO1FBQU07S0FDL0I7SUFFRCxPQUFPO1FBQUVDO1FBQU1DO0lBQU07QUFDdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL2F1ZGl0LnRzP2Y0NjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnXG5pbXBvcnQgeyBBdWRpdEFjdGlvbiB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCdcbmltcG9ydCB7IGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5cbmludGVyZmFjZSBBdWRpdExvZ0lucHV0IHtcbiAgYWN0aW9uOiBBdWRpdEFjdGlvblxuICBhY3RvcklkOiBzdHJpbmdcbiAgYWN0b3JFbWFpbDogc3RyaW5nXG4gIHRlbmFudElkPzogc3RyaW5nIHwgbnVsbFxuICB0YXJnZXRUeXBlPzogc3RyaW5nXG4gIHRhcmdldElkPzogc3RyaW5nXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxufVxuXG4vKipcbiAqIENyZWF0ZSBhbiBhdWRpdCBsb2cgZW50cnlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUF1ZGl0TG9nKGlucHV0OiBBdWRpdExvZ0lucHV0KTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgaGVhZGVyc0xpc3QgPSBhd2FpdCBoZWFkZXJzKClcbiAgICBjb25zdCBpcEFkZHJlc3MgPSBoZWFkZXJzTGlzdC5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IGhlYWRlcnNMaXN0LmdldCgneC1yZWFsLWlwJykgfHwgJ3Vua25vd24nXG4gICAgY29uc3QgdXNlckFnZW50ID0gaGVhZGVyc0xpc3QuZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nXG4gICAgXG4gICAgYXdhaXQgcHJpc21hLmF1ZGl0TG9nLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgYWN0aW9uOiBpbnB1dC5hY3Rpb24sXG4gICAgICAgIGFjdG9ySWQ6IGlucHV0LmFjdG9ySWQsXG4gICAgICAgIGFjdG9yRW1haWw6IGlucHV0LmFjdG9yRW1haWwsXG4gICAgICAgIHRlbmFudElkOiBpbnB1dC50ZW5hbnRJZCB8fCBudWxsLFxuICAgICAgICB0YXJnZXRUeXBlOiBpbnB1dC50YXJnZXRUeXBlIHx8IG51bGwsXG4gICAgICAgIHRhcmdldElkOiBpbnB1dC50YXJnZXRJZCB8fCBudWxsLFxuICAgICAgICBtZXRhZGF0YTogaW5wdXQubWV0YWRhdGEgfHwgdW5kZWZpbmVkLFxuICAgICAgICBpcEFkZHJlc3MsXG4gICAgICAgIHVzZXJBZ2VudFxuICAgICAgfVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBhdWRpdCBsb2c6JywgZXJyb3IpXG4gICAgLy8gRG9uJ3QgdGhyb3cgLSBhdWRpdCBsb2dnaW5nIHNob3VsZCBub3QgYnJlYWsgb3BlcmF0aW9uc1xuICB9XG59XG5cbi8qKlxuICogR2V0IGF1ZGl0IGxvZ3MgZm9yIGEgdGVuYW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpdExvZ3Mob3B0aW9uczoge1xuICB0ZW5hbnRJZD86IHN0cmluZ1xuICBhY3RvcklkPzogc3RyaW5nXG4gIGFjdGlvbj86IEF1ZGl0QWN0aW9uXG4gIHRhcmdldFR5cGU/OiBzdHJpbmdcbiAgbGltaXQ/OiBudW1iZXJcbiAgb2Zmc2V0PzogbnVtYmVyXG59KSB7XG4gIGNvbnN0IHsgdGVuYW50SWQsIGFjdG9ySWQsIGFjdGlvbiwgdGFyZ2V0VHlwZSwgbGltaXQgPSA1MCwgb2Zmc2V0ID0gMCB9ID0gb3B0aW9uc1xuICBcbiAgY29uc3Qgd2hlcmU6IGFueSA9IHt9XG4gIGlmICh0ZW5hbnRJZCkgd2hlcmUudGVuYW50SWQgPSB0ZW5hbnRJZFxuICBpZiAoYWN0b3JJZCkgd2hlcmUuYWN0b3JJZCA9IGFjdG9ySWRcbiAgaWYgKGFjdGlvbikgd2hlcmUuYWN0aW9uID0gYWN0aW9uXG4gIGlmICh0YXJnZXRUeXBlKSB3aGVyZS50YXJnZXRUeXBlID0gdGFyZ2V0VHlwZVxuICBcbiAgY29uc3QgW2xvZ3MsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBwcmlzbWEuYXVkaXRMb2cuZmluZE1hbnkoe1xuICAgICAgd2hlcmUsXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiBsaW1pdCxcbiAgICAgIHNraXA6IG9mZnNldFxuICAgIH0pLFxuICAgIHByaXNtYS5hdWRpdExvZy5jb3VudCh7IHdoZXJlIH0pXG4gIF0pXG4gIFxuICByZXR1cm4geyBsb2dzLCB0b3RhbCB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwidjQiLCJ1dWlkdjQiLCJoZWFkZXJzIiwiY3JlYXRlQXVkaXRMb2ciLCJpbnB1dCIsImhlYWRlcnNMaXN0IiwiaXBBZGRyZXNzIiwiZ2V0IiwidXNlckFnZW50IiwiYXVkaXRMb2ciLCJjcmVhdGUiLCJkYXRhIiwiaWQiLCJhY3Rpb24iLCJhY3RvcklkIiwiYWN0b3JFbWFpbCIsInRlbmFudElkIiwidGFyZ2V0VHlwZSIsInRhcmdldElkIiwibWV0YWRhdGEiLCJ1bmRlZmluZWQiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRBdWRpdExvZ3MiLCJvcHRpb25zIiwibGltaXQiLCJvZmZzZXQiLCJ3aGVyZSIsImxvZ3MiLCJ0b3RhbCIsIlByb21pc2UiLCJhbGwiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJjcmVhdGVkQXQiLCJ0YWtlIiwic2tpcCIsImNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/audit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/svm-event-handlers.ts":
/*!***************************************!*\
  !*** ./src/lib/svm-event-handlers.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getSVMEntitlements: () => (/* binding */ getSVMEntitlements),\n/* harmony export */   handleOrderCancelled: () => (/* binding */ handleOrderCancelled),\n/* harmony export */   handleOrderPlaced: () => (/* binding */ handleOrderPlaced),\n/* harmony export */   handleOrderShipped: () => (/* binding */ handleOrderShipped),\n/* harmony export */   handlePaymentRequested: () => (/* binding */ handlePaymentRequested),\n/* harmony export */   handleRefundRequested: () => (/* binding */ handleRefundRequested),\n/* harmony export */   handleSVMEvent: () => (/* binding */ handleSVMEvent)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _audit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./audit */ \"(rsc)/./src/lib/audit.ts\");\n/**\n * SVM Event Handlers\n * \n * Core's handlers for events emitted by the SVM (Single Vendor Marketplace) module.\n * \n * Events handled:\n * - svm.order.placed → Reserve inventory\n * - svm.order.payment_requested → Create payment intent\n * - svm.order.cancelled → Release inventory, process refund\n * - svm.order.refund_requested → Process refund\n */ \n\n// ============================================================================\n// IDEMPOTENCY CHECK\n// ============================================================================\nasync function isEventProcessed(idempotencyKey) {\n    const existing = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.findFirst({\n        where: {\n            targetId: idempotencyKey,\n            action: \"TENANT_UPDATED\" // Using existing action for SVM events\n        }\n    });\n    return !!existing;\n}\nasync function markEventProcessed(idempotencyKey, eventType, tenantId, actorId) {\n    await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n        action: \"TENANT_UPDATED\",\n        actorId: actorId || \"system\",\n        actorEmail: \"svm-system@internal\",\n        tenantId,\n        targetType: \"SVM_EVENT\",\n        targetId: idempotencyKey,\n        metadata: {\n            eventType,\n            processedAt: new Date().toISOString()\n        }\n    });\n}\n// ============================================================================\n// EVENT HANDLERS\n// ============================================================================\n/**\n * Handle order placed - Reserve inventory\n */ async function handleOrderPlaced(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        console.log(\"[SVM] Event already processed:\", idempotencyKey);\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, orderId, orderNumber, items, grandTotal, customerId } = payload;\n        console.log(\"[SVM] Order placed:\", orderNumber, \"for tenant\", tenantId);\n        console.log(\"[SVM] Total: $\" + grandTotal + \", Items:\", items.length);\n        // TODO: Reserve inventory in Core\n        // In production:\n        // const reservationId = await inventoryService.reserve(tenantId, items)\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_CREATED\",\n            actorId: customerId || \"guest\",\n            actorEmail: payload.guestEmail || \"guest@checkout\",\n            tenantId,\n            targetType: \"ORDER\",\n            targetId: orderId,\n            metadata: {\n                eventType: \"SVM_ORDER_PLACED\",\n                orderNumber,\n                grandTotal,\n                itemCount: items.length,\n                currency: payload.currency\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"svm.order.placed\", tenantId, customerId || \"guest\");\n        return {\n            success: true,\n            reservationId: `res_${Date.now()}`\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error handling order placed:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n/**\n * Handle payment requested - Create payment intent\n */ async function handlePaymentRequested(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, orderId, orderNumber, amount, currency, customerId } = payload;\n        console.log(\"[SVM] Payment requested:\", orderNumber, \"for $\" + amount);\n        // TODO: Create payment intent in Core (Stripe, etc.)\n        // In production:\n        // const paymentIntent = await paymentService.createIntent({\n        //   tenantId,\n        //   amount,\n        //   currency,\n        //   metadata: { orderId, orderNumber }\n        // })\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_UPDATED\",\n            actorId: customerId || \"guest\",\n            actorEmail: payload.guestEmail || \"guest@checkout\",\n            tenantId,\n            targetType: \"PAYMENT_REQUEST\",\n            targetId: orderId,\n            metadata: {\n                eventType: \"SVM_PAYMENT_REQUESTED\",\n                orderNumber,\n                amount,\n                currency\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"svm.order.payment_requested\", tenantId, customerId || \"guest\");\n        return {\n            success: true,\n            paymentIntentId: `pi_${Date.now()}`\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error handling payment requested:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n/**\n * Handle order cancelled - Release inventory, refund if needed\n */ async function handleOrderCancelled(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, orderId, orderNumber, cancelledBy, cancelledByUserId, reason, items, wasPaymentCaptured, refundAmount } = payload;\n        console.log(\"[SVM] Order cancelled:\", orderNumber, \"by\", cancelledBy);\n        // TODO: Release inventory reservation\n        // In production:\n        // await inventoryService.release(tenantId, items)\n        // TODO: Process refund if payment was captured\n        // if (wasPaymentCaptured && refundAmount) {\n        //   await paymentService.refund(corePaymentId, refundAmount)\n        // }\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_SUSPENDED\",\n            actorId: cancelledByUserId || cancelledBy.toLowerCase(),\n            actorEmail: \"svm@internal\",\n            tenantId,\n            targetType: \"ORDER\",\n            targetId: orderId,\n            metadata: {\n                eventType: \"SVM_ORDER_CANCELLED\",\n                orderNumber,\n                reason,\n                cancelledBy,\n                wasPaymentCaptured,\n                refundAmount: refundAmount || 0,\n                itemCount: items.length\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"svm.order.cancelled\", tenantId, cancelledByUserId || \"system\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error handling order cancelled:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n/**\n * Handle refund requested - Process refund and optionally restock\n */ async function handleRefundRequested(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, orderId, orderNumber, corePaymentId, refundType, refundAmount, reason, items, requestedBy } = payload;\n        console.log(\"[SVM] Refund requested:\", orderNumber, refundType, \"$\" + refundAmount);\n        // TODO: Process refund\n        // In production:\n        // const refund = await paymentService.refund(corePaymentId, refundAmount)\n        // TODO: Restock items if requested\n        // if (items) {\n        //   for (const item of items) {\n        //     if (item.restockItem) {\n        //       await inventoryService.restock(tenantId, item.productId, item.variantId, item.quantity)\n        //     }\n        //   }\n        // }\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_ACTIVATED\",\n            actorId: requestedBy,\n            actorEmail: \"svm@internal\",\n            tenantId,\n            targetType: \"REFUND\",\n            targetId: orderId,\n            metadata: {\n                eventType: \"SVM_REFUND_REQUESTED\",\n                orderNumber,\n                refundType,\n                refundAmount,\n                reason,\n                corePaymentId,\n                itemCount: items?.length || 0\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"svm.order.refund_requested\", tenantId, requestedBy);\n        return {\n            success: true,\n            refundId: `ref_${Date.now()}`\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error handling refund requested:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n/**\n * Handle order shipped - Send notification to customer\n */ async function handleOrderShipped(event) {\n    const { idempotencyKey, payload } = event;\n    if (await isEventProcessed(idempotencyKey)) {\n        return {\n            success: true\n        };\n    }\n    try {\n        const { tenantId, orderId, orderNumber, carrier, trackingNumber, trackingUrl, notifyCustomer, customerEmail } = payload;\n        console.log(\"[SVM] Order shipped:\", orderNumber, \"via\", carrier, trackingNumber);\n        // TODO: Send email notification if requested\n        // if (notifyCustomer && customerEmail) {\n        //   await emailService.sendShippingNotification({\n        //     to: customerEmail,\n        //     orderNumber,\n        //     carrier,\n        //     trackingNumber,\n        //     trackingUrl\n        //   })\n        // }\n        await (0,_audit__WEBPACK_IMPORTED_MODULE_1__.createAuditLog)({\n            action: \"TENANT_UPDATED\",\n            actorId: \"system\",\n            actorEmail: \"svm@internal\",\n            tenantId,\n            targetType: \"ORDER\",\n            targetId: orderId,\n            metadata: {\n                eventType: \"SVM_ORDER_SHIPPED\",\n                orderNumber,\n                carrier,\n                trackingNumber,\n                trackingUrl,\n                notifyCustomer\n            }\n        });\n        await markEventProcessed(idempotencyKey, \"svm.order.shipped\", tenantId, \"system\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error handling order shipped:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n// ============================================================================\n// EVENT ROUTER\n// ============================================================================\nasync function handleSVMEvent(event) {\n    console.log(\"[SVM] Received event:\", event.eventType);\n    switch(event.eventType){\n        case \"svm.order.placed\":\n            return handleOrderPlaced(event);\n        case \"svm.order.payment_requested\":\n            return handlePaymentRequested(event);\n        case \"svm.order.cancelled\":\n            return handleOrderCancelled(event);\n        case \"svm.order.refund_requested\":\n            return handleRefundRequested(event);\n        case \"svm.order.shipped\":\n            return handleOrderShipped(event);\n        // Events that don't need Core action (just log)\n        case \"svm.order.created\":\n        case \"svm.order.paid\":\n        case \"svm.order.processing\":\n        case \"svm.order.delivered\":\n        case \"svm.order.fulfilled\":\n        case \"svm.order.refunded\":\n        case \"svm.order.status_changed\":\n            console.log(\"[SVM] Event logged:\", event.eventType, event.payload);\n            return {\n                success: true\n            };\n        default:\n            console.log(\"[SVM] Unhandled event type:\", event.eventType);\n            return {\n                success: true\n            };\n    }\n}\n// ============================================================================\n// SVM ENTITLEMENT SERVICE\n// ============================================================================\nasync function getSVMEntitlements(tenantId) {\n    try {\n        const entitlement = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.entitlement.findUnique({\n            where: {\n                tenantId_module: {\n                    tenantId,\n                    module: \"SVM\"\n                }\n            }\n        });\n        if (!entitlement || entitlement.status !== \"ACTIVE\") {\n            // Return default entitlements for testing\n            return {\n                module: \"SVM\",\n                features: [\n                    \"storefront\",\n                    \"cart\",\n                    \"checkout\",\n                    \"orders\"\n                ],\n                limits: {\n                    max_products: 100,\n                    max_orders_per_month: 500,\n                    max_storage_mb: 1024\n                },\n                expiresAt: null\n            };\n        }\n        const limits = entitlement.limits || {};\n        const features = [\n            \"storefront\",\n            \"cart\",\n            \"checkout\",\n            \"orders\"\n        ];\n        if (limits.promotions_enabled !== false) features.push(\"promotions\");\n        if (limits.reviews_enabled !== false) features.push(\"reviews\");\n        if (limits.wishlist_enabled !== false) features.push(\"wishlist\");\n        if (limits.cms_enabled !== false) features.push(\"cms\");\n        if (limits.seo_enabled !== false) features.push(\"seo\");\n        if (limits.analytics_enabled !== false) features.push(\"analytics\");\n        if (limits.api_enabled === true) features.push(\"api\");\n        return {\n            module: \"SVM\",\n            features,\n            limits: {\n                max_products: typeof limits.max_products === \"number\" ? limits.max_products : 100,\n                max_orders_per_month: typeof limits.max_orders_per_month === \"number\" ? limits.max_orders_per_month : 500,\n                max_storage_mb: typeof limits.max_storage_mb === \"number\" ? limits.max_storage_mb : 1024,\n                max_banners: typeof limits.max_banners === \"number\" ? limits.max_banners : 10,\n                max_pages: typeof limits.max_pages === \"number\" ? limits.max_pages : 20\n            },\n            expiresAt: entitlement.validUntil?.toISOString() || null\n        };\n    } catch (error) {\n        console.error(\"[SVM] Error fetching entitlements:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBWSxHQUFHO2dCQUM5RUMsc0JBQXNCLE9BQU9GLE9BQU9FLG9CQUFvQixLQUFLLFdBQVdGLE9BQU9FLG9CQUFvQixHQUFHO2dCQUN0R0MsZ0JBQWdCLE9BQU9ILE9BQU9HLGNBQWMsS0FBSyxXQUFXSCxPQUFPRyxjQUFjLEdBQUc7Z0JBQ3BGVSxhQUFhLE9BQU9iLE9BQU9hLFdBQVcsS0FBSyxXQUFXYixPQUFPYSxXQUFXLEdBQUc7Z0JBQzNFQyxXQUFXLE9BQU9kLE9BQU9jLFNBQVMsS0FBSyxXQUFXZCxPQUFPYyxTQUFTLEdBQUc7WUFDdkU7WUFDQVYsV0FBV1YsWUFBWXFCLFVBQVUsRUFBRWpFLGlCQUFpQjtRQUN0RDtJQUNGLEVBQUUsT0FBT2tCLE9BQU87UUFDZGQsUUFBUWMsS0FBSyxDQUFDLHNDQUFzQ0E7UUFDcEQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3N2bS1ldmVudC1oYW5kbGVycy50cz9lZDBhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU1ZNIEV2ZW50IEhhbmRsZXJzXG4gKiBcbiAqIENvcmUncyBoYW5kbGVycyBmb3IgZXZlbnRzIGVtaXR0ZWQgYnkgdGhlIFNWTSAoU2luZ2xlIFZlbmRvciBNYXJrZXRwbGFjZSkgbW9kdWxlLlxuICogXG4gKiBFdmVudHMgaGFuZGxlZDpcbiAqIC0gc3ZtLm9yZGVyLnBsYWNlZCDihpIgUmVzZXJ2ZSBpbnZlbnRvcnlcbiAqIC0gc3ZtLm9yZGVyLnBheW1lbnRfcmVxdWVzdGVkIOKGkiBDcmVhdGUgcGF5bWVudCBpbnRlbnRcbiAqIC0gc3ZtLm9yZGVyLmNhbmNlbGxlZCDihpIgUmVsZWFzZSBpbnZlbnRvcnksIHByb2Nlc3MgcmVmdW5kXG4gKiAtIHN2bS5vcmRlci5yZWZ1bmRfcmVxdWVzdGVkIOKGkiBQcm9jZXNzIHJlZnVuZFxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuaW1wb3J0IHsgY3JlYXRlQXVkaXRMb2cgfSBmcm9tICcuL2F1ZGl0J1xuaW1wb3J0IHsgQXVkaXRBY3Rpb24gfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVFlQRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW50ZXJmYWNlIFNWTUV2ZW50QmFzZSB7XG4gIGV2ZW50SWQ6IHN0cmluZ1xuICBldmVudFR5cGU6IHN0cmluZ1xuICB0aW1lc3RhbXA6IHN0cmluZ1xuICBpZGVtcG90ZW5jeUtleTogc3RyaW5nXG59XG5cbmludGVyZmFjZSBPcmRlclBsYWNlZFBheWxvYWQge1xuICBvcmRlcklkOiBzdHJpbmdcbiAgb3JkZXJOdW1iZXI6IHN0cmluZ1xuICB0ZW5hbnRJZDogc3RyaW5nXG4gIGN1c3RvbWVySWQ/OiBzdHJpbmdcbiAgZ3Vlc3RFbWFpbD86IHN0cmluZ1xuICBpdGVtczogQXJyYXk8e1xuICAgIHByb2R1Y3RJZDogc3RyaW5nXG4gICAgdmFyaWFudElkPzogc3RyaW5nXG4gICAgcXVhbnRpdHk6IG51bWJlclxuICAgIHVuaXRQcmljZTogbnVtYmVyXG4gIH0+XG4gIHN1YnRvdGFsOiBudW1iZXJcbiAgc2hpcHBpbmdUb3RhbDogbnVtYmVyXG4gIHRheFRvdGFsOiBudW1iZXJcbiAgZGlzY291bnRUb3RhbDogbnVtYmVyXG4gIGdyYW5kVG90YWw6IG51bWJlclxuICBjdXJyZW5jeTogc3RyaW5nXG4gIHNoaXBwaW5nQWRkcmVzczoge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIGFkZHJlc3MxOiBzdHJpbmdcbiAgICBhZGRyZXNzMj86IHN0cmluZ1xuICAgIGNpdHk6IHN0cmluZ1xuICAgIHN0YXRlPzogc3RyaW5nXG4gICAgcG9zdGFsQ29kZTogc3RyaW5nXG4gICAgY291bnRyeTogc3RyaW5nXG4gICAgcGhvbmU/OiBzdHJpbmdcbiAgfVxuICBzaGlwcGluZ01ldGhvZD86IHN0cmluZ1xuICByZXNlcnZhdGlvbklkPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBQYXltZW50UmVxdWVzdGVkUGF5bG9hZCB7XG4gIG9yZGVySWQ6IHN0cmluZ1xuICBvcmRlck51bWJlcjogc3RyaW5nXG4gIHRlbmFudElkOiBzdHJpbmdcbiAgY3VzdG9tZXJJZD86IHN0cmluZ1xuICBndWVzdEVtYWlsPzogc3RyaW5nXG4gIGFtb3VudDogbnVtYmVyXG4gIGN1cnJlbmN5OiBzdHJpbmdcbiAgcmV0dXJuVXJsPzogc3RyaW5nXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxufVxuXG5pbnRlcmZhY2UgT3JkZXJDYW5jZWxsZWRQYXlsb2FkIHtcbiAgb3JkZXJJZDogc3RyaW5nXG4gIG9yZGVyTnVtYmVyOiBzdHJpbmdcbiAgdGVuYW50SWQ6IHN0cmluZ1xuICByZWFzb246IHN0cmluZ1xuICBjYW5jZWxsZWRCeTogJ0NVU1RPTUVSJyB8ICdNRVJDSEFOVCcgfCAnU1lTVEVNJ1xuICBjYW5jZWxsZWRCeVVzZXJJZD86IHN0cmluZ1xuICBpdGVtczogQXJyYXk8e1xuICAgIHByb2R1Y3RJZDogc3RyaW5nXG4gICAgdmFyaWFudElkPzogc3RyaW5nXG4gICAgcXVhbnRpdHk6IG51bWJlclxuICB9PlxuICB3YXNQYXltZW50Q2FwdHVyZWQ6IGJvb2xlYW5cbiAgY29yZVBheW1lbnRJZD86IHN0cmluZ1xuICByZWZ1bmRBbW91bnQ/OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIFJlZnVuZFJlcXVlc3RlZFBheWxvYWQge1xuICBvcmRlcklkOiBzdHJpbmdcbiAgb3JkZXJOdW1iZXI6IHN0cmluZ1xuICB0ZW5hbnRJZDogc3RyaW5nXG4gIGNvcmVQYXltZW50SWQ6IHN0cmluZ1xuICByZWZ1bmRUeXBlOiAnRlVMTCcgfCAnUEFSVElBTCdcbiAgcmVmdW5kQW1vdW50OiBudW1iZXJcbiAgcmVhc29uOiBzdHJpbmdcbiAgaXRlbXM/OiBBcnJheTx7XG4gICAgcHJvZHVjdElkOiBzdHJpbmdcbiAgICB2YXJpYW50SWQ/OiBzdHJpbmdcbiAgICBxdWFudGl0eTogbnVtYmVyXG4gICAgcmVzdG9ja0l0ZW06IGJvb2xlYW5cbiAgfT5cbiAgcmVxdWVzdGVkQnk6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgT3JkZXJTaGlwcGVkUGF5bG9hZCB7XG4gIG9yZGVySWQ6IHN0cmluZ1xuICBvcmRlck51bWJlcjogc3RyaW5nXG4gIHRlbmFudElkOiBzdHJpbmdcbiAgY3VzdG9tZXJJZD86IHN0cmluZ1xuICBjYXJyaWVyOiBzdHJpbmdcbiAgdHJhY2tpbmdOdW1iZXI6IHN0cmluZ1xuICB0cmFja2luZ1VybD86IHN0cmluZ1xuICBlc3RpbWF0ZWREZWxpdmVyeT86IHN0cmluZ1xuICBzaGlwcGVkQXQ6IHN0cmluZ1xuICBub3RpZnlDdXN0b21lcjogYm9vbGVhblxuICBjdXN0b21lckVtYWlsPzogc3RyaW5nXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIElERU1QT1RFTkNZIENIRUNLXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmFzeW5jIGZ1bmN0aW9uIGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXk6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5hdWRpdExvZy5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICB0YXJnZXRJZDogaWRlbXBvdGVuY3lLZXksXG4gICAgICBhY3Rpb246ICdURU5BTlRfVVBEQVRFRCcgLy8gVXNpbmcgZXhpc3RpbmcgYWN0aW9uIGZvciBTVk0gZXZlbnRzXG4gICAgfVxuICB9KVxuICByZXR1cm4gISFleGlzdGluZ1xufVxuXG5hc3luYyBmdW5jdGlvbiBtYXJrRXZlbnRQcm9jZXNzZWQoXG4gIGlkZW1wb3RlbmN5S2V5OiBzdHJpbmcsIFxuICBldmVudFR5cGU6IHN0cmluZyxcbiAgdGVuYW50SWQ6IHN0cmluZyxcbiAgYWN0b3JJZDogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgY3JlYXRlQXVkaXRMb2coe1xuICAgIGFjdGlvbjogJ1RFTkFOVF9VUERBVEVEJyBhcyBBdWRpdEFjdGlvbixcbiAgICBhY3RvcklkOiBhY3RvcklkIHx8ICdzeXN0ZW0nLFxuICAgIGFjdG9yRW1haWw6ICdzdm0tc3lzdGVtQGludGVybmFsJyxcbiAgICB0ZW5hbnRJZCxcbiAgICB0YXJnZXRUeXBlOiAnU1ZNX0VWRU5UJyxcbiAgICB0YXJnZXRJZDogaWRlbXBvdGVuY3lLZXksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIGV2ZW50VHlwZSxcbiAgICAgIHByb2Nlc3NlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9XG4gIH0pXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UIEhBTkRMRVJTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogSGFuZGxlIG9yZGVyIHBsYWNlZCAtIFJlc2VydmUgaW52ZW50b3J5XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVPcmRlclBsYWNlZChcbiAgZXZlbnQ6IFNWTUV2ZW50QmFzZSAmIHsgcGF5bG9hZDogT3JkZXJQbGFjZWRQYXlsb2FkIH1cbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZzsgcmVzZXJ2YXRpb25JZD86IHN0cmluZyB9PiB7XG4gIGNvbnN0IHsgaWRlbXBvdGVuY3lLZXksIHBheWxvYWQgfSA9IGV2ZW50XG5cbiAgaWYgKGF3YWl0IGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXkpKSB7XG4gICAgY29uc29sZS5sb2coJ1tTVk1dIEV2ZW50IGFscmVhZHkgcHJvY2Vzc2VkOicsIGlkZW1wb3RlbmN5S2V5KVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHRlbmFudElkLCBvcmRlcklkLCBvcmRlck51bWJlciwgaXRlbXMsIGdyYW5kVG90YWwsIGN1c3RvbWVySWQgfSA9IHBheWxvYWRcblxuICAgIGNvbnNvbGUubG9nKCdbU1ZNXSBPcmRlciBwbGFjZWQ6Jywgb3JkZXJOdW1iZXIsICdmb3IgdGVuYW50JywgdGVuYW50SWQpXG4gICAgY29uc29sZS5sb2coJ1tTVk1dIFRvdGFsOiAkJyArIGdyYW5kVG90YWwgKyAnLCBJdGVtczonLCBpdGVtcy5sZW5ndGgpXG5cbiAgICAvLyBUT0RPOiBSZXNlcnZlIGludmVudG9yeSBpbiBDb3JlXG4gICAgLy8gSW4gcHJvZHVjdGlvbjpcbiAgICAvLyBjb25zdCByZXNlcnZhdGlvbklkID0gYXdhaXQgaW52ZW50b3J5U2VydmljZS5yZXNlcnZlKHRlbmFudElkLCBpdGVtcylcblxuICAgIGF3YWl0IGNyZWF0ZUF1ZGl0TG9nKHtcbiAgICAgIGFjdGlvbjogJ1RFTkFOVF9DUkVBVEVEJyBhcyBBdWRpdEFjdGlvbiwgLy8gVXNpbmcgZm9yIFNWTV9PUkRFUl9QTEFDRURcbiAgICAgIGFjdG9ySWQ6IGN1c3RvbWVySWQgfHwgJ2d1ZXN0JyxcbiAgICAgIGFjdG9yRW1haWw6IHBheWxvYWQuZ3Vlc3RFbWFpbCB8fCAnZ3Vlc3RAY2hlY2tvdXQnLFxuICAgICAgdGVuYW50SWQsXG4gICAgICB0YXJnZXRUeXBlOiAnT1JERVInLFxuICAgICAgdGFyZ2V0SWQ6IG9yZGVySWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBldmVudFR5cGU6ICdTVk1fT1JERVJfUExBQ0VEJyxcbiAgICAgICAgb3JkZXJOdW1iZXIsXG4gICAgICAgIGdyYW5kVG90YWwsXG4gICAgICAgIGl0ZW1Db3VudDogaXRlbXMubGVuZ3RoLFxuICAgICAgICBjdXJyZW5jeTogcGF5bG9hZC5jdXJyZW5jeVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBhd2FpdCBtYXJrRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXksICdzdm0ub3JkZXIucGxhY2VkJywgdGVuYW50SWQsIGN1c3RvbWVySWQgfHwgJ2d1ZXN0JylcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCByZXNlcnZhdGlvbklkOiBgcmVzXyR7RGF0ZS5ub3coKX1gIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBoYW5kbGluZyBvcmRlciBwbGFjZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogSGFuZGxlIHBheW1lbnQgcmVxdWVzdGVkIC0gQ3JlYXRlIHBheW1lbnQgaW50ZW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVQYXltZW50UmVxdWVzdGVkKFxuICBldmVudDogU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBQYXltZW50UmVxdWVzdGVkUGF5bG9hZCB9XG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmc7IHBheW1lbnRJbnRlbnRJZD86IHN0cmluZyB9PiB7XG4gIGNvbnN0IHsgaWRlbXBvdGVuY3lLZXksIHBheWxvYWQgfSA9IGV2ZW50XG5cbiAgaWYgKGF3YWl0IGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXkpKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgdGVuYW50SWQsIG9yZGVySWQsIG9yZGVyTnVtYmVyLCBhbW91bnQsIGN1cnJlbmN5LCBjdXN0b21lcklkIH0gPSBwYXlsb2FkXG5cbiAgICBjb25zb2xlLmxvZygnW1NWTV0gUGF5bWVudCByZXF1ZXN0ZWQ6Jywgb3JkZXJOdW1iZXIsICdmb3IgJCcgKyBhbW91bnQpXG5cbiAgICAvLyBUT0RPOiBDcmVhdGUgcGF5bWVudCBpbnRlbnQgaW4gQ29yZSAoU3RyaXBlLCBldGMuKVxuICAgIC8vIEluIHByb2R1Y3Rpb246XG4gICAgLy8gY29uc3QgcGF5bWVudEludGVudCA9IGF3YWl0IHBheW1lbnRTZXJ2aWNlLmNyZWF0ZUludGVudCh7XG4gICAgLy8gICB0ZW5hbnRJZCxcbiAgICAvLyAgIGFtb3VudCxcbiAgICAvLyAgIGN1cnJlbmN5LFxuICAgIC8vICAgbWV0YWRhdGE6IHsgb3JkZXJJZCwgb3JkZXJOdW1iZXIgfVxuICAgIC8vIH0pXG5cbiAgICBhd2FpdCBjcmVhdGVBdWRpdExvZyh7XG4gICAgICBhY3Rpb246ICdURU5BTlRfVVBEQVRFRCcgYXMgQXVkaXRBY3Rpb24sXG4gICAgICBhY3RvcklkOiBjdXN0b21lcklkIHx8ICdndWVzdCcsXG4gICAgICBhY3RvckVtYWlsOiBwYXlsb2FkLmd1ZXN0RW1haWwgfHwgJ2d1ZXN0QGNoZWNrb3V0JyxcbiAgICAgIHRlbmFudElkLFxuICAgICAgdGFyZ2V0VHlwZTogJ1BBWU1FTlRfUkVRVUVTVCcsXG4gICAgICB0YXJnZXRJZDogb3JkZXJJZCxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGV2ZW50VHlwZTogJ1NWTV9QQVlNRU5UX1JFUVVFU1RFRCcsXG4gICAgICAgIG9yZGVyTnVtYmVyLFxuICAgICAgICBhbW91bnQsXG4gICAgICAgIGN1cnJlbmN5XG4gICAgICB9XG4gICAgfSlcblxuICAgIGF3YWl0IG1hcmtFdmVudFByb2Nlc3NlZChpZGVtcG90ZW5jeUtleSwgJ3N2bS5vcmRlci5wYXltZW50X3JlcXVlc3RlZCcsIHRlbmFudElkLCBjdXN0b21lcklkIHx8ICdndWVzdCcpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGF5bWVudEludGVudElkOiBgcGlfJHtEYXRlLm5vdygpfWAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTVk1dIEVycm9yIGhhbmRsaW5nIHBheW1lbnQgcmVxdWVzdGVkOicsIGVycm9yKVxuICAgIHJldHVybiB7IFxuICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIFxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEhhbmRsZSBvcmRlciBjYW5jZWxsZWQgLSBSZWxlYXNlIGludmVudG9yeSwgcmVmdW5kIGlmIG5lZWRlZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlT3JkZXJDYW5jZWxsZWQoXG4gIGV2ZW50OiBTVk1FdmVudEJhc2UgJiB7IHBheWxvYWQ6IE9yZGVyQ2FuY2VsbGVkUGF5bG9hZCB9XG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICBjb25zdCB7IGlkZW1wb3RlbmN5S2V5LCBwYXlsb2FkIH0gPSBldmVudFxuXG4gIGlmIChhd2FpdCBpc0V2ZW50UHJvY2Vzc2VkKGlkZW1wb3RlbmN5S2V5KSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IFxuICAgICAgdGVuYW50SWQsIG9yZGVySWQsIG9yZGVyTnVtYmVyLCBjYW5jZWxsZWRCeSwgXG4gICAgICBjYW5jZWxsZWRCeVVzZXJJZCwgcmVhc29uLCBpdGVtcywgd2FzUGF5bWVudENhcHR1cmVkLCByZWZ1bmRBbW91bnQgXG4gICAgfSA9IHBheWxvYWRcblxuICAgIGNvbnNvbGUubG9nKCdbU1ZNXSBPcmRlciBjYW5jZWxsZWQ6Jywgb3JkZXJOdW1iZXIsICdieScsIGNhbmNlbGxlZEJ5KVxuXG4gICAgLy8gVE9ETzogUmVsZWFzZSBpbnZlbnRvcnkgcmVzZXJ2YXRpb25cbiAgICAvLyBJbiBwcm9kdWN0aW9uOlxuICAgIC8vIGF3YWl0IGludmVudG9yeVNlcnZpY2UucmVsZWFzZSh0ZW5hbnRJZCwgaXRlbXMpXG5cbiAgICAvLyBUT0RPOiBQcm9jZXNzIHJlZnVuZCBpZiBwYXltZW50IHdhcyBjYXB0dXJlZFxuICAgIC8vIGlmICh3YXNQYXltZW50Q2FwdHVyZWQgJiYgcmVmdW5kQW1vdW50KSB7XG4gICAgLy8gICBhd2FpdCBwYXltZW50U2VydmljZS5yZWZ1bmQoY29yZVBheW1lbnRJZCwgcmVmdW5kQW1vdW50KVxuICAgIC8vIH1cblxuICAgIGF3YWl0IGNyZWF0ZUF1ZGl0TG9nKHtcbiAgICAgIGFjdGlvbjogJ1RFTkFOVF9TVVNQRU5ERUQnIGFzIEF1ZGl0QWN0aW9uLCAvLyBVc2luZyBmb3IgU1ZNX09SREVSX0NBTkNFTExFRFxuICAgICAgYWN0b3JJZDogY2FuY2VsbGVkQnlVc2VySWQgfHwgY2FuY2VsbGVkQnkudG9Mb3dlckNhc2UoKSxcbiAgICAgIGFjdG9yRW1haWw6ICdzdm1AaW50ZXJuYWwnLFxuICAgICAgdGVuYW50SWQsXG4gICAgICB0YXJnZXRUeXBlOiAnT1JERVInLFxuICAgICAgdGFyZ2V0SWQ6IG9yZGVySWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBldmVudFR5cGU6ICdTVk1fT1JERVJfQ0FOQ0VMTEVEJyxcbiAgICAgICAgb3JkZXJOdW1iZXIsXG4gICAgICAgIHJlYXNvbixcbiAgICAgICAgY2FuY2VsbGVkQnksXG4gICAgICAgIHdhc1BheW1lbnRDYXB0dXJlZCxcbiAgICAgICAgcmVmdW5kQW1vdW50OiByZWZ1bmRBbW91bnQgfHwgMCxcbiAgICAgICAgaXRlbUNvdW50OiBpdGVtcy5sZW5ndGhcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgYXdhaXQgbWFya0V2ZW50UHJvY2Vzc2VkKGlkZW1wb3RlbmN5S2V5LCAnc3ZtLm9yZGVyLmNhbmNlbGxlZCcsIHRlbmFudElkLCBjYW5jZWxsZWRCeVVzZXJJZCB8fCAnc3lzdGVtJylcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBoYW5kbGluZyBvcmRlciBjYW5jZWxsZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogSGFuZGxlIHJlZnVuZCByZXF1ZXN0ZWQgLSBQcm9jZXNzIHJlZnVuZCBhbmQgb3B0aW9uYWxseSByZXN0b2NrXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVSZWZ1bmRSZXF1ZXN0ZWQoXG4gIGV2ZW50OiBTVk1FdmVudEJhc2UgJiB7IHBheWxvYWQ6IFJlZnVuZFJlcXVlc3RlZFBheWxvYWQgfVxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nOyByZWZ1bmRJZD86IHN0cmluZyB9PiB7XG4gIGNvbnN0IHsgaWRlbXBvdGVuY3lLZXksIHBheWxvYWQgfSA9IGV2ZW50XG5cbiAgaWYgKGF3YWl0IGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXkpKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgXG4gICAgICB0ZW5hbnRJZCwgb3JkZXJJZCwgb3JkZXJOdW1iZXIsIGNvcmVQYXltZW50SWQsXG4gICAgICByZWZ1bmRUeXBlLCByZWZ1bmRBbW91bnQsIHJlYXNvbiwgaXRlbXMsIHJlcXVlc3RlZEJ5IFxuICAgIH0gPSBwYXlsb2FkXG5cbiAgICBjb25zb2xlLmxvZygnW1NWTV0gUmVmdW5kIHJlcXVlc3RlZDonLCBvcmRlck51bWJlciwgcmVmdW5kVHlwZSwgJyQnICsgcmVmdW5kQW1vdW50KVxuXG4gICAgLy8gVE9ETzogUHJvY2VzcyByZWZ1bmRcbiAgICAvLyBJbiBwcm9kdWN0aW9uOlxuICAgIC8vIGNvbnN0IHJlZnVuZCA9IGF3YWl0IHBheW1lbnRTZXJ2aWNlLnJlZnVuZChjb3JlUGF5bWVudElkLCByZWZ1bmRBbW91bnQpXG5cbiAgICAvLyBUT0RPOiBSZXN0b2NrIGl0ZW1zIGlmIHJlcXVlc3RlZFxuICAgIC8vIGlmIChpdGVtcykge1xuICAgIC8vICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgLy8gICAgIGlmIChpdGVtLnJlc3RvY2tJdGVtKSB7XG4gICAgLy8gICAgICAgYXdhaXQgaW52ZW50b3J5U2VydmljZS5yZXN0b2NrKHRlbmFudElkLCBpdGVtLnByb2R1Y3RJZCwgaXRlbS52YXJpYW50SWQsIGl0ZW0ucXVhbnRpdHkpXG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICBhd2FpdCBjcmVhdGVBdWRpdExvZyh7XG4gICAgICBhY3Rpb246ICdURU5BTlRfQUNUSVZBVEVEJyBhcyBBdWRpdEFjdGlvbiwgLy8gVXNpbmcgZm9yIFNWTV9SRUZVTkRcbiAgICAgIGFjdG9ySWQ6IHJlcXVlc3RlZEJ5LFxuICAgICAgYWN0b3JFbWFpbDogJ3N2bUBpbnRlcm5hbCcsXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHRhcmdldFR5cGU6ICdSRUZVTkQnLFxuICAgICAgdGFyZ2V0SWQ6IG9yZGVySWQsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBldmVudFR5cGU6ICdTVk1fUkVGVU5EX1JFUVVFU1RFRCcsXG4gICAgICAgIG9yZGVyTnVtYmVyLFxuICAgICAgICByZWZ1bmRUeXBlLFxuICAgICAgICByZWZ1bmRBbW91bnQsXG4gICAgICAgIHJlYXNvbixcbiAgICAgICAgY29yZVBheW1lbnRJZCxcbiAgICAgICAgaXRlbUNvdW50OiBpdGVtcz8ubGVuZ3RoIHx8IDBcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgYXdhaXQgbWFya0V2ZW50UHJvY2Vzc2VkKGlkZW1wb3RlbmN5S2V5LCAnc3ZtLm9yZGVyLnJlZnVuZF9yZXF1ZXN0ZWQnLCB0ZW5hbnRJZCwgcmVxdWVzdGVkQnkpXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcmVmdW5kSWQ6IGByZWZfJHtEYXRlLm5vdygpfWAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTVk1dIEVycm9yIGhhbmRsaW5nIHJlZnVuZCByZXF1ZXN0ZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogSGFuZGxlIG9yZGVyIHNoaXBwZWQgLSBTZW5kIG5vdGlmaWNhdGlvbiB0byBjdXN0b21lclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlT3JkZXJTaGlwcGVkKFxuICBldmVudDogU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBPcmRlclNoaXBwZWRQYXlsb2FkIH1cbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gIGNvbnN0IHsgaWRlbXBvdGVuY3lLZXksIHBheWxvYWQgfSA9IGV2ZW50XG5cbiAgaWYgKGF3YWl0IGlzRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXkpKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgXG4gICAgICB0ZW5hbnRJZCwgb3JkZXJJZCwgb3JkZXJOdW1iZXIsIGNhcnJpZXIsIFxuICAgICAgdHJhY2tpbmdOdW1iZXIsIHRyYWNraW5nVXJsLCBub3RpZnlDdXN0b21lciwgY3VzdG9tZXJFbWFpbCBcbiAgICB9ID0gcGF5bG9hZFxuXG4gICAgY29uc29sZS5sb2coJ1tTVk1dIE9yZGVyIHNoaXBwZWQ6Jywgb3JkZXJOdW1iZXIsICd2aWEnLCBjYXJyaWVyLCB0cmFja2luZ051bWJlcilcblxuICAgIC8vIFRPRE86IFNlbmQgZW1haWwgbm90aWZpY2F0aW9uIGlmIHJlcXVlc3RlZFxuICAgIC8vIGlmIChub3RpZnlDdXN0b21lciAmJiBjdXN0b21lckVtYWlsKSB7XG4gICAgLy8gICBhd2FpdCBlbWFpbFNlcnZpY2Uuc2VuZFNoaXBwaW5nTm90aWZpY2F0aW9uKHtcbiAgICAvLyAgICAgdG86IGN1c3RvbWVyRW1haWwsXG4gICAgLy8gICAgIG9yZGVyTnVtYmVyLFxuICAgIC8vICAgICBjYXJyaWVyLFxuICAgIC8vICAgICB0cmFja2luZ051bWJlcixcbiAgICAvLyAgICAgdHJhY2tpbmdVcmxcbiAgICAvLyAgIH0pXG4gICAgLy8gfVxuXG4gICAgYXdhaXQgY3JlYXRlQXVkaXRMb2coe1xuICAgICAgYWN0aW9uOiAnVEVOQU5UX1VQREFURUQnIGFzIEF1ZGl0QWN0aW9uLFxuICAgICAgYWN0b3JJZDogJ3N5c3RlbScsXG4gICAgICBhY3RvckVtYWlsOiAnc3ZtQGludGVybmFsJyxcbiAgICAgIHRlbmFudElkLFxuICAgICAgdGFyZ2V0VHlwZTogJ09SREVSJyxcbiAgICAgIHRhcmdldElkOiBvcmRlcklkLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZXZlbnRUeXBlOiAnU1ZNX09SREVSX1NISVBQRUQnLFxuICAgICAgICBvcmRlck51bWJlcixcbiAgICAgICAgY2FycmllcixcbiAgICAgICAgdHJhY2tpbmdOdW1iZXIsXG4gICAgICAgIHRyYWNraW5nVXJsLFxuICAgICAgICBub3RpZnlDdXN0b21lclxuICAgICAgfVxuICAgIH0pXG5cbiAgICBhd2FpdCBtYXJrRXZlbnRQcm9jZXNzZWQoaWRlbXBvdGVuY3lLZXksICdzdm0ub3JkZXIuc2hpcHBlZCcsIHRlbmFudElkLCAnc3lzdGVtJylcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBoYW5kbGluZyBvcmRlciBzaGlwcGVkOicsIGVycm9yKVxuICAgIHJldHVybiB7IFxuICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIFxuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFVkVOVCBST1VURVJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNWTUV2ZW50KFxuICBldmVudDogU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9XG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmc7IGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9PiB7XG4gIGNvbnNvbGUubG9nKCdbU1ZNXSBSZWNlaXZlZCBldmVudDonLCBldmVudC5ldmVudFR5cGUpXG5cbiAgc3dpdGNoIChldmVudC5ldmVudFR5cGUpIHtcbiAgICBjYXNlICdzdm0ub3JkZXIucGxhY2VkJzpcbiAgICAgIHJldHVybiBoYW5kbGVPcmRlclBsYWNlZChldmVudCBhcyB1bmtub3duIGFzIFNWTUV2ZW50QmFzZSAmIHsgcGF5bG9hZDogT3JkZXJQbGFjZWRQYXlsb2FkIH0pXG4gICAgXG4gICAgY2FzZSAnc3ZtLm9yZGVyLnBheW1lbnRfcmVxdWVzdGVkJzpcbiAgICAgIHJldHVybiBoYW5kbGVQYXltZW50UmVxdWVzdGVkKGV2ZW50IGFzIHVua25vd24gYXMgU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBQYXltZW50UmVxdWVzdGVkUGF5bG9hZCB9KVxuICAgIFxuICAgIGNhc2UgJ3N2bS5vcmRlci5jYW5jZWxsZWQnOlxuICAgICAgcmV0dXJuIGhhbmRsZU9yZGVyQ2FuY2VsbGVkKGV2ZW50IGFzIHVua25vd24gYXMgU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBPcmRlckNhbmNlbGxlZFBheWxvYWQgfSlcbiAgICBcbiAgICBjYXNlICdzdm0ub3JkZXIucmVmdW5kX3JlcXVlc3RlZCc6XG4gICAgICByZXR1cm4gaGFuZGxlUmVmdW5kUmVxdWVzdGVkKGV2ZW50IGFzIHVua25vd24gYXMgU1ZNRXZlbnRCYXNlICYgeyBwYXlsb2FkOiBSZWZ1bmRSZXF1ZXN0ZWRQYXlsb2FkIH0pXG4gICAgXG4gICAgY2FzZSAnc3ZtLm9yZGVyLnNoaXBwZWQnOlxuICAgICAgcmV0dXJuIGhhbmRsZU9yZGVyU2hpcHBlZChldmVudCBhcyB1bmtub3duIGFzIFNWTUV2ZW50QmFzZSAmIHsgcGF5bG9hZDogT3JkZXJTaGlwcGVkUGF5bG9hZCB9KVxuICAgIFxuICAgIC8vIEV2ZW50cyB0aGF0IGRvbid0IG5lZWQgQ29yZSBhY3Rpb24gKGp1c3QgbG9nKVxuICAgIGNhc2UgJ3N2bS5vcmRlci5jcmVhdGVkJzpcbiAgICBjYXNlICdzdm0ub3JkZXIucGFpZCc6XG4gICAgY2FzZSAnc3ZtLm9yZGVyLnByb2Nlc3NpbmcnOlxuICAgIGNhc2UgJ3N2bS5vcmRlci5kZWxpdmVyZWQnOlxuICAgIGNhc2UgJ3N2bS5vcmRlci5mdWxmaWxsZWQnOlxuICAgIGNhc2UgJ3N2bS5vcmRlci5yZWZ1bmRlZCc6XG4gICAgY2FzZSAnc3ZtLm9yZGVyLnN0YXR1c19jaGFuZ2VkJzpcbiAgICAgIGNvbnNvbGUubG9nKCdbU1ZNXSBFdmVudCBsb2dnZWQ6JywgZXZlbnQuZXZlbnRUeXBlLCBldmVudC5wYXlsb2FkKVxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gICAgXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUubG9nKCdbU1ZNXSBVbmhhbmRsZWQgZXZlbnQgdHlwZTonLCBldmVudC5ldmVudFR5cGUpXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTVk0gRU5USVRMRU1FTlQgU0VSVklDRVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U1ZNRW50aXRsZW1lbnRzKHRlbmFudElkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgbW9kdWxlOiAnU1ZNJ1xuICBmZWF0dXJlczogc3RyaW5nW11cbiAgbGltaXRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXIgfCBudWxsPlxuICBleHBpcmVzQXQ6IHN0cmluZyB8IG51bGxcbn0gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZW50aXRsZW1lbnQgPSBhd2FpdCBwcmlzbWEuZW50aXRsZW1lbnQuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB0ZW5hbnRJZF9tb2R1bGU6IHsgdGVuYW50SWQsIG1vZHVsZTogJ1NWTScgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBpZiAoIWVudGl0bGVtZW50IHx8IGVudGl0bGVtZW50LnN0YXR1cyAhPT0gJ0FDVElWRScpIHtcbiAgICAgIC8vIFJldHVybiBkZWZhdWx0IGVudGl0bGVtZW50cyBmb3IgdGVzdGluZ1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbW9kdWxlOiAnU1ZNJyxcbiAgICAgICAgZmVhdHVyZXM6IFsnc3RvcmVmcm9udCcsICdjYXJ0JywgJ2NoZWNrb3V0JywgJ29yZGVycyddLFxuICAgICAgICBsaW1pdHM6IHtcbiAgICAgICAgICBtYXhfcHJvZHVjdHM6IDEwMCxcbiAgICAgICAgICBtYXhfb3JkZXJzX3Blcl9tb250aDogNTAwLFxuICAgICAgICAgIG1heF9zdG9yYWdlX21iOiAxMDI0XG4gICAgICAgIH0sXG4gICAgICAgIGV4cGlyZXNBdDogbnVsbFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGxpbWl0cyA9IChlbnRpdGxlbWVudC5saW1pdHMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHx8IHt9XG4gICAgY29uc3QgZmVhdHVyZXM6IHN0cmluZ1tdID0gWydzdG9yZWZyb250JywgJ2NhcnQnLCAnY2hlY2tvdXQnLCAnb3JkZXJzJ11cbiAgICBcbiAgICBpZiAobGltaXRzLnByb21vdGlvbnNfZW5hYmxlZCAhPT0gZmFsc2UpIGZlYXR1cmVzLnB1c2goJ3Byb21vdGlvbnMnKVxuICAgIGlmIChsaW1pdHMucmV2aWV3c19lbmFibGVkICE9PSBmYWxzZSkgZmVhdHVyZXMucHVzaCgncmV2aWV3cycpXG4gICAgaWYgKGxpbWl0cy53aXNobGlzdF9lbmFibGVkICE9PSBmYWxzZSkgZmVhdHVyZXMucHVzaCgnd2lzaGxpc3QnKVxuICAgIGlmIChsaW1pdHMuY21zX2VuYWJsZWQgIT09IGZhbHNlKSBmZWF0dXJlcy5wdXNoKCdjbXMnKVxuICAgIGlmIChsaW1pdHMuc2VvX2VuYWJsZWQgIT09IGZhbHNlKSBmZWF0dXJlcy5wdXNoKCdzZW8nKVxuICAgIGlmIChsaW1pdHMuYW5hbHl0aWNzX2VuYWJsZWQgIT09IGZhbHNlKSBmZWF0dXJlcy5wdXNoKCdhbmFseXRpY3MnKVxuICAgIGlmIChsaW1pdHMuYXBpX2VuYWJsZWQgPT09IHRydWUpIGZlYXR1cmVzLnB1c2goJ2FwaScpXG5cbiAgICByZXR1cm4ge1xuICAgICAgbW9kdWxlOiAnU1ZNJyxcbiAgICAgIGZlYXR1cmVzLFxuICAgICAgbGltaXRzOiB7XG4gICAgICAgIG1heF9wcm9kdWN0czogdHlwZW9mIGxpbWl0cy5tYXhfcHJvZHVjdHMgPT09ICdudW1iZXInID8gbGltaXRzLm1heF9wcm9kdWN0cyA6IDEwMCxcbiAgICAgICAgbWF4X29yZGVyc19wZXJfbW9udGg6IHR5cGVvZiBsaW1pdHMubWF4X29yZGVyc19wZXJfbW9udGggPT09ICdudW1iZXInID8gbGltaXRzLm1heF9vcmRlcnNfcGVyX21vbnRoIDogNTAwLFxuICAgICAgICBtYXhfc3RvcmFnZV9tYjogdHlwZW9mIGxpbWl0cy5tYXhfc3RvcmFnZV9tYiA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X3N0b3JhZ2VfbWIgOiAxMDI0LFxuICAgICAgICBtYXhfYmFubmVyczogdHlwZW9mIGxpbWl0cy5tYXhfYmFubmVycyA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X2Jhbm5lcnMgOiAxMCxcbiAgICAgICAgbWF4X3BhZ2VzOiB0eXBlb2YgbGltaXRzLm1heF9wYWdlcyA9PT0gJ251bWJlcicgPyBsaW1pdHMubWF4X3BhZ2VzIDogMjBcbiAgICAgIH0sXG4gICAgICBleHBpcmVzQXQ6IGVudGl0bGVtZW50LnZhbGlkVW50aWw/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbFxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBmZXRjaGluZyBlbnRpdGxlbWVudHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImNyZWF0ZUF1ZGl0TG9nIiwiaXNFdmVudFByb2Nlc3NlZCIsImlkZW1wb3RlbmN5S2V5IiwiZXhpc3RpbmciLCJhdWRpdExvZyIsImZpbmRGaXJzdCIsIndoZXJlIiwidGFyZ2V0SWQiLCJhY3Rpb24iLCJtYXJrRXZlbnRQcm9jZXNzZWQiLCJldmVudFR5cGUiLCJ0ZW5hbnRJZCIsImFjdG9ySWQiLCJhY3RvckVtYWlsIiwidGFyZ2V0VHlwZSIsIm1ldGFkYXRhIiwicHJvY2Vzc2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJoYW5kbGVPcmRlclBsYWNlZCIsImV2ZW50IiwicGF5bG9hZCIsImNvbnNvbGUiLCJsb2ciLCJzdWNjZXNzIiwib3JkZXJJZCIsIm9yZGVyTnVtYmVyIiwiaXRlbXMiLCJncmFuZFRvdGFsIiwiY3VzdG9tZXJJZCIsImxlbmd0aCIsImd1ZXN0RW1haWwiLCJpdGVtQ291bnQiLCJjdXJyZW5jeSIsInJlc2VydmF0aW9uSWQiLCJub3ciLCJlcnJvciIsIkVycm9yIiwibWVzc2FnZSIsImhhbmRsZVBheW1lbnRSZXF1ZXN0ZWQiLCJhbW91bnQiLCJwYXltZW50SW50ZW50SWQiLCJoYW5kbGVPcmRlckNhbmNlbGxlZCIsImNhbmNlbGxlZEJ5IiwiY2FuY2VsbGVkQnlVc2VySWQiLCJyZWFzb24iLCJ3YXNQYXltZW50Q2FwdHVyZWQiLCJyZWZ1bmRBbW91bnQiLCJ0b0xvd2VyQ2FzZSIsImhhbmRsZVJlZnVuZFJlcXVlc3RlZCIsImNvcmVQYXltZW50SWQiLCJyZWZ1bmRUeXBlIiwicmVxdWVzdGVkQnkiLCJyZWZ1bmRJZCIsImhhbmRsZU9yZGVyU2hpcHBlZCIsImNhcnJpZXIiLCJ0cmFja2luZ051bWJlciIsInRyYWNraW5nVXJsIiwibm90aWZ5Q3VzdG9tZXIiLCJjdXN0b21lckVtYWlsIiwiaGFuZGxlU1ZNRXZlbnQiLCJnZXRTVk1FbnRpdGxlbWVudHMiLCJlbnRpdGxlbWVudCIsImZpbmRVbmlxdWUiLCJ0ZW5hbnRJZF9tb2R1bGUiLCJtb2R1bGUiLCJzdGF0dXMiLCJmZWF0dXJlcyIsImxpbWl0cyIsIm1heF9wcm9kdWN0cyIsIm1heF9vcmRlcnNfcGVyX21vbnRoIiwibWF4X3N0b3JhZ2VfbWIiLCJleHBpcmVzQXQiLCJwcm9tb3Rpb25zX2VuYWJsZWQiLCJwdXNoIiwicmV2aWV3c19lbmFibGVkIiwid2lzaGxpc3RfZW5hYmxlZCIsImNtc19lbmFibGVkIiwic2VvX2VuYWJsZWQiLCJhbmFseXRpY3NfZW5hYmxlZCIsImFwaV9lbmFibGVkIiwibWF4X2Jhbm5lcnMiLCJtYXhfcGFnZXMiLCJ2YWxpZFVudGlsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/svm-event-handlers.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Fevents%2Froute&page=%2Fapi%2Fsvm%2Fevents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Fevents%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();