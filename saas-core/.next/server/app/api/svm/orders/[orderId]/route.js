"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/svm/orders/[orderId]/route";
exports.ids = ["app/api/svm/orders/[orderId]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&page=%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&page=%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_svm_orders_orderId_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/svm/orders/[orderId]/route.ts */ \"(rsc)/./src/app/api/svm/orders/[orderId]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/svm/orders/[orderId]/route\",\n        pathname: \"/api/svm/orders/[orderId]\",\n        filename: \"route\",\n        bundlePath: \"app/api/svm/orders/[orderId]/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/svm/orders/[orderId]/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_svm_orders_orderId_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/svm/orders/[orderId]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdm0lMkZvcmRlcnMlMkYlNUJvcmRlcklkJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzdm0lMkZvcmRlcnMlMkYlNUJvcmRlcklkJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc3ZtJTJGb3JkZXJzJTJGJTVCb3JkZXJJZCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/NDc5MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9zdm0vb3JkZXJzL1tvcmRlcklkXS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3ZtL29yZGVycy9bb3JkZXJJZF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zdm0vb3JkZXJzL1tvcmRlcklkXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc3ZtL29yZGVycy9bb3JkZXJJZF0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9zdm0vb3JkZXJzL1tvcmRlcklkXS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvc3ZtL29yZGVycy9bb3JkZXJJZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&page=%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/svm/orders/[orderId]/route.ts":
/*!***************************************************!*\
  !*** ./src/app/api/svm/orders/[orderId]/route.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * SVM Order by ID API - Database Persistent\n * \n * GET /api/svm/orders/:orderId - Get order details\n * PUT /api/svm/orders/:orderId - Update order status\n * DELETE /api/svm/orders/:orderId - Cancel order\n */ \n\n// Valid status transitions\nconst validOrderTransitions = {\n    \"PENDING\": [\n        \"CONFIRMED\",\n        \"CANCELLED\"\n    ],\n    \"CONFIRMED\": [\n        \"PROCESSING\",\n        \"CANCELLED\"\n    ],\n    \"PROCESSING\": [\n        \"SHIPPED\",\n        \"CANCELLED\"\n    ],\n    \"SHIPPED\": [\n        \"DELIVERED\",\n        \"CANCELLED\"\n    ],\n    \"DELIVERED\": [\n        \"REFUNDED\",\n        \"PARTIALLY_REFUNDED\"\n    ],\n    \"CANCELLED\": [],\n    \"REFUNDED\": [],\n    \"PARTIALLY_REFUNDED\": [\n        \"REFUNDED\"\n    ]\n};\nconst validPaymentTransitions = {\n    \"PENDING\": [\n        \"AUTHORIZED\",\n        \"CAPTURED\",\n        \"FAILED\"\n    ],\n    \"AUTHORIZED\": [\n        \"CAPTURED\",\n        \"FAILED\"\n    ],\n    \"CAPTURED\": [\n        \"PARTIALLY_REFUNDED\",\n        \"REFUNDED\"\n    ],\n    \"PARTIALLY_REFUNDED\": [\n        \"REFUNDED\"\n    ],\n    \"REFUNDED\": [],\n    \"FAILED\": [\n        \"PENDING\"\n    ]\n};\nconst validFulfillmentTransitions = {\n    \"UNFULFILLED\": [\n        \"PARTIALLY_FULFILLED\",\n        \"FULFILLED\"\n    ],\n    \"PARTIALLY_FULFILLED\": [\n        \"FULFILLED\"\n    ],\n    \"FULFILLED\": []\n};\n/**\n * GET /api/svm/orders/:orderId\n * Get order details\n */ async function GET(request, { params }) {\n    try {\n        const { orderId } = await params;\n        const { searchParams } = new URL(request.url);\n        const tenantId = searchParams.get(\"tenantId\");\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.findUnique({\n            where: {\n                id: orderId\n            },\n            include: {\n                items: true\n            }\n        });\n        if (!order) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order not found\"\n            }, {\n                status: 404\n            });\n        }\n        if (order.tenantId !== tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order does not belong to this tenant\"\n            }, {\n                status: 403\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            order: {\n                id: order.id,\n                orderNumber: order.orderNumber,\n                status: order.status,\n                paymentStatus: order.paymentStatus,\n                fulfillmentStatus: order.fulfillmentStatus,\n                tenantId: order.tenantId,\n                customerId: order.customerId,\n                customerEmail: order.customerEmail,\n                customerPhone: order.customerPhone,\n                customerName: order.customerName,\n                channel: order.channel,\n                items: order.items.map((item)=>({\n                        id: item.id,\n                        productId: item.productId,\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        sku: item.sku,\n                        variantName: item.variantName,\n                        imageUrl: item.imageUrl,\n                        unitPrice: Number(item.unitPrice),\n                        quantity: item.quantity,\n                        lineTotal: Number(item.lineTotal),\n                        discountAmount: Number(item.discountAmount),\n                        taxAmount: Number(item.taxAmount),\n                        fulfilledQuantity: item.fulfilledQuantity,\n                        refundedQuantity: item.refundedQuantity,\n                        customizations: item.customizations\n                    })),\n                subtotal: Number(order.subtotal),\n                shippingTotal: Number(order.shippingTotal),\n                taxTotal: Number(order.taxTotal),\n                discountTotal: Number(order.discountTotal),\n                grandTotal: Number(order.grandTotal),\n                refundedAmount: Number(order.refundedAmount),\n                promotionCode: order.promotionCode,\n                promotionId: order.promotionId,\n                currency: order.currency,\n                shippingAddress: order.shippingAddress,\n                billingAddress: order.billingAddress,\n                shippingMethod: order.shippingMethod,\n                shippingCarrier: order.shippingCarrier,\n                trackingNumber: order.trackingNumber,\n                trackingUrl: order.trackingUrl,\n                estimatedDelivery: order.estimatedDelivery?.toISOString() || null,\n                paymentMethod: order.paymentMethod,\n                paymentRef: order.paymentRef,\n                customerNotes: order.customerNotes,\n                internalNotes: order.internalNotes,\n                refundReason: order.refundReason,\n                paidAt: order.paidAt?.toISOString() || null,\n                shippedAt: order.shippedAt?.toISOString() || null,\n                deliveredAt: order.deliveredAt?.toISOString() || null,\n                cancelledAt: order.cancelledAt?.toISOString() || null,\n                refundedAt: order.refundedAt?.toISOString() || null,\n                createdAt: order.createdAt.toISOString(),\n                updatedAt: order.updatedAt.toISOString()\n            }\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error fetching order:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * PUT /api/svm/orders/:orderId\n * Update order status or details\n */ async function PUT(request, { params }) {\n    try {\n        const { orderId } = await params;\n        const body = await request.json();\n        const { tenantId, status, paymentStatus, fulfillmentStatus, trackingNumber, trackingUrl, shippingCarrier, estimatedDelivery, paymentMethod, paymentRef, internalNotes, refundReason, refundedAmount, shippingAddress, billingAddress } = body;\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.findUnique({\n            where: {\n                id: orderId\n            }\n        });\n        if (!order) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order not found\"\n            }, {\n                status: 404\n            });\n        }\n        if (order.tenantId !== tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order does not belong to this tenant\"\n            }, {\n                status: 403\n            });\n        }\n        // Build update data\n        const updateData = {};\n        const now = new Date();\n        const events = [];\n        // Handle order status transition\n        if (status && status !== order.status) {\n            const allowed = validOrderTransitions[order.status] || [];\n            if (!allowed.includes(status)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: `Invalid status transition from ${order.status} to ${status}. Allowed: ${allowed.join(\", \") || \"none\"}`\n                }, {\n                    status: 400\n                });\n            }\n            updateData.status = status;\n            events.push({\n                type: \"status\",\n                from: order.status,\n                to: status\n            });\n            // Set timestamps based on status\n            if (status === \"CANCELLED\") {\n                updateData.cancelledAt = now;\n            } else if (status === \"REFUNDED\") {\n                updateData.refundedAt = now;\n                if (refundReason) updateData.refundReason = refundReason;\n            } else if (status === \"DELIVERED\") {\n                updateData.deliveredAt = now;\n            }\n        }\n        // Handle payment status transition\n        if (paymentStatus && paymentStatus !== order.paymentStatus) {\n            const allowed = validPaymentTransitions[order.paymentStatus] || [];\n            if (!allowed.includes(paymentStatus)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: `Invalid payment status transition from ${order.paymentStatus} to ${paymentStatus}. Allowed: ${allowed.join(\", \") || \"none\"}`\n                }, {\n                    status: 400\n                });\n            }\n            updateData.paymentStatus = paymentStatus;\n            events.push({\n                type: \"paymentStatus\",\n                from: order.paymentStatus,\n                to: paymentStatus\n            });\n            // Set paid timestamp\n            if (paymentStatus === \"CAPTURED\") {\n                updateData.paidAt = now;\n            }\n        }\n        // Handle fulfillment status transition\n        if (fulfillmentStatus && fulfillmentStatus !== order.fulfillmentStatus) {\n            const allowed = validFulfillmentTransitions[order.fulfillmentStatus] || [];\n            if (!allowed.includes(fulfillmentStatus)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: `Invalid fulfillment status transition from ${order.fulfillmentStatus} to ${fulfillmentStatus}. Allowed: ${allowed.join(\", \") || \"none\"}`\n                }, {\n                    status: 400\n                });\n            }\n            updateData.fulfillmentStatus = fulfillmentStatus;\n            events.push({\n                type: \"fulfillmentStatus\",\n                from: order.fulfillmentStatus,\n                to: fulfillmentStatus\n            });\n        }\n        // Handle other field updates\n        if (trackingNumber !== undefined) {\n            updateData.trackingNumber = trackingNumber;\n            // If tracking added, assume shipped\n            if (trackingNumber && !order.shippedAt) {\n                updateData.shippedAt = now;\n            }\n        }\n        if (trackingUrl !== undefined) updateData.trackingUrl = trackingUrl;\n        if (shippingCarrier !== undefined) updateData.shippingCarrier = shippingCarrier;\n        if (estimatedDelivery !== undefined) updateData.estimatedDelivery = estimatedDelivery ? new Date(estimatedDelivery) : null;\n        if (paymentMethod !== undefined) updateData.paymentMethod = paymentMethod;\n        if (paymentRef !== undefined) updateData.paymentRef = paymentRef;\n        if (internalNotes !== undefined) updateData.internalNotes = internalNotes;\n        if (refundedAmount !== undefined) updateData.refundedAmount = refundedAmount;\n        if (shippingAddress !== undefined) updateData.shippingAddress = shippingAddress;\n        if (billingAddress !== undefined) updateData.billingAddress = billingAddress;\n        if (Object.keys(updateData).length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"No valid fields to update\"\n            }, {\n                status: 400\n            });\n        }\n        const updatedOrder = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.update({\n            where: {\n                id: orderId\n            },\n            data: updateData,\n            include: {\n                items: true\n            }\n        });\n        // Log events\n        if (events.length > 0) {\n            console.log(\"[SVM] Order Event: svm.order.updated\", {\n                orderId: updatedOrder.id,\n                orderNumber: updatedOrder.orderNumber,\n                tenantId,\n                changes: events\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            order: {\n                id: updatedOrder.id,\n                orderNumber: updatedOrder.orderNumber,\n                status: updatedOrder.status,\n                paymentStatus: updatedOrder.paymentStatus,\n                fulfillmentStatus: updatedOrder.fulfillmentStatus,\n                tenantId: updatedOrder.tenantId,\n                customerId: updatedOrder.customerId,\n                customerEmail: updatedOrder.customerEmail,\n                customerPhone: updatedOrder.customerPhone,\n                customerName: updatedOrder.customerName,\n                channel: updatedOrder.channel,\n                items: updatedOrder.items.map((item)=>({\n                        id: item.id,\n                        productId: item.productId,\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        sku: item.sku,\n                        variantName: item.variantName,\n                        imageUrl: item.imageUrl,\n                        unitPrice: Number(item.unitPrice),\n                        quantity: item.quantity,\n                        lineTotal: Number(item.lineTotal),\n                        discountAmount: Number(item.discountAmount),\n                        taxAmount: Number(item.taxAmount),\n                        fulfilledQuantity: item.fulfilledQuantity,\n                        refundedQuantity: item.refundedQuantity\n                    })),\n                subtotal: Number(updatedOrder.subtotal),\n                shippingTotal: Number(updatedOrder.shippingTotal),\n                taxTotal: Number(updatedOrder.taxTotal),\n                discountTotal: Number(updatedOrder.discountTotal),\n                grandTotal: Number(updatedOrder.grandTotal),\n                refundedAmount: Number(updatedOrder.refundedAmount),\n                promotionCode: updatedOrder.promotionCode,\n                currency: updatedOrder.currency,\n                shippingAddress: updatedOrder.shippingAddress,\n                billingAddress: updatedOrder.billingAddress,\n                shippingMethod: updatedOrder.shippingMethod,\n                shippingCarrier: updatedOrder.shippingCarrier,\n                trackingNumber: updatedOrder.trackingNumber,\n                trackingUrl: updatedOrder.trackingUrl,\n                estimatedDelivery: updatedOrder.estimatedDelivery?.toISOString() || null,\n                paymentMethod: updatedOrder.paymentMethod,\n                paymentRef: updatedOrder.paymentRef,\n                internalNotes: updatedOrder.internalNotes,\n                refundReason: updatedOrder.refundReason,\n                paidAt: updatedOrder.paidAt?.toISOString() || null,\n                shippedAt: updatedOrder.shippedAt?.toISOString() || null,\n                deliveredAt: updatedOrder.deliveredAt?.toISOString() || null,\n                cancelledAt: updatedOrder.cancelledAt?.toISOString() || null,\n                refundedAt: updatedOrder.refundedAt?.toISOString() || null,\n                createdAt: updatedOrder.createdAt.toISOString(),\n                updatedAt: updatedOrder.updatedAt.toISOString()\n            },\n            events: events.map((e)=>({\n                    eventId: `evt_${Date.now().toString(36)}`,\n                    eventType: `svm.order.${e.type}_changed`,\n                    previous: e.from,\n                    current: e.to,\n                    timestamp: now.toISOString()\n                }))\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error updating order:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * DELETE /api/svm/orders/:orderId\n * Cancel an order (soft delete via status change)\n */ async function DELETE(request, { params }) {\n    try {\n        const { orderId } = await params;\n        const { searchParams } = new URL(request.url);\n        let tenantId = searchParams.get(\"tenantId\");\n        // Try body if not in query params\n        if (!tenantId) {\n            try {\n                const body = await request.json();\n                tenantId = body.tenantId;\n            } catch  {\n            // Body parse failed\n            }\n        }\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.findUnique({\n            where: {\n                id: orderId\n            }\n        });\n        if (!order) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order not found\"\n            }, {\n                status: 404\n            });\n        }\n        if (order.tenantId !== tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Order does not belong to this tenant\"\n            }, {\n                status: 403\n            });\n        }\n        // Check if cancellation is allowed\n        const allowed = validOrderTransitions[order.status] || [];\n        if (!allowed.includes(\"CANCELLED\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: `Cannot cancel order in ${order.status} status. Order can only be cancelled from: PENDING, CONFIRMED, PROCESSING, or ON_HOLD`\n            }, {\n                status: 400\n            });\n        }\n        const updatedOrder = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.update({\n            where: {\n                id: orderId\n            },\n            data: {\n                status: \"CANCELLED\",\n                cancelledAt: new Date()\n            }\n        });\n        console.log(\"[SVM] Order Event: svm.order.cancelled\", {\n            orderId: updatedOrder.id,\n            orderNumber: updatedOrder.orderNumber,\n            previousStatus: order.status,\n            tenantId\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"Order cancelled successfully\",\n            order: {\n                id: updatedOrder.id,\n                orderNumber: updatedOrder.orderNumber,\n                status: updatedOrder.status,\n                cancelledAt: updatedOrder.cancelledAt?.toISOString()\n            },\n            events: [\n                {\n                    eventId: `evt_${Date.now().toString(36)}`,\n                    eventType: \"svm.order.cancelled\",\n                    timestamp: new Date().toISOString()\n                }\n            ]\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error cancelling order:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdm0vb3JkZXJzL1tvcmRlcklkXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7Ozs7Q0FNQyxHQUVzRDtBQUNsQjtBQU9yQywyQkFBMkI7QUFDM0IsTUFBTUUsd0JBQWtEO0lBQ3RELFdBQVc7UUFBQztRQUFhO0tBQVk7SUFDckMsYUFBYTtRQUFDO1FBQWM7S0FBWTtJQUN4QyxjQUFjO1FBQUM7UUFBVztLQUFZO0lBQ3RDLFdBQVc7UUFBQztRQUFhO0tBQVk7SUFDckMsYUFBYTtRQUFDO1FBQVk7S0FBcUI7SUFDL0MsYUFBYSxFQUFFO0lBQ2YsWUFBWSxFQUFFO0lBQ2Qsc0JBQXNCO1FBQUM7S0FBVztBQUNwQztBQUVBLE1BQU1DLDBCQUFvRDtJQUN4RCxXQUFXO1FBQUM7UUFBYztRQUFZO0tBQVM7SUFDL0MsY0FBYztRQUFDO1FBQVk7S0FBUztJQUNwQyxZQUFZO1FBQUM7UUFBc0I7S0FBVztJQUM5QyxzQkFBc0I7UUFBQztLQUFXO0lBQ2xDLFlBQVksRUFBRTtJQUNkLFVBQVU7UUFBQztLQUFVO0FBQ3ZCO0FBRUEsTUFBTUMsOEJBQXdEO0lBQzVELGVBQWU7UUFBQztRQUF1QjtLQUFZO0lBQ25ELHVCQUF1QjtRQUFDO0tBQVk7SUFDcEMsYUFBYSxFQUFFO0FBQ2pCO0FBTUE7OztDQUdDLEdBQ00sZUFBZUMsSUFDcEJDLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBZTtJQUV2QixJQUFJO1FBQ0YsTUFBTSxFQUFFQyxPQUFPLEVBQUUsR0FBRyxNQUFNRDtRQUMxQixNQUFNLEVBQUVFLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlKLFFBQVFLLEdBQUc7UUFDNUMsTUFBTUMsV0FBV0gsYUFBYUksR0FBRyxDQUFDO1FBRWxDLElBQUksQ0FBQ0QsVUFBVTtZQUNiLE9BQU9aLHFEQUFZQSxDQUFDYyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQXVCLEdBQ2hEO2dCQUFFQyxRQUFRO1lB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QSxNQUFNZ0YsZUFBZSxNQUFNaEcsK0NBQU1BLENBQUNrQixRQUFRLENBQUMrRSxNQUFNLENBQUM7WUFDaEQ3RSxPQUFPO2dCQUFFQyxJQUFJZDtZQUFRO1lBQ3JCMkYsTUFBTTtnQkFDSmxGLFFBQVE7Z0JBQ1IwRCxhQUFhLElBQUlTO1lBQ25CO1FBQ0Y7UUFFQUwsUUFBUXFCLEdBQUcsQ0FBQywwQ0FBMEM7WUFDcEQ1RixTQUFTeUYsYUFBYTNFLEVBQUU7WUFDeEJHLGFBQWF3RSxhQUFheEUsV0FBVztZQUNyQ3VGLGdCQUFnQjlGLE1BQU1ELE1BQU07WUFDNUJMO1FBQ0Y7UUFFQSxPQUFPWixxREFBWUEsQ0FBQ2MsSUFBSSxDQUFDO1lBQ3ZCQyxTQUFTO1lBQ1QrRixTQUFTO1lBQ1Q1RixPQUFPO2dCQUNMSSxJQUFJMkUsYUFBYTNFLEVBQUU7Z0JBQ25CRyxhQUFhd0UsYUFBYXhFLFdBQVc7Z0JBQ3JDUixRQUFRZ0YsYUFBYWhGLE1BQU07Z0JBQzNCMEQsYUFBYXNCLGFBQWF0QixXQUFXLEVBQUVUO1lBQ3pDO1lBQ0FtQixRQUFRO2dCQUFDO29CQUNQa0IsU0FBUyxDQUFDLElBQUksRUFBRW5CLEtBQUtELEdBQUcsR0FBR3FCLFFBQVEsQ0FBQyxJQUFJLENBQUM7b0JBQ3pDQyxXQUFXO29CQUNYRyxXQUFXLElBQUl4QixPQUFPbEIsV0FBVztnQkFDbkM7YUFBRTtRQUNKO0lBRUYsRUFBRSxPQUFPbEQsT0FBTztRQUNkK0QsUUFBUS9ELEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9oQixxREFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9DLE9BQU9BLGlCQUFpQjZGLFFBQVE3RixNQUFNOEYsT0FBTyxHQUFHO1FBQXdCLEdBQzFGO1lBQUU3RixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9hcHAvYXBpL3N2bS9vcmRlcnMvW29yZGVySWRdL3JvdXRlLnRzP2JjNmIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTVk0gT3JkZXIgYnkgSUQgQVBJIC0gRGF0YWJhc2UgUGVyc2lzdGVudFxuICogXG4gKiBHRVQgL2FwaS9zdm0vb3JkZXJzLzpvcmRlcklkIC0gR2V0IG9yZGVyIGRldGFpbHNcbiAqIFBVVCAvYXBpL3N2bS9vcmRlcnMvOm9yZGVySWQgLSBVcGRhdGUgb3JkZXIgc3RhdHVzXG4gKiBERUxFVEUgL2FwaS9zdm0vb3JkZXJzLzpvcmRlcklkIC0gQ2FuY2VsIG9yZGVyXG4gKi9cblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvcHJpc21hJ1xuXG4vLyBTdGF0dXMgZW51bXMgZnJvbSBzY2hlbWFcbnR5cGUgU3ZtT3JkZXJTdGF0dXMgPSAnUEVORElORycgfCAnQ09ORklSTUVEJyB8ICdQUk9DRVNTSU5HJyB8ICdTSElQUEVEJyB8ICdERUxJVkVSRUQnIHwgJ0NBTkNFTExFRCcgfCAnUkVGVU5ERUQnIHwgJ1BBUlRJQUxMWV9SRUZVTkRFRCdcbnR5cGUgU3ZtUGF5bWVudFN0YXR1cyA9ICdQRU5ESU5HJyB8ICdBVVRIT1JJWkVEJyB8ICdDQVBUVVJFRCcgfCAnRkFJTEVEJyB8ICdSRUZVTkRFRCcgfCAnUEFSVElBTExZX1JFRlVOREVEJ1xudHlwZSBTdm1GdWxmaWxsbWVudFN0YXR1cyA9ICdVTkZVTEZJTExFRCcgfCAnUEFSVElBTExZX0ZVTEZJTExFRCcgfCAnRlVMRklMTEVEJ1xuXG4vLyBWYWxpZCBzdGF0dXMgdHJhbnNpdGlvbnNcbmNvbnN0IHZhbGlkT3JkZXJUcmFuc2l0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAnUEVORElORyc6IFsnQ09ORklSTUVEJywgJ0NBTkNFTExFRCddLFxuICAnQ09ORklSTUVEJzogWydQUk9DRVNTSU5HJywgJ0NBTkNFTExFRCddLFxuICAnUFJPQ0VTU0lORyc6IFsnU0hJUFBFRCcsICdDQU5DRUxMRUQnXSxcbiAgJ1NISVBQRUQnOiBbJ0RFTElWRVJFRCcsICdDQU5DRUxMRUQnXSxcbiAgJ0RFTElWRVJFRCc6IFsnUkVGVU5ERUQnLCAnUEFSVElBTExZX1JFRlVOREVEJ10sXG4gICdDQU5DRUxMRUQnOiBbXSxcbiAgJ1JFRlVOREVEJzogW10sXG4gICdQQVJUSUFMTFlfUkVGVU5ERUQnOiBbJ1JFRlVOREVEJ11cbn1cblxuY29uc3QgdmFsaWRQYXltZW50VHJhbnNpdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgJ1BFTkRJTkcnOiBbJ0FVVEhPUklaRUQnLCAnQ0FQVFVSRUQnLCAnRkFJTEVEJ10sXG4gICdBVVRIT1JJWkVEJzogWydDQVBUVVJFRCcsICdGQUlMRUQnXSxcbiAgJ0NBUFRVUkVEJzogWydQQVJUSUFMTFlfUkVGVU5ERUQnLCAnUkVGVU5ERUQnXSxcbiAgJ1BBUlRJQUxMWV9SRUZVTkRFRCc6IFsnUkVGVU5ERUQnXSxcbiAgJ1JFRlVOREVEJzogW10sXG4gICdGQUlMRUQnOiBbJ1BFTkRJTkcnXVxufVxuXG5jb25zdCB2YWxpZEZ1bGZpbGxtZW50VHJhbnNpdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgJ1VORlVMRklMTEVEJzogWydQQVJUSUFMTFlfRlVMRklMTEVEJywgJ0ZVTEZJTExFRCddLFxuICAnUEFSVElBTExZX0ZVTEZJTExFRCc6IFsnRlVMRklMTEVEJ10sXG4gICdGVUxGSUxMRUQnOiBbXVxufVxuXG5pbnRlcmZhY2UgUm91dGVQYXJhbXMge1xuICBwYXJhbXM6IFByb21pc2U8eyBvcmRlcklkOiBzdHJpbmcgfT5cbn1cblxuLyoqXG4gKiBHRVQgL2FwaS9zdm0vb3JkZXJzLzpvcmRlcklkXG4gKiBHZXQgb3JkZXIgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogUm91dGVQYXJhbXNcbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgb3JkZXJJZCB9ID0gYXdhaXQgcGFyYW1zXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgdGVuYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW5hbnRJZCcpXG5cbiAgICBpZiAoIXRlbmFudElkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAndGVuYW50SWQgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IG9yZGVyID0gYXdhaXQgcHJpc21hLnN2bU9yZGVyLmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVySWQgfSxcbiAgICAgIGluY2x1ZGU6IHsgaXRlbXM6IHRydWUgfVxuICAgIH0pXG5cbiAgICBpZiAoIW9yZGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9LFxuICAgICAgICB7IHN0YXR1czogNDA0IH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAob3JkZXIudGVuYW50SWQgIT09IHRlbmFudElkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnT3JkZXIgZG9lcyBub3QgYmVsb25nIHRvIHRoaXMgdGVuYW50JyB9LFxuICAgICAgICB7IHN0YXR1czogNDAzIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGlkOiBvcmRlci5pZCxcbiAgICAgICAgb3JkZXJOdW1iZXI6IG9yZGVyLm9yZGVyTnVtYmVyLFxuICAgICAgICBzdGF0dXM6IG9yZGVyLnN0YXR1cyxcbiAgICAgICAgcGF5bWVudFN0YXR1czogb3JkZXIucGF5bWVudFN0YXR1cyxcbiAgICAgICAgZnVsZmlsbG1lbnRTdGF0dXM6IG9yZGVyLmZ1bGZpbGxtZW50U3RhdHVzLFxuICAgICAgICB0ZW5hbnRJZDogb3JkZXIudGVuYW50SWQsXG4gICAgICAgIGN1c3RvbWVySWQ6IG9yZGVyLmN1c3RvbWVySWQsXG4gICAgICAgIGN1c3RvbWVyRW1haWw6IG9yZGVyLmN1c3RvbWVyRW1haWwsXG4gICAgICAgIGN1c3RvbWVyUGhvbmU6IG9yZGVyLmN1c3RvbWVyUGhvbmUsXG4gICAgICAgIGN1c3RvbWVyTmFtZTogb3JkZXIuY3VzdG9tZXJOYW1lLFxuICAgICAgICBjaGFubmVsOiBvcmRlci5jaGFubmVsLFxuICAgICAgICBpdGVtczogb3JkZXIuaXRlbXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICBpZDogaXRlbS5pZCxcbiAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLFxuICAgICAgICAgIHZhcmlhbnRJZDogaXRlbS52YXJpYW50SWQsXG4gICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsXG4gICAgICAgICAgc2t1OiBpdGVtLnNrdSxcbiAgICAgICAgICB2YXJpYW50TmFtZTogaXRlbS52YXJpYW50TmFtZSxcbiAgICAgICAgICBpbWFnZVVybDogaXRlbS5pbWFnZVVybCxcbiAgICAgICAgICB1bml0UHJpY2U6IE51bWJlcihpdGVtLnVuaXRQcmljZSksXG4gICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgbGluZVRvdGFsOiBOdW1iZXIoaXRlbS5saW5lVG90YWwpLFxuICAgICAgICAgIGRpc2NvdW50QW1vdW50OiBOdW1iZXIoaXRlbS5kaXNjb3VudEFtb3VudCksXG4gICAgICAgICAgdGF4QW1vdW50OiBOdW1iZXIoaXRlbS50YXhBbW91bnQpLFxuICAgICAgICAgIGZ1bGZpbGxlZFF1YW50aXR5OiBpdGVtLmZ1bGZpbGxlZFF1YW50aXR5LFxuICAgICAgICAgIHJlZnVuZGVkUXVhbnRpdHk6IGl0ZW0ucmVmdW5kZWRRdWFudGl0eSxcbiAgICAgICAgICBjdXN0b21pemF0aW9uczogaXRlbS5jdXN0b21pemF0aW9uc1xuICAgICAgICB9KSksXG4gICAgICAgIHN1YnRvdGFsOiBOdW1iZXIob3JkZXIuc3VidG90YWwpLFxuICAgICAgICBzaGlwcGluZ1RvdGFsOiBOdW1iZXIob3JkZXIuc2hpcHBpbmdUb3RhbCksXG4gICAgICAgIHRheFRvdGFsOiBOdW1iZXIob3JkZXIudGF4VG90YWwpLFxuICAgICAgICBkaXNjb3VudFRvdGFsOiBOdW1iZXIob3JkZXIuZGlzY291bnRUb3RhbCksXG4gICAgICAgIGdyYW5kVG90YWw6IE51bWJlcihvcmRlci5ncmFuZFRvdGFsKSxcbiAgICAgICAgcmVmdW5kZWRBbW91bnQ6IE51bWJlcihvcmRlci5yZWZ1bmRlZEFtb3VudCksXG4gICAgICAgIHByb21vdGlvbkNvZGU6IG9yZGVyLnByb21vdGlvbkNvZGUsXG4gICAgICAgIHByb21vdGlvbklkOiBvcmRlci5wcm9tb3Rpb25JZCxcbiAgICAgICAgY3VycmVuY3k6IG9yZGVyLmN1cnJlbmN5LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IG9yZGVyLnNoaXBwaW5nQWRkcmVzcyxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IG9yZGVyLmJpbGxpbmdBZGRyZXNzLFxuICAgICAgICBzaGlwcGluZ01ldGhvZDogb3JkZXIuc2hpcHBpbmdNZXRob2QsXG4gICAgICAgIHNoaXBwaW5nQ2Fycmllcjogb3JkZXIuc2hpcHBpbmdDYXJyaWVyLFxuICAgICAgICB0cmFja2luZ051bWJlcjogb3JkZXIudHJhY2tpbmdOdW1iZXIsXG4gICAgICAgIHRyYWNraW5nVXJsOiBvcmRlci50cmFja2luZ1VybCxcbiAgICAgICAgZXN0aW1hdGVkRGVsaXZlcnk6IG9yZGVyLmVzdGltYXRlZERlbGl2ZXJ5Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIHBheW1lbnRNZXRob2Q6IG9yZGVyLnBheW1lbnRNZXRob2QsXG4gICAgICAgIHBheW1lbnRSZWY6IG9yZGVyLnBheW1lbnRSZWYsXG4gICAgICAgIGN1c3RvbWVyTm90ZXM6IG9yZGVyLmN1c3RvbWVyTm90ZXMsXG4gICAgICAgIGludGVybmFsTm90ZXM6IG9yZGVyLmludGVybmFsTm90ZXMsXG4gICAgICAgIHJlZnVuZFJlYXNvbjogb3JkZXIucmVmdW5kUmVhc29uLFxuICAgICAgICBwYWlkQXQ6IG9yZGVyLnBhaWRBdD8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICBzaGlwcGVkQXQ6IG9yZGVyLnNoaXBwZWRBdD8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICBkZWxpdmVyZWRBdDogb3JkZXIuZGVsaXZlcmVkQXQ/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbCxcbiAgICAgICAgY2FuY2VsbGVkQXQ6IG9yZGVyLmNhbmNlbGxlZEF0Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIHJlZnVuZGVkQXQ6IG9yZGVyLnJlZnVuZGVkQXQ/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbCxcbiAgICAgICAgY3JlYXRlZEF0OiBvcmRlci5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBvcmRlci51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBmZXRjaGluZyBvcmRlcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIFBVVCAvYXBpL3N2bS9vcmRlcnMvOm9yZGVySWRcbiAqIFVwZGF0ZSBvcmRlciBzdGF0dXMgb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogUm91dGVQYXJhbXNcbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgb3JkZXJJZCB9ID0gYXdhaXQgcGFyYW1zXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyBcbiAgICAgIHRlbmFudElkLCBcbiAgICAgIHN0YXR1cywgXG4gICAgICBwYXltZW50U3RhdHVzLFxuICAgICAgZnVsZmlsbG1lbnRTdGF0dXMsXG4gICAgICB0cmFja2luZ051bWJlciwgXG4gICAgICB0cmFja2luZ1VybCwgXG4gICAgICBzaGlwcGluZ0NhcnJpZXIsXG4gICAgICBlc3RpbWF0ZWREZWxpdmVyeSxcbiAgICAgIHBheW1lbnRNZXRob2QsXG4gICAgICBwYXltZW50UmVmLFxuICAgICAgaW50ZXJuYWxOb3RlcyxcbiAgICAgIHJlZnVuZFJlYXNvbixcbiAgICAgIHJlZnVuZGVkQW1vdW50LFxuICAgICAgc2hpcHBpbmdBZGRyZXNzLFxuICAgICAgYmlsbGluZ0FkZHJlc3NcbiAgICB9ID0gYm9keVxuXG4gICAgaWYgKCF0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3RlbmFudElkIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCBvcmRlciA9IGF3YWl0IHByaXNtYS5zdm1PcmRlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH1cbiAgICB9KVxuXG4gICAgaWYgKCFvcmRlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09yZGVyIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKG9yZGVyLnRlbmFudElkICE9PSB0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09yZGVyIGRvZXMgbm90IGJlbG9uZyB0byB0aGlzIHRlbmFudCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQnVpbGQgdXBkYXRlIGRhdGFcbiAgICBjb25zdCB1cGRhdGVEYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICAgIGNvbnN0IGV2ZW50czogeyB0eXBlOiBzdHJpbmc7IGZyb206IHN0cmluZzsgdG86IHN0cmluZyB9W10gPSBbXVxuXG4gICAgLy8gSGFuZGxlIG9yZGVyIHN0YXR1cyB0cmFuc2l0aW9uXG4gICAgaWYgKHN0YXR1cyAmJiBzdGF0dXMgIT09IG9yZGVyLnN0YXR1cykge1xuICAgICAgY29uc3QgYWxsb3dlZCA9IHZhbGlkT3JkZXJUcmFuc2l0aW9uc1tvcmRlci5zdGF0dXNdIHx8IFtdXG4gICAgICBpZiAoIWFsbG93ZWQuaW5jbHVkZXMoc3RhdHVzKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBzdGF0dXMgdHJhbnNpdGlvbiBmcm9tICR7b3JkZXIuc3RhdHVzfSB0byAke3N0YXR1c30uIEFsbG93ZWQ6ICR7YWxsb3dlZC5qb2luKCcsICcpIHx8ICdub25lJ31gIFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIHVwZGF0ZURhdGEuc3RhdHVzID0gc3RhdHVzXG4gICAgICBldmVudHMucHVzaCh7IHR5cGU6ICdzdGF0dXMnLCBmcm9tOiBvcmRlci5zdGF0dXMsIHRvOiBzdGF0dXMgfSlcblxuICAgICAgLy8gU2V0IHRpbWVzdGFtcHMgYmFzZWQgb24gc3RhdHVzXG4gICAgICBpZiAoc3RhdHVzID09PSAnQ0FOQ0VMTEVEJykge1xuICAgICAgICB1cGRhdGVEYXRhLmNhbmNlbGxlZEF0ID0gbm93XG4gICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ1JFRlVOREVEJykge1xuICAgICAgICB1cGRhdGVEYXRhLnJlZnVuZGVkQXQgPSBub3dcbiAgICAgICAgaWYgKHJlZnVuZFJlYXNvbikgdXBkYXRlRGF0YS5yZWZ1bmRSZWFzb24gPSByZWZ1bmRSZWFzb25cbiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAnREVMSVZFUkVEJykge1xuICAgICAgICB1cGRhdGVEYXRhLmRlbGl2ZXJlZEF0ID0gbm93XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHBheW1lbnQgc3RhdHVzIHRyYW5zaXRpb25cbiAgICBpZiAocGF5bWVudFN0YXR1cyAmJiBwYXltZW50U3RhdHVzICE9PSBvcmRlci5wYXltZW50U3RhdHVzKSB7XG4gICAgICBjb25zdCBhbGxvd2VkID0gdmFsaWRQYXltZW50VHJhbnNpdGlvbnNbb3JkZXIucGF5bWVudFN0YXR1c10gfHwgW11cbiAgICAgIGlmICghYWxsb3dlZC5pbmNsdWRlcyhwYXltZW50U3RhdHVzKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBwYXltZW50IHN0YXR1cyB0cmFuc2l0aW9uIGZyb20gJHtvcmRlci5wYXltZW50U3RhdHVzfSB0byAke3BheW1lbnRTdGF0dXN9LiBBbGxvd2VkOiAke2FsbG93ZWQuam9pbignLCAnKSB8fCAnbm9uZSd9YCBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApXG4gICAgICB9XG4gICAgICB1cGRhdGVEYXRhLnBheW1lbnRTdGF0dXMgPSBwYXltZW50U3RhdHVzXG4gICAgICBldmVudHMucHVzaCh7IHR5cGU6ICdwYXltZW50U3RhdHVzJywgZnJvbTogb3JkZXIucGF5bWVudFN0YXR1cywgdG86IHBheW1lbnRTdGF0dXMgfSlcblxuICAgICAgLy8gU2V0IHBhaWQgdGltZXN0YW1wXG4gICAgICBpZiAocGF5bWVudFN0YXR1cyA9PT0gJ0NBUFRVUkVEJykge1xuICAgICAgICB1cGRhdGVEYXRhLnBhaWRBdCA9IG5vd1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBmdWxmaWxsbWVudCBzdGF0dXMgdHJhbnNpdGlvblxuICAgIGlmIChmdWxmaWxsbWVudFN0YXR1cyAmJiBmdWxmaWxsbWVudFN0YXR1cyAhPT0gb3JkZXIuZnVsZmlsbG1lbnRTdGF0dXMpIHtcbiAgICAgIGNvbnN0IGFsbG93ZWQgPSB2YWxpZEZ1bGZpbGxtZW50VHJhbnNpdGlvbnNbb3JkZXIuZnVsZmlsbG1lbnRTdGF0dXNdIHx8IFtdXG4gICAgICBpZiAoIWFsbG93ZWQuaW5jbHVkZXMoZnVsZmlsbG1lbnRTdGF0dXMpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGZ1bGZpbGxtZW50IHN0YXR1cyB0cmFuc2l0aW9uIGZyb20gJHtvcmRlci5mdWxmaWxsbWVudFN0YXR1c30gdG8gJHtmdWxmaWxsbWVudFN0YXR1c30uIEFsbG93ZWQ6ICR7YWxsb3dlZC5qb2luKCcsICcpIHx8ICdub25lJ31gIFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIHVwZGF0ZURhdGEuZnVsZmlsbG1lbnRTdGF0dXMgPSBmdWxmaWxsbWVudFN0YXR1c1xuICAgICAgZXZlbnRzLnB1c2goeyB0eXBlOiAnZnVsZmlsbG1lbnRTdGF0dXMnLCBmcm9tOiBvcmRlci5mdWxmaWxsbWVudFN0YXR1cywgdG86IGZ1bGZpbGxtZW50U3RhdHVzIH0pXG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIG90aGVyIGZpZWxkIHVwZGF0ZXNcbiAgICBpZiAodHJhY2tpbmdOdW1iZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRGF0YS50cmFja2luZ051bWJlciA9IHRyYWNraW5nTnVtYmVyXG4gICAgICAvLyBJZiB0cmFja2luZyBhZGRlZCwgYXNzdW1lIHNoaXBwZWRcbiAgICAgIGlmICh0cmFja2luZ051bWJlciAmJiAhb3JkZXIuc2hpcHBlZEF0KSB7XG4gICAgICAgIHVwZGF0ZURhdGEuc2hpcHBlZEF0ID0gbm93XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0cmFja2luZ1VybCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRyYWNraW5nVXJsID0gdHJhY2tpbmdVcmxcbiAgICBpZiAoc2hpcHBpbmdDYXJyaWVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2hpcHBpbmdDYXJyaWVyID0gc2hpcHBpbmdDYXJyaWVyXG4gICAgaWYgKGVzdGltYXRlZERlbGl2ZXJ5ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZXN0aW1hdGVkRGVsaXZlcnkgPSBlc3RpbWF0ZWREZWxpdmVyeSA/IG5ldyBEYXRlKGVzdGltYXRlZERlbGl2ZXJ5KSA6IG51bGxcbiAgICBpZiAocGF5bWVudE1ldGhvZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnBheW1lbnRNZXRob2QgPSBwYXltZW50TWV0aG9kXG4gICAgaWYgKHBheW1lbnRSZWYgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wYXltZW50UmVmID0gcGF5bWVudFJlZlxuICAgIGlmIChpbnRlcm5hbE5vdGVzICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaW50ZXJuYWxOb3RlcyA9IGludGVybmFsTm90ZXNcbiAgICBpZiAocmVmdW5kZWRBbW91bnQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5yZWZ1bmRlZEFtb3VudCA9IHJlZnVuZGVkQW1vdW50XG4gICAgaWYgKHNoaXBwaW5nQWRkcmVzcyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nQWRkcmVzcyA9IHNoaXBwaW5nQWRkcmVzc1xuICAgIGlmIChiaWxsaW5nQWRkcmVzcyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJpbGxpbmdBZGRyZXNzID0gYmlsbGluZ0FkZHJlc3NcblxuICAgIGlmIChPYmplY3Qua2V5cyh1cGRhdGVEYXRhKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdObyB2YWxpZCBmaWVsZHMgdG8gdXBkYXRlJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVkT3JkZXIgPSBhd2FpdCBwcmlzbWEuc3ZtT3JkZXIudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICBkYXRhOiB1cGRhdGVEYXRhLFxuICAgICAgaW5jbHVkZTogeyBpdGVtczogdHJ1ZSB9XG4gICAgfSlcblxuICAgIC8vIExvZyBldmVudHNcbiAgICBpZiAoZXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU1ZNXSBPcmRlciBFdmVudDogc3ZtLm9yZGVyLnVwZGF0ZWQnLCB7XG4gICAgICAgIG9yZGVySWQ6IHVwZGF0ZWRPcmRlci5pZCxcbiAgICAgICAgb3JkZXJOdW1iZXI6IHVwZGF0ZWRPcmRlci5vcmRlck51bWJlcixcbiAgICAgICAgdGVuYW50SWQsXG4gICAgICAgIGNoYW5nZXM6IGV2ZW50c1xuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGlkOiB1cGRhdGVkT3JkZXIuaWQsXG4gICAgICAgIG9yZGVyTnVtYmVyOiB1cGRhdGVkT3JkZXIub3JkZXJOdW1iZXIsXG4gICAgICAgIHN0YXR1czogdXBkYXRlZE9yZGVyLnN0YXR1cyxcbiAgICAgICAgcGF5bWVudFN0YXR1czogdXBkYXRlZE9yZGVyLnBheW1lbnRTdGF0dXMsXG4gICAgICAgIGZ1bGZpbGxtZW50U3RhdHVzOiB1cGRhdGVkT3JkZXIuZnVsZmlsbG1lbnRTdGF0dXMsXG4gICAgICAgIHRlbmFudElkOiB1cGRhdGVkT3JkZXIudGVuYW50SWQsXG4gICAgICAgIGN1c3RvbWVySWQ6IHVwZGF0ZWRPcmRlci5jdXN0b21lcklkLFxuICAgICAgICBjdXN0b21lckVtYWlsOiB1cGRhdGVkT3JkZXIuY3VzdG9tZXJFbWFpbCxcbiAgICAgICAgY3VzdG9tZXJQaG9uZTogdXBkYXRlZE9yZGVyLmN1c3RvbWVyUGhvbmUsXG4gICAgICAgIGN1c3RvbWVyTmFtZTogdXBkYXRlZE9yZGVyLmN1c3RvbWVyTmFtZSxcbiAgICAgICAgY2hhbm5lbDogdXBkYXRlZE9yZGVyLmNoYW5uZWwsXG4gICAgICAgIGl0ZW1zOiB1cGRhdGVkT3JkZXIuaXRlbXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICBpZDogaXRlbS5pZCxcbiAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLFxuICAgICAgICAgIHZhcmlhbnRJZDogaXRlbS52YXJpYW50SWQsXG4gICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsXG4gICAgICAgICAgc2t1OiBpdGVtLnNrdSxcbiAgICAgICAgICB2YXJpYW50TmFtZTogaXRlbS52YXJpYW50TmFtZSxcbiAgICAgICAgICBpbWFnZVVybDogaXRlbS5pbWFnZVVybCxcbiAgICAgICAgICB1bml0UHJpY2U6IE51bWJlcihpdGVtLnVuaXRQcmljZSksXG4gICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgbGluZVRvdGFsOiBOdW1iZXIoaXRlbS5saW5lVG90YWwpLFxuICAgICAgICAgIGRpc2NvdW50QW1vdW50OiBOdW1iZXIoaXRlbS5kaXNjb3VudEFtb3VudCksXG4gICAgICAgICAgdGF4QW1vdW50OiBOdW1iZXIoaXRlbS50YXhBbW91bnQpLFxuICAgICAgICAgIGZ1bGZpbGxlZFF1YW50aXR5OiBpdGVtLmZ1bGZpbGxlZFF1YW50aXR5LFxuICAgICAgICAgIHJlZnVuZGVkUXVhbnRpdHk6IGl0ZW0ucmVmdW5kZWRRdWFudGl0eVxuICAgICAgICB9KSksXG4gICAgICAgIHN1YnRvdGFsOiBOdW1iZXIodXBkYXRlZE9yZGVyLnN1YnRvdGFsKSxcbiAgICAgICAgc2hpcHBpbmdUb3RhbDogTnVtYmVyKHVwZGF0ZWRPcmRlci5zaGlwcGluZ1RvdGFsKSxcbiAgICAgICAgdGF4VG90YWw6IE51bWJlcih1cGRhdGVkT3JkZXIudGF4VG90YWwpLFxuICAgICAgICBkaXNjb3VudFRvdGFsOiBOdW1iZXIodXBkYXRlZE9yZGVyLmRpc2NvdW50VG90YWwpLFxuICAgICAgICBncmFuZFRvdGFsOiBOdW1iZXIodXBkYXRlZE9yZGVyLmdyYW5kVG90YWwpLFxuICAgICAgICByZWZ1bmRlZEFtb3VudDogTnVtYmVyKHVwZGF0ZWRPcmRlci5yZWZ1bmRlZEFtb3VudCksXG4gICAgICAgIHByb21vdGlvbkNvZGU6IHVwZGF0ZWRPcmRlci5wcm9tb3Rpb25Db2RlLFxuICAgICAgICBjdXJyZW5jeTogdXBkYXRlZE9yZGVyLmN1cnJlbmN5LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHVwZGF0ZWRPcmRlci5zaGlwcGluZ0FkZHJlc3MsXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB1cGRhdGVkT3JkZXIuYmlsbGluZ0FkZHJlc3MsXG4gICAgICAgIHNoaXBwaW5nTWV0aG9kOiB1cGRhdGVkT3JkZXIuc2hpcHBpbmdNZXRob2QsXG4gICAgICAgIHNoaXBwaW5nQ2FycmllcjogdXBkYXRlZE9yZGVyLnNoaXBwaW5nQ2FycmllcixcbiAgICAgICAgdHJhY2tpbmdOdW1iZXI6IHVwZGF0ZWRPcmRlci50cmFja2luZ051bWJlcixcbiAgICAgICAgdHJhY2tpbmdVcmw6IHVwZGF0ZWRPcmRlci50cmFja2luZ1VybCxcbiAgICAgICAgZXN0aW1hdGVkRGVsaXZlcnk6IHVwZGF0ZWRPcmRlci5lc3RpbWF0ZWREZWxpdmVyeT8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVkT3JkZXIucGF5bWVudE1ldGhvZCxcbiAgICAgICAgcGF5bWVudFJlZjogdXBkYXRlZE9yZGVyLnBheW1lbnRSZWYsXG4gICAgICAgIGludGVybmFsTm90ZXM6IHVwZGF0ZWRPcmRlci5pbnRlcm5hbE5vdGVzLFxuICAgICAgICByZWZ1bmRSZWFzb246IHVwZGF0ZWRPcmRlci5yZWZ1bmRSZWFzb24sXG4gICAgICAgIHBhaWRBdDogdXBkYXRlZE9yZGVyLnBhaWRBdD8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICBzaGlwcGVkQXQ6IHVwZGF0ZWRPcmRlci5zaGlwcGVkQXQ/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbCxcbiAgICAgICAgZGVsaXZlcmVkQXQ6IHVwZGF0ZWRPcmRlci5kZWxpdmVyZWRBdD8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICBjYW5jZWxsZWRBdDogdXBkYXRlZE9yZGVyLmNhbmNlbGxlZEF0Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIHJlZnVuZGVkQXQ6IHVwZGF0ZWRPcmRlci5yZWZ1bmRlZEF0Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIGNyZWF0ZWRBdDogdXBkYXRlZE9yZGVyLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxuICAgICAgICB1cGRhdGVkQXQ6IHVwZGF0ZWRPcmRlci51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxuICAgICAgfSxcbiAgICAgIGV2ZW50czogZXZlbnRzLm1hcChlID0+ICh7XG4gICAgICAgIGV2ZW50SWQ6IGBldnRfJHtEYXRlLm5vdygpLnRvU3RyaW5nKDM2KX1gLFxuICAgICAgICBldmVudFR5cGU6IGBzdm0ub3JkZXIuJHtlLnR5cGV9X2NoYW5nZWRgLFxuICAgICAgICBwcmV2aW91czogZS5mcm9tLFxuICAgICAgICBjdXJyZW50OiBlLnRvLFxuICAgICAgICB0aW1lc3RhbXA6IG5vdy50b0lTT1N0cmluZygpXG4gICAgICB9KSlcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1NWTV0gRXJyb3IgdXBkYXRpbmcgb3JkZXI6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIERFTEVURSAvYXBpL3N2bS9vcmRlcnMvOm9yZGVySWRcbiAqIENhbmNlbCBhbiBvcmRlciAoc29mdCBkZWxldGUgdmlhIHN0YXR1cyBjaGFuZ2UpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiBSb3V0ZVBhcmFtc1xuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBvcmRlcklkIH0gPSBhd2FpdCBwYXJhbXNcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICBsZXQgdGVuYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW5hbnRJZCcpXG5cbiAgICAvLyBUcnkgYm9keSBpZiBub3QgaW4gcXVlcnkgcGFyYW1zXG4gICAgaWYgKCF0ZW5hbnRJZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgICAgIHRlbmFudElkID0gYm9keS50ZW5hbnRJZFxuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIEJvZHkgcGFyc2UgZmFpbGVkXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3RlbmFudElkIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCBvcmRlciA9IGF3YWl0IHByaXNtYS5zdm1PcmRlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH1cbiAgICB9KVxuXG4gICAgaWYgKCFvcmRlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09yZGVyIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKG9yZGVyLnRlbmFudElkICE9PSB0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09yZGVyIGRvZXMgbm90IGJlbG9uZyB0byB0aGlzIHRlbmFudCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgY2FuY2VsbGF0aW9uIGlzIGFsbG93ZWRcbiAgICBjb25zdCBhbGxvd2VkID0gdmFsaWRPcmRlclRyYW5zaXRpb25zW29yZGVyLnN0YXR1c10gfHwgW11cbiAgICBpZiAoIWFsbG93ZWQuaW5jbHVkZXMoJ0NBTkNFTExFRCcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgIGVycm9yOiBgQ2Fubm90IGNhbmNlbCBvcmRlciBpbiAke29yZGVyLnN0YXR1c30gc3RhdHVzLiBPcmRlciBjYW4gb25seSBiZSBjYW5jZWxsZWQgZnJvbTogUEVORElORywgQ09ORklSTUVELCBQUk9DRVNTSU5HLCBvciBPTl9IT0xEYCBcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgdXBkYXRlZE9yZGVyID0gYXdhaXQgcHJpc21hLnN2bU9yZGVyLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBzdGF0dXM6ICdDQU5DRUxMRUQnLFxuICAgICAgICBjYW5jZWxsZWRBdDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZygnW1NWTV0gT3JkZXIgRXZlbnQ6IHN2bS5vcmRlci5jYW5jZWxsZWQnLCB7XG4gICAgICBvcmRlcklkOiB1cGRhdGVkT3JkZXIuaWQsXG4gICAgICBvcmRlck51bWJlcjogdXBkYXRlZE9yZGVyLm9yZGVyTnVtYmVyLFxuICAgICAgcHJldmlvdXNTdGF0dXM6IG9yZGVyLnN0YXR1cyxcbiAgICAgIHRlbmFudElkXG4gICAgfSlcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogJ09yZGVyIGNhbmNlbGxlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgb3JkZXI6IHtcbiAgICAgICAgaWQ6IHVwZGF0ZWRPcmRlci5pZCxcbiAgICAgICAgb3JkZXJOdW1iZXI6IHVwZGF0ZWRPcmRlci5vcmRlck51bWJlcixcbiAgICAgICAgc3RhdHVzOiB1cGRhdGVkT3JkZXIuc3RhdHVzLFxuICAgICAgICBjYW5jZWxsZWRBdDogdXBkYXRlZE9yZGVyLmNhbmNlbGxlZEF0Py50b0lTT1N0cmluZygpXG4gICAgICB9LFxuICAgICAgZXZlbnRzOiBbe1xuICAgICAgICBldmVudElkOiBgZXZ0XyR7RGF0ZS5ub3coKS50b1N0cmluZygzNil9YCxcbiAgICAgICAgZXZlbnRUeXBlOiAnc3ZtLm9yZGVyLmNhbmNlbGxlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XVxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU1ZNXSBFcnJvciBjYW5jZWxsaW5nIG9yZGVyOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJ2YWxpZE9yZGVyVHJhbnNpdGlvbnMiLCJ2YWxpZFBheW1lbnRUcmFuc2l0aW9ucyIsInZhbGlkRnVsZmlsbG1lbnRUcmFuc2l0aW9ucyIsIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJvcmRlcklkIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwidGVuYW50SWQiLCJnZXQiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwic3RhdHVzIiwib3JkZXIiLCJzdm1PcmRlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwiaW5jbHVkZSIsIml0ZW1zIiwib3JkZXJOdW1iZXIiLCJwYXltZW50U3RhdHVzIiwiZnVsZmlsbG1lbnRTdGF0dXMiLCJjdXN0b21lcklkIiwiY3VzdG9tZXJFbWFpbCIsImN1c3RvbWVyUGhvbmUiLCJjdXN0b21lck5hbWUiLCJjaGFubmVsIiwibWFwIiwiaXRlbSIsInByb2R1Y3RJZCIsInZhcmlhbnRJZCIsInByb2R1Y3ROYW1lIiwic2t1IiwidmFyaWFudE5hbWUiLCJpbWFnZVVybCIsInVuaXRQcmljZSIsIk51bWJlciIsInF1YW50aXR5IiwibGluZVRvdGFsIiwiZGlzY291bnRBbW91bnQiLCJ0YXhBbW91bnQiLCJmdWxmaWxsZWRRdWFudGl0eSIsInJlZnVuZGVkUXVhbnRpdHkiLCJjdXN0b21pemF0aW9ucyIsInN1YnRvdGFsIiwic2hpcHBpbmdUb3RhbCIsInRheFRvdGFsIiwiZGlzY291bnRUb3RhbCIsImdyYW5kVG90YWwiLCJyZWZ1bmRlZEFtb3VudCIsInByb21vdGlvbkNvZGUiLCJwcm9tb3Rpb25JZCIsImN1cnJlbmN5Iiwic2hpcHBpbmdBZGRyZXNzIiwiYmlsbGluZ0FkZHJlc3MiLCJzaGlwcGluZ01ldGhvZCIsInNoaXBwaW5nQ2FycmllciIsInRyYWNraW5nTnVtYmVyIiwidHJhY2tpbmdVcmwiLCJlc3RpbWF0ZWREZWxpdmVyeSIsInRvSVNPU3RyaW5nIiwicGF5bWVudE1ldGhvZCIsInBheW1lbnRSZWYiLCJjdXN0b21lck5vdGVzIiwiaW50ZXJuYWxOb3RlcyIsInJlZnVuZFJlYXNvbiIsInBhaWRBdCIsInNoaXBwZWRBdCIsImRlbGl2ZXJlZEF0IiwiY2FuY2VsbGVkQXQiLCJyZWZ1bmRlZEF0IiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwiY29uc29sZSIsIlBVVCIsImJvZHkiLCJ1cGRhdGVEYXRhIiwibm93IiwiRGF0ZSIsImV2ZW50cyIsImFsbG93ZWQiLCJpbmNsdWRlcyIsImpvaW4iLCJwdXNoIiwidHlwZSIsImZyb20iLCJ0byIsInVuZGVmaW5lZCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJ1cGRhdGVkT3JkZXIiLCJ1cGRhdGUiLCJkYXRhIiwibG9nIiwiY2hhbmdlcyIsImUiLCJldmVudElkIiwidG9TdHJpbmciLCJldmVudFR5cGUiLCJwcmV2aW91cyIsImN1cnJlbnQiLCJ0aW1lc3RhbXAiLCJFcnJvciIsIm1lc3NhZ2UiLCJERUxFVEUiLCJwcmV2aW91c1N0YXR1cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/svm/orders/[orderId]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&page=%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2F%5BorderId%5D%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();