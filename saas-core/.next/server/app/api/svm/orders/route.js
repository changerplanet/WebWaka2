"use strict";(()=>{var e={};e.id=4353,e.ids=[4353],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},21379:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>S,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>c,POST:()=>d});var n=r(49303),o=r(88716),a=r(60670),u=r(87070);function i(e){let t=Date.now().toString(36),r=Math.random().toString(36).substring(2,9);return`${e}_${t}${r}`}async function d(e){try{let{tenantId:t,customerId:r,guestEmail:s,items:n,shippingAddress:o,shippingMethod:a,currency:d,shippingTotal:c,taxTotal:p,discountTotal:l}=await e.json();if(!t)return u.NextResponse.json({success:!1,error:"tenantId is required"},{status:400});if(!r&&!s)return u.NextResponse.json({success:!1,error:"Either customerId or guestEmail is required"},{status:400});if(!n||!Array.isArray(n)||0===n.length)return u.NextResponse.json({success:!1,error:"At least one item is required"},{status:400});for(let e of n)if(!e.productId||!e.productName||void 0===e.unitPrice||!e.quantity)return u.NextResponse.json({success:!1,error:"Each item must have productId, productName, unitPrice, and quantity"},{status:400});let m=i("order"),g=function(){let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=Math.floor(9999*Math.random()).toString().padStart(4,"0");return`ORD-${t}${r}${s}-${n}`}(),v=new Date,S=n.map(e=>({productId:e.productId,variantId:e.variantId,productName:e.productName,productSku:e.productSku,variantName:e.variantName,unitPrice:e.unitPrice,quantity:e.quantity,lineTotal:e.unitPrice*e.quantity})),f=S.reduce((e,t)=>e+t.lineTotal,0),h=f+(c||0)+(p||0)-(l||0);return console.log("[SVM] Order Event: svm.order.created",{orderId:m,orderNumber:g,tenantId:t,itemCount:S.length}),u.NextResponse.json({success:!0,order:{id:m,orderNumber:g,status:"DRAFT",tenantId:t,customerId:r,guestEmail:s,items:S,subtotal:f,shippingTotal:c||0,taxTotal:p||0,discountTotal:l||0,grandTotal:h,currency:d||"USD",shippingAddress:o,shippingMethod:a,createdAt:v.toISOString(),updatedAt:v.toISOString()},events:[{eventId:i("evt"),eventType:"svm.order.created",timestamp:v.toISOString()}]},{status:201})}catch(e){return console.error("[SVM] Error creating order:",e),u.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Internal server error"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("tenantId"),s=t.get("customerId"),n=t.get("status"),o=parseInt(t.get("limit")||"50"),a=parseInt(t.get("offset")||"0");if(!r)return u.NextResponse.json({success:!1,error:"tenantId is required"},{status:400});return u.NextResponse.json({success:!0,orders:[],pagination:{limit:o,offset:a,total:0},filters:{tenantId:r,customerId:s||null,status:n||"all"}})}catch(e){return console.error("[SVM] Error listing orders:",e),u.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/svm/orders/route",pathname:"/api/svm/orders",filename:"route",bundlePath:"app/api/svm/orders/route"},resolvedPagePath:"/app/saas-core/src/app/api/svm/orders/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=p,v="/api/svm/orders/route";function S(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9380,5972],()=>r(21379));module.exports=s})();