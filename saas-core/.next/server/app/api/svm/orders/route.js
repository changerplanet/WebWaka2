"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/svm/orders/route";
exports.ids = ["app/api/svm/orders/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2Froute&page=%2Fapi%2Fsvm%2Forders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2Froute&page=%2Fapi%2Fsvm%2Forders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_svm_orders_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/svm/orders/route.ts */ \"(rsc)/./src/app/api/svm/orders/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/svm/orders/route\",\n        pathname: \"/api/svm/orders\",\n        filename: \"route\",\n        bundlePath: \"app/api/svm/orders/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/svm/orders/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_svm_orders_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/svm/orders/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdm0lMkZvcmRlcnMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN2bSUyRm9yZGVycyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN2bSUyRm9yZGVycyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDRjtBQUMzRTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/YTVmOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9zdm0vb3JkZXJzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zdm0vb3JkZXJzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3ZtL29yZGVyc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc3ZtL29yZGVycy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL3N2bS9vcmRlcnMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3N2bS9vcmRlcnMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2Froute&page=%2Fapi%2Fsvm%2Forders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/svm/orders/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/svm/orders/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * SVM Orders API - Database Persistent\n * \n * POST /api/svm/orders - Create a new order from cart or items\n * GET /api/svm/orders - List orders for tenant/customer\n * \n * Uses Prisma for database persistence.\n */ \n\nfunction generateOrderNumber() {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    const seq = Math.floor(Math.random() * 9999).toString().padStart(4, \"0\");\n    return `ORD-${year}${month}${day}-${seq}`;\n}\n/**\n * POST /api/svm/orders\n * Create a new order - can be from cart or direct items\n */ async function POST(request) {\n    try {\n        const body = await request.json();\n        const { tenantId, customerId, cartId, customerEmail, customerPhone, customerName, items, shippingAddress, billingAddress, shippingMethod, shippingCarrier, channel = \"WEB\", currency = \"USD\", shippingTotal = 0, taxTotal = 0, discountTotal = 0, promotionCode, promotionId, customerNotes, ipAddress, userAgent } = body;\n        // Validation\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!shippingAddress) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"shippingAddress is required\"\n            }, {\n                status: 400\n            });\n        }\n        let orderItems = items || [];\n        let sourceCartId = null;\n        let resolvedEmail = customerEmail;\n        // If cartId provided, get items from cart\n        if (cartId) {\n            const cart = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmCart.findUnique({\n                where: {\n                    id: cartId\n                },\n                include: {\n                    items: true\n                }\n            });\n            if (!cart) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Cart not found\"\n                }, {\n                    status: 404\n                });\n            }\n            if (cart.tenantId !== tenantId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Cart does not belong to this tenant\"\n                }, {\n                    status: 403\n                });\n            }\n            if (cart.items.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Cart is empty\"\n                }, {\n                    status: 400\n                });\n            }\n            orderItems = cart.items.map((item)=>({\n                    productId: item.productId,\n                    variantId: item.variantId || undefined,\n                    productName: item.productName,\n                    sku: item.sku || undefined,\n                    variantName: item.variantName || undefined,\n                    imageUrl: item.imageUrl || undefined,\n                    unitPrice: Number(item.unitPrice),\n                    quantity: item.quantity\n                }));\n            sourceCartId = cartId;\n            // Use cart email if not provided\n            if (!resolvedEmail && cart.email) {\n                resolvedEmail = cart.email;\n            }\n        }\n        // Validate items\n        if (!orderItems || orderItems.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"At least one item is required (provide items array or cartId)\"\n            }, {\n                status: 400\n            });\n        }\n        // Email is required\n        if (!resolvedEmail) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"customerEmail is required\"\n            }, {\n                status: 400\n            });\n        }\n        for (const item of orderItems){\n            if (!item.productId || !item.productName || item.unitPrice === undefined || !item.quantity) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: \"Each item must have productId, productName, unitPrice, and quantity\"\n                }, {\n                    status: 400\n                });\n            }\n        }\n        // Calculate totals\n        const subtotal = orderItems.reduce((sum, item)=>sum + item.unitPrice * item.quantity, 0);\n        const grandTotal = subtotal + shippingTotal + taxTotal - discountTotal;\n        // Create order with items in a transaction\n        const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.$transaction(async (tx)=>{\n            // Create the order\n            const newOrder = await tx.svmOrder.create({\n                data: {\n                    tenantId,\n                    orderNumber: generateOrderNumber(),\n                    customerId: customerId || null,\n                    customerEmail: resolvedEmail,\n                    customerPhone: customerPhone || null,\n                    customerName: customerName || null,\n                    status: \"PENDING\",\n                    paymentStatus: \"PENDING\",\n                    fulfillmentStatus: \"UNFULFILLED\",\n                    sourceCartId: sourceCartId,\n                    channel,\n                    currency,\n                    subtotal,\n                    shippingTotal,\n                    taxTotal,\n                    discountTotal,\n                    grandTotal,\n                    promotionCode: promotionCode || null,\n                    promotionId: promotionId || null,\n                    shippingAddress,\n                    billingAddress: billingAddress || null,\n                    shippingMethod: shippingMethod || null,\n                    shippingCarrier: shippingCarrier || null,\n                    customerNotes: customerNotes || null,\n                    ipAddress: ipAddress || null,\n                    userAgent: userAgent || null,\n                    items: {\n                        create: orderItems.map((item)=>({\n                                productId: item.productId,\n                                variantId: item.variantId || null,\n                                productName: item.productName,\n                                sku: item.sku || null,\n                                variantName: item.variantName || null,\n                                imageUrl: item.imageUrl || null,\n                                unitPrice: item.unitPrice,\n                                quantity: item.quantity,\n                                lineTotal: item.unitPrice * item.quantity,\n                                discountAmount: 0,\n                                taxAmount: 0\n                            }))\n                    }\n                },\n                include: {\n                    items: true\n                }\n            });\n            // If created from cart, mark cart as converted\n            if (sourceCartId) {\n                await tx.svmCart.update({\n                    where: {\n                        id: sourceCartId\n                    },\n                    data: {\n                        status: \"CONVERTED\",\n                        convertedOrderId: newOrder.id\n                    }\n                });\n            }\n            return newOrder;\n        });\n        // Emit order created event (logged)\n        console.log(\"[SVM] Order Event: svm.order.created\", {\n            orderId: order.id,\n            orderNumber: order.orderNumber,\n            tenantId,\n            customerEmail: order.customerEmail,\n            itemCount: order.items.length,\n            grandTotal: Number(order.grandTotal)\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            order: {\n                id: order.id,\n                orderNumber: order.orderNumber,\n                status: order.status,\n                paymentStatus: order.paymentStatus,\n                fulfillmentStatus: order.fulfillmentStatus,\n                tenantId: order.tenantId,\n                customerId: order.customerId,\n                customerEmail: order.customerEmail,\n                customerPhone: order.customerPhone,\n                customerName: order.customerName,\n                channel: order.channel,\n                items: order.items.map((item)=>({\n                        id: item.id,\n                        productId: item.productId,\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        sku: item.sku,\n                        variantName: item.variantName,\n                        imageUrl: item.imageUrl,\n                        unitPrice: Number(item.unitPrice),\n                        quantity: item.quantity,\n                        lineTotal: Number(item.lineTotal),\n                        discountAmount: Number(item.discountAmount),\n                        taxAmount: Number(item.taxAmount)\n                    })),\n                subtotal: Number(order.subtotal),\n                shippingTotal: Number(order.shippingTotal),\n                taxTotal: Number(order.taxTotal),\n                discountTotal: Number(order.discountTotal),\n                grandTotal: Number(order.grandTotal),\n                promotionCode: order.promotionCode,\n                currency: order.currency,\n                shippingAddress: order.shippingAddress,\n                billingAddress: order.billingAddress,\n                shippingMethod: order.shippingMethod,\n                customerNotes: order.customerNotes,\n                createdAt: order.createdAt.toISOString(),\n                updatedAt: order.updatedAt.toISOString()\n            },\n            events: [\n                {\n                    eventId: `evt_${Date.now().toString(36)}`,\n                    eventType: \"svm.order.created\",\n                    timestamp: new Date().toISOString()\n                }\n            ]\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error creating order:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * GET /api/svm/orders\n * List orders for the tenant, optionally filtered by customer/status\n */ async function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const tenantId = searchParams.get(\"tenantId\");\n        const customerId = searchParams.get(\"customerId\");\n        const customerEmail = searchParams.get(\"customerEmail\");\n        const status = searchParams.get(\"status\");\n        const paymentStatus = searchParams.get(\"paymentStatus\");\n        const fulfillmentStatus = searchParams.get(\"fulfillmentStatus\");\n        const orderNumber = searchParams.get(\"orderNumber\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        if (!tenantId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"tenantId is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Build where clause\n        const where = {\n            tenantId\n        };\n        if (customerId) where.customerId = customerId;\n        if (customerEmail) where.customerEmail = customerEmail;\n        if (status) where.status = status;\n        if (paymentStatus) where.paymentStatus = paymentStatus;\n        if (fulfillmentStatus) where.fulfillmentStatus = fulfillmentStatus;\n        if (orderNumber) where.orderNumber = {\n            contains: orderNumber,\n            mode: \"insensitive\"\n        };\n        // Get total count\n        const total = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.count({\n            where\n        });\n        // Get orders with items\n        const orders = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.findMany({\n            where,\n            include: {\n                items: true\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            skip: offset,\n            take: limit\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            orders: orders.map((order)=>({\n                    id: order.id,\n                    orderNumber: order.orderNumber,\n                    status: order.status,\n                    paymentStatus: order.paymentStatus,\n                    fulfillmentStatus: order.fulfillmentStatus,\n                    tenantId: order.tenantId,\n                    customerId: order.customerId,\n                    customerEmail: order.customerEmail,\n                    customerPhone: order.customerPhone,\n                    customerName: order.customerName,\n                    channel: order.channel,\n                    items: order.items.map((item)=>({\n                            id: item.id,\n                            productId: item.productId,\n                            variantId: item.variantId,\n                            productName: item.productName,\n                            sku: item.sku,\n                            variantName: item.variantName,\n                            imageUrl: item.imageUrl,\n                            unitPrice: Number(item.unitPrice),\n                            quantity: item.quantity,\n                            lineTotal: Number(item.lineTotal),\n                            discountAmount: Number(item.discountAmount),\n                            taxAmount: Number(item.taxAmount),\n                            fulfilledQuantity: item.fulfilledQuantity,\n                            refundedQuantity: item.refundedQuantity\n                        })),\n                    subtotal: Number(order.subtotal),\n                    shippingTotal: Number(order.shippingTotal),\n                    taxTotal: Number(order.taxTotal),\n                    discountTotal: Number(order.discountTotal),\n                    grandTotal: Number(order.grandTotal),\n                    refundedAmount: Number(order.refundedAmount),\n                    promotionCode: order.promotionCode,\n                    currency: order.currency,\n                    shippingAddress: order.shippingAddress,\n                    billingAddress: order.billingAddress,\n                    shippingMethod: order.shippingMethod,\n                    shippingCarrier: order.shippingCarrier,\n                    trackingNumber: order.trackingNumber,\n                    trackingUrl: order.trackingUrl,\n                    paidAt: order.paidAt?.toISOString() || null,\n                    shippedAt: order.shippedAt?.toISOString() || null,\n                    deliveredAt: order.deliveredAt?.toISOString() || null,\n                    cancelledAt: order.cancelledAt?.toISOString() || null,\n                    refundedAt: order.refundedAt?.toISOString() || null,\n                    createdAt: order.createdAt.toISOString(),\n                    updatedAt: order.updatedAt.toISOString()\n                })),\n            pagination: {\n                limit,\n                offset,\n                total\n            },\n            filters: {\n                tenantId,\n                customerId: customerId || null,\n                customerEmail: customerEmail || null,\n                status: status || \"all\",\n                paymentStatus: paymentStatus || \"all\",\n                fulfillmentStatus: fulfillmentStatus || \"all\",\n                orderNumber: orderNumber || null\n            }\n        });\n    } catch (error) {\n        console.error(\"[SVM] Error listing orders:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJBQWlCO29CQUM3Q2lDLGFBQWFyRCxNQUFNcUQsV0FBVyxFQUFFakMsaUJBQWlCO29CQUNqRGtDLGFBQWF0RCxNQUFNc0QsV0FBVyxFQUFFbEMsaUJBQWlCO29CQUNqRG1DLFlBQVl2RCxNQUFNdUQsVUFBVSxFQUFFbkMsaUJBQWlCO29CQUMvQ0QsV0FBV25CLE1BQU1tQixTQUFTLENBQUNDLFdBQVc7b0JBQ3RDQyxXQUFXckIsTUFBTXFCLFNBQVMsQ0FBQ0QsV0FBVztnQkFDeEM7WUFDQW9DLFlBQVk7Z0JBQ1Z0QjtnQkFDQUU7Z0JBQ0FHO1lBQ0Y7WUFDQWtCLFNBQVM7Z0JBQ1A1RztnQkFDQUMsWUFBWUEsY0FBYztnQkFDMUJFLGVBQWVBLGlCQUFpQjtnQkFDaENvQixRQUFRQSxVQUFVO2dCQUNsQm9DLGVBQWVBLGlCQUFpQjtnQkFDaENDLG1CQUFtQkEscUJBQXFCO2dCQUN4Q0YsYUFBYUEsZUFBZTtZQUM5QjtRQUNGO0lBRUYsRUFBRSxPQUFPcEMsT0FBTztRQUNkNEMsUUFBUTVDLEtBQUssQ0FBQywrQkFBK0JBO1FBQzdDLE9BQU81QyxxREFBWUEsQ0FBQ3FCLElBQUksQ0FDdEI7WUFBRXNCLFNBQVM7WUFBT0MsT0FBTztRQUF3QixHQUNqRDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8uL3NyYy9hcHAvYXBpL3N2bS9vcmRlcnMvcm91dGUudHM/Y2VkNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNWTSBPcmRlcnMgQVBJIC0gRGF0YWJhc2UgUGVyc2lzdGVudFxuICogXG4gKiBQT1NUIC9hcGkvc3ZtL29yZGVycyAtIENyZWF0ZSBhIG5ldyBvcmRlciBmcm9tIGNhcnQgb3IgaXRlbXNcbiAqIEdFVCAvYXBpL3N2bS9vcmRlcnMgLSBMaXN0IG9yZGVycyBmb3IgdGVuYW50L2N1c3RvbWVyXG4gKiBcbiAqIFVzZXMgUHJpc21hIGZvciBkYXRhYmFzZSBwZXJzaXN0ZW5jZS5cbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnXG5cbmludGVyZmFjZSBPcmRlckl0ZW1JbnB1dCB7XG4gIHByb2R1Y3RJZDogc3RyaW5nXG4gIHZhcmlhbnRJZD86IHN0cmluZ1xuICBwcm9kdWN0TmFtZTogc3RyaW5nXG4gIHNrdT86IHN0cmluZ1xuICB2YXJpYW50TmFtZT86IHN0cmluZ1xuICBpbWFnZVVybD86IHN0cmluZ1xuICB1bml0UHJpY2U6IG51bWJlclxuICBxdWFudGl0eTogbnVtYmVyXG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlT3JkZXJOdW1iZXIoKTogc3RyaW5nIHtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcbiAgY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKVxuICBjb25zdCBtb250aCA9IFN0cmluZyhkYXRlLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpXG4gIGNvbnN0IGRheSA9IFN0cmluZyhkYXRlLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKVxuICBjb25zdCBzZXEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA5OTk5KS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJylcbiAgcmV0dXJuIGBPUkQtJHt5ZWFyfSR7bW9udGh9JHtkYXl9LSR7c2VxfWBcbn1cblxuLyoqXG4gKiBQT1NUIC9hcGkvc3ZtL29yZGVyc1xuICogQ3JlYXRlIGEgbmV3IG9yZGVyIC0gY2FuIGJlIGZyb20gY2FydCBvciBkaXJlY3QgaXRlbXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IFxuICAgICAgdGVuYW50SWQsIFxuICAgICAgY3VzdG9tZXJJZCwgXG4gICAgICBjYXJ0SWQsIC8vIE9wdGlvbmFsOiBjcmVhdGUgZnJvbSBleGlzdGluZyBjYXJ0XG4gICAgICBjdXN0b21lckVtYWlsLFxuICAgICAgY3VzdG9tZXJQaG9uZSxcbiAgICAgIGN1c3RvbWVyTmFtZSxcbiAgICAgIGl0ZW1zLCAvLyBPcHRpb25hbCBpZiBjYXJ0SWQgcHJvdmlkZWRcbiAgICAgIHNoaXBwaW5nQWRkcmVzcywgXG4gICAgICBiaWxsaW5nQWRkcmVzcyxcbiAgICAgIHNoaXBwaW5nTWV0aG9kLFxuICAgICAgc2hpcHBpbmdDYXJyaWVyLFxuICAgICAgY2hhbm5lbCA9ICdXRUInLFxuICAgICAgY3VycmVuY3kgPSAnVVNEJyxcbiAgICAgIHNoaXBwaW5nVG90YWwgPSAwLFxuICAgICAgdGF4VG90YWwgPSAwLFxuICAgICAgZGlzY291bnRUb3RhbCA9IDAsXG4gICAgICBwcm9tb3Rpb25Db2RlLFxuICAgICAgcHJvbW90aW9uSWQsXG4gICAgICBjdXN0b21lck5vdGVzLFxuICAgICAgaXBBZGRyZXNzLFxuICAgICAgdXNlckFnZW50XG4gICAgfSA9IGJvZHlcblxuICAgIC8vIFZhbGlkYXRpb25cbiAgICBpZiAoIXRlbmFudElkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAndGVuYW50SWQgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGlmICghc2hpcHBpbmdBZGRyZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnc2hpcHBpbmdBZGRyZXNzIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBsZXQgb3JkZXJJdGVtczogT3JkZXJJdGVtSW5wdXRbXSA9IGl0ZW1zIHx8IFtdXG4gICAgbGV0IHNvdXJjZUNhcnRJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgICBsZXQgcmVzb2x2ZWRFbWFpbCA9IGN1c3RvbWVyRW1haWxcblxuICAgIC8vIElmIGNhcnRJZCBwcm92aWRlZCwgZ2V0IGl0ZW1zIGZyb20gY2FydFxuICAgIGlmIChjYXJ0SWQpIHtcbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBwcmlzbWEuc3ZtQ2FydC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNhcnRJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7IGl0ZW1zOiB0cnVlIH1cbiAgICAgIH0pXG5cbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDYXJ0IG5vdCBmb3VuZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDA0IH1cbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBpZiAoY2FydC50ZW5hbnRJZCAhPT0gdGVuYW50SWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2FydCBkb2VzIG5vdCBiZWxvbmcgdG8gdGhpcyB0ZW5hbnQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgaWYgKGNhcnQuaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NhcnQgaXMgZW1wdHknIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgb3JkZXJJdGVtcyA9IGNhcnQuaXRlbXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgcHJvZHVjdElkOiBpdGVtLnByb2R1Y3RJZCxcbiAgICAgICAgdmFyaWFudElkOiBpdGVtLnZhcmlhbnRJZCB8fCB1bmRlZmluZWQsXG4gICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3ROYW1lLFxuICAgICAgICBza3U6IGl0ZW0uc2t1IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgdmFyaWFudE5hbWU6IGl0ZW0udmFyaWFudE5hbWUgfHwgdW5kZWZpbmVkLFxuICAgICAgICBpbWFnZVVybDogaXRlbS5pbWFnZVVybCB8fCB1bmRlZmluZWQsXG4gICAgICAgIHVuaXRQcmljZTogTnVtYmVyKGl0ZW0udW5pdFByaWNlKSxcbiAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHlcbiAgICAgIH0pKVxuICAgICAgXG4gICAgICBzb3VyY2VDYXJ0SWQgPSBjYXJ0SWRcbiAgICAgIFxuICAgICAgLy8gVXNlIGNhcnQgZW1haWwgaWYgbm90IHByb3ZpZGVkXG4gICAgICBpZiAoIXJlc29sdmVkRW1haWwgJiYgY2FydC5lbWFpbCkge1xuICAgICAgICByZXNvbHZlZEVtYWlsID0gY2FydC5lbWFpbFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGl0ZW1zXG4gICAgaWYgKCFvcmRlckl0ZW1zIHx8IG9yZGVySXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXQgbGVhc3Qgb25lIGl0ZW0gaXMgcmVxdWlyZWQgKHByb3ZpZGUgaXRlbXMgYXJyYXkgb3IgY2FydElkKScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gRW1haWwgaXMgcmVxdWlyZWRcbiAgICBpZiAoIXJlc29sdmVkRW1haWwpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdjdXN0b21lckVtYWlsIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygb3JkZXJJdGVtcykge1xuICAgICAgaWYgKCFpdGVtLnByb2R1Y3RJZCB8fCAhaXRlbS5wcm9kdWN0TmFtZSB8fCBpdGVtLnVuaXRQcmljZSA9PT0gdW5kZWZpbmVkIHx8ICFpdGVtLnF1YW50aXR5KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0VhY2ggaXRlbSBtdXN0IGhhdmUgcHJvZHVjdElkLCBwcm9kdWN0TmFtZSwgdW5pdFByaWNlLCBhbmQgcXVhbnRpdHknIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgdG90YWxzXG4gICAgY29uc3Qgc3VidG90YWwgPSBvcmRlckl0ZW1zLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyAoaXRlbS51bml0UHJpY2UgKiBpdGVtLnF1YW50aXR5KSwgMClcbiAgICBjb25zdCBncmFuZFRvdGFsID0gc3VidG90YWwgKyBzaGlwcGluZ1RvdGFsICsgdGF4VG90YWwgLSBkaXNjb3VudFRvdGFsXG5cbiAgICAvLyBDcmVhdGUgb3JkZXIgd2l0aCBpdGVtcyBpbiBhIHRyYW5zYWN0aW9uXG4gICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIHRoZSBvcmRlclxuICAgICAgY29uc3QgbmV3T3JkZXIgPSBhd2FpdCB0eC5zdm1PcmRlci5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdGVuYW50SWQsXG4gICAgICAgICAgb3JkZXJOdW1iZXI6IGdlbmVyYXRlT3JkZXJOdW1iZXIoKSxcbiAgICAgICAgICBjdXN0b21lcklkOiBjdXN0b21lcklkIHx8IG51bGwsXG4gICAgICAgICAgY3VzdG9tZXJFbWFpbDogcmVzb2x2ZWRFbWFpbCxcbiAgICAgICAgICBjdXN0b21lclBob25lOiBjdXN0b21lclBob25lIHx8IG51bGwsXG4gICAgICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUgfHwgbnVsbCxcbiAgICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyxcbiAgICAgICAgICBwYXltZW50U3RhdHVzOiAnUEVORElORycsXG4gICAgICAgICAgZnVsZmlsbG1lbnRTdGF0dXM6ICdVTkZVTEZJTExFRCcsXG4gICAgICAgICAgc291cmNlQ2FydElkOiBzb3VyY2VDYXJ0SWQsXG4gICAgICAgICAgY2hhbm5lbCxcbiAgICAgICAgICBjdXJyZW5jeSxcbiAgICAgICAgICBzdWJ0b3RhbCxcbiAgICAgICAgICBzaGlwcGluZ1RvdGFsLFxuICAgICAgICAgIHRheFRvdGFsLFxuICAgICAgICAgIGRpc2NvdW50VG90YWwsXG4gICAgICAgICAgZ3JhbmRUb3RhbCxcbiAgICAgICAgICBwcm9tb3Rpb25Db2RlOiBwcm9tb3Rpb25Db2RlIHx8IG51bGwsXG4gICAgICAgICAgcHJvbW90aW9uSWQ6IHByb21vdGlvbklkIHx8IG51bGwsXG4gICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLFxuICAgICAgICAgIGJpbGxpbmdBZGRyZXNzOiBiaWxsaW5nQWRkcmVzcyB8fCBudWxsLFxuICAgICAgICAgIHNoaXBwaW5nTWV0aG9kOiBzaGlwcGluZ01ldGhvZCB8fCBudWxsLFxuICAgICAgICAgIHNoaXBwaW5nQ2Fycmllcjogc2hpcHBpbmdDYXJyaWVyIHx8IG51bGwsXG4gICAgICAgICAgY3VzdG9tZXJOb3RlczogY3VzdG9tZXJOb3RlcyB8fCBudWxsLFxuICAgICAgICAgIGlwQWRkcmVzczogaXBBZGRyZXNzIHx8IG51bGwsXG4gICAgICAgICAgdXNlckFnZW50OiB1c2VyQWdlbnQgfHwgbnVsbCxcbiAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgY3JlYXRlOiBvcmRlckl0ZW1zLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsXG4gICAgICAgICAgICAgIHZhcmlhbnRJZDogaXRlbS52YXJpYW50SWQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsXG4gICAgICAgICAgICAgIHNrdTogaXRlbS5za3UgfHwgbnVsbCxcbiAgICAgICAgICAgICAgdmFyaWFudE5hbWU6IGl0ZW0udmFyaWFudE5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgaW1hZ2VVcmw6IGl0ZW0uaW1hZ2VVcmwgfHwgbnVsbCxcbiAgICAgICAgICAgICAgdW5pdFByaWNlOiBpdGVtLnVuaXRQcmljZSxcbiAgICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICAgIGxpbmVUb3RhbDogaXRlbS51bml0UHJpY2UgKiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICBkaXNjb3VudEFtb3VudDogMCxcbiAgICAgICAgICAgICAgdGF4QW1vdW50OiAwXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgaXRlbXM6IHRydWUgfVxuICAgICAgfSlcblxuICAgICAgLy8gSWYgY3JlYXRlZCBmcm9tIGNhcnQsIG1hcmsgY2FydCBhcyBjb252ZXJ0ZWRcbiAgICAgIGlmIChzb3VyY2VDYXJ0SWQpIHtcbiAgICAgICAgYXdhaXQgdHguc3ZtQ2FydC51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBzb3VyY2VDYXJ0SWQgfSxcbiAgICAgICAgICBkYXRhOiB7IFxuICAgICAgICAgICAgc3RhdHVzOiAnQ09OVkVSVEVEJyxcbiAgICAgICAgICAgIGNvbnZlcnRlZE9yZGVySWQ6IG5ld09yZGVyLmlkXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3T3JkZXJcbiAgICB9KVxuXG4gICAgLy8gRW1pdCBvcmRlciBjcmVhdGVkIGV2ZW50IChsb2dnZWQpXG4gICAgY29uc29sZS5sb2coJ1tTVk1dIE9yZGVyIEV2ZW50OiBzdm0ub3JkZXIuY3JlYXRlZCcsIHtcbiAgICAgIG9yZGVySWQ6IG9yZGVyLmlkLFxuICAgICAgb3JkZXJOdW1iZXI6IG9yZGVyLm9yZGVyTnVtYmVyLFxuICAgICAgdGVuYW50SWQsXG4gICAgICBjdXN0b21lckVtYWlsOiBvcmRlci5jdXN0b21lckVtYWlsLFxuICAgICAgaXRlbUNvdW50OiBvcmRlci5pdGVtcy5sZW5ndGgsXG4gICAgICBncmFuZFRvdGFsOiBOdW1iZXIob3JkZXIuZ3JhbmRUb3RhbClcbiAgICB9KVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBvcmRlcjoge1xuICAgICAgICBpZDogb3JkZXIuaWQsXG4gICAgICAgIG9yZGVyTnVtYmVyOiBvcmRlci5vcmRlck51bWJlcixcbiAgICAgICAgc3RhdHVzOiBvcmRlci5zdGF0dXMsXG4gICAgICAgIHBheW1lbnRTdGF0dXM6IG9yZGVyLnBheW1lbnRTdGF0dXMsXG4gICAgICAgIGZ1bGZpbGxtZW50U3RhdHVzOiBvcmRlci5mdWxmaWxsbWVudFN0YXR1cyxcbiAgICAgICAgdGVuYW50SWQ6IG9yZGVyLnRlbmFudElkLFxuICAgICAgICBjdXN0b21lcklkOiBvcmRlci5jdXN0b21lcklkLFxuICAgICAgICBjdXN0b21lckVtYWlsOiBvcmRlci5jdXN0b21lckVtYWlsLFxuICAgICAgICBjdXN0b21lclBob25lOiBvcmRlci5jdXN0b21lclBob25lLFxuICAgICAgICBjdXN0b21lck5hbWU6IG9yZGVyLmN1c3RvbWVyTmFtZSxcbiAgICAgICAgY2hhbm5lbDogb3JkZXIuY2hhbm5lbCxcbiAgICAgICAgaXRlbXM6IG9yZGVyLml0ZW1zLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgcHJvZHVjdElkOiBpdGVtLnByb2R1Y3RJZCxcbiAgICAgICAgICB2YXJpYW50SWQ6IGl0ZW0udmFyaWFudElkLFxuICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3ROYW1lLFxuICAgICAgICAgIHNrdTogaXRlbS5za3UsXG4gICAgICAgICAgdmFyaWFudE5hbWU6IGl0ZW0udmFyaWFudE5hbWUsXG4gICAgICAgICAgaW1hZ2VVcmw6IGl0ZW0uaW1hZ2VVcmwsXG4gICAgICAgICAgdW5pdFByaWNlOiBOdW1iZXIoaXRlbS51bml0UHJpY2UpLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIGxpbmVUb3RhbDogTnVtYmVyKGl0ZW0ubGluZVRvdGFsKSxcbiAgICAgICAgICBkaXNjb3VudEFtb3VudDogTnVtYmVyKGl0ZW0uZGlzY291bnRBbW91bnQpLFxuICAgICAgICAgIHRheEFtb3VudDogTnVtYmVyKGl0ZW0udGF4QW1vdW50KVxuICAgICAgICB9KSksXG4gICAgICAgIHN1YnRvdGFsOiBOdW1iZXIob3JkZXIuc3VidG90YWwpLFxuICAgICAgICBzaGlwcGluZ1RvdGFsOiBOdW1iZXIob3JkZXIuc2hpcHBpbmdUb3RhbCksXG4gICAgICAgIHRheFRvdGFsOiBOdW1iZXIob3JkZXIudGF4VG90YWwpLFxuICAgICAgICBkaXNjb3VudFRvdGFsOiBOdW1iZXIob3JkZXIuZGlzY291bnRUb3RhbCksXG4gICAgICAgIGdyYW5kVG90YWw6IE51bWJlcihvcmRlci5ncmFuZFRvdGFsKSxcbiAgICAgICAgcHJvbW90aW9uQ29kZTogb3JkZXIucHJvbW90aW9uQ29kZSxcbiAgICAgICAgY3VycmVuY3k6IG9yZGVyLmN1cnJlbmN5LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IG9yZGVyLnNoaXBwaW5nQWRkcmVzcyxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IG9yZGVyLmJpbGxpbmdBZGRyZXNzLFxuICAgICAgICBzaGlwcGluZ01ldGhvZDogb3JkZXIuc2hpcHBpbmdNZXRob2QsXG4gICAgICAgIGN1c3RvbWVyTm90ZXM6IG9yZGVyLmN1c3RvbWVyTm90ZXMsXG4gICAgICAgIGNyZWF0ZWRBdDogb3JkZXIuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVwZGF0ZWRBdDogb3JkZXIudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgIH0sXG4gICAgICBldmVudHM6IFt7XG4gICAgICAgIGV2ZW50SWQ6IGBldnRfJHtEYXRlLm5vdygpLnRvU3RyaW5nKDM2KX1gLFxuICAgICAgICBldmVudFR5cGU6ICdzdm0ub3JkZXIuY3JlYXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XVxuICAgIH0sIHsgc3RhdHVzOiAyMDEgfSlcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTVk1dIEVycm9yIGNyZWF0aW5nIG9yZGVyOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuLyoqXG4gKiBHRVQgL2FwaS9zdm0vb3JkZXJzXG4gKiBMaXN0IG9yZGVycyBmb3IgdGhlIHRlbmFudCwgb3B0aW9uYWxseSBmaWx0ZXJlZCBieSBjdXN0b21lci9zdGF0dXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICAgIGNvbnN0IHRlbmFudElkID0gc2VhcmNoUGFyYW1zLmdldCgndGVuYW50SWQnKVxuICAgIGNvbnN0IGN1c3RvbWVySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdjdXN0b21lcklkJylcbiAgICBjb25zdCBjdXN0b21lckVtYWlsID0gc2VhcmNoUGFyYW1zLmdldCgnY3VzdG9tZXJFbWFpbCcpXG4gICAgY29uc3Qgc3RhdHVzID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhdHVzJylcbiAgICBjb25zdCBwYXltZW50U3RhdHVzID0gc2VhcmNoUGFyYW1zLmdldCgncGF5bWVudFN0YXR1cycpXG4gICAgY29uc3QgZnVsZmlsbG1lbnRTdGF0dXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdmdWxmaWxsbWVudFN0YXR1cycpXG4gICAgY29uc3Qgb3JkZXJOdW1iZXIgPSBzZWFyY2hQYXJhbXMuZ2V0KCdvcmRlck51bWJlcicpXG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc1MCcpXG4gICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnb2Zmc2V0JykgfHwgJzAnKVxuXG4gICAgaWYgKCF0ZW5hbnRJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ3RlbmFudElkIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBCdWlsZCB3aGVyZSBjbGF1c2VcbiAgICBjb25zdCB3aGVyZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7IHRlbmFudElkIH1cbiAgICBcbiAgICBpZiAoY3VzdG9tZXJJZCkgd2hlcmUuY3VzdG9tZXJJZCA9IGN1c3RvbWVySWRcbiAgICBpZiAoY3VzdG9tZXJFbWFpbCkgd2hlcmUuY3VzdG9tZXJFbWFpbCA9IGN1c3RvbWVyRW1haWxcbiAgICBpZiAoc3RhdHVzKSB3aGVyZS5zdGF0dXMgPSBzdGF0dXNcbiAgICBpZiAocGF5bWVudFN0YXR1cykgd2hlcmUucGF5bWVudFN0YXR1cyA9IHBheW1lbnRTdGF0dXNcbiAgICBpZiAoZnVsZmlsbG1lbnRTdGF0dXMpIHdoZXJlLmZ1bGZpbGxtZW50U3RhdHVzID0gZnVsZmlsbG1lbnRTdGF0dXNcbiAgICBpZiAob3JkZXJOdW1iZXIpIHdoZXJlLm9yZGVyTnVtYmVyID0geyBjb250YWluczogb3JkZXJOdW1iZXIsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfVxuXG4gICAgLy8gR2V0IHRvdGFsIGNvdW50XG4gICAgY29uc3QgdG90YWwgPSBhd2FpdCBwcmlzbWEuc3ZtT3JkZXIuY291bnQoeyB3aGVyZSB9KVxuXG4gICAgLy8gR2V0IG9yZGVycyB3aXRoIGl0ZW1zXG4gICAgY29uc3Qgb3JkZXJzID0gYXdhaXQgcHJpc21hLnN2bU9yZGVyLmZpbmRNYW55KHtcbiAgICAgIHdoZXJlLFxuICAgICAgaW5jbHVkZTogeyBpdGVtczogdHJ1ZSB9LFxuICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgc2tpcDogb2Zmc2V0LFxuICAgICAgdGFrZTogbGltaXRcbiAgICB9KVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBvcmRlcnM6IG9yZGVycy5tYXAob3JkZXIgPT4gKHtcbiAgICAgICAgaWQ6IG9yZGVyLmlkLFxuICAgICAgICBvcmRlck51bWJlcjogb3JkZXIub3JkZXJOdW1iZXIsXG4gICAgICAgIHN0YXR1czogb3JkZXIuc3RhdHVzLFxuICAgICAgICBwYXltZW50U3RhdHVzOiBvcmRlci5wYXltZW50U3RhdHVzLFxuICAgICAgICBmdWxmaWxsbWVudFN0YXR1czogb3JkZXIuZnVsZmlsbG1lbnRTdGF0dXMsXG4gICAgICAgIHRlbmFudElkOiBvcmRlci50ZW5hbnRJZCxcbiAgICAgICAgY3VzdG9tZXJJZDogb3JkZXIuY3VzdG9tZXJJZCxcbiAgICAgICAgY3VzdG9tZXJFbWFpbDogb3JkZXIuY3VzdG9tZXJFbWFpbCxcbiAgICAgICAgY3VzdG9tZXJQaG9uZTogb3JkZXIuY3VzdG9tZXJQaG9uZSxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiBvcmRlci5jdXN0b21lck5hbWUsXG4gICAgICAgIGNoYW5uZWw6IG9yZGVyLmNoYW5uZWwsXG4gICAgICAgIGl0ZW1zOiBvcmRlci5pdGVtcy5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgIGlkOiBpdGVtLmlkLFxuICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsXG4gICAgICAgICAgdmFyaWFudElkOiBpdGVtLnZhcmlhbnRJZCxcbiAgICAgICAgICBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0TmFtZSxcbiAgICAgICAgICBza3U6IGl0ZW0uc2t1LFxuICAgICAgICAgIHZhcmlhbnROYW1lOiBpdGVtLnZhcmlhbnROYW1lLFxuICAgICAgICAgIGltYWdlVXJsOiBpdGVtLmltYWdlVXJsLFxuICAgICAgICAgIHVuaXRQcmljZTogTnVtYmVyKGl0ZW0udW5pdFByaWNlKSxcbiAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICBsaW5lVG90YWw6IE51bWJlcihpdGVtLmxpbmVUb3RhbCksXG4gICAgICAgICAgZGlzY291bnRBbW91bnQ6IE51bWJlcihpdGVtLmRpc2NvdW50QW1vdW50KSxcbiAgICAgICAgICB0YXhBbW91bnQ6IE51bWJlcihpdGVtLnRheEFtb3VudCksXG4gICAgICAgICAgZnVsZmlsbGVkUXVhbnRpdHk6IGl0ZW0uZnVsZmlsbGVkUXVhbnRpdHksXG4gICAgICAgICAgcmVmdW5kZWRRdWFudGl0eTogaXRlbS5yZWZ1bmRlZFF1YW50aXR5XG4gICAgICAgIH0pKSxcbiAgICAgICAgc3VidG90YWw6IE51bWJlcihvcmRlci5zdWJ0b3RhbCksXG4gICAgICAgIHNoaXBwaW5nVG90YWw6IE51bWJlcihvcmRlci5zaGlwcGluZ1RvdGFsKSxcbiAgICAgICAgdGF4VG90YWw6IE51bWJlcihvcmRlci50YXhUb3RhbCksXG4gICAgICAgIGRpc2NvdW50VG90YWw6IE51bWJlcihvcmRlci5kaXNjb3VudFRvdGFsKSxcbiAgICAgICAgZ3JhbmRUb3RhbDogTnVtYmVyKG9yZGVyLmdyYW5kVG90YWwpLFxuICAgICAgICByZWZ1bmRlZEFtb3VudDogTnVtYmVyKG9yZGVyLnJlZnVuZGVkQW1vdW50KSxcbiAgICAgICAgcHJvbW90aW9uQ29kZTogb3JkZXIucHJvbW90aW9uQ29kZSxcbiAgICAgICAgY3VycmVuY3k6IG9yZGVyLmN1cnJlbmN5LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IG9yZGVyLnNoaXBwaW5nQWRkcmVzcyxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IG9yZGVyLmJpbGxpbmdBZGRyZXNzLFxuICAgICAgICBzaGlwcGluZ01ldGhvZDogb3JkZXIuc2hpcHBpbmdNZXRob2QsXG4gICAgICAgIHNoaXBwaW5nQ2Fycmllcjogb3JkZXIuc2hpcHBpbmdDYXJyaWVyLFxuICAgICAgICB0cmFja2luZ051bWJlcjogb3JkZXIudHJhY2tpbmdOdW1iZXIsXG4gICAgICAgIHRyYWNraW5nVXJsOiBvcmRlci50cmFja2luZ1VybCxcbiAgICAgICAgcGFpZEF0OiBvcmRlci5wYWlkQXQ/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbCxcbiAgICAgICAgc2hpcHBlZEF0OiBvcmRlci5zaGlwcGVkQXQ/LnRvSVNPU3RyaW5nKCkgfHwgbnVsbCxcbiAgICAgICAgZGVsaXZlcmVkQXQ6IG9yZGVyLmRlbGl2ZXJlZEF0Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIGNhbmNlbGxlZEF0OiBvcmRlci5jYW5jZWxsZWRBdD8udG9JU09TdHJpbmcoKSB8fCBudWxsLFxuICAgICAgICByZWZ1bmRlZEF0OiBvcmRlci5yZWZ1bmRlZEF0Py50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgIGNyZWF0ZWRBdDogb3JkZXIuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVwZGF0ZWRBdDogb3JkZXIudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgIH0pKSxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgbGltaXQsXG4gICAgICAgIG9mZnNldCxcbiAgICAgICAgdG90YWxcbiAgICAgIH0sXG4gICAgICBmaWx0ZXJzOiB7XG4gICAgICAgIHRlbmFudElkLFxuICAgICAgICBjdXN0b21lcklkOiBjdXN0b21lcklkIHx8IG51bGwsXG4gICAgICAgIGN1c3RvbWVyRW1haWw6IGN1c3RvbWVyRW1haWwgfHwgbnVsbCxcbiAgICAgICAgc3RhdHVzOiBzdGF0dXMgfHwgJ2FsbCcsXG4gICAgICAgIHBheW1lbnRTdGF0dXM6IHBheW1lbnRTdGF0dXMgfHwgJ2FsbCcsXG4gICAgICAgIGZ1bGZpbGxtZW50U3RhdHVzOiBmdWxmaWxsbWVudFN0YXR1cyB8fCAnYWxsJyxcbiAgICAgICAgb3JkZXJOdW1iZXI6IG9yZGVyTnVtYmVyIHx8IG51bGxcbiAgICAgIH1cbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1NWTV0gRXJyb3IgbGlzdGluZyBvcmRlcnM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJnZW5lcmF0ZU9yZGVyTnVtYmVyIiwiZGF0ZSIsIkRhdGUiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJtb250aCIsIlN0cmluZyIsImdldE1vbnRoIiwicGFkU3RhcnQiLCJkYXkiLCJnZXREYXRlIiwic2VxIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwidGVuYW50SWQiLCJjdXN0b21lcklkIiwiY2FydElkIiwiY3VzdG9tZXJFbWFpbCIsImN1c3RvbWVyUGhvbmUiLCJjdXN0b21lck5hbWUiLCJpdGVtcyIsInNoaXBwaW5nQWRkcmVzcyIsImJpbGxpbmdBZGRyZXNzIiwic2hpcHBpbmdNZXRob2QiLCJzaGlwcGluZ0NhcnJpZXIiLCJjaGFubmVsIiwiY3VycmVuY3kiLCJzaGlwcGluZ1RvdGFsIiwidGF4VG90YWwiLCJkaXNjb3VudFRvdGFsIiwicHJvbW90aW9uQ29kZSIsInByb21vdGlvbklkIiwiY3VzdG9tZXJOb3RlcyIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsIm9yZGVySXRlbXMiLCJzb3VyY2VDYXJ0SWQiLCJyZXNvbHZlZEVtYWlsIiwiY2FydCIsInN2bUNhcnQiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpZCIsImluY2x1ZGUiLCJsZW5ndGgiLCJtYXAiLCJpdGVtIiwicHJvZHVjdElkIiwidmFyaWFudElkIiwidW5kZWZpbmVkIiwicHJvZHVjdE5hbWUiLCJza3UiLCJ2YXJpYW50TmFtZSIsImltYWdlVXJsIiwidW5pdFByaWNlIiwiTnVtYmVyIiwicXVhbnRpdHkiLCJlbWFpbCIsInN1YnRvdGFsIiwicmVkdWNlIiwic3VtIiwiZ3JhbmRUb3RhbCIsIm9yZGVyIiwiJHRyYW5zYWN0aW9uIiwidHgiLCJuZXdPcmRlciIsInN2bU9yZGVyIiwiY3JlYXRlIiwiZGF0YSIsIm9yZGVyTnVtYmVyIiwicGF5bWVudFN0YXR1cyIsImZ1bGZpbGxtZW50U3RhdHVzIiwibGluZVRvdGFsIiwiZGlzY291bnRBbW91bnQiLCJ0YXhBbW91bnQiLCJ1cGRhdGUiLCJjb252ZXJ0ZWRPcmRlcklkIiwiY29uc29sZSIsImxvZyIsIm9yZGVySWQiLCJpdGVtQ291bnQiLCJjcmVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRBdCIsImV2ZW50cyIsImV2ZW50SWQiLCJub3ciLCJldmVudFR5cGUiLCJ0aW1lc3RhbXAiLCJFcnJvciIsIm1lc3NhZ2UiLCJHRVQiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJnZXQiLCJsaW1pdCIsInBhcnNlSW50Iiwib2Zmc2V0IiwiY29udGFpbnMiLCJtb2RlIiwidG90YWwiLCJjb3VudCIsIm9yZGVycyIsImZpbmRNYW55Iiwib3JkZXJCeSIsInNraXAiLCJ0YWtlIiwiZnVsZmlsbGVkUXVhbnRpdHkiLCJyZWZ1bmRlZFF1YW50aXR5IiwicmVmdW5kZWRBbW91bnQiLCJ0cmFja2luZ051bWJlciIsInRyYWNraW5nVXJsIiwicGFpZEF0Iiwic2hpcHBlZEF0IiwiZGVsaXZlcmVkQXQiLCJjYW5jZWxsZWRBdCIsInJlZnVuZGVkQXQiLCJwYWdpbmF0aW9uIiwiZmlsdGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/svm/orders/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsvm%2Forders%2Froute&page=%2Fapi%2Fsvm%2Forders%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsvm%2Forders%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();