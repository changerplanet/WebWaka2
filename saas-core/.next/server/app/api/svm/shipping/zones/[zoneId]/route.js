"use strict";(()=>{var e={};e.id=5534,e.ids=[5534],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},43729:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>R,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var r={};t.r(r),t.d(r,{DELETE:()=>c,GET:()=>d,PUT:()=>p});var n=t(49303),o=t(88716),a=t(60670),i=t(87070),u=t(84588);async function d(e,s){try{let{zoneId:t}=await s.params,{searchParams:r}=new URL(e.url),n=r.get("tenantId");if(!t)return i.NextResponse.json({success:!1,error:"zoneId is required"},{status:400});if(!n)return i.NextResponse.json({success:!1,error:"tenantId query parameter is required"},{status:400});let o=await (0,u.nA)(n,t);if(!o)return i.NextResponse.json({success:!1,error:`Shipping zone ${t} not found`},{status:404});return i.NextResponse.json({success:!0,zone:o})}catch(e){return console.error("[SVM] Error fetching shipping zone:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function p(e,s){try{let{zoneId:t}=await s.params,r=await e.json(),{tenantId:n,action:o}=r;if(!t||!n)return i.NextResponse.json({success:!1,error:"zoneId and tenantId are required"},{status:400});let a=await (0,u.nA)(n,t);if(!a)return i.NextResponse.json({success:!1,error:`Shipping zone ${t} not found`},{status:404});switch(o){case"UPDATE_ZONE":{let{name:e,description:s,countries:o,states:a,postalCodes:d,cities:p,isDefault:c,isActive:l,priority:m}=r,g={};void 0!==e&&(g.name=e),void 0!==s&&(g.description=s),void 0!==o&&(g.countries=o),void 0!==a&&(g.states=a),void 0!==d&&(g.postalCodes=d),void 0!==p&&(g.cities=p),void 0!==c&&(g.isDefault=c),void 0!==l&&(g.isActive=l),void 0!==m&&(g.priority=m);let x=await (0,u.Bf)(n,t,g);return i.NextResponse.json({success:!0,message:"Zone updated",zone:x})}case"ADD_RATE":{let{rate:e}=r;if(!e||!e.name||!e.rateType)return i.NextResponse.json({success:!1,error:"rate with name and rateType is required"},{status:400});let s={id:(0,u.Ox)("rate"),zoneId:t,name:e.name,description:e.description,carrier:e.carrier,rateType:e.rateType,flatRate:e.flatRate,weightRate:e.weightRate,baseWeightFee:e.baseWeightFee,percentageRate:e.percentageRate,perItemRate:e.perItemRate,minWeight:e.minWeight,maxWeight:e.maxWeight,minOrderTotal:e.minOrderTotal,maxOrderTotal:e.maxOrderTotal,freeAbove:e.freeAbove,minDays:e.minDays,maxDays:e.maxDays,allowedProductIds:e.allowedProductIds||[],excludedProductIds:e.excludedProductIds||[],allowedCategoryIds:e.allowedCategoryIds||[],excludedCategoryIds:e.excludedCategoryIds||[],isActive:e.isActive??!0,priority:a.rates.length};await (0,u.$p)(n,t,s);let o=await (0,u.nA)(n,t);return i.NextResponse.json({success:!0,message:"Rate added",rate:s,zone:o})}case"UPDATE_RATE":{let{rateId:e,rate:s}=r;if(!e)return i.NextResponse.json({success:!1,error:"rateId is required"},{status:400});let o=await (0,u.tc)(n,t,e,s);if(!o)return i.NextResponse.json({success:!1,error:`Rate ${e} not found`},{status:404});let a=await (0,u.nA)(n,t);return i.NextResponse.json({success:!0,message:"Rate updated",rate:o,zone:a})}case"DELETE_RATE":{let{rateId:e}=r;if(!e)return i.NextResponse.json({success:!1,error:"rateId is required"},{status:400});if(!await (0,u.Cn)(n,t,e))return i.NextResponse.json({success:!1,error:`Rate ${e} not found`},{status:404});let s=await (0,u.nA)(n,t);return i.NextResponse.json({success:!0,message:"Rate deleted",zone:s})}default:{let{name:e,description:s,countries:o,states:a,postalCodes:d,cities:p,isDefault:c,isActive:l,priority:m}=r,g={};void 0!==e&&(g.name=e),void 0!==s&&(g.description=s),void 0!==o&&(g.countries=o),void 0!==a&&(g.states=a),void 0!==d&&(g.postalCodes=d),void 0!==p&&(g.cities=p),void 0!==c&&(g.isDefault=c),void 0!==l&&(g.isActive=l),void 0!==m&&(g.priority=m);let x=await (0,u.Bf)(n,t,g);return i.NextResponse.json({success:!0,message:`Shipping zone ${t} updated`,zone:x})}}}catch(e){return console.error("[SVM] Error updating shipping zone:",e),i.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Internal server error"},{status:500})}}async function c(e,s){try{let{zoneId:t}=await s.params,{searchParams:r}=new URL(e.url),n=r.get("tenantId");if(!t||!n)return i.NextResponse.json({success:!1,error:"zoneId and tenantId are required"},{status:400});let o=await (0,u.vp)(n,t);if(!o)return i.NextResponse.json({success:!1,error:`Shipping zone ${t} not found`},{status:404});return i.NextResponse.json({success:!0,message:`Shipping zone ${o.name} deleted`,deletedZoneId:t})}catch(e){return console.error("[SVM] Error deleting shipping zone:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/svm/shipping/zones/[zoneId]/route",pathname:"/api/svm/shipping/zones/[zoneId]",filename:"route",bundlePath:"app/api/svm/shipping/zones/[zoneId]/route"},resolvedPagePath:"/app/saas-core/src/app/api/svm/shipping/zones/[zoneId]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:x}=l,R="/api/svm/shipping/zones/[zoneId]/route";function v(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9380,5972,4588],()=>t(43729));module.exports=r})();