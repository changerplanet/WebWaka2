"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/metrics/route";
exports.ids = ["app/api/metrics/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetrics%2Froute&page=%2Fapi%2Fmetrics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetrics%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetrics%2Froute&page=%2Fapi%2Fmetrics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetrics%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _app_saas_core_src_app_api_metrics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/metrics/route.ts */ \"(rsc)/./src/app/api/metrics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/metrics/route\",\n        pathname: \"/api/metrics\",\n        filename: \"route\",\n        bundlePath: \"app/api/metrics/route\"\n    },\n    resolvedPagePath: \"/app/saas-core/src/app/api/metrics/route.ts\",\n    nextConfigOutput,\n    userland: _app_saas_core_src_app_api_metrics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/metrics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZXRyaWNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZtZXRyaWNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbWV0cmljcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZhcHAlMkZzYWFzLWNvcmUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmFwcCUyRnNhYXMtY29yZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDTDtBQUN4RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NhYXMtY29yZS8/YThkOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvYXBwL3NhYXMtY29yZS9zcmMvYXBwL2FwaS9tZXRyaWNzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tZXRyaWNzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWV0cmljc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbWV0cmljcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9hcHAvc2Fhcy1jb3JlL3NyYy9hcHAvYXBpL21ldHJpY3Mvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL21ldHJpY3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetrics%2Froute&page=%2Fapi%2Fmetrics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetrics%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/metrics/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/metrics/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_rate_limiter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/rate-limiter */ \"(rsc)/./src/lib/rate-limiter.ts\");\n/* harmony import */ var _lib_audit_logger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/audit-logger */ \"(rsc)/./src/lib/audit-logger.ts\");\n/**\n * Metrics & Health Check API\n * \n * GET /api/metrics - System metrics and health status\n */ \n\n\n\n/**\n * GET /api/metrics\n * Returns system health and metrics\n */ async function GET(request) {\n    const { searchParams } = new URL(request.url);\n    const detailed = searchParams.get(\"detailed\") === \"true\";\n    const startTime = Date.now();\n    const checks = [];\n    // Database health check\n    try {\n        const dbStart = Date.now();\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.$queryRaw`SELECT 1`;\n        const dbLatency = Date.now() - dbStart;\n        checks.push({\n            name: \"database\",\n            status: dbLatency < 100 ? \"healthy\" : dbLatency < 500 ? \"degraded\" : \"unhealthy\",\n            latency: dbLatency\n        });\n    } catch (error) {\n        checks.push({\n            name: \"database\",\n            status: \"unhealthy\",\n            message: error instanceof Error ? error.message : \"Connection failed\"\n        });\n    }\n    // Memory usage check\n    const memUsage = process.memoryUsage();\n    const heapUsedMB = Math.round(memUsage.heapUsed / 1024 / 1024);\n    const heapTotalMB = Math.round(memUsage.heapTotal / 1024 / 1024);\n    const heapPercent = memUsage.heapUsed / memUsage.heapTotal * 100;\n    checks.push({\n        name: \"memory\",\n        status: heapPercent < 70 ? \"healthy\" : heapPercent < 90 ? \"degraded\" : \"unhealthy\",\n        message: `${heapUsedMB}MB / ${heapTotalMB}MB (${heapPercent.toFixed(1)}%)`\n    });\n    // Overall status\n    const overallStatus = checks.every((c)=>c.status === \"healthy\") ? \"healthy\" : checks.some((c)=>c.status === \"unhealthy\") ? \"unhealthy\" : \"degraded\";\n    const response = {\n        status: overallStatus,\n        timestamp: new Date().toISOString(),\n        uptime: process.uptime(),\n        checks\n    };\n    // Detailed metrics (only if requested)\n    if (detailed) {\n        // Rate limiter stats\n        const rateLimitStats = (0,_lib_rate_limiter__WEBPACK_IMPORTED_MODULE_2__.getRateLimitStats)();\n        // Audit stats\n        const auditStats = (0,_lib_audit_logger__WEBPACK_IMPORTED_MODULE_3__.getAuditStats)();\n        // Process stats\n        response.metrics = {\n            memory: {\n                heapUsed: memUsage.heapUsed,\n                heapTotal: memUsage.heapTotal,\n                external: memUsage.external,\n                rss: memUsage.rss\n            },\n            rateLimiter: rateLimitStats,\n            audit: auditStats,\n            process: {\n                pid: process.pid,\n                uptime: process.uptime(),\n                nodeVersion: process.version\n            }\n        };\n        // Database stats (if available)\n        try {\n            const [walletCount, orderCount, cartCount] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.commerceWallet.count(),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmOrder.count(),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.svmCart.count()\n            ]);\n            response.metrics = {\n                ...response.metrics,\n                database: {\n                    wallets: walletCount,\n                    orders: orderCount,\n                    carts: cartCount\n                }\n            };\n        } catch  {\n        // Skip if counts fail\n        }\n    }\n    const totalLatency = Date.now() - startTime;\n    response.responseTime = totalLatency;\n    const statusCode = overallStatus === \"healthy\" ? 200 : overallStatus === \"degraded\" ? 200 : 503;\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n        status: statusCode,\n        headers: {\n            \"Cache-Control\": \"no-store\",\n            \"X-Response-Time\": `${totalLatency}ms`\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxDQUFDNkQsUUFBUSxDQUFDRCxLQUFLO2dCQUNyQjVELCtDQUFNQSxDQUFDOEQsT0FBTyxDQUFDRixLQUFLO2FBQ3JCO1lBRURyQixTQUFTTSxPQUFPLEdBQUc7Z0JBQ2pCLEdBQUdOLFNBQVNNLE9BQU87Z0JBQ25Ca0IsVUFBVTtvQkFDUkMsU0FBU1Y7b0JBQ1RXLFFBQVFWO29CQUNSVyxPQUFPVjtnQkFDVDtZQUNGO1FBQ0YsRUFBRSxPQUFNO1FBQ04sc0JBQXNCO1FBQ3hCO0lBQ0Y7SUFFQSxNQUFNVyxlQUFleEQsS0FBS0MsR0FBRyxLQUFLRjtJQUNsQzZCLFNBQVM2QixZQUFZLEdBQUdEO0lBRXhCLE1BQU1FLGFBQWFsQyxrQkFBa0IsWUFBWSxNQUFNQSxrQkFBa0IsYUFBYSxNQUFNO0lBRTVGLE9BQU9wQyxxREFBWUEsQ0FBQ3VFLElBQUksQ0FBQy9CLFVBQVU7UUFDakNwQixRQUFRa0Q7UUFDUkUsU0FBUztZQUNQLGlCQUFpQjtZQUNqQixtQkFBbUIsQ0FBQyxFQUFFSixhQUFhLEVBQUUsQ0FBQztRQUN4QztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvYXBwL2FwaS9tZXRyaWNzL3JvdXRlLnRzP2MzNmEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNZXRyaWNzICYgSGVhbHRoIENoZWNrIEFQSVxuICogXG4gKiBHRVQgL2FwaS9tZXRyaWNzIC0gU3lzdGVtIG1ldHJpY3MgYW5kIGhlYWx0aCBzdGF0dXNcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnXG5pbXBvcnQgeyBnZXRSYXRlTGltaXRTdGF0cyB9IGZyb20gJ0AvbGliL3JhdGUtbGltaXRlcidcbmltcG9ydCB7IGdldEF1ZGl0U3RhdHMgfSBmcm9tICdAL2xpYi9hdWRpdC1sb2dnZXInXG5cbmludGVyZmFjZSBIZWFsdGhDaGVjayB7XG4gIG5hbWU6IHN0cmluZ1xuICBzdGF0dXM6ICdoZWFsdGh5JyB8ICdkZWdyYWRlZCcgfCAndW5oZWFsdGh5J1xuICBsYXRlbmN5PzogbnVtYmVyXG4gIG1lc3NhZ2U/OiBzdHJpbmdcbn1cblxuLyoqXG4gKiBHRVQgL2FwaS9tZXRyaWNzXG4gKiBSZXR1cm5zIHN5c3RlbSBoZWFsdGggYW5kIG1ldHJpY3NcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgY29uc3QgZGV0YWlsZWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdkZXRhaWxlZCcpID09PSAndHJ1ZSdcbiAgXG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcbiAgY29uc3QgY2hlY2tzOiBIZWFsdGhDaGVja1tdID0gW11cbiAgXG4gIC8vIERhdGFiYXNlIGhlYWx0aCBjaGVja1xuICB0cnkge1xuICAgIGNvbnN0IGRiU3RhcnQgPSBEYXRlLm5vdygpXG4gICAgYXdhaXQgcHJpc21hLiRxdWVyeVJhd2BTRUxFQ1QgMWBcbiAgICBjb25zdCBkYkxhdGVuY3kgPSBEYXRlLm5vdygpIC0gZGJTdGFydFxuICAgIFxuICAgIGNoZWNrcy5wdXNoKHtcbiAgICAgIG5hbWU6ICdkYXRhYmFzZScsXG4gICAgICBzdGF0dXM6IGRiTGF0ZW5jeSA8IDEwMCA/ICdoZWFsdGh5JyA6IGRiTGF0ZW5jeSA8IDUwMCA/ICdkZWdyYWRlZCcgOiAndW5oZWFsdGh5JyxcbiAgICAgIGxhdGVuY3k6IGRiTGF0ZW5jeVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY2hlY2tzLnB1c2goe1xuICAgICAgbmFtZTogJ2RhdGFiYXNlJyxcbiAgICAgIHN0YXR1czogJ3VuaGVhbHRoeScsXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdDb25uZWN0aW9uIGZhaWxlZCdcbiAgICB9KVxuICB9XG5cbiAgLy8gTWVtb3J5IHVzYWdlIGNoZWNrXG4gIGNvbnN0IG1lbVVzYWdlID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpXG4gIGNvbnN0IGhlYXBVc2VkTUIgPSBNYXRoLnJvdW5kKG1lbVVzYWdlLmhlYXBVc2VkIC8gMTAyNCAvIDEwMjQpXG4gIGNvbnN0IGhlYXBUb3RhbE1CID0gTWF0aC5yb3VuZChtZW1Vc2FnZS5oZWFwVG90YWwgLyAxMDI0IC8gMTAyNClcbiAgY29uc3QgaGVhcFBlcmNlbnQgPSAobWVtVXNhZ2UuaGVhcFVzZWQgLyBtZW1Vc2FnZS5oZWFwVG90YWwpICogMTAwXG5cbiAgY2hlY2tzLnB1c2goe1xuICAgIG5hbWU6ICdtZW1vcnknLFxuICAgIHN0YXR1czogaGVhcFBlcmNlbnQgPCA3MCA/ICdoZWFsdGh5JyA6IGhlYXBQZXJjZW50IDwgOTAgPyAnZGVncmFkZWQnIDogJ3VuaGVhbHRoeScsXG4gICAgbWVzc2FnZTogYCR7aGVhcFVzZWRNQn1NQiAvICR7aGVhcFRvdGFsTUJ9TUIgKCR7aGVhcFBlcmNlbnQudG9GaXhlZCgxKX0lKWBcbiAgfSlcblxuICAvLyBPdmVyYWxsIHN0YXR1c1xuICBjb25zdCBvdmVyYWxsU3RhdHVzID0gY2hlY2tzLmV2ZXJ5KGMgPT4gYy5zdGF0dXMgPT09ICdoZWFsdGh5JylcbiAgICA/ICdoZWFsdGh5J1xuICAgIDogY2hlY2tzLnNvbWUoYyA9PiBjLnN0YXR1cyA9PT0gJ3VuaGVhbHRoeScpXG4gICAgICA/ICd1bmhlYWx0aHknXG4gICAgICA6ICdkZWdyYWRlZCdcblxuICBjb25zdCByZXNwb25zZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7XG4gICAgc3RhdHVzOiBvdmVyYWxsU3RhdHVzLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIHVwdGltZTogcHJvY2Vzcy51cHRpbWUoKSxcbiAgICBjaGVja3NcbiAgfVxuXG4gIC8vIERldGFpbGVkIG1ldHJpY3MgKG9ubHkgaWYgcmVxdWVzdGVkKVxuICBpZiAoZGV0YWlsZWQpIHtcbiAgICAvLyBSYXRlIGxpbWl0ZXIgc3RhdHNcbiAgICBjb25zdCByYXRlTGltaXRTdGF0cyA9IGdldFJhdGVMaW1pdFN0YXRzKClcbiAgICBcbiAgICAvLyBBdWRpdCBzdGF0c1xuICAgIGNvbnN0IGF1ZGl0U3RhdHMgPSBnZXRBdWRpdFN0YXRzKClcbiAgICBcbiAgICAvLyBQcm9jZXNzIHN0YXRzXG4gICAgcmVzcG9uc2UubWV0cmljcyA9IHtcbiAgICAgIG1lbW9yeToge1xuICAgICAgICBoZWFwVXNlZDogbWVtVXNhZ2UuaGVhcFVzZWQsXG4gICAgICAgIGhlYXBUb3RhbDogbWVtVXNhZ2UuaGVhcFRvdGFsLFxuICAgICAgICBleHRlcm5hbDogbWVtVXNhZ2UuZXh0ZXJuYWwsXG4gICAgICAgIHJzczogbWVtVXNhZ2UucnNzXG4gICAgICB9LFxuICAgICAgcmF0ZUxpbWl0ZXI6IHJhdGVMaW1pdFN0YXRzLFxuICAgICAgYXVkaXQ6IGF1ZGl0U3RhdHMsXG4gICAgICBwcm9jZXNzOiB7XG4gICAgICAgIHBpZDogcHJvY2Vzcy5waWQsXG4gICAgICAgIHVwdGltZTogcHJvY2Vzcy51cHRpbWUoKSxcbiAgICAgICAgbm9kZVZlcnNpb246IHByb2Nlc3MudmVyc2lvblxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERhdGFiYXNlIHN0YXRzIChpZiBhdmFpbGFibGUpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFt3YWxsZXRDb3VudCwgb3JkZXJDb3VudCwgY2FydENvdW50XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgcHJpc21hLmNvbW1lcmNlV2FsbGV0LmNvdW50KCksXG4gICAgICAgIHByaXNtYS5zdm1PcmRlci5jb3VudCgpLFxuICAgICAgICBwcmlzbWEuc3ZtQ2FydC5jb3VudCgpXG4gICAgICBdKVxuICAgICAgXG4gICAgICByZXNwb25zZS5tZXRyaWNzID0ge1xuICAgICAgICAuLi5yZXNwb25zZS5tZXRyaWNzIGFzIG9iamVjdCxcbiAgICAgICAgZGF0YWJhc2U6IHtcbiAgICAgICAgICB3YWxsZXRzOiB3YWxsZXRDb3VudCxcbiAgICAgICAgICBvcmRlcnM6IG9yZGVyQ291bnQsXG4gICAgICAgICAgY2FydHM6IGNhcnRDb3VudFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBTa2lwIGlmIGNvdW50cyBmYWlsXG4gICAgfVxuICB9XG5cbiAgY29uc3QgdG90YWxMYXRlbmN5ID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICByZXNwb25zZS5yZXNwb25zZVRpbWUgPSB0b3RhbExhdGVuY3lcblxuICBjb25zdCBzdGF0dXNDb2RlID0gb3ZlcmFsbFN0YXR1cyA9PT0gJ2hlYWx0aHknID8gMjAwIDogb3ZlcmFsbFN0YXR1cyA9PT0gJ2RlZ3JhZGVkJyA/IDIwMCA6IDUwM1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwgeyBcbiAgICBzdGF0dXM6IHN0YXR1c0NvZGUsXG4gICAgaGVhZGVyczoge1xuICAgICAgJ0NhY2hlLUNvbnRyb2wnOiAnbm8tc3RvcmUnLFxuICAgICAgJ1gtUmVzcG9uc2UtVGltZSc6IGAke3RvdGFsTGF0ZW5jeX1tc2BcbiAgICB9XG4gIH0pXG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicHJpc21hIiwiZ2V0UmF0ZUxpbWl0U3RhdHMiLCJnZXRBdWRpdFN0YXRzIiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImRldGFpbGVkIiwiZ2V0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNoZWNrcyIsImRiU3RhcnQiLCIkcXVlcnlSYXciLCJkYkxhdGVuY3kiLCJwdXNoIiwibmFtZSIsInN0YXR1cyIsImxhdGVuY3kiLCJlcnJvciIsIm1lc3NhZ2UiLCJFcnJvciIsIm1lbVVzYWdlIiwicHJvY2VzcyIsIm1lbW9yeVVzYWdlIiwiaGVhcFVzZWRNQiIsIk1hdGgiLCJyb3VuZCIsImhlYXBVc2VkIiwiaGVhcFRvdGFsTUIiLCJoZWFwVG90YWwiLCJoZWFwUGVyY2VudCIsInRvRml4ZWQiLCJvdmVyYWxsU3RhdHVzIiwiZXZlcnkiLCJjIiwic29tZSIsInJlc3BvbnNlIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJ1cHRpbWUiLCJyYXRlTGltaXRTdGF0cyIsImF1ZGl0U3RhdHMiLCJtZXRyaWNzIiwibWVtb3J5IiwiZXh0ZXJuYWwiLCJyc3MiLCJyYXRlTGltaXRlciIsImF1ZGl0IiwicGlkIiwibm9kZVZlcnNpb24iLCJ2ZXJzaW9uIiwid2FsbGV0Q291bnQiLCJvcmRlckNvdW50IiwiY2FydENvdW50IiwiUHJvbWlzZSIsImFsbCIsImNvbW1lcmNlV2FsbGV0IiwiY291bnQiLCJzdm1PcmRlciIsInN2bUNhcnQiLCJkYXRhYmFzZSIsIndhbGxldHMiLCJvcmRlcnMiLCJjYXJ0cyIsInRvdGFsTGF0ZW5jeSIsInJlc3BvbnNlVGltZSIsInN0YXR1c0NvZGUiLCJqc29uIiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/metrics/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/audit-logger.ts":
/*!*********************************!*\
  !*** ./src/lib/audit-logger.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   forceFlush: () => (/* binding */ forceFlush),\n/* harmony export */   getAuditStats: () => (/* binding */ getAuditStats),\n/* harmony export */   logAudit: () => (/* binding */ logAudit),\n/* harmony export */   logAuthEvent: () => (/* binding */ logAuthEvent),\n/* harmony export */   logOrderEvent: () => (/* binding */ logOrderEvent),\n/* harmony export */   logRateLimitExceeded: () => (/* binding */ logRateLimitExceeded),\n/* harmony export */   logSecurityViolation: () => (/* binding */ logSecurityViolation),\n/* harmony export */   logWalletOperation: () => (/* binding */ logWalletOperation)\n/* harmony export */ });\n/**\n * Audit Logger\n * Comprehensive audit logging for security and compliance\n */ // In-memory buffer for batch writes (use proper queue in production)\nconst auditBuffer = [];\nconst BUFFER_FLUSH_SIZE = 100;\nconst BUFFER_FLUSH_INTERVAL = 5000 // 5 seconds\n;\nlet flushInterval = null;\n/**\n * Log an audit event\n */ async function logAudit(entry) {\n    const logEntry = {\n        ...entry,\n        timestamp: entry.timestamp || new Date()\n    };\n    // Add to buffer\n    auditBuffer.push(logEntry);\n    // Console log for immediate visibility (in production, use structured logging)\n    const logLevel = entry.severity === \"CRITICAL\" || entry.severity === \"ERROR\" ? \"error\" : entry.severity === \"WARNING\" ? \"warn\" : \"log\";\n    console[logLevel](`[AUDIT] ${entry.eventType}`, {\n        tenant: entry.tenantId,\n        user: entry.userId,\n        resource: entry.resourceType ? `${entry.resourceType}:${entry.resourceId}` : undefined,\n        action: entry.action,\n        severity: entry.severity\n    });\n    // Flush if buffer is full\n    if (auditBuffer.length >= BUFFER_FLUSH_SIZE) {\n        await flushAuditBuffer();\n    }\n    // Start flush interval if not running\n    if (!flushInterval) {\n        flushInterval = setInterval(flushAuditBuffer, BUFFER_FLUSH_INTERVAL);\n    }\n}\n/**\n * Flush audit buffer to database\n */ async function flushAuditBuffer() {\n    if (auditBuffer.length === 0) return;\n    const entries = auditBuffer.splice(0, auditBuffer.length);\n    try {\n        // In a real system, you'd write to an AuditLog table\n        // For now, we'll just log them\n        // await prisma.auditLog.createMany({ data: entries })\n        // Console summary\n        console.log(`[AUDIT] Flushed ${entries.length} audit entries`);\n    } catch (error) {\n        console.error(\"[AUDIT] Failed to flush audit buffer:\", error);\n        // Re-add entries to buffer on failure\n        auditBuffer.unshift(...entries);\n    }\n}\n/**\n * Log authentication event\n */ function logAuthEvent(eventType, tenantId, userId, success, details, ipAddress, userAgent) {\n    logAudit({\n        eventType,\n        severity: success ? \"INFO\" : \"WARNING\",\n        tenantId,\n        userId,\n        action: eventType.replace(\"AUTH_\", \"\").toLowerCase(),\n        details: {\n            success,\n            ...details\n        },\n        ipAddress,\n        userAgent\n    });\n}\n/**\n * Log wallet operation\n */ function logWalletOperation(operation, tenantId, walletId, amount, details, userId) {\n    logAudit({\n        eventType: `WALLET_${operation}`,\n        severity: \"INFO\",\n        tenantId,\n        userId,\n        resourceType: \"wallet\",\n        resourceId: walletId,\n        action: operation.toLowerCase(),\n        details: {\n            amount,\n            ...details\n        }\n    });\n}\n/**\n * Log order event\n */ function logOrderEvent(eventType, tenantId, orderId, details, userId) {\n    logAudit({\n        eventType,\n        severity: \"INFO\",\n        tenantId,\n        userId,\n        resourceType: \"order\",\n        resourceId: orderId,\n        action: eventType.replace(\"ORDER_\", \"\").toLowerCase(),\n        details\n    });\n}\n/**\n * Log security violation\n */ function logSecurityViolation(tenantId, violation, details, ipAddress, userId) {\n    logAudit({\n        eventType: \"SECURITY_VIOLATION\",\n        severity: \"CRITICAL\",\n        tenantId,\n        userId,\n        action: violation,\n        details,\n        ipAddress\n    });\n}\n/**\n * Log rate limit exceeded\n */ function logRateLimitExceeded(tenantId, endpoint, ipAddress, userId) {\n    logAudit({\n        eventType: \"RATE_LIMIT_EXCEEDED\",\n        severity: \"WARNING\",\n        tenantId,\n        userId,\n        action: \"rate_limit_exceeded\",\n        details: {\n            endpoint\n        },\n        ipAddress\n    });\n}\n/**\n * Get audit statistics\n */ function getAuditStats() {\n    return {\n        bufferSize: BUFFER_FLUSH_SIZE,\n        pendingFlush: auditBuffer.length\n    };\n}\n/**\n * Force flush (for graceful shutdown)\n */ async function forceFlush() {\n    if (flushInterval) {\n        clearInterval(flushInterval);\n        flushInterval = null;\n    }\n    await flushAuditBuffer();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1ZGl0LWxvZ2dlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOzs7Q0FHQyxHQW9ERCxxRUFBcUU7QUFDckUsTUFBTUEsY0FBK0IsRUFBRTtBQUN2QyxNQUFNQyxvQkFBb0I7QUFDMUIsTUFBTUMsd0JBQXdCLEtBQUssWUFBWTs7QUFFL0MsSUFBSUMsZ0JBQXVDO0FBRTNDOztDQUVDLEdBQ00sZUFBZUMsU0FBU0MsS0FBb0I7SUFDakQsTUFBTUMsV0FBVztRQUNmLEdBQUdELEtBQUs7UUFDUkUsV0FBV0YsTUFBTUUsU0FBUyxJQUFJLElBQUlDO0lBQ3BDO0lBRUEsZ0JBQWdCO0lBQ2hCUixZQUFZUyxJQUFJLENBQUNIO0lBRWpCLCtFQUErRTtJQUMvRSxNQUFNSSxXQUFXTCxNQUFNTSxRQUFRLEtBQUssY0FBY04sTUFBTU0sUUFBUSxLQUFLLFVBQ2pFLFVBQ0FOLE1BQU1NLFFBQVEsS0FBSyxZQUNqQixTQUNBO0lBRU5DLE9BQU8sQ0FBQ0YsU0FBUyxDQUFDLENBQUMsUUFBUSxFQUFFTCxNQUFNUSxTQUFTLENBQUMsQ0FBQyxFQUFFO1FBQzlDQyxRQUFRVCxNQUFNVSxRQUFRO1FBQ3RCQyxNQUFNWCxNQUFNWSxNQUFNO1FBQ2xCQyxVQUFVYixNQUFNYyxZQUFZLEdBQUcsQ0FBQyxFQUFFZCxNQUFNYyxZQUFZLENBQUMsQ0FBQyxFQUFFZCxNQUFNZSxVQUFVLENBQUMsQ0FBQyxHQUFHQztRQUM3RUMsUUFBUWpCLE1BQU1pQixNQUFNO1FBQ3BCWCxVQUFVTixNQUFNTSxRQUFRO0lBQzFCO0lBRUEsMEJBQTBCO0lBQzFCLElBQUlYLFlBQVl1QixNQUFNLElBQUl0QixtQkFBbUI7UUFDM0MsTUFBTXVCO0lBQ1I7SUFFQSxzQ0FBc0M7SUFDdEMsSUFBSSxDQUFDckIsZUFBZTtRQUNsQkEsZ0JBQWdCc0IsWUFBWUQsa0JBQWtCdEI7SUFDaEQ7QUFDRjtBQUVBOztDQUVDLEdBQ0QsZUFBZXNCO0lBQ2IsSUFBSXhCLFlBQVl1QixNQUFNLEtBQUssR0FBRztJQUU5QixNQUFNRyxVQUFVMUIsWUFBWTJCLE1BQU0sQ0FBQyxHQUFHM0IsWUFBWXVCLE1BQU07SUFFeEQsSUFBSTtRQUNGLHFEQUFxRDtRQUNyRCwrQkFBK0I7UUFDL0Isc0RBQXNEO1FBRXRELGtCQUFrQjtRQUNsQlgsUUFBUWdCLEdBQUcsQ0FBQyxDQUFDLGdCQUFnQixFQUFFRixRQUFRSCxNQUFNLENBQUMsY0FBYyxDQUFDO0lBQy9ELEVBQUUsT0FBT00sT0FBTztRQUNkakIsUUFBUWlCLEtBQUssQ0FBQyx5Q0FBeUNBO1FBQ3ZELHNDQUFzQztRQUN0QzdCLFlBQVk4QixPQUFPLElBQUlKO0lBQ3pCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNLLGFBQ2RsQixTQUE4RSxFQUM5RUUsUUFBZ0IsRUFDaEJFLE1BQTBCLEVBQzFCZSxPQUFnQixFQUNoQkMsT0FBaUMsRUFDakNDLFNBQWtCLEVBQ2xCQyxTQUFrQjtJQUVsQi9CLFNBQVM7UUFDUFM7UUFDQUYsVUFBVXFCLFVBQVUsU0FBUztRQUM3QmpCO1FBQ0FFO1FBQ0FLLFFBQVFULFVBQVV1QixPQUFPLENBQUMsU0FBUyxJQUFJQyxXQUFXO1FBQ2xESixTQUFTO1lBQUVEO1lBQVMsR0FBR0MsT0FBTztRQUFDO1FBQy9CQztRQUNBQztJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNHLG1CQUNkQyxTQUFxRSxFQUNyRXhCLFFBQWdCLEVBQ2hCeUIsUUFBZ0IsRUFDaEJDLE1BQWUsRUFDZlIsT0FBaUMsRUFDakNoQixNQUFlO0lBRWZiLFNBQVM7UUFDUFMsV0FBVyxDQUFDLE9BQU8sRUFBRTBCLFVBQVUsQ0FBQztRQUNoQzVCLFVBQVU7UUFDVkk7UUFDQUU7UUFDQUUsY0FBYztRQUNkQyxZQUFZb0I7UUFDWmxCLFFBQVFpQixVQUFVRixXQUFXO1FBQzdCSixTQUFTO1lBQUVRO1lBQVEsR0FBR1IsT0FBTztRQUFDO0lBQ2hDO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNTLGNBQ2Q3QixTQUFrRSxFQUNsRUUsUUFBZ0IsRUFDaEI0QixPQUFlLEVBQ2ZWLE9BQWlDLEVBQ2pDaEIsTUFBZTtJQUVmYixTQUFTO1FBQ1BTO1FBQ0FGLFVBQVU7UUFDVkk7UUFDQUU7UUFDQUUsY0FBYztRQUNkQyxZQUFZdUI7UUFDWnJCLFFBQVFULFVBQVV1QixPQUFPLENBQUMsVUFBVSxJQUFJQyxXQUFXO1FBQ25ESjtJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNXLHFCQUNkN0IsUUFBZ0IsRUFDaEI4QixTQUFpQixFQUNqQlosT0FBZ0MsRUFDaENDLFNBQWtCLEVBQ2xCakIsTUFBZTtJQUVmYixTQUFTO1FBQ1BTLFdBQVc7UUFDWEYsVUFBVTtRQUNWSTtRQUNBRTtRQUNBSyxRQUFRdUI7UUFDUlo7UUFDQUM7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTWSxxQkFDZC9CLFFBQWdCLEVBQ2hCZ0MsUUFBZ0IsRUFDaEJiLFNBQWlCLEVBQ2pCakIsTUFBZTtJQUVmYixTQUFTO1FBQ1BTLFdBQVc7UUFDWEYsVUFBVTtRQUNWSTtRQUNBRTtRQUNBSyxRQUFRO1FBQ1JXLFNBQVM7WUFBRWM7UUFBUztRQUNwQmI7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTYztJQUlkLE9BQU87UUFDTEMsWUFBWWhEO1FBQ1ppRCxjQUFjbEQsWUFBWXVCLE1BQU07SUFDbEM7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZTRCO0lBQ3BCLElBQUloRCxlQUFlO1FBQ2pCaUQsY0FBY2pEO1FBQ2RBLGdCQUFnQjtJQUNsQjtJQUNBLE1BQU1xQjtBQUNSIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9hdWRpdC1sb2dnZXIudHM/Zjg4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1ZGl0IExvZ2dlclxuICogQ29tcHJlaGVuc2l2ZSBhdWRpdCBsb2dnaW5nIGZvciBzZWN1cml0eSBhbmQgY29tcGxpYW5jZVxuICovXG5cbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vcHJpc21hJ1xuXG4vLyBBdWRpdCBldmVudCB0eXBlc1xuZXhwb3J0IHR5cGUgQXVkaXRFdmVudFR5cGUgPVxuICB8ICdBVVRIX0xPR0lOJ1xuICB8ICdBVVRIX0xPR09VVCdcbiAgfCAnQVVUSF9GQUlMRUQnXG4gIHwgJ0FVVEhfVE9LRU5fUkVGUkVTSCdcbiAgfCAnVVNFUl9DUkVBVEUnXG4gIHwgJ1VTRVJfVVBEQVRFJ1xuICB8ICdVU0VSX0RFTEVURSdcbiAgfCAnV0FMTEVUX0NSRUFURSdcbiAgfCAnV0FMTEVUX0NSRURJVCdcbiAgfCAnV0FMTEVUX0RFQklUJ1xuICB8ICdXQUxMRVRfVFJBTlNGRVInXG4gIHwgJ1dBTExFVF9IT0xEJ1xuICB8ICdXQUxMRVRfU1RBVFVTX0NIQU5HRSdcbiAgfCAnT1JERVJfQ1JFQVRFJ1xuICB8ICdPUkRFUl9TVEFUVVNfQ0hBTkdFJ1xuICB8ICdPUkRFUl9DQU5DRUwnXG4gIHwgJ0NBUlRfQ1JFQVRFJ1xuICB8ICdDQVJUX1VQREFURSdcbiAgfCAnQ0FSVF9DSEVDS09VVCdcbiAgfCAnUEFZT1VUX0NSRUFURSdcbiAgfCAnUEFZT1VUX1BST0NFU1MnXG4gIHwgJ1JBVEVfTElNSVRfRVhDRUVERUQnXG4gIHwgJ1NFQ1VSSVRZX1ZJT0xBVElPTidcbiAgfCAnQ09ORklHX0NIQU5HRSdcbiAgfCAnREFUQV9FWFBPUlQnXG4gIHwgJ0RBVEFfQUNDRVNTJ1xuXG4vLyBBdWRpdCBzZXZlcml0eSBsZXZlbHNcbmV4cG9ydCB0eXBlIEF1ZGl0U2V2ZXJpdHkgPSAnSU5GTycgfCAnV0FSTklORycgfCAnRVJST1InIHwgJ0NSSVRJQ0FMJ1xuXG4vLyBBdWRpdCBsb2cgZW50cnkgaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0TG9nRW50cnkge1xuICBldmVudFR5cGU6IEF1ZGl0RXZlbnRUeXBlXG4gIHNldmVyaXR5OiBBdWRpdFNldmVyaXR5XG4gIHRlbmFudElkOiBzdHJpbmdcbiAgdXNlcklkPzogc3RyaW5nXG4gIHJlc291cmNlVHlwZT86IHN0cmluZ1xuICByZXNvdXJjZUlkPzogc3RyaW5nXG4gIGFjdGlvbjogc3RyaW5nXG4gIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICBpcEFkZHJlc3M/OiBzdHJpbmdcbiAgdXNlckFnZW50Pzogc3RyaW5nXG4gIHJlcXVlc3RJZD86IHN0cmluZ1xuICB0aW1lc3RhbXA/OiBEYXRlXG59XG5cbi8vIEluLW1lbW9yeSBidWZmZXIgZm9yIGJhdGNoIHdyaXRlcyAodXNlIHByb3BlciBxdWV1ZSBpbiBwcm9kdWN0aW9uKVxuY29uc3QgYXVkaXRCdWZmZXI6IEF1ZGl0TG9nRW50cnlbXSA9IFtdXG5jb25zdCBCVUZGRVJfRkxVU0hfU0laRSA9IDEwMFxuY29uc3QgQlVGRkVSX0ZMVVNIX0lOVEVSVkFMID0gNTAwMCAvLyA1IHNlY29uZHNcblxubGV0IGZsdXNoSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGxcblxuLyoqXG4gKiBMb2cgYW4gYXVkaXQgZXZlbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0F1ZGl0KGVudHJ5OiBBdWRpdExvZ0VudHJ5KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGxvZ0VudHJ5ID0ge1xuICAgIC4uLmVudHJ5LFxuICAgIHRpbWVzdGFtcDogZW50cnkudGltZXN0YW1wIHx8IG5ldyBEYXRlKClcbiAgfVxuXG4gIC8vIEFkZCB0byBidWZmZXJcbiAgYXVkaXRCdWZmZXIucHVzaChsb2dFbnRyeSlcblxuICAvLyBDb25zb2xlIGxvZyBmb3IgaW1tZWRpYXRlIHZpc2liaWxpdHkgKGluIHByb2R1Y3Rpb24sIHVzZSBzdHJ1Y3R1cmVkIGxvZ2dpbmcpXG4gIGNvbnN0IGxvZ0xldmVsID0gZW50cnkuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcgfHwgZW50cnkuc2V2ZXJpdHkgPT09ICdFUlJPUicgXG4gICAgPyAnZXJyb3InIFxuICAgIDogZW50cnkuc2V2ZXJpdHkgPT09ICdXQVJOSU5HJyBcbiAgICAgID8gJ3dhcm4nIFxuICAgICAgOiAnbG9nJ1xuICBcbiAgY29uc29sZVtsb2dMZXZlbF0oYFtBVURJVF0gJHtlbnRyeS5ldmVudFR5cGV9YCwge1xuICAgIHRlbmFudDogZW50cnkudGVuYW50SWQsXG4gICAgdXNlcjogZW50cnkudXNlcklkLFxuICAgIHJlc291cmNlOiBlbnRyeS5yZXNvdXJjZVR5cGUgPyBgJHtlbnRyeS5yZXNvdXJjZVR5cGV9OiR7ZW50cnkucmVzb3VyY2VJZH1gIDogdW5kZWZpbmVkLFxuICAgIGFjdGlvbjogZW50cnkuYWN0aW9uLFxuICAgIHNldmVyaXR5OiBlbnRyeS5zZXZlcml0eVxuICB9KVxuXG4gIC8vIEZsdXNoIGlmIGJ1ZmZlciBpcyBmdWxsXG4gIGlmIChhdWRpdEJ1ZmZlci5sZW5ndGggPj0gQlVGRkVSX0ZMVVNIX1NJWkUpIHtcbiAgICBhd2FpdCBmbHVzaEF1ZGl0QnVmZmVyKClcbiAgfVxuXG4gIC8vIFN0YXJ0IGZsdXNoIGludGVydmFsIGlmIG5vdCBydW5uaW5nXG4gIGlmICghZmx1c2hJbnRlcnZhbCkge1xuICAgIGZsdXNoSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmbHVzaEF1ZGl0QnVmZmVyLCBCVUZGRVJfRkxVU0hfSU5URVJWQUwpXG4gIH1cbn1cblxuLyoqXG4gKiBGbHVzaCBhdWRpdCBidWZmZXIgdG8gZGF0YWJhc2VcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmx1c2hBdWRpdEJ1ZmZlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKGF1ZGl0QnVmZmVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuXG5cbiAgY29uc3QgZW50cmllcyA9IGF1ZGl0QnVmZmVyLnNwbGljZSgwLCBhdWRpdEJ1ZmZlci5sZW5ndGgpXG4gIFxuICB0cnkge1xuICAgIC8vIEluIGEgcmVhbCBzeXN0ZW0sIHlvdSdkIHdyaXRlIHRvIGFuIEF1ZGl0TG9nIHRhYmxlXG4gICAgLy8gRm9yIG5vdywgd2UnbGwganVzdCBsb2cgdGhlbVxuICAgIC8vIGF3YWl0IHByaXNtYS5hdWRpdExvZy5jcmVhdGVNYW55KHsgZGF0YTogZW50cmllcyB9KVxuICAgIFxuICAgIC8vIENvbnNvbGUgc3VtbWFyeVxuICAgIGNvbnNvbGUubG9nKGBbQVVESVRdIEZsdXNoZWQgJHtlbnRyaWVzLmxlbmd0aH0gYXVkaXQgZW50cmllc2ApXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW0FVRElUXSBGYWlsZWQgdG8gZmx1c2ggYXVkaXQgYnVmZmVyOicsIGVycm9yKVxuICAgIC8vIFJlLWFkZCBlbnRyaWVzIHRvIGJ1ZmZlciBvbiBmYWlsdXJlXG4gICAgYXVkaXRCdWZmZXIudW5zaGlmdCguLi5lbnRyaWVzKVxuICB9XG59XG5cbi8qKlxuICogTG9nIGF1dGhlbnRpY2F0aW9uIGV2ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2dBdXRoRXZlbnQoXG4gIGV2ZW50VHlwZTogJ0FVVEhfTE9HSU4nIHwgJ0FVVEhfTE9HT1VUJyB8ICdBVVRIX0ZBSUxFRCcgfCAnQVVUSF9UT0tFTl9SRUZSRVNIJyxcbiAgdGVuYW50SWQ6IHN0cmluZyxcbiAgdXNlcklkOiBzdHJpbmcgfCB1bmRlZmluZWQsXG4gIHN1Y2Nlc3M6IGJvb2xlYW4sXG4gIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgaXBBZGRyZXNzPzogc3RyaW5nLFxuICB1c2VyQWdlbnQ/OiBzdHJpbmdcbik6IHZvaWQge1xuICBsb2dBdWRpdCh7XG4gICAgZXZlbnRUeXBlLFxuICAgIHNldmVyaXR5OiBzdWNjZXNzID8gJ0lORk8nIDogJ1dBUk5JTkcnLFxuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBhY3Rpb246IGV2ZW50VHlwZS5yZXBsYWNlKCdBVVRIXycsICcnKS50b0xvd2VyQ2FzZSgpLFxuICAgIGRldGFpbHM6IHsgc3VjY2VzcywgLi4uZGV0YWlscyB9LFxuICAgIGlwQWRkcmVzcyxcbiAgICB1c2VyQWdlbnRcbiAgfSlcbn1cblxuLyoqXG4gKiBMb2cgd2FsbGV0IG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9nV2FsbGV0T3BlcmF0aW9uKFxuICBvcGVyYXRpb246ICdDUkVESVQnIHwgJ0RFQklUJyB8ICdUUkFOU0ZFUicgfCAnSE9MRCcgfCAnU1RBVFVTX0NIQU5HRScsXG4gIHRlbmFudElkOiBzdHJpbmcsXG4gIHdhbGxldElkOiBzdHJpbmcsXG4gIGFtb3VudD86IG51bWJlcixcbiAgZGV0YWlscz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICB1c2VySWQ/OiBzdHJpbmdcbik6IHZvaWQge1xuICBsb2dBdWRpdCh7XG4gICAgZXZlbnRUeXBlOiBgV0FMTEVUXyR7b3BlcmF0aW9ufWAgYXMgQXVkaXRFdmVudFR5cGUsXG4gICAgc2V2ZXJpdHk6ICdJTkZPJyxcbiAgICB0ZW5hbnRJZCxcbiAgICB1c2VySWQsXG4gICAgcmVzb3VyY2VUeXBlOiAnd2FsbGV0JyxcbiAgICByZXNvdXJjZUlkOiB3YWxsZXRJZCxcbiAgICBhY3Rpb246IG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpLFxuICAgIGRldGFpbHM6IHsgYW1vdW50LCAuLi5kZXRhaWxzIH1cbiAgfSlcbn1cblxuLyoqXG4gKiBMb2cgb3JkZXIgZXZlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ09yZGVyRXZlbnQoXG4gIGV2ZW50VHlwZTogJ09SREVSX0NSRUFURScgfCAnT1JERVJfU1RBVFVTX0NIQU5HRScgfCAnT1JERVJfQ0FOQ0VMJyxcbiAgdGVuYW50SWQ6IHN0cmluZyxcbiAgb3JkZXJJZDogc3RyaW5nLFxuICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gIHVzZXJJZD86IHN0cmluZ1xuKTogdm9pZCB7XG4gIGxvZ0F1ZGl0KHtcbiAgICBldmVudFR5cGUsXG4gICAgc2V2ZXJpdHk6ICdJTkZPJyxcbiAgICB0ZW5hbnRJZCxcbiAgICB1c2VySWQsXG4gICAgcmVzb3VyY2VUeXBlOiAnb3JkZXInLFxuICAgIHJlc291cmNlSWQ6IG9yZGVySWQsXG4gICAgYWN0aW9uOiBldmVudFR5cGUucmVwbGFjZSgnT1JERVJfJywgJycpLnRvTG93ZXJDYXNlKCksXG4gICAgZGV0YWlsc1xuICB9KVxufVxuXG4vKipcbiAqIExvZyBzZWN1cml0eSB2aW9sYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ1NlY3VyaXR5VmlvbGF0aW9uKFxuICB0ZW5hbnRJZDogc3RyaW5nLFxuICB2aW9sYXRpb246IHN0cmluZyxcbiAgZGV0YWlsczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gIGlwQWRkcmVzcz86IHN0cmluZyxcbiAgdXNlcklkPzogc3RyaW5nXG4pOiB2b2lkIHtcbiAgbG9nQXVkaXQoe1xuICAgIGV2ZW50VHlwZTogJ1NFQ1VSSVRZX1ZJT0xBVElPTicsXG4gICAgc2V2ZXJpdHk6ICdDUklUSUNBTCcsXG4gICAgdGVuYW50SWQsXG4gICAgdXNlcklkLFxuICAgIGFjdGlvbjogdmlvbGF0aW9uLFxuICAgIGRldGFpbHMsXG4gICAgaXBBZGRyZXNzXG4gIH0pXG59XG5cbi8qKlxuICogTG9nIHJhdGUgbGltaXQgZXhjZWVkZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ1JhdGVMaW1pdEV4Y2VlZGVkKFxuICB0ZW5hbnRJZDogc3RyaW5nLFxuICBlbmRwb2ludDogc3RyaW5nLFxuICBpcEFkZHJlc3M6IHN0cmluZyxcbiAgdXNlcklkPzogc3RyaW5nXG4pOiB2b2lkIHtcbiAgbG9nQXVkaXQoe1xuICAgIGV2ZW50VHlwZTogJ1JBVEVfTElNSVRfRVhDRUVERUQnLFxuICAgIHNldmVyaXR5OiAnV0FSTklORycsXG4gICAgdGVuYW50SWQsXG4gICAgdXNlcklkLFxuICAgIGFjdGlvbjogJ3JhdGVfbGltaXRfZXhjZWVkZWQnLFxuICAgIGRldGFpbHM6IHsgZW5kcG9pbnQgfSxcbiAgICBpcEFkZHJlc3NcbiAgfSlcbn1cblxuLyoqXG4gKiBHZXQgYXVkaXQgc3RhdGlzdGljc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXVkaXRTdGF0cygpOiB7XG4gIGJ1ZmZlclNpemU6IG51bWJlclxuICBwZW5kaW5nRmx1c2g6IG51bWJlclxufSB7XG4gIHJldHVybiB7XG4gICAgYnVmZmVyU2l6ZTogQlVGRkVSX0ZMVVNIX1NJWkUsXG4gICAgcGVuZGluZ0ZsdXNoOiBhdWRpdEJ1ZmZlci5sZW5ndGhcbiAgfVxufVxuXG4vKipcbiAqIEZvcmNlIGZsdXNoIChmb3IgZ3JhY2VmdWwgc2h1dGRvd24pXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmb3JjZUZsdXNoKCk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoZmx1c2hJbnRlcnZhbCkge1xuICAgIGNsZWFySW50ZXJ2YWwoZmx1c2hJbnRlcnZhbClcbiAgICBmbHVzaEludGVydmFsID0gbnVsbFxuICB9XG4gIGF3YWl0IGZsdXNoQXVkaXRCdWZmZXIoKVxufVxuIl0sIm5hbWVzIjpbImF1ZGl0QnVmZmVyIiwiQlVGRkVSX0ZMVVNIX1NJWkUiLCJCVUZGRVJfRkxVU0hfSU5URVJWQUwiLCJmbHVzaEludGVydmFsIiwibG9nQXVkaXQiLCJlbnRyeSIsImxvZ0VudHJ5IiwidGltZXN0YW1wIiwiRGF0ZSIsInB1c2giLCJsb2dMZXZlbCIsInNldmVyaXR5IiwiY29uc29sZSIsImV2ZW50VHlwZSIsInRlbmFudCIsInRlbmFudElkIiwidXNlciIsInVzZXJJZCIsInJlc291cmNlIiwicmVzb3VyY2VUeXBlIiwicmVzb3VyY2VJZCIsInVuZGVmaW5lZCIsImFjdGlvbiIsImxlbmd0aCIsImZsdXNoQXVkaXRCdWZmZXIiLCJzZXRJbnRlcnZhbCIsImVudHJpZXMiLCJzcGxpY2UiLCJsb2ciLCJlcnJvciIsInVuc2hpZnQiLCJsb2dBdXRoRXZlbnQiLCJzdWNjZXNzIiwiZGV0YWlscyIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImxvZ1dhbGxldE9wZXJhdGlvbiIsIm9wZXJhdGlvbiIsIndhbGxldElkIiwiYW1vdW50IiwibG9nT3JkZXJFdmVudCIsIm9yZGVySWQiLCJsb2dTZWN1cml0eVZpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZ1JhdGVMaW1pdEV4Y2VlZGVkIiwiZW5kcG9pbnQiLCJnZXRBdWRpdFN0YXRzIiwiYnVmZmVyU2l6ZSIsInBlbmRpbmdGbHVzaCIsImZvcmNlRmx1c2giLCJjbGVhckludGVydmFsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/audit-logger.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.logViolation),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   validatePartnerAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantData),\n/* harmony export */   withTenantFilter: () => (/* reexport safe */ _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__.withTenantFilter)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tenant_isolation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tenant-isolation */ \"(rsc)/./src/lib/tenant-isolation.ts\");\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n// Re-export tenant isolation utilities\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQzdFLEdBQUU7QUFFRixJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsdUNBQXVDO0FBd0JaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG5cbi8vIFJlLWV4cG9ydCB0ZW5hbnQgaXNvbGF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IHtcbiAgdmFsaWRhdGVUZW5hbnRBY2Nlc3MsXG4gIHZhbGlkYXRlUGFydG5lckFjY2VzcyxcbiAgY3JlYXRlVGVuYW50Q29udGV4dCxcbiAgY3JlYXRlUGFydG5lckNvbnRleHQsXG4gIHdpdGhUZW5hbnRGaWx0ZXIsXG4gIHdpdGhUZW5hbnREYXRhLFxuICB3aXRoUGFydG5lckZpbHRlcixcbiAgd2l0aFBhcnRuZXJEYXRhLFxuICBUZW5hbnRJc29sYXRpb25FcnJvcixcbiAgaXNUZW5hbnRTY29wZWRNb2RlbCxcbiAgaXNQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIGdldFZpb2xhdGlvbkxvZ3MsXG4gIGNsZWFyVmlvbGF0aW9uTG9ncyxcbiAgbG9nVmlvbGF0aW9uLFxuICBURU5BTlRfU0NPUEVEX01PREVMUyxcbiAgUEFSVE5FUl9TQ09QRURfTU9ERUxTLFxuICBQTEFURk9STV9NT0RFTFMsXG4gIHR5cGUgVGVuYW50Q29udGV4dCxcbiAgdHlwZSBQYXJ0bmVyQ29udGV4dCxcbiAgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCxcbiAgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwsXG4gIHR5cGUgUGxhdGZvcm1Nb2RlbFxufSBmcm9tICcuL3RlbmFudC1pc29sYXRpb24nXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJ2YWxpZGF0ZVRlbmFudEFjY2VzcyIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsIndpdGhUZW5hbnRGaWx0ZXIiLCJ3aXRoVGVuYW50RGF0YSIsIndpdGhQYXJ0bmVyRmlsdGVyIiwid2l0aFBhcnRuZXJEYXRhIiwiVGVuYW50SXNvbGF0aW9uRXJyb3IiLCJpc1RlbmFudFNjb3BlZE1vZGVsIiwiaXNQYXJ0bmVyU2NvcGVkTW9kZWwiLCJnZXRWaW9sYXRpb25Mb2dzIiwiY2xlYXJWaW9sYXRpb25Mb2dzIiwibG9nVmlvbGF0aW9uIiwiVEVOQU5UX1NDT1BFRF9NT0RFTFMiLCJQQVJUTkVSX1NDT1BFRF9NT0RFTFMiLCJQTEFURk9STV9NT0RFTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/rate-limiter.ts":
/*!*********************************!*\
  !*** ./src/lib/rate-limiter.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkRateLimit: () => (/* binding */ checkRateLimit),\n/* harmony export */   getRateLimitHeaders: () => (/* binding */ getRateLimitHeaders),\n/* harmony export */   getRateLimitStats: () => (/* binding */ getRateLimitStats),\n/* harmony export */   resetRateLimit: () => (/* binding */ resetRateLimit)\n/* harmony export */ });\n/**\n * Rate Limiting Middleware\n * In-memory rate limiter with configurable limits per endpoint\n */ // In-memory store (use Redis in production for distributed systems)\nconst rateLimitStore = new Map();\n// Default configurations by endpoint pattern\nconst rateLimitConfigs = {\n    // Auth endpoints - stricter limits\n    \"/api/auth\": {\n        windowMs: 60 * 1000,\n        maxRequests: 10,\n        message: \"Too many authentication attempts. Please try again later.\"\n    },\n    // Write operations - moderate limits\n    \"/api/wallets\": {\n        windowMs: 60 * 1000,\n        maxRequests: 60,\n        message: \"Too many wallet operations. Please slow down.\"\n    },\n    \"/api/svm/cart\": {\n        windowMs: 60 * 1000,\n        maxRequests: 100,\n        message: \"Too many cart operations. Please slow down.\"\n    },\n    \"/api/svm/orders\": {\n        windowMs: 60 * 1000,\n        maxRequests: 30,\n        message: \"Too many order operations. Please slow down.\"\n    },\n    // Read operations - higher limits\n    \"default\": {\n        windowMs: 60 * 1000,\n        maxRequests: 200,\n        message: \"Too many requests. Please slow down.\"\n    }\n};\n/**\n * Get rate limit config for a path\n */ function getConfigForPath(path) {\n    for (const [pattern, config] of Object.entries(rateLimitConfigs)){\n        if (pattern !== \"default\" && path.startsWith(pattern)) {\n            return config;\n        }\n    }\n    return rateLimitConfigs.default;\n}\n/**\n * Generate rate limit key from request\n */ function getRateLimitKey(identifier, path) {\n    // Normalize path (remove dynamic segments)\n    const normalizedPath = path.replace(/\\/[a-zA-Z0-9_-]{20,}(?=\\/|$)/g, \"/:id\");\n    return `ratelimit:${identifier}:${normalizedPath}`;\n}\n/**\n * Check rate limit for a request\n */ function checkRateLimit(identifier, path) {\n    const config = getConfigForPath(path);\n    const key = getRateLimitKey(identifier, path);\n    const now = Date.now();\n    let entry = rateLimitStore.get(key);\n    // Clean up expired entries periodically\n    if (rateLimitStore.size > 10000) {\n        cleanupExpiredEntries();\n    }\n    // Check if window has expired\n    if (!entry || now > entry.resetTime) {\n        entry = {\n            count: 0,\n            resetTime: now + config.windowMs\n        };\n    }\n    entry.count++;\n    rateLimitStore.set(key, entry);\n    const remaining = Math.max(0, config.maxRequests - entry.count);\n    const allowed = entry.count <= config.maxRequests;\n    return {\n        allowed,\n        remaining,\n        resetTime: entry.resetTime,\n        message: allowed ? undefined : config.message\n    };\n}\n/**\n * Clean up expired entries\n */ function cleanupExpiredEntries() {\n    const now = Date.now();\n    for (const [key, entry] of rateLimitStore.entries()){\n        if (now > entry.resetTime) {\n            rateLimitStore.delete(key);\n        }\n    }\n}\n/**\n * Reset rate limit for testing\n */ function resetRateLimit(identifier, path) {\n    const key = getRateLimitKey(identifier, path);\n    rateLimitStore.delete(key);\n}\n/**\n * Get rate limit headers\n */ function getRateLimitHeaders(remaining, resetTime, limit = 200) {\n    return {\n        \"X-RateLimit-Limit\": limit.toString(),\n        \"X-RateLimit-Remaining\": remaining.toString(),\n        \"X-RateLimit-Reset\": Math.ceil(resetTime / 1000).toString()\n    };\n}\n/**\n * Rate limit stats for monitoring\n */ function getRateLimitStats() {\n    const now = Date.now();\n    let activeKeys = 0;\n    for (const entry of rateLimitStore.values()){\n        if (now < entry.resetTime) {\n            activeKeys++;\n        }\n    }\n    return {\n        totalKeys: rateLimitStore.size,\n        activeKeys\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVuQixPQUFPO1FBQ0wscUJBQXFCQSxNQUFNQyxRQUFRO1FBQ25DLHlCQUF5QlQsVUFBVVMsUUFBUTtRQUMzQyxxQkFBcUJSLEtBQUtTLElBQUksQ0FBQ2IsWUFBWSxNQUFNWSxRQUFRO0lBQzNEO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNFO0lBSWQsTUFBTXBCLE1BQU1DLEtBQUtELEdBQUc7SUFDcEIsSUFBSXFCLGFBQWE7SUFFakIsS0FBSyxNQUFNbkIsU0FBU3RCLGVBQWUwQyxNQUFNLEdBQUk7UUFDM0MsSUFBSXRCLE1BQU1FLE1BQU1JLFNBQVMsRUFBRTtZQUN6QmU7UUFDRjtJQUNGO0lBRUEsT0FBTztRQUNMRSxXQUFXM0MsZUFBZXdCLElBQUk7UUFDOUJpQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYWFzLWNvcmUvLi9zcmMvbGliL3JhdGUtbGltaXRlci50cz8xYmFiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmF0ZSBMaW1pdGluZyBNaWRkbGV3YXJlXG4gKiBJbi1tZW1vcnkgcmF0ZSBsaW1pdGVyIHdpdGggY29uZmlndXJhYmxlIGxpbWl0cyBwZXIgZW5kcG9pbnRcbiAqL1xuXG5pbnRlcmZhY2UgUmF0ZUxpbWl0Q29uZmlnIHtcbiAgd2luZG93TXM6IG51bWJlciAgICAgIC8vIFRpbWUgd2luZG93IGluIG1pbGxpc2Vjb25kc1xuICBtYXhSZXF1ZXN0czogbnVtYmVyICAgLy8gTWF4IHJlcXVlc3RzIHBlciB3aW5kb3dcbiAgbWVzc2FnZT86IHN0cmluZyAgICAgIC8vIEN1c3RvbSBlcnJvciBtZXNzYWdlXG59XG5cbmludGVyZmFjZSBSYXRlTGltaXRFbnRyeSB7XG4gIGNvdW50OiBudW1iZXJcbiAgcmVzZXRUaW1lOiBudW1iZXJcbn1cblxuLy8gSW4tbWVtb3J5IHN0b3JlICh1c2UgUmVkaXMgaW4gcHJvZHVjdGlvbiBmb3IgZGlzdHJpYnV0ZWQgc3lzdGVtcylcbmNvbnN0IHJhdGVMaW1pdFN0b3JlID0gbmV3IE1hcDxzdHJpbmcsIFJhdGVMaW1pdEVudHJ5PigpXG5cbi8vIERlZmF1bHQgY29uZmlndXJhdGlvbnMgYnkgZW5kcG9pbnQgcGF0dGVyblxuY29uc3QgcmF0ZUxpbWl0Q29uZmlnczogUmVjb3JkPHN0cmluZywgUmF0ZUxpbWl0Q29uZmlnPiA9IHtcbiAgLy8gQXV0aCBlbmRwb2ludHMgLSBzdHJpY3RlciBsaW1pdHNcbiAgJy9hcGkvYXV0aCc6IHtcbiAgICB3aW5kb3dNczogNjAgKiAxMDAwLCAgICAvLyAxIG1pbnV0ZVxuICAgIG1heFJlcXVlc3RzOiAxMCxcbiAgICBtZXNzYWdlOiAnVG9vIG1hbnkgYXV0aGVudGljYXRpb24gYXR0ZW1wdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJ1xuICB9LFxuICBcbiAgLy8gV3JpdGUgb3BlcmF0aW9ucyAtIG1vZGVyYXRlIGxpbWl0c1xuICAnL2FwaS93YWxsZXRzJzoge1xuICAgIHdpbmRvd01zOiA2MCAqIDEwMDAsICAgIC8vIDEgbWludXRlXG4gICAgbWF4UmVxdWVzdHM6IDYwLFxuICAgIG1lc3NhZ2U6ICdUb28gbWFueSB3YWxsZXQgb3BlcmF0aW9ucy4gUGxlYXNlIHNsb3cgZG93bi4nXG4gIH0sXG4gIFxuICAnL2FwaS9zdm0vY2FydCc6IHtcbiAgICB3aW5kb3dNczogNjAgKiAxMDAwLCAgICAvLyAxIG1pbnV0ZVxuICAgIG1heFJlcXVlc3RzOiAxMDAsXG4gICAgbWVzc2FnZTogJ1RvbyBtYW55IGNhcnQgb3BlcmF0aW9ucy4gUGxlYXNlIHNsb3cgZG93bi4nXG4gIH0sXG4gIFxuICAnL2FwaS9zdm0vb3JkZXJzJzoge1xuICAgIHdpbmRvd01zOiA2MCAqIDEwMDAsICAgIC8vIDEgbWludXRlXG4gICAgbWF4UmVxdWVzdHM6IDMwLFxuICAgIG1lc3NhZ2U6ICdUb28gbWFueSBvcmRlciBvcGVyYXRpb25zLiBQbGVhc2Ugc2xvdyBkb3duLidcbiAgfSxcbiAgXG4gIC8vIFJlYWQgb3BlcmF0aW9ucyAtIGhpZ2hlciBsaW1pdHNcbiAgJ2RlZmF1bHQnOiB7XG4gICAgd2luZG93TXM6IDYwICogMTAwMCwgICAgLy8gMSBtaW51dGVcbiAgICBtYXhSZXF1ZXN0czogMjAwLFxuICAgIG1lc3NhZ2U6ICdUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHNsb3cgZG93bi4nXG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgcmF0ZSBsaW1pdCBjb25maWcgZm9yIGEgcGF0aFxuICovXG5mdW5jdGlvbiBnZXRDb25maWdGb3JQYXRoKHBhdGg6IHN0cmluZyk6IFJhdGVMaW1pdENvbmZpZyB7XG4gIGZvciAoY29uc3QgW3BhdHRlcm4sIGNvbmZpZ10gb2YgT2JqZWN0LmVudHJpZXMocmF0ZUxpbWl0Q29uZmlncykpIHtcbiAgICBpZiAocGF0dGVybiAhPT0gJ2RlZmF1bHQnICYmIHBhdGguc3RhcnRzV2l0aChwYXR0ZXJuKSkge1xuICAgICAgcmV0dXJuIGNvbmZpZ1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmF0ZUxpbWl0Q29uZmlncy5kZWZhdWx0XG59XG5cbi8qKlxuICogR2VuZXJhdGUgcmF0ZSBsaW1pdCBrZXkgZnJvbSByZXF1ZXN0XG4gKi9cbmZ1bmN0aW9uIGdldFJhdGVMaW1pdEtleShcbiAgaWRlbnRpZmllcjogc3RyaW5nLFxuICBwYXRoOiBzdHJpbmdcbik6IHN0cmluZyB7XG4gIC8vIE5vcm1hbGl6ZSBwYXRoIChyZW1vdmUgZHluYW1pYyBzZWdtZW50cylcbiAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSBwYXRoLnJlcGxhY2UoL1xcL1thLXpBLVowLTlfLV17MjAsfSg/PVxcL3wkKS9nLCAnLzppZCcpXG4gIHJldHVybiBgcmF0ZWxpbWl0OiR7aWRlbnRpZmllcn06JHtub3JtYWxpemVkUGF0aH1gXG59XG5cbi8qKlxuICogQ2hlY2sgcmF0ZSBsaW1pdCBmb3IgYSByZXF1ZXN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1JhdGVMaW1pdChcbiAgaWRlbnRpZmllcjogc3RyaW5nLCAgLy8gSVAgYWRkcmVzcyBvciB1c2VyIElEXG4gIHBhdGg6IHN0cmluZ1xuKTogeyBhbGxvd2VkOiBib29sZWFuOyByZW1haW5pbmc6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXI7IG1lc3NhZ2U/OiBzdHJpbmcgfSB7XG4gIGNvbnN0IGNvbmZpZyA9IGdldENvbmZpZ0ZvclBhdGgocGF0aClcbiAgY29uc3Qga2V5ID0gZ2V0UmF0ZUxpbWl0S2V5KGlkZW50aWZpZXIsIHBhdGgpXG4gIGNvbnN0IG5vdyA9IERhdGUubm93KClcblxuICBsZXQgZW50cnkgPSByYXRlTGltaXRTdG9yZS5nZXQoa2V5KVxuXG4gIC8vIENsZWFuIHVwIGV4cGlyZWQgZW50cmllcyBwZXJpb2RpY2FsbHlcbiAgaWYgKHJhdGVMaW1pdFN0b3JlLnNpemUgPiAxMDAwMCkge1xuICAgIGNsZWFudXBFeHBpcmVkRW50cmllcygpXG4gIH1cblxuICAvLyBDaGVjayBpZiB3aW5kb3cgaGFzIGV4cGlyZWRcbiAgaWYgKCFlbnRyeSB8fCBub3cgPiBlbnRyeS5yZXNldFRpbWUpIHtcbiAgICBlbnRyeSA9IHtcbiAgICAgIGNvdW50OiAwLFxuICAgICAgcmVzZXRUaW1lOiBub3cgKyBjb25maWcud2luZG93TXNcbiAgICB9XG4gIH1cblxuICBlbnRyeS5jb3VudCsrXG4gIHJhdGVMaW1pdFN0b3JlLnNldChrZXksIGVudHJ5KVxuXG4gIGNvbnN0IHJlbWFpbmluZyA9IE1hdGgubWF4KDAsIGNvbmZpZy5tYXhSZXF1ZXN0cyAtIGVudHJ5LmNvdW50KVxuICBjb25zdCBhbGxvd2VkID0gZW50cnkuY291bnQgPD0gY29uZmlnLm1heFJlcXVlc3RzXG5cbiAgcmV0dXJuIHtcbiAgICBhbGxvd2VkLFxuICAgIHJlbWFpbmluZyxcbiAgICByZXNldFRpbWU6IGVudHJ5LnJlc2V0VGltZSxcbiAgICBtZXNzYWdlOiBhbGxvd2VkID8gdW5kZWZpbmVkIDogY29uZmlnLm1lc3NhZ2VcbiAgfVxufVxuXG4vKipcbiAqIENsZWFuIHVwIGV4cGlyZWQgZW50cmllc1xuICovXG5mdW5jdGlvbiBjbGVhbnVwRXhwaXJlZEVudHJpZXMoKTogdm9pZCB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgcmF0ZUxpbWl0U3RvcmUuZW50cmllcygpKSB7XG4gICAgaWYgKG5vdyA+IGVudHJ5LnJlc2V0VGltZSkge1xuICAgICAgcmF0ZUxpbWl0U3RvcmUuZGVsZXRlKGtleSlcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZXNldCByYXRlIGxpbWl0IGZvciB0ZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFJhdGVMaW1pdChpZGVudGlmaWVyOiBzdHJpbmcsIHBhdGg6IHN0cmluZyk6IHZvaWQge1xuICBjb25zdCBrZXkgPSBnZXRSYXRlTGltaXRLZXkoaWRlbnRpZmllciwgcGF0aClcbiAgcmF0ZUxpbWl0U3RvcmUuZGVsZXRlKGtleSlcbn1cblxuLyoqXG4gKiBHZXQgcmF0ZSBsaW1pdCBoZWFkZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSYXRlTGltaXRIZWFkZXJzKFxuICByZW1haW5pbmc6IG51bWJlcixcbiAgcmVzZXRUaW1lOiBudW1iZXIsXG4gIGxpbWl0OiBudW1iZXIgPSAyMDBcbik6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICByZXR1cm4ge1xuICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6IGxpbWl0LnRvU3RyaW5nKCksXG4gICAgJ1gtUmF0ZUxpbWl0LVJlbWFpbmluZyc6IHJlbWFpbmluZy50b1N0cmluZygpLFxuICAgICdYLVJhdGVMaW1pdC1SZXNldCc6IE1hdGguY2VpbChyZXNldFRpbWUgLyAxMDAwKS50b1N0cmluZygpXG4gIH1cbn1cblxuLyoqXG4gKiBSYXRlIGxpbWl0IHN0YXRzIGZvciBtb25pdG9yaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSYXRlTGltaXRTdGF0cygpOiB7XG4gIHRvdGFsS2V5czogbnVtYmVyXG4gIGFjdGl2ZUtleXM6IG51bWJlclxufSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KClcbiAgbGV0IGFjdGl2ZUtleXMgPSAwXG4gIFxuICBmb3IgKGNvbnN0IGVudHJ5IG9mIHJhdGVMaW1pdFN0b3JlLnZhbHVlcygpKSB7XG4gICAgaWYgKG5vdyA8IGVudHJ5LnJlc2V0VGltZSkge1xuICAgICAgYWN0aXZlS2V5cysrXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0b3RhbEtleXM6IHJhdGVMaW1pdFN0b3JlLnNpemUsXG4gICAgYWN0aXZlS2V5c1xuICB9XG59XG4iXSwibmFtZXMiOlsicmF0ZUxpbWl0U3RvcmUiLCJNYXAiLCJyYXRlTGltaXRDb25maWdzIiwid2luZG93TXMiLCJtYXhSZXF1ZXN0cyIsIm1lc3NhZ2UiLCJnZXRDb25maWdGb3JQYXRoIiwicGF0aCIsInBhdHRlcm4iLCJjb25maWciLCJPYmplY3QiLCJlbnRyaWVzIiwic3RhcnRzV2l0aCIsImRlZmF1bHQiLCJnZXRSYXRlTGltaXRLZXkiLCJpZGVudGlmaWVyIiwibm9ybWFsaXplZFBhdGgiLCJyZXBsYWNlIiwiY2hlY2tSYXRlTGltaXQiLCJrZXkiLCJub3ciLCJEYXRlIiwiZW50cnkiLCJnZXQiLCJzaXplIiwiY2xlYW51cEV4cGlyZWRFbnRyaWVzIiwicmVzZXRUaW1lIiwiY291bnQiLCJzZXQiLCJyZW1haW5pbmciLCJNYXRoIiwibWF4IiwiYWxsb3dlZCIsInVuZGVmaW5lZCIsImRlbGV0ZSIsInJlc2V0UmF0ZUxpbWl0IiwiZ2V0UmF0ZUxpbWl0SGVhZGVycyIsImxpbWl0IiwidG9TdHJpbmciLCJjZWlsIiwiZ2V0UmF0ZUxpbWl0U3RhdHMiLCJhY3RpdmVLZXlzIiwidmFsdWVzIiwidG90YWxLZXlzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/rate-limiter.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant-isolation.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant-isolation.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PARTNER_SCOPED_MODELS: () => (/* binding */ PARTNER_SCOPED_MODELS),\n/* harmony export */   PLATFORM_MODELS: () => (/* binding */ PLATFORM_MODELS),\n/* harmony export */   TENANT_SCOPED_MODELS: () => (/* binding */ TENANT_SCOPED_MODELS),\n/* harmony export */   TenantIsolationError: () => (/* binding */ TenantIsolationError),\n/* harmony export */   clearViolationLogs: () => (/* binding */ clearViolationLogs),\n/* harmony export */   createPartnerContext: () => (/* binding */ createPartnerContext),\n/* harmony export */   createTenantContext: () => (/* binding */ createTenantContext),\n/* harmony export */   getViolationLogs: () => (/* binding */ getViolationLogs),\n/* harmony export */   isPartnerScopedModel: () => (/* binding */ isPartnerScopedModel),\n/* harmony export */   isTenantScopedModel: () => (/* binding */ isTenantScopedModel),\n/* harmony export */   logViolation: () => (/* binding */ logViolation),\n/* harmony export */   validatePartnerAccess: () => (/* binding */ validatePartnerAccess),\n/* harmony export */   validateTenantAccess: () => (/* binding */ validateTenantAccess),\n/* harmony export */   withPartnerData: () => (/* binding */ withPartnerData),\n/* harmony export */   withPartnerFilter: () => (/* binding */ withPartnerFilter),\n/* harmony export */   withTenantData: () => (/* binding */ withTenantData),\n/* harmony export */   withTenantFilter: () => (/* binding */ withTenantFilter)\n/* harmony export */ });\n/**\n * Tenant Isolation Enforcement\n * \n * This module provides strict tenant data isolation at the database level.\n * Instead of Prisma middleware (which has async context issues), this uses\n * application-level validation before queries are executed.\n * \n * Features:\n * - Pre-query validation functions\n * - SUPER_ADMIN bypass with explicit flag\n * - Violation logging and hard failure\n * - Safe query builders that enforce tenant scoping\n */ // Models that require tenant isolation (tenant-scoped)\nconst TENANT_SCOPED_MODELS = [\n    \"TenantMembership\",\n    \"TenantDomain\",\n    \"AuditLog\"\n];\n// Models that require partner isolation (partner-scoped)\n// These are separate from tenant isolation - partners are platform-level\nconst PARTNER_SCOPED_MODELS = [\n    \"PartnerUser\",\n    \"PartnerAgreement\",\n    \"PartnerReferralCode\",\n    \"PartnerReferral\",\n    \"PartnerEarning\"\n];\n// Platform-level models (no isolation, Super Admin only)\nconst PLATFORM_MODELS = [\n    \"Partner\",\n    \"User\",\n    \"Tenant\",\n    \"Session\",\n    \"MagicLink\"\n];\nconst violations = [];\nconst MAX_VIOLATION_LOGS = 1000;\nfunction logViolation(violation) {\n    const log = {\n        ...violation,\n        timestamp: new Date()\n    };\n    violations.push(log);\n    if (violations.length > MAX_VIOLATION_LOGS) {\n        violations.shift();\n    }\n    console.error(\"[TENANT ISOLATION VIOLATION]\", JSON.stringify(log, null, 2));\n}\nfunction getViolationLogs() {\n    return [\n        ...violations\n    ];\n}\nfunction clearViolationLogs() {\n    violations.length = 0;\n}\n/**\n * Tenant Isolation Error\n */ class TenantIsolationError extends Error {\n    constructor(message, model, action, context){\n        super(message);\n        this.model = model;\n        this.action = action;\n        this.context = context;\n        this.name = \"TenantIsolationError\";\n    }\n}\n/**\n * Check if a model is tenant-scoped\n */ function isTenantScopedModel(model) {\n    return TENANT_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate tenant context before executing a query\n * This should be called before any tenant-scoped database operation\n */ function validateTenantAccess(model, action, context, queryTenantId) {\n    // Skip validation for global models\n    if (!isTenantScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context,\n                query: {\n                    queryTenantId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No tenant context provided for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // No tenantId in context = violation\n    if (!context.tenantId) {\n        const reason = \"No tenantId in context for tenant-scoped query\";\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a tenantId, it must match context\n    if (queryTenantId && queryTenantId !== context.tenantId) {\n        const reason = `Cross-tenant access attempt: query tenantId (${queryTenantId}) != context tenantId (${context.tenantId})`;\n        logViolation({\n            model,\n            action,\n            context,\n            query: {\n                queryTenantId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Create a tenant context from user session\n */ function createTenantContext(tenantId, userId, isSuperAdmin, bypassIsolation = false) {\n    return {\n        tenantId,\n        userId,\n        isSuperAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Create a partner context from user session\n */ function createPartnerContext(partnerId, userId, isSuperAdmin, isPartnerOwner = false, isPartnerAdmin = false, bypassIsolation = false) {\n    return {\n        partnerId,\n        userId,\n        isSuperAdmin,\n        isPartnerOwner,\n        isPartnerAdmin,\n        bypassIsolation\n    };\n}\n/**\n * Ensure a WHERE clause includes the correct tenantId\n */ function withTenantFilter(where, tenantId) {\n    return {\n        ...where,\n        tenantId\n    };\n}\n/**\n * Ensure data being created includes the correct tenantId\n */ function withTenantData(data, tenantId) {\n    return {\n        ...data,\n        tenantId\n    };\n}\n/**\n * Check if a model is partner-scoped\n */ function isPartnerScopedModel(model) {\n    return PARTNER_SCOPED_MODELS.includes(model);\n}\n/**\n * Validate partner context before executing a query\n * This should be called before any partner-scoped database operation\n */ function validatePartnerAccess(model, action, context, queryPartnerId) {\n    // Skip validation for non-partner models\n    if (!isPartnerScopedModel(model)) {\n        return;\n    }\n    // Allow explicit bypass (for migrations, admin tools, etc.)\n    if (context?.bypassIsolation === true) {\n        if (!context.isSuperAdmin) {\n            const reason = \"Partner bypass isolation attempted without SUPER_ADMIN role\";\n            logViolation({\n                model,\n                action,\n                context: context,\n                query: {\n                    queryPartnerId\n                },\n                reason\n            });\n            throw new TenantIsolationError(reason, model, action, context);\n        }\n        return;\n    }\n    // SUPER_ADMIN can access all partner data\n    if (context?.isSuperAdmin) {\n        return;\n    }\n    // No context = violation\n    if (!context) {\n        const reason = \"No partner context provided for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: null,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, null);\n    }\n    // No partnerId in context = violation\n    if (!context.partnerId) {\n        const reason = \"No partnerId in context for partner-scoped query\";\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n    // If query specifies a partnerId, it must match context\n    if (queryPartnerId && queryPartnerId !== context.partnerId) {\n        const reason = `Cross-partner access attempt: query partnerId (${queryPartnerId}) != context partnerId (${context.partnerId})`;\n        logViolation({\n            model,\n            action,\n            context: context,\n            query: {\n                queryPartnerId\n            },\n            reason\n        });\n        throw new TenantIsolationError(reason, model, action, context);\n    }\n}\n/**\n * Ensure a WHERE clause includes the correct partnerId\n */ function withPartnerFilter(where, partnerId) {\n    return {\n        ...where,\n        partnerId\n    };\n}\n/**\n * Ensure data being created includes the correct partnerId\n */ function withPartnerData(data, partnerId) {\n    return {\n        ...data,\n        partnerId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UE4sU0FBaUI7SUFFakIsT0FBTztRQUNMLEdBQUdNLElBQUk7UUFDUE47SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2Fhcy1jb3JlLy4vc3JjL2xpYi90ZW5hbnQtaXNvbGF0aW9uLnRzP2YyNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZW5hbnQgSXNvbGF0aW9uIEVuZm9yY2VtZW50XG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIHN0cmljdCB0ZW5hbnQgZGF0YSBpc29sYXRpb24gYXQgdGhlIGRhdGFiYXNlIGxldmVsLlxuICogSW5zdGVhZCBvZiBQcmlzbWEgbWlkZGxld2FyZSAod2hpY2ggaGFzIGFzeW5jIGNvbnRleHQgaXNzdWVzKSwgdGhpcyB1c2VzXG4gKiBhcHBsaWNhdGlvbi1sZXZlbCB2YWxpZGF0aW9uIGJlZm9yZSBxdWVyaWVzIGFyZSBleGVjdXRlZC5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFByZS1xdWVyeSB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICogLSBTVVBFUl9BRE1JTiBieXBhc3Mgd2l0aCBleHBsaWNpdCBmbGFnXG4gKiAtIFZpb2xhdGlvbiBsb2dnaW5nIGFuZCBoYXJkIGZhaWx1cmVcbiAqIC0gU2FmZSBxdWVyeSBidWlsZGVycyB0aGF0IGVuZm9yY2UgdGVuYW50IHNjb3BpbmdcbiAqL1xuXG4vLyBNb2RlbHMgdGhhdCByZXF1aXJlIHRlbmFudCBpc29sYXRpb24gKHRlbmFudC1zY29wZWQpXG5leHBvcnQgY29uc3QgVEVOQU5UX1NDT1BFRF9NT0RFTFMgPSBbXG4gICdUZW5hbnRNZW1iZXJzaGlwJyxcbiAgJ1RlbmFudERvbWFpbicsIFxuICAnQXVkaXRMb2cnLFxuICAvLyBBZGQgZnV0dXJlIHRlbmFudC1zY29wZWQgbW9kZWxzIGhlcmVcbl0gYXMgY29uc3RcblxuLy8gTW9kZWxzIHRoYXQgcmVxdWlyZSBwYXJ0bmVyIGlzb2xhdGlvbiAocGFydG5lci1zY29wZWQpXG4vLyBUaGVzZSBhcmUgc2VwYXJhdGUgZnJvbSB0ZW5hbnQgaXNvbGF0aW9uIC0gcGFydG5lcnMgYXJlIHBsYXRmb3JtLWxldmVsXG5leHBvcnQgY29uc3QgUEFSVE5FUl9TQ09QRURfTU9ERUxTID0gW1xuICAnUGFydG5lclVzZXInLFxuICAnUGFydG5lckFncmVlbWVudCcsXG4gICdQYXJ0bmVyUmVmZXJyYWxDb2RlJyxcbiAgJ1BhcnRuZXJSZWZlcnJhbCcsXG4gICdQYXJ0bmVyRWFybmluZycsXG5dIGFzIGNvbnN0XG5cbi8vIFBsYXRmb3JtLWxldmVsIG1vZGVscyAobm8gaXNvbGF0aW9uLCBTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX01PREVMUyA9IFtcbiAgJ1BhcnRuZXInLFxuICAnVXNlcicsXG4gICdUZW5hbnQnLFxuICAnU2Vzc2lvbicsXG4gICdNYWdpY0xpbmsnLFxuXSBhcyBjb25zdFxuXG5leHBvcnQgdHlwZSBUZW5hbnRTY29wZWRNb2RlbCA9IHR5cGVvZiBURU5BTlRfU0NPUEVEX01PREVMU1tudW1iZXJdXG5leHBvcnQgdHlwZSBQYXJ0bmVyU2NvcGVkTW9kZWwgPSB0eXBlb2YgUEFSVE5FUl9TQ09QRURfTU9ERUxTW251bWJlcl1cbmV4cG9ydCB0eXBlIFBsYXRmb3JtTW9kZWwgPSB0eXBlb2YgUExBVEZPUk1fTU9ERUxTW251bWJlcl1cblxuZXhwb3J0IGludGVyZmFjZSBUZW5hbnRDb250ZXh0IHtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBieXBhc3NJc29sYXRpb24/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydG5lckNvbnRleHQge1xuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGxcbiAgdXNlcklkOiBzdHJpbmcgfCBudWxsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhblxuICBpc1BhcnRuZXJPd25lcj86IGJvb2xlYW5cbiAgaXNQYXJ0bmVyQWRtaW4/OiBib29sZWFuXG4gIGJ5cGFzc0lzb2xhdGlvbj86IGJvb2xlYW5cbn1cblxuLyoqXG4gKiBWaW9sYXRpb24gbG9nZ2VyXG4gKi9cbmludGVyZmFjZSBWaW9sYXRpb25Mb2cge1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbW9kZWw6IHN0cmluZ1xuICBhY3Rpb246IHN0cmluZ1xuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbFxuICBxdWVyeTogYW55XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmNvbnN0IHZpb2xhdGlvbnM6IFZpb2xhdGlvbkxvZ1tdID0gW11cbmNvbnN0IE1BWF9WSU9MQVRJT05fTE9HUyA9IDEwMDBcblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1Zpb2xhdGlvbih2aW9sYXRpb246IE9taXQ8VmlvbGF0aW9uTG9nLCAndGltZXN0YW1wJz4pOiB2b2lkIHtcbiAgY29uc3QgbG9nOiBWaW9sYXRpb25Mb2cgPSB7XG4gICAgLi4udmlvbGF0aW9uLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB2aW9sYXRpb25zLnB1c2gobG9nKVxuICBcbiAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gTUFYX1ZJT0xBVElPTl9MT0dTKSB7XG4gICAgdmlvbGF0aW9ucy5zaGlmdCgpXG4gIH1cbiAgXG4gIGNvbnNvbGUuZXJyb3IoJ1tURU5BTlQgSVNPTEFUSU9OIFZJT0xBVElPTl0nLCBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmlvbGF0aW9uTG9ncygpOiBWaW9sYXRpb25Mb2dbXSB7XG4gIHJldHVybiBbLi4udmlvbGF0aW9uc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmlvbGF0aW9uTG9ncygpOiB2b2lkIHtcbiAgdmlvbGF0aW9ucy5sZW5ndGggPSAwXG59XG5cbi8qKlxuICogVGVuYW50IElzb2xhdGlvbiBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgVGVuYW50SXNvbGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgbW9kZWw6IHN0cmluZyxcbiAgICBwdWJsaWMgYWN0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIGNvbnRleHQ6IFRlbmFudENvbnRleHQgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG4gICAgdGhpcy5uYW1lID0gJ1RlbmFudElzb2xhdGlvbkVycm9yJ1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBtb2RlbCBpcyB0ZW5hbnQtc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsOiBzdHJpbmcpOiBtb2RlbCBpcyBUZW5hbnRTY29wZWRNb2RlbCB7XG4gIHJldHVybiBURU5BTlRfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgdGVuYW50IGNvbnRleHQgYmVmb3JlIGV4ZWN1dGluZyBhIHF1ZXJ5XG4gKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGFueSB0ZW5hbnQtc2NvcGVkIGRhdGFiYXNlIG9wZXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVUZW5hbnRBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBUZW5hbnRDb250ZXh0IHwgbnVsbCxcbiAgcXVlcnlUZW5hbnRJZD86IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICAvLyBTa2lwIHZhbGlkYXRpb24gZm9yIGdsb2JhbCBtb2RlbHNcbiAgaWYgKCFpc1RlbmFudFNjb3BlZE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBBbGxvdyBleHBsaWNpdCBieXBhc3MgKGZvciBtaWdyYXRpb25zLCBhZG1pbiB0b29scywgZXRjLilcbiAgaWYgKGNvbnRleHQ/LmJ5cGFzc0lzb2xhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIGlmICghY29udGV4dC5pc1N1cGVyQWRtaW4pIHtcbiAgICAgIGNvbnN0IHJlYXNvbiA9ICdCeXBhc3MgaXNvbGF0aW9uIGF0dGVtcHRlZCB3aXRob3V0IFNVUEVSX0FETUlOIHJvbGUnXG4gICAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dClcbiAgICB9XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIFNVUEVSX0FETUlOIGNhbiBhY2Nlc3MgYWxsIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyB0ZW5hbnQgY29udGV4dCBwcm92aWRlZCBmb3IgdGVuYW50LXNjb3BlZCBxdWVyeSdcbiAgICBsb2dWaW9sYXRpb24oeyBtb2RlbCwgYWN0aW9uLCBjb250ZXh0LCBxdWVyeTogeyBxdWVyeVRlbmFudElkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIGNvbnRleHQpXG4gIH1cbiAgXG4gIC8vIE5vIHRlbmFudElkIGluIGNvbnRleHQgPSB2aW9sYXRpb25cbiAgaWYgKCFjb250ZXh0LnRlbmFudElkKSB7XG4gICAgY29uc3QgcmVhc29uID0gJ05vIHRlbmFudElkIGluIGNvbnRleHQgZm9yIHRlbmFudC1zY29wZWQgcXVlcnknXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG4gIFxuICAvLyBJZiBxdWVyeSBzcGVjaWZpZXMgYSB0ZW5hbnRJZCwgaXQgbXVzdCBtYXRjaCBjb250ZXh0XG4gIGlmIChxdWVyeVRlbmFudElkICYmIHF1ZXJ5VGVuYW50SWQgIT09IGNvbnRleHQudGVuYW50SWQpIHtcbiAgICBjb25zdCByZWFzb24gPSBgQ3Jvc3MtdGVuYW50IGFjY2VzcyBhdHRlbXB0OiBxdWVyeSB0ZW5hbnRJZCAoJHtxdWVyeVRlbmFudElkfSkgIT0gY29udGV4dCB0ZW5hbnRJZCAoJHtjb250ZXh0LnRlbmFudElkfSlgXG4gICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dCwgcXVlcnk6IHsgcXVlcnlUZW5hbnRJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0KVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgdGVuYW50IGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlbmFudENvbnRleHQoXG4gIHRlbmFudElkOiBzdHJpbmcgfCBudWxsLFxuICB1c2VySWQ6IHN0cmluZyB8IG51bGwsXG4gIGlzU3VwZXJBZG1pbjogYm9vbGVhbixcbiAgYnlwYXNzSXNvbGF0aW9uOiBib29sZWFuID0gZmFsc2Vcbik6IFRlbmFudENvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHRlbmFudElkLFxuICAgIHVzZXJJZCxcbiAgICBpc1N1cGVyQWRtaW4sXG4gICAgYnlwYXNzSXNvbGF0aW9uXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwYXJ0bmVyIGNvbnRleHQgZnJvbSB1c2VyIHNlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcnRuZXJDb250ZXh0KFxuICBwYXJ0bmVySWQ6IHN0cmluZyB8IG51bGwsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbCxcbiAgaXNTdXBlckFkbWluOiBib29sZWFuLFxuICBpc1BhcnRuZXJPd25lcjogYm9vbGVhbiA9IGZhbHNlLFxuICBpc1BhcnRuZXJBZG1pbjogYm9vbGVhbiA9IGZhbHNlLFxuICBieXBhc3NJc29sYXRpb246IGJvb2xlYW4gPSBmYWxzZVxuKTogUGFydG5lckNvbnRleHQge1xuICByZXR1cm4ge1xuICAgIHBhcnRuZXJJZCxcbiAgICB1c2VySWQsXG4gICAgaXNTdXBlckFkbWluLFxuICAgIGlzUGFydG5lck93bmVyLFxuICAgIGlzUGFydG5lckFkbWluLFxuICAgIGJ5cGFzc0lzb2xhdGlvblxuICB9XG59XG5cbi8qKlxuICogRW5zdXJlIGEgV0hFUkUgY2xhdXNlIGluY2x1ZGVzIHRoZSBjb3JyZWN0IHRlbmFudElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGVuYW50RmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHRlbmFudElkOiBzdHJpbmdcbik6IFQgJiB7IHRlbmFudElkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4ud2hlcmUsXG4gICAgdGVuYW50SWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgdGVuYW50SWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhUZW5hbnREYXRhPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVCxcbiAgdGVuYW50SWQ6IHN0cmluZ1xuKTogVCAmIHsgdGVuYW50SWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIHRlbmFudElkXG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGlzIHBhcnRuZXItc2NvcGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRuZXJTY29wZWRNb2RlbChtb2RlbDogc3RyaW5nKTogbW9kZWwgaXMgUGFydG5lclNjb3BlZE1vZGVsIHtcbiAgcmV0dXJuIFBBUlRORVJfU0NPUEVEX01PREVMUy5pbmNsdWRlcyhtb2RlbCBhcyBhbnkpXG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFydG5lciBjb250ZXh0IGJlZm9yZSBleGVjdXRpbmcgYSBxdWVyeVxuICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBhbnkgcGFydG5lci1zY29wZWQgZGF0YWJhc2Ugb3BlcmF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnRuZXJBY2Nlc3MoXG4gIG1vZGVsOiBzdHJpbmcsXG4gIGFjdGlvbjogc3RyaW5nLFxuICBjb250ZXh0OiBQYXJ0bmVyQ29udGV4dCB8IG51bGwsXG4gIHF1ZXJ5UGFydG5lcklkPzogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIC8vIFNraXAgdmFsaWRhdGlvbiBmb3Igbm9uLXBhcnRuZXIgbW9kZWxzXG4gIGlmICghaXNQYXJ0bmVyU2NvcGVkTW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgXG4gIC8vIEFsbG93IGV4cGxpY2l0IGJ5cGFzcyAoZm9yIG1pZ3JhdGlvbnMsIGFkbWluIHRvb2xzLCBldGMuKVxuICBpZiAoY29udGV4dD8uYnlwYXNzSXNvbGF0aW9uID09PSB0cnVlKSB7XG4gICAgaWYgKCFjb250ZXh0LmlzU3VwZXJBZG1pbikge1xuICAgICAgY29uc3QgcmVhc29uID0gJ1BhcnRuZXIgYnlwYXNzIGlzb2xhdGlvbiBhdHRlbXB0ZWQgd2l0aG91dCBTVVBFUl9BRE1JTiByb2xlJ1xuICAgICAgbG9nVmlvbGF0aW9uKHsgbW9kZWwsIGFjdGlvbiwgY29udGV4dDogY29udGV4dCBhcyBhbnksIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgICAgdGhyb3cgbmV3IFRlbmFudElzb2xhdGlvbkVycm9yKHJlYXNvbiwgbW9kZWwsIGFjdGlvbiwgY29udGV4dCBhcyBhbnkpXG4gICAgfVxuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBTVVBFUl9BRE1JTiBjYW4gYWNjZXNzIGFsbCBwYXJ0bmVyIGRhdGFcbiAgaWYgKGNvbnRleHQ/LmlzU3VwZXJBZG1pbikge1xuICAgIHJldHVyblxuICB9XG4gIFxuICAvLyBObyBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dCkge1xuICAgIGNvbnN0IHJlYXNvbiA9ICdObyBwYXJ0bmVyIGNvbnRleHQgcHJvdmlkZWQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IG51bGwsIHF1ZXJ5OiB7IHF1ZXJ5UGFydG5lcklkIH0sIHJlYXNvbiB9KVxuICAgIHRocm93IG5ldyBUZW5hbnRJc29sYXRpb25FcnJvcihyZWFzb24sIG1vZGVsLCBhY3Rpb24sIG51bGwpXG4gIH1cbiAgXG4gIC8vIE5vIHBhcnRuZXJJZCBpbiBjb250ZXh0ID0gdmlvbGF0aW9uXG4gIGlmICghY29udGV4dC5wYXJ0bmVySWQpIHtcbiAgICBjb25zdCByZWFzb24gPSAnTm8gcGFydG5lcklkIGluIGNvbnRleHQgZm9yIHBhcnRuZXItc2NvcGVkIHF1ZXJ5J1xuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxuICBcbiAgLy8gSWYgcXVlcnkgc3BlY2lmaWVzIGEgcGFydG5lcklkLCBpdCBtdXN0IG1hdGNoIGNvbnRleHRcbiAgaWYgKHF1ZXJ5UGFydG5lcklkICYmIHF1ZXJ5UGFydG5lcklkICE9PSBjb250ZXh0LnBhcnRuZXJJZCkge1xuICAgIGNvbnN0IHJlYXNvbiA9IGBDcm9zcy1wYXJ0bmVyIGFjY2VzcyBhdHRlbXB0OiBxdWVyeSBwYXJ0bmVySWQgKCR7cXVlcnlQYXJ0bmVySWR9KSAhPSBjb250ZXh0IHBhcnRuZXJJZCAoJHtjb250ZXh0LnBhcnRuZXJJZH0pYFxuICAgIGxvZ1Zpb2xhdGlvbih7IG1vZGVsLCBhY3Rpb24sIGNvbnRleHQ6IGNvbnRleHQgYXMgYW55LCBxdWVyeTogeyBxdWVyeVBhcnRuZXJJZCB9LCByZWFzb24gfSlcbiAgICB0aHJvdyBuZXcgVGVuYW50SXNvbGF0aW9uRXJyb3IocmVhc29uLCBtb2RlbCwgYWN0aW9uLCBjb250ZXh0IGFzIGFueSlcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBhIFdIRVJFIGNsYXVzZSBpbmNsdWRlcyB0aGUgY29ycmVjdCBwYXJ0bmVySWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQYXJ0bmVyRmlsdGVyPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgd2hlcmU6IFQsXG4gIHBhcnRuZXJJZDogc3RyaW5nXG4pOiBUICYgeyBwYXJ0bmVySWQ6IHN0cmluZyB9IHtcbiAgcmV0dXJuIHtcbiAgICAuLi53aGVyZSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuXG4vKipcbiAqIEVuc3VyZSBkYXRhIGJlaW5nIGNyZWF0ZWQgaW5jbHVkZXMgdGhlIGNvcnJlY3QgcGFydG5lcklkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUGFydG5lckRhdGE8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICBkYXRhOiBULFxuICBwYXJ0bmVySWQ6IHN0cmluZ1xuKTogVCAmIHsgcGFydG5lcklkOiBzdHJpbmcgfSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBwYXJ0bmVySWRcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlRFTkFOVF9TQ09QRURfTU9ERUxTIiwiUEFSVE5FUl9TQ09QRURfTU9ERUxTIiwiUExBVEZPUk1fTU9ERUxTIiwidmlvbGF0aW9ucyIsIk1BWF9WSU9MQVRJT05fTE9HUyIsImxvZ1Zpb2xhdGlvbiIsInZpb2xhdGlvbiIsImxvZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJjb25zb2xlIiwiZXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0VmlvbGF0aW9uTG9ncyIsImNsZWFyVmlvbGF0aW9uTG9ncyIsIlRlbmFudElzb2xhdGlvbkVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJtb2RlbCIsImFjdGlvbiIsImNvbnRleHQiLCJuYW1lIiwiaXNUZW5hbnRTY29wZWRNb2RlbCIsImluY2x1ZGVzIiwidmFsaWRhdGVUZW5hbnRBY2Nlc3MiLCJxdWVyeVRlbmFudElkIiwiYnlwYXNzSXNvbGF0aW9uIiwiaXNTdXBlckFkbWluIiwicmVhc29uIiwicXVlcnkiLCJ0ZW5hbnRJZCIsImNyZWF0ZVRlbmFudENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVQYXJ0bmVyQ29udGV4dCIsInBhcnRuZXJJZCIsImlzUGFydG5lck93bmVyIiwiaXNQYXJ0bmVyQWRtaW4iLCJ3aXRoVGVuYW50RmlsdGVyIiwid2hlcmUiLCJ3aXRoVGVuYW50RGF0YSIsImRhdGEiLCJpc1BhcnRuZXJTY29wZWRNb2RlbCIsInZhbGlkYXRlUGFydG5lckFjY2VzcyIsInF1ZXJ5UGFydG5lcklkIiwid2l0aFBhcnRuZXJGaWx0ZXIiLCJ3aXRoUGFydG5lckRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant-isolation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmetrics%2Froute&page=%2Fapi%2Fmetrics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmetrics%2Froute.ts&appDir=%2Fapp%2Fsaas-core%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fapp%2Fsaas-core&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();