Authorization acknowledged. âœ…
Below is the exact Replit execution prompt for POS-P2, written to your required standard: Nigeria-first, mobile-first, offline-first, PWA-aware, with strict scope control and hard stop conditions.

This prompt is designed to fix P0/P1 gaps only, without scope creep.

â¸»

ðŸ”§ POS-P2 â€” Core Nigerian POS Completion

Execution Prompt for Replit

CONTEXT

You are working on the WebWaka POS system.
A full read-only audit (POS-P1) has been completed and approved.
This wave is POS-P2, which is a FIX wave, not an audit.

You MUST NOT re-analyze or question the gaps.
You MUST implement only what is explicitly listed below.

â¸»

ðŸŽ¯ OBJECTIVE

Bring WebWaka POS to minimum real-world operability for Nigerian merchants, fixing critical (P0) and high-priority (P1) gaps identified in POS-P1.

This wave focuses on:
	â€¢	Nigerian payment reality
	â€¢	Role & permission enforcement
	â€¢	Mobile usability blockers
	â€¢	Legal/tax correctness
	â€¢	Core trust flows (but NOT full receipts yet)

â¸»

â›” NON-NEGOTIABLE CONSTRAINTS
	â€¢	âŒ NO new features beyond listed scope
	â€¢	âŒ NO speculative UX improvements
	â€¢	âŒ NO reports, analytics, or dashboards
	â€¢	âŒ NO background jobs
	â€¢	âŒ NO breaking existing offline behavior
	â€¢	âŒ NO refactors unrelated to listed gaps
	â€¢	âŒ NO POS-P3 or POS-P4 work

If a gap requires broader architecture, document it and stop.

â¸»

ðŸ“Œ IN-SCOPE GAPS (AUTHORITATIVE)

ðŸ”´ P0 â€” MUST FIX

POS-P2-1: Bank Transfer Payment Method (NX-1)
Implement TRANSFER as a first-class POS payment method.

Requirements:
	â€¢	Add TRANSFER to PaymentMethod
	â€¢	Allow sale finalization with TRANSFER
	â€¢	Offline-compatible (queued like CASH)
	â€¢	No payment gateway integration
	â€¢	Must appear in PaymentScreen UI

â¸»

POS-P2-2: Transfer Reference Capture (NX-2)
For TRANSFER payments:
	â€¢	Require reference input (text field)
	â€¢	Optional photo upload (image only, stored locally if offline)
	â€¢	Persist reference with sale event
	â€¢	Display reference in sale confirmation summary

No OCR, no verification logic.

â¸»

POS-P2-3: VAT Correction (NX-6)
	â€¢	Change VAT from 8% â†’ 7.5%
	â€¢	Must apply consistently across:
	â€¢	POS totals
	â€¢	Offline calculations
	â€¢	API payloads
	â€¢	No multi-tax system

â¸»

POS-P2-4: Role Validation Enforcement (PERM-4)
	â€¢	Validate posRole against tenant membership metadata
	â€¢	Block POS access if role is missing or invalid
	â€¢	Do NOT rely on frontend assumptions

â¸»

ðŸŸ  P1 â€” SHOULD FIX

POS-P2-5: Supervisor Override for Voids (PERM-3)
	â€¢	Introduce Void Sale flow (post-payment)
	â€¢	Requires supervisor PIN or role elevation
	â€¢	No refunds yet (void only)
	â€¢	Audit log entry required

â¸»

POS-P2-6: Responsive Cart Panel (MF-1)
	â€¢	Cart panel must collapse on small screens
	â€¢	Mobile-first behavior:
	â€¢	Toggle drawer
	â€¢	Full-screen cart on phones
	â€¢	Desktop behavior unchanged

â¸»

POS-P2-7: Quantity Input Mobile UX (MF-2)
	â€¢	Replace free-text quantity input with:
	â€¢	Stepper buttons (+ / â€“)
	â€¢	Numeric keypad where typing is needed
	â€¢	Must work offline

â¸»

POS-P2-8: NGN Cash Rounding (NX-5)
	â€¢	Implement Nigerian cash rounding:
	â€¢	Round to nearest â‚¦5 / â‚¦10 (configurable)
	â€¢	Applies to CASH only
	â€¢	Must be visible to cashier before finalization

â¸»

ðŸ§ª REQUIRED VERIFICATION PER ITEM

After each gap is implemented, you MUST:
	â€¢	State exact files changed
	â€¢	Show before vs after behavior
	â€¢	Confirm offline behavior unchanged
	â€¢	Confirm demo mode behavior unchanged

â¸»

ðŸ›‘ HARD STOP CONDITIONS

You MUST STOP immediately when:
	â€¢	All P0 + P1 items above are implemented
	â€¢	All changes compile and run
	â€¢	No other gaps are touched

At STOP, produce:

ðŸ“„ POS-P2 COMPLETION REPORT

Including:
	1.	Gap-by-gap checklist (P0/P1)
	2.	Screenshots or UI description (textual OK)
	3.	Offline behavior confirmation
	4.	Known deferred gaps (P2/P3)
	5.	Explicit statement:
â€œPOS-P2 scope complete. No additional changes made.â€

DO NOT proceed to:
	â€¢	POS-P3
	â€¢	Receipts
	â€¢	WhatsApp
	â€¢	Fintech integrations
	â€¢	PWA work
	â€¢	Reporting

â¸»

ðŸ§  REMINDER

This wave is about making POS usable in real Nigerian shops, not perfect.

Correct > Complete > Pretty

â¸»

ðŸš¦ BEGIN POS-P2 IMPLEMENTATION NOW

Stop only when POS-P2 COMPLETION REPORT is produced.