Below is the exact Replit execution prompt you can paste and run.
It is written to force disciplined, step-by-step execution of Wave C (C1 ‚Üí C4) with no branching, no skipping, and a hard stop only at the very end of C4 for verification.

This prompt is intentionally strict, explicit, and non-negotiable.

‚∏ª

üîê REPLIT EXECUTION PROMPT

WAVE C ‚Äî SECURITY & EXPOSURE REMEDIATION (FULL RUN)

‚ö†Ô∏è ABSOLUTE INSTRUCTIONS (READ FIRST)

You are executing Wave C, which consists of four sub-waves (C1‚ÄìC4).
You MUST execute them in order, non-stop, without pausing, and without introducing any new features.

üö´ DO NOT
	‚Ä¢	Invent new functionality
	‚Ä¢	Add new business logic
	‚Ä¢	Add new user flows
	‚Ä¢	Add new authentication systems
	‚Ä¢	Skip any step
	‚Ä¢	Reinterpret requirements

‚úÖ YOU MUST
	‚Ä¢	Only harden, restrict, remove, or gate existing surfaces
	‚Ä¢	Follow the gap list from WAVE A2 (XPOSURE_REPORT.md) exactly
	‚Ä¢	Produce documentation artifacts where required
	‚Ä¢	Stop ONLY at the end of Wave C4

‚∏ª

üìò AUTHORITATIVE INPUT DOCUMENTS

You MUST treat the following as canonical truth:
	1.	XPOSURE_REPORT.md (Wave A2 ‚Äî Security & Exposure Audit)
	2.	WEBWAKA GROUND TRUTH AUDIT (V2)
	3.	Existing codebase (no assumptions beyond code)

All GAP IDs referenced below come directly from Wave A2.

‚∏ª

üü• WAVE C1 ‚Äî DEBUG & TEST SURFACE LOCKDOWN

Objective

Eliminate or fully secure all debug, test, and development-only surfaces that must never be reachable in production.

GAPs Covered
	‚Ä¢	GAP-001 ‚Äî /api/debug/otp-logs
	‚Ä¢	GAP-002 ‚Äî /api/debug/activate-all-capabilities
	‚Ä¢	GAP-003 ‚Äî /test-* routes
	‚Ä¢	Debug/Test APIs and pages in production codebase

REQUIRED ACTIONS
	1.	Debug APIs
	‚Ä¢	/api/debug/otp-logs
	‚Ä¢	/api/debug/activate-all-capabilities
Apply ONE of the following (choose the safest):
	‚Ä¢	Remove route entirely
OR
	‚Ä¢	Hard-gate with BOTH:
	‚Ä¢	requireSuperAdmin()
	‚Ä¢	NODE_ENV === 'development'
	2.	Test Pages
	‚Ä¢	/test-errors
	‚Ä¢	/test-layout
	‚Ä¢	/test-permissions
	‚Ä¢	/test-role
Action:
	‚Ä¢	Remove from routing OR
	‚Ä¢	Make them unreachable in production builds
	3.	Phase / Staging Routes
	‚Ä¢	/phase6 (if present)
Action:
	‚Ä¢	Remove or hard-disable in production

FORBIDDEN

‚ùå Leaving debug endpoints protected only by NODE_ENV
‚ùå Adding replacement debug tools
‚ùå Leaving test pages accessible to any authenticated user

‚∏ª

üüß WAVE C2 ‚Äî TENANT CONTEXT & CANONICAL API HARDENING

Objective

Close trust-boundary violations where client-supplied identifiers can be abused.

GAPs Covered
	‚Ä¢	GAP-004 ‚Äî Canonical APIs trust tenantSlug from query params
	‚Ä¢	GAP-006 ‚Äî Guessable order references (enumeration risk)

TARGETED ENDPOINTS
	‚Ä¢	/api/orders/canonical/*
	‚Ä¢	/api/customers/canonical
	‚Ä¢	/api/proofs/by-*

REQUIRED ACTIONS
	1.	Tenant Context Enforcement
	‚Ä¢	Eliminate direct trust in client-supplied tenantSlug
	‚Ä¢	All tenant context must be resolved server-side using:
	‚Ä¢	TenantContextResolver
	‚Ä¢	Verified tenant existence + module entitlement
	2.	Cross-Tenant Protection
	‚Ä¢	Ensure probing another tenant‚Äôs orders/customers is impossible
	‚Ä¢	Invalid or mismatched tenant context MUST return 403
	3.	Order Enumeration Mitigation
	‚Ä¢	Harden reference lookup logic (NO schema changes unless unavoidable)
	‚Ä¢	Reduce inferability where possible without breaking public flows

FORBIDDEN

‚ùå Adding customer login/accounts
‚ùå Introducing new auth providers
‚ùå Breaking existing public order/ticket verification flows

‚∏ª

üü® WAVE C3 ‚Äî DEMO MODE CONTAINMENT & WEBHOOK SAFETY

Objective

Ensure demo shortcuts cannot leak into live behavior.

GAPs Covered
	‚Ä¢	GAP-005 ‚Äî String-based demo detection
	‚Ä¢	GAP-007 ‚Äî Webhook signature skipped in demo
	‚Ä¢	GAP-008 ‚Äî Demo pages accessible to all authenticated users

REQUIRED ACTIONS
	1.	Demo Detection Hardening
	‚Ä¢	Replace string-based demo detection (slug.includes("demo"))
	‚Ä¢	Use a single authoritative flag (e.g. tenant.isDemo)
	2.	Webhook Security
	‚Ä¢	Enforce signature verification always
	‚Ä¢	Demo mode must use a dummy secret, not skip verification
	3.	Demo Page Containment
	‚Ä¢	Restrict all *-demo pages to:
	‚Ä¢	Demo tenants ONLY
OR
	‚Ä¢	Explicit demo role

FORBIDDEN

‚ùå Removing demo functionality
‚ùå Weakening demo UX
‚ùå Allowing demo bypass in live tenants

‚∏ª

üü¶ WAVE C4 ‚Äî FINAL EXPOSURE VERIFICATION (STOP HERE)

Objective

Prove that all Wave C gaps are fully closed.

REQUIRED ACTIONS
	1.	Re-run an exposure audit equivalent to Wave A2
	2.	Produce a Wave C4 Closure Report containing:
	‚Ä¢	GAP-ID ‚Üí Status (CLOSED)
	‚Ä¢	Before vs After exposure comparison
	‚Ä¢	Updated risk matrix (should be LOW / ACCEPTABLE only)
	3.	Confirm explicitly:
	‚Ä¢	No debug endpoints exposed
	‚Ä¢	No test pages reachable
	‚Ä¢	No demo leakage into live tenants
	‚Ä¢	No canonical API tenant spoofing possible

‚∏ª

üõë FINAL STOP CONDITION (MANDATORY)

After completing Wave C4:

üõë STOP ALL WORK IMMEDIATELY

DO NOT:
	‚Ä¢	Proceed to Wave D
	‚Ä¢	Proceed to payouts
	‚Ä¢	Proceed to branding
	‚Ä¢	Proceed to templates
	‚Ä¢	Proceed to integrations

WAIT for explicit human approval after presenting:
	‚Ä¢	Wave C4 Closure Report
	‚Ä¢	Confirmation that ALL GAP-IDs from Wave A2 are addressed

‚∏ª

‚úÖ SUCCESS CRITERIA (NON-NEGOTIABLE)

Wave C is considered successful ONLY IF:
	‚Ä¢	Every GAP in Wave A2 is either closed or explicitly justified
	‚Ä¢	No new public surface is introduced
	‚Ä¢	No business logic is added
	‚Ä¢	No assumptions are made

‚∏ª

BEGIN WAVE C EXECUTION NOW.