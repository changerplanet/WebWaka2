generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model AuditLog {
  id         String      @id
  action     AuditAction
  actorId    String
  actorEmail String
  tenantId   String?
  targetType String?
  targetId   String?
  metadata   Json?
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime    @default(now())

  @@index([action])
  @@index([actorId])
  @@index([createdAt])
  @@index([targetType, targetId])
  @@index([tenantId])
}

model BusinessProfile {
  id                 String   @id
  tenantId           String   @unique
  legalName          String?
  tradingName        String?
  taxId              String?
  registrationNumber String?
  businessType       String?
  industry           String?
  email              String?
  phone              String?
  website            String?
  addressLine1       String?
  addressLine2       String?
  city               String?
  state              String?
  postalCode         String?
  country            String?  @default("US")
  timezone           String   @default("UTC")
  currency           String   @default("USD")
  dateFormat         String   @default("YYYY-MM-DD")
  createdAt          DateTime @default(now())
  updatedAt          DateTime
  Tenant             Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model Customer {
  id                String            @id
  tenantId          String
  email             String?
  phone             String?
  firstName         String?
  lastName          String?
  fullName          String?
  company           String?
  taxId             String?
  defaultAddressId  String?
  status            CustomerStatus    @default(ACTIVE)
  acceptsMarketing  Boolean           @default(false)
  marketingOptInAt  DateTime?
  notes             String?
  tags              String[]          @default([])
  totalOrders       Int               @default(0)
  totalSpent        Decimal           @default(0) @db.Decimal(12, 2)
  averageOrderValue Decimal?          @db.Decimal(12, 2)
  lastOrderAt       DateTime?
  loyaltyPoints     Int               @default(0)
  loyaltyTier       String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  CustomerAddress   CustomerAddress[]
  Wallet            Wallet[]

  @@unique([tenantId, email])
  @@index([email])
  @@index([phone])
  @@index([status])
  @@index([tenantId])
}

model CustomerAddress {
  id           String      @id
  customerId   String
  type         AddressType @default(BOTH)
  firstName    String?
  lastName     String?
  company      String?
  phone        String?
  addressLine1 String
  addressLine2 String?
  city         String
  state        String?
  postalCode   String
  country      String
  isDefault    Boolean     @default(false)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime
  Customer     Customer    @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([customerId])
}

model Entitlement {
  id             String            @id
  tenantId       String
  subscriptionId String?
  module         String
  status         EntitlementStatus @default(ACTIVE)
  validFrom      DateTime          @default(now())
  validUntil     DateTime?
  limits         Json?
  source         String            @default("subscription")
  createdAt      DateTime          @default(now())
  updatedAt      DateTime
  Subscription   Subscription?     @relation(fields: [subscriptionId], references: [id])
  Tenant         Tenant            @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, module])
  @@index([module])
  @@index([status])
  @@index([tenantId])
}

model InstanceFinancialSummary {
  id                        String           @id
  platformInstanceId        String           @unique
  partnerId                 String
  totalRevenue              Decimal          @default(0) @db.Decimal(14, 2)
  currentMonthRevenue       Decimal          @default(0) @db.Decimal(14, 2)
  lastMonthRevenue          Decimal          @default(0) @db.Decimal(14, 2)
  totalWholesaleCost        Decimal          @default(0) @db.Decimal(14, 2)
  currentMonthWholesaleCost Decimal          @default(0) @db.Decimal(14, 2)
  totalProfit               Decimal          @default(0) @db.Decimal(14, 2)
  currentMonthProfit        Decimal          @default(0) @db.Decimal(14, 2)
  outstandingBalance        Decimal          @default(0) @db.Decimal(14, 2)
  totalCommissionEarned     Decimal          @default(0) @db.Decimal(14, 2)
  pendingCommission         Decimal          @default(0) @db.Decimal(14, 2)
  paidCommission            Decimal          @default(0) @db.Decimal(14, 2)
  lastCalculatedAt          DateTime         @default(now())
  createdAt                 DateTime         @default(now())
  updatedAt                 DateTime
  Partner                   Partner          @relation(fields: [partnerId], references: [id], onDelete: Cascade)
  PlatformInstance          PlatformInstance @relation(fields: [platformInstanceId], references: [id], onDelete: Cascade)

  @@index([lastCalculatedAt])
  @@index([partnerId])
}

model InstanceSubscription {
  id                 String                     @id
  platformInstanceId String                     @unique
  partnerId          String
  planId             String?
  status             InstanceSubscriptionStatus @default(TRIAL)
  billingInterval    String                     @default("monthly")
  currentPeriodStart DateTime
  currentPeriodEnd   DateTime
  amount             Decimal                    @db.Decimal(12, 2)
  currency           String                     @default("NGN")
  wholesaleCost      Decimal                    @db.Decimal(12, 2)
  partnerMargin      Decimal                    @db.Decimal(12, 2)
  trialStart         DateTime?
  trialEnd           DateTime?
  suspendedAt        DateTime?
  suspendedReason    String?
  cancelledAt        DateTime?
  cancelReason       String?
  cancelAtPeriodEnd  Boolean                    @default(false)
  metadata           Json?
  createdAt          DateTime                   @default(now())
  updatedAt          DateTime
  Partner            Partner                    @relation(fields: [partnerId], references: [id])
  SubscriptionPlan   SubscriptionPlan?          @relation(fields: [planId], references: [id])
  PlatformInstance   PlatformInstance           @relation(fields: [platformInstanceId], references: [id], onDelete: Cascade)

  @@index([currentPeriodEnd])
  @@index([partnerId])
  @@index([status])
}

model InventoryLevel {
  id                String          @id
  tenantId          String
  productId         String
  variantId         String?
  locationId        String
  quantityOnHand    Int             @default(0)
  quantityReserved  Int             @default(0)
  quantityAvailable Int             @default(0)
  quantityIncoming  Int             @default(0)
  reorderPoint      Int?
  reorderQuantity   Int?
  binLocation       String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime
  lastCountedAt     DateTime?
  Location          Location        @relation(fields: [locationId], references: [id], onDelete: Cascade)
  Product           Product         @relation(fields: [productId], references: [id], onDelete: Cascade)
  ProductVariant    ProductVariant? @relation(fields: [variantId], references: [id], onDelete: Cascade)

  @@unique([productId, variantId, locationId])
  @@index([locationId])
  @@index([productId])
  @@index([quantityAvailable])
  @@index([tenantId])
}

model Invoice {
  id             String       @id
  subscriptionId String
  tenantId       String
  invoiceNumber  String       @unique
  status         String
  subtotal       Decimal      @db.Decimal(12, 2)
  tax            Decimal      @default(0) @db.Decimal(12, 2)
  total          Decimal      @db.Decimal(12, 2)
  amountPaid     Decimal      @default(0) @db.Decimal(12, 2)
  amountDue      Decimal      @db.Decimal(12, 2)
  currency       String       @default("USD")
  periodStart    DateTime
  periodEnd      DateTime
  issuedAt       DateTime     @default(now())
  dueAt          DateTime
  paidAt         DateTime?
  externalId     String?
  hostedUrl      String?
  pdfUrl         String?
  partnerId      String?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime
  Subscription   Subscription @relation(fields: [subscriptionId], references: [id], onDelete: Cascade)
  Tenant         Tenant       @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([partnerId])
  @@index([status])
  @@index([subscriptionId])
  @@index([tenantId])
}

model Location {
  id                String           @id
  tenantId          String
  name              String
  code              String?
  type              String           @default("STORE")
  status            LocationStatus   @default(ACTIVE)
  email             String?
  phone             String?
  addressLine1      String?
  addressLine2      String?
  city              String?
  state             String?
  postalCode        String?
  country           String?
  latitude          Decimal?         @db.Decimal(10, 8)
  longitude         Decimal?         @db.Decimal(11, 8)
  operatingHours    Json?
  isDefaultLocation Boolean          @default(false)
  allowsPickup      Boolean          @default(false)
  allowsShipping    Boolean          @default(false)
  createdAt         DateTime         @default(now())
  updatedAt         DateTime
  InventoryLevel    InventoryLevel[]
  StaffMember       StaffMember[]

  @@unique([tenantId, code])
  @@index([status])
  @@index([tenantId])
}

model MagicLink {
  id        String    @id
  token     String    @unique
  userId    String
  tenantId  String?
  expiresAt DateTime
  usedAt    DateTime?
  createdAt DateTime  @default(now())
  Tenant    Tenant?   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  User      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([expiresAt])
  @@index([token])
  @@index([userId])
}

model Notification {
  id             String              @id
  tenantId       String?
  userId         String?
  recipientEmail String?
  recipientPhone String?
  channel        NotificationChannel
  title          String?
  body           String
  actionUrl      String?
  templateId     String?
  templateData   Json?
  status         NotificationStatus  @default(PENDING)
  scheduledAt    DateTime?
  sentAt         DateTime?
  deliveredAt    DateTime?
  readAt         DateTime?
  failedAt       DateTime?
  failureReason  String?
  sourceModule   String?
  sourceEvent    String?
  sourceId       String?
  createdAt      DateTime            @default(now())

  @@index([channel])
  @@index([createdAt])
  @@index([status])
  @@index([tenantId])
  @@index([userId])
}

model NotificationPreference {
  id        String   @id
  userId    String
  tenantId  String?
  category  String
  email     Boolean  @default(true)
  sms       Boolean  @default(false)
  push      Boolean  @default(true)
  inApp     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@unique([userId, tenantId, category])
  @@index([userId])
}

model OtpCode {
  id                String     @id
  phone             String?
  email             String?
  userId            String?
  code              String
  codeHash          String
  purpose           OtpPurpose @default(LOGIN)
  channel           OtpChannel @default(SMS)
  status            OtpStatus  @default(PENDING)
  attempts          Int        @default(0)
  maxAttempts       Int        @default(3)
  resendCount       Int        @default(0)
  maxResends        Int        @default(3)
  lastResentAt      DateTime?
  expiresAt         DateTime
  verifiedAt        DateTime?
  verifiedIp        String?
  verifiedUserAgent String?
  provider          String?
  providerMsgId     String?
  ipAddress         String?
  userAgent         String?
  deviceFingerprint String?
  createdAt         DateTime   @default(now())
  User              User?      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([email])
  @@index([expiresAt])
  @@index([phone])
  @@index([status])
  @@index([userId])
}

model Partner {
  id                       String                     @id
  name                     String
  slug                     String                     @unique
  email                    String
  phone                    String?
  website                  String?
  status                   PartnerStatus              @default(PENDING)
  tier                     PartnerTier                @default(BRONZE)
  companyNumber            String?
  taxId                    String?
  address                  Json?
  metadata                 Json?
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime
  approvedAt               DateTime?
  InstanceFinancialSummary InstanceFinancialSummary[]
  InstanceSubscription     InstanceSubscription[]
  PartnerAgreement         PartnerAgreement[]
  PartnerEarning           PartnerEarning[]
  PartnerInstanceEarning   PartnerInstanceEarning[]
  PartnerPackage           PartnerPackage[]
  PartnerPayoutSettings    PartnerPayoutSettings?
  PartnerReferral          PartnerReferral[]
  PartnerReferralCode      PartnerReferralCode[]
  PartnerUser              PartnerUser[]
  PayoutBatch              PayoutBatch[]
  PlatformInstance         PlatformInstance[]

  @@index([email])
  @@index([slug])
  @@index([status])
  @@index([tier])
}

model PartnerAgreement {
  id                String            @id
  partnerId         String
  version           Int
  effectiveFrom     DateTime
  effectiveTo       DateTime?
  commissionType    CommissionType    @default(PERCENTAGE)
  commissionRate    Decimal           @db.Decimal(5, 4)
  commissionTiers   Json?
  terms             Json?
  status            AgreementStatus   @default(DRAFT)
  signedAt          DateTime?
  signedByUserId    String?
  approvedAt        DateTime?
  approvedByUserId  String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  clearanceDays     Int               @default(30)
  commissionRules   Json?
  commissionTrigger CommissionTrigger @default(ON_PAYMENT)
  currency          String            @default("USD")
  fixedAmount       Decimal?          @db.Decimal(12, 2)
  maxCommission     Decimal?          @db.Decimal(12, 2)
  minCommission     Decimal?          @db.Decimal(12, 2)
  setupFee          Decimal?          @db.Decimal(12, 2)
  Partner           Partner           @relation(fields: [partnerId], references: [id], onDelete: Cascade)
  PartnerEarning    PartnerEarning[]

  @@unique([partnerId, version])
  @@index([effectiveFrom, effectiveTo])
  @@index([partnerId])
  @@index([status])
}

model PartnerEarning {
  id                  String           @id
  partnerId           String
  referralId          String
  agreementId         String
  periodStart         DateTime
  periodEnd           DateTime
  grossAmount         Decimal          @db.Decimal(12, 2)
  commissionRate      Decimal?         @db.Decimal(5, 4)
  commissionAmount    Decimal          @db.Decimal(12, 2)
  currency            String           @default("USD")
  status              EarningStatus    @default(PENDING)
  paidAt              DateTime?
  paymentReference    String?
  paymentMethod       String?
  createdAt           DateTime         @default(now())
  approvedAt          DateTime?
  approvedByUserId    String?
  calculationDetails  Json?
  clearedAt           DateTime?
  commissionType      CommissionType
  createdByUserId     String?
  disputedAt          DateTime?
  entryType           EarningEntryType @default(CREDIT)
  fixedAmount         Decimal?         @db.Decimal(12, 2)
  idempotencyKey      String           @unique
  metadata            Json?
  payoutBatchId       String?
  reversalEntryId     String?
  reversalReason      String?
  reversedAt          DateTime?
  reversedById        String?
  subscriptionEventId String?
  voidedAt            DateTime?
  PartnerAgreement    PartnerAgreement @relation(fields: [agreementId], references: [id])
  Partner             Partner          @relation(fields: [partnerId], references: [id])
  PartnerReferral     PartnerReferral  @relation(fields: [referralId], references: [id])

  @@index([agreementId])
  @@index([createdAt])
  @@index([entryType])
  @@index([partnerId])
  @@index([payoutBatchId])
  @@index([periodStart, periodEnd])
  @@index([referralId])
  @@index([status])
}

model PartnerInstanceEarning {
  id                 String           @id
  partnerId          String
  platformInstanceId String
  earningType        String
  description        String?
  referenceType      String?
  referenceId        String?
  grossAmount        Decimal          @db.Decimal(12, 2)
  commissionRate     Decimal          @db.Decimal(5, 4)
  commissionAmount   Decimal          @db.Decimal(12, 2)
  currency           String           @default("NGN")
  status             EarningStatus    @default(PENDING)
  clearsAt           DateTime?
  clearedAt          DateTime?
  payoutId           String?
  paidAt             DateTime?
  metadata           Json?
  createdAt          DateTime         @default(now())
  updatedAt          DateTime
  Partner            Partner          @relation(fields: [partnerId], references: [id], onDelete: Cascade)
  PlatformInstance   PlatformInstance @relation(fields: [platformInstanceId], references: [id], onDelete: Cascade)

  @@index([clearsAt])
  @@index([createdAt])
  @@index([partnerId])
  @@index([platformInstanceId])
  @@index([status])
}

model PartnerPackage {
  id                   String   @id
  partnerId            String
  name                 String
  slug                 String
  description          String?
  includedInstances    Int      @default(1)
  includedSuiteKeys    String[] @default([])
  priceMonthly         Decimal  @db.Decimal(12, 2)
  priceYearly          Decimal? @db.Decimal(12, 2)
  setupFee             Decimal? @db.Decimal(12, 2)
  trialDays            Int      @default(14)
  currency             String   @default("NGN")
  wholesaleCostMonthly Decimal? @db.Decimal(12, 2)
  features             Json?
  isActive             Boolean  @default(true)
  isPublic             Boolean  @default(true)
  sortOrder            Int      @default(0)
  createdAt            DateTime @default(now())
  updatedAt            DateTime
  Partner              Partner  @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  @@unique([partnerId, slug])
  @@index([isActive, isPublic])
  @@index([partnerId])
}

model PartnerPayoutSettings {
  id                    String    @id
  partnerId             String    @unique
  minimumPayout         Decimal   @default(100.00) @db.Decimal(12, 2)
  currency              String    @default("USD")
  payoutFrequency       String    @default("MONTHLY")
  taxWithholdingEnabled Boolean   @default(false)
  taxWithholdingRate    Decimal?  @db.Decimal(5, 4)
  taxWithholdingReason  String?
  taxDocumentStatus     String    @default("NOT_SUBMITTED")
  taxDocumentType       String?
  taxDocumentVerifiedAt DateTime?
  paymentMethodType     String?
  paymentMethodVerified Boolean   @default(false)
  paymentMethodDetails  Json?
  payoutHold            Boolean   @default(false)
  payoutHoldReason      String?
  payoutHoldUntil       DateTime?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  Partner               Partner   @relation(fields: [partnerId], references: [id], onDelete: Cascade)
}

model PartnerReferral {
  id                    String               @id
  partnerId             String
  tenantId              String               @unique
  referralCodeId        String?
  referredAt            DateTime             @default(now())
  attributionLocked     Boolean              @default(false)
  lockedAt              DateTime?
  referralSource        String?
  landingPage           String?
  metadata              Json?
  createdAt             DateTime             @default(now())
  attributionExpiresAt  DateTime?
  attributionMethod     AttributionMethod    @default(REFERRAL_LINK)
  attributionWindowDays Int?
  createdByUserId       String?
  PartnerEarning        PartnerEarning[]
  Partner               Partner              @relation(fields: [partnerId], references: [id])
  PartnerReferralCode   PartnerReferralCode? @relation(fields: [referralCodeId], references: [id])
  Tenant                Tenant               @relation(fields: [tenantId], references: [id])
  Subscription          Subscription[]

  @@index([attributionLocked])
  @@index([attributionMethod])
  @@index([partnerId])
  @@index([referredAt])
  @@index([tenantId])
}

model PartnerReferralCode {
  id              String            @id
  partnerId       String
  code            String            @unique
  isActive        Boolean           @default(true)
  usageLimit      Int?
  usageCount      Int               @default(0)
  expiresAt       DateTime?
  campaignName    String?
  metadata        Json?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime
  PartnerReferral PartnerReferral[]
  Partner         Partner           @relation(fields: [partnerId], references: [id], onDelete: Cascade)

  @@index([code])
  @@index([isActive])
  @@index([partnerId])
}

model PartnerUser {
  id                String      @id
  partnerId         String
  userId            String      @unique
  role              PartnerRole @default(PARTNER_STAFF)
  isActive          Boolean     @default(true)
  createdAt         DateTime    @default(now())
  updatedAt         DateTime
  joinedAt          DateTime    @default(now())
  assignedTenantIds String[]    @default([])
  department        String?
  displayName       String?
  Partner           Partner     @relation(fields: [partnerId], references: [id], onDelete: Cascade)
  User              User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([partnerId, userId])
  @@index([partnerId])
  @@index([role])
}

model PayoutBatch {
  id                 String    @id
  partnerId          String
  batchNumber        String    @unique
  status             String    @default("DRAFT")
  currency           String    @default("USD")
  earningsCount      Int
  periodStart        DateTime
  periodEnd          DateTime
  paymentMethod      String?
  paymentReference   String?
  processedAt        DateTime?
  approvedAt         DateTime?
  approvedByUserId   String?
  createdAt          DateTime  @default(now())
  blockReason        String?
  cancellationReason String?
  cancelledAt        DateTime?
  cancelledByUserId  String?
  failureReason      String?
  grossAmount        Decimal   @db.Decimal(12, 2)
  internalNotes      String?
  netAmount          Decimal   @db.Decimal(12, 2)
  readinessChecks    Json?
  readinessStatus    String    @default("NOT_CHECKED")
  taxWithholding     Decimal   @default(0) @db.Decimal(12, 2)
  updatedAt          DateTime
  Partner            Partner   @relation(fields: [partnerId], references: [id])

  @@index([createdAt])
  @@index([partnerId])
  @@index([readinessStatus])
  @@index([status])
}

model PlatformInstance {
  id                       String                    @id
  tenantId                 String
  name                     String
  slug                     String
  description              String?
  suiteKeys                String[]                  @default([])
  displayName              String?
  logoUrl                  String?
  faviconUrl               String?
  primaryColor             String?
  secondaryColor           String?
  navigationConfig         Json?                     @default("{}")
  isDefault                Boolean                   @default(false)
  isActive                 Boolean                   @default(true)
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime
  createdByPartnerId       String?
  suspendedAt              DateTime?
  suspendedReason          String?
  InstanceFinancialSummary InstanceFinancialSummary?
  InstanceSubscription     InstanceSubscription?
  PartnerInstanceEarning   PartnerInstanceEarning[]
  Partner                  Partner?                  @relation(fields: [createdByPartnerId], references: [id])
  Tenant                   Tenant                    @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  TenantDomain             TenantDomain[]

  @@unique([tenantId, slug])
  @@index([createdByPartnerId])
  @@index([isActive])
  @@index([isDefault])
  @@index([tenantId])
}

model PricingRule {
  id            String           @id
  tenantId      String
  name          String
  description   String?
  type          PricingRuleType
  value         Decimal          @db.Decimal(12, 4)
  scope         PricingRuleScope @default(ALL_PRODUCTS)
  scopeIds      String[]         @default([])
  minQuantity   Int?
  minOrderValue Decimal?         @db.Decimal(12, 2)
  startsAt      DateTime?
  endsAt        DateTime?
  priority      Int              @default(0)
  isActive      Boolean          @default(true)
  isStackable   Boolean          @default(false)
  createdAt     DateTime         @default(now())
  updatedAt     DateTime

  @@index([isActive])
  @@index([scope])
  @@index([startsAt, endsAt])
  @@index([tenantId])
}

model Product {
  id               String           @id
  tenantId         String
  name             String
  slug             String
  sku              String?
  barcode          String?
  description      String?
  shortDescription String?
  categoryId       String?
  tags             String[]         @default([])
  type             ProductType      @default(PHYSICAL)
  price            Decimal          @db.Decimal(12, 2)
  compareAtPrice   Decimal?         @db.Decimal(12, 2)
  costPrice        Decimal?         @db.Decimal(12, 2)
  taxable          Boolean          @default(true)
  taxCategoryId    String?
  weight           Decimal?         @db.Decimal(10, 4)
  weightUnit       String?          @default("kg")
  length           Decimal?         @db.Decimal(10, 2)
  width            Decimal?         @db.Decimal(10, 2)
  height           Decimal?         @db.Decimal(10, 2)
  dimensionUnit    String?          @default("cm")
  trackInventory   Boolean          @default(true)
  allowBackorder   Boolean          @default(false)
  images           Json?
  metaTitle        String?
  metaDescription  String?
  status           ProductStatus    @default(DRAFT)
  publishedAt      DateTime?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  InventoryLevel   InventoryLevel[]
  ProductCategory  ProductCategory? @relation(fields: [categoryId], references: [id])
  ProductVariant   ProductVariant[]

  @@unique([tenantId, sku])
  @@unique([tenantId, slug])
  @@index([barcode])
  @@index([categoryId])
  @@index([status])
  @@index([tenantId])
}

model ProductCategory {
  id                    String            @id
  tenantId              String
  name                  String
  slug                  String
  description           String?
  imageUrl              String?
  parentId              String?
  sortOrder             Int               @default(0)
  isActive              Boolean           @default(true)
  createdAt             DateTime          @default(now())
  updatedAt             DateTime
  Product               Product[]
  ProductCategory       ProductCategory?  @relation("ProductCategoryToProductCategory", fields: [parentId], references: [id])
  other_ProductCategory ProductCategory[] @relation("ProductCategoryToProductCategory")

  @@unique([tenantId, slug])
  @@index([parentId])
  @@index([tenantId])
}

model ProductVariant {
  id             String           @id
  productId      String
  name           String
  sku            String?
  barcode        String?
  options        Json?
  price          Decimal?         @db.Decimal(12, 2)
  compareAtPrice Decimal?         @db.Decimal(12, 2)
  costPrice      Decimal?         @db.Decimal(12, 2)
  weight         Decimal?         @db.Decimal(10, 4)
  imageUrl       String?
  isActive       Boolean          @default(true)
  position       Int              @default(0)
  createdAt      DateTime         @default(now())
  updatedAt      DateTime
  InventoryLevel InventoryLevel[]
  Product        Product          @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([barcode])
  @@index([productId])
  @@index([sku])
}

model Session {
  id                String    @id
  userId            String
  token             String    @unique
  activeTenant      String?
  userAgent         String?
  ipAddress         String?
  expiresAt         DateTime
  createdAt         DateTime  @default(now())
  lastActiveAt      DateTime  @default(now())
  authMethod        String    @default("magic_link")
  deviceFingerprint String?
  deviceName        String?
  isRemembered      Boolean   @default(false)
  rememberedAt      DateTime?
  user              User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([deviceFingerprint])
  @@index([expiresAt])
  @@index([token])
  @@index([userId])
}

model SignupSession {
  id                String     @id
  sessionToken      String     @unique
  phone             String?
  email             String?
  currentStep       SignupStep @default(IDENTITY)
  stepsCompleted    String[]   @default([])
  userIntent        String?
  businessName      String?
  businessType      String?
  country           String     @default("NG")
  state             String?
  city              String?
  discoveryChoices  String[]   @default([])
  marketingIntent   String?
  marketingSource   String?
  referralCode      String?
  partnerId         String?
  userId            String?
  tenantId          String?
  completedAt       DateTime?
  expiresAt         DateTime
  lastActiveAt      DateTime   @default(now())
  ipAddress         String?
  userAgent         String?
  deviceFingerprint String?
  createdAt         DateTime   @default(now())
  updatedAt         DateTime

  @@index([currentStep])
  @@index([email])
  @@index([expiresAt])
  @@index([phone])
  @@index([sessionToken])
}

model StaffMember {
  id          String      @id
  tenantId    String
  userId      String?
  email       String
  firstName   String
  lastName    String
  phone       String?
  employeeId  String?
  department  String?
  jobTitle    String?
  hireDate    DateTime?
  locationId  String?
  status      StaffStatus @default(ACTIVE)
  permissions String[]    @default([])
  pinHash     String?
  createdAt   DateTime    @default(now())
  updatedAt   DateTime
  Location    Location?   @relation(fields: [locationId], references: [id])

  @@unique([tenantId, email])
  @@unique([tenantId, employeeId])
  @@index([locationId])
  @@index([status])
  @@index([tenantId])
}

model Subscription {
  id                 String              @id
  tenantId           String              @unique
  planId             String
  status             SubscriptionStatus  @default(PENDING)
  billingInterval    BillingInterval     @default(MONTHLY)
  currentPeriodStart DateTime
  currentPeriodEnd   DateTime
  amount             Decimal             @db.Decimal(12, 2)
  currency           String              @default("USD")
  trialStart         DateTime?
  trialEnd           DateTime?
  cancelledAt        DateTime?
  cancelReason       String?
  cancelAtPeriodEnd  Boolean             @default(false)
  externalId         String?
  paymentProvider    String?
  partnerReferralId  String?
  metadata           Json?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime
  gracePeriodDays    Int                 @default(7)
  gracePeriodEnd     DateTime?
  gracePeriodStart   DateTime?
  paymentFailedAt    DateTime?
  paymentRetryCount  Int                 @default(0)
  Entitlement        Entitlement[]
  Invoice            Invoice[]
  PartnerReferral    PartnerReferral?    @relation(fields: [partnerReferralId], references: [id])
  SubscriptionPlan   SubscriptionPlan    @relation(fields: [planId], references: [id])
  Tenant             Tenant              @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  SubscriptionEvent  SubscriptionEvent[]

  @@index([currentPeriodEnd])
  @@index([partnerReferralId])
  @@index([status])
  @@index([tenantId])
}

model SubscriptionEvent {
  id              String                @id
  subscriptionId  String
  eventType       SubscriptionEventType
  tenantId        String
  partnerId       String?
  modules         String[]
  billingAmount   Decimal?              @db.Decimal(12, 2)
  billingCurrency String?
  billingInterval BillingInterval?
  periodStart     DateTime?
  periodEnd       DateTime?
  metadata        Json?
  externalEventId String?
  occurredAt      DateTime              @default(now())
  Subscription    Subscription          @relation(fields: [subscriptionId], references: [id], onDelete: Cascade)

  @@index([eventType])
  @@index([occurredAt])
  @@index([partnerId])
  @@index([subscriptionId])
  @@index([tenantId])
}

model SubscriptionPlan {
  id                   String                 @id
  name                 String
  slug                 String                 @unique
  description          String?
  priceMonthly         Decimal                @db.Decimal(12, 2)
  priceYearly          Decimal                @db.Decimal(12, 2)
  currency             String                 @default("USD")
  includedModules      String[]
  maxUsers             Int?
  maxStorage           Int?
  features             Json?
  isActive             Boolean                @default(true)
  isPublic             Boolean                @default(true)
  sortOrder            Int                    @default(0)
  trialDays            Int                    @default(14)
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  gracePeriodDays      Int                    @default(7)
  InstanceSubscription InstanceSubscription[]
  Subscription         Subscription[]

  @@index([isActive, isPublic])
  @@index([slug])
}

model Supplier {
  id           String         @id
  tenantId     String
  name         String
  code         String?
  email        String?
  phone        String?
  website      String?
  contactName  String?
  contactEmail String?
  contactPhone String?
  addressLine1 String?
  addressLine2 String?
  city         String?
  state        String?
  postalCode   String?
  country      String?
  paymentTerms String?
  currency     String         @default("USD")
  status       SupplierStatus @default(ACTIVE)
  notes        String?
  createdAt    DateTime       @default(now())
  updatedAt    DateTime

  @@unique([tenantId, code])
  @@index([status])
  @@index([tenantId])
}

model TaxRate {
  id            String   @id
  taxRuleId     String
  taxCategoryId String?
  rate          Decimal? @db.Decimal(6, 4)
  isExempt      Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  TaxRule       TaxRule  @relation(fields: [taxRuleId], references: [id], onDelete: Cascade)

  @@index([taxCategoryId])
  @@index([taxRuleId])
}

model TaxRule {
  id                String    @id
  tenantId          String
  name              String
  code              String?
  country           String
  state             String?
  postalCode        String?
  city              String?
  rate              Decimal   @db.Decimal(6, 4)
  isCompound        Boolean   @default(false)
  priority          Int       @default(0)
  appliesToShipping Boolean   @default(false)
  isActive          Boolean   @default(true)
  validFrom         DateTime  @default(now())
  validUntil        DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime
  TaxRate           TaxRate[]

  @@unique([tenantId, code])
  @@index([country, state])
  @@index([isActive])
  @@index([tenantId])
}

model Tenant {
  id               String             @id
  name             String
  slug             String             @unique
  status           TenantStatus       @default(ACTIVE)
  appName          String             @default("SaaS App")
  logoUrl          String?
  faviconUrl       String?
  primaryColor     String             @default("#6366f1")
  secondaryColor   String             @default("#8b5cf6")
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  activatedAt      DateTime?
  activatedModules String[]           @default([])
  requestedModules String[]           @default([])
  BusinessProfile  BusinessProfile?
  Entitlement      Entitlement[]
  Invoice          Invoice[]
  MagicLink        MagicLink[]
  PartnerReferral  PartnerReferral?
  PlatformInstance PlatformInstance[]
  Subscription     Subscription?
  TenantDomain     TenantDomain[]
  memberships TenantMembership[]

  @@index([slug])
  @@index([status])
}

model TenantDomain {
  id                 String            @id
  tenantId           String
  domain             String            @unique
  type               DomainType
  status             DomainStatus      @default(PENDING)
  isPrimary          Boolean           @default(false)
  verificationToken  String?
  verifiedAt         DateTime?
  createdAt          DateTime          @default(now())
  updatedAt          DateTime
  platformInstanceId String?
  PlatformInstance   PlatformInstance? @relation(fields: [platformInstanceId], references: [id])
  Tenant             Tenant            @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([domain])
  @@index([platformInstanceId])
  @@index([tenantId])
  @@index([type, status])
}

model TenantMembership {
  id        String     @id
  userId    String
  tenantId  String
  role      TenantRole @default(TENANT_USER)
  isActive  Boolean    @default(true)
  createdAt DateTime   @default(now())
  updatedAt DateTime
  joinedAt  DateTime   @default(now())
  tenant    Tenant     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, tenantId])
  @@index([role])
  @@index([tenantId])
  @@index([userId])
}

model User {
  id               String             @id
  email            String?            @unique
  name             String?
  avatarUrl        String?
  globalRole       GlobalRole         @default(USER)
  isActive         Boolean            @default(true)
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  lastLoginAt      DateTime?
  emailVerifiedAt  DateTime?
  passwordHash     String?
  passwordSetAt    DateTime?
  phone            String?            @unique
  phoneVerifiedAt  DateTime?
  MagicLink        MagicLink[]
  OtpCode          OtpCode[]
  PartnerUser      PartnerUser?
  Session          Session[]
  memberships      TenantMembership[]
  user_intents     user_intents[]

  @@index([email])
  @@index([globalRole])
  @@index([phone])
}

model Wallet {
  id                String              @id
  tenantId          String
  customerId        String?
  type              WalletType
  code              String?
  balance           Decimal             @default(0) @db.Decimal(12, 2)
  currency          String              @default("USD")
  initialValue      Decimal?            @db.Decimal(12, 2)
  status            WalletStatus        @default(ACTIVE)
  expiresAt         DateTime?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  Customer          Customer?           @relation(fields: [customerId], references: [id])
  WalletTransaction WalletTransaction[]

  @@unique([tenantId, code])
  @@index([customerId])
  @@index([status])
  @@index([tenantId])
  @@index([type])
}

model WalletTransaction {
  id             String                @id
  walletId       String
  type           WalletTransactionType
  amount         Decimal               @db.Decimal(12, 2)
  balanceAfter   Decimal               @db.Decimal(12, 2)
  sourceModule   String?
  sourceType     String?
  sourceId       String?
  description    String?
  idempotencyKey String?               @unique
  createdAt      DateTime              @default(now())
  createdBy      String?
  Wallet         Wallet                @relation(fields: [walletId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([sourceModule, sourceId])
  @@index([walletId])
}

model access_scopes {
  id          String          @id
  key         String          @unique
  name        String
  resource    String
  permission  AccessScopeType
  description String?
  isHighRisk  Boolean         @default(false)
  moduleKey   String?
  isActive    Boolean         @default(true)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime

  @@index([permission])
  @@index([resource])
}

model acct_chart_of_accounts {
  id                           String                   @id
  tenantId                     String
  code                         String
  name                         String
  description                  String?
  accountType                  AcctAccountType
  accountSubType               AcctAccountSubType?
  parentId                     String?
  normalBalance                String                   @default("DEBIT")
  isSystemAccount              Boolean                  @default(false)
  isActive                     Boolean                  @default(true)
  isBankAccount                Boolean                  @default(false)
  isControlAccount             Boolean                  @default(false)
  taxCode                      String?
  isTaxAccount                 Boolean                  @default(false)
  sortOrder                    Int                      @default(0)
  metadata                     Json?
  createdAt                    DateTime                 @default(now())
  updatedAt                    DateTime
  createdBy                    String?
  acct_chart_of_accounts       acct_chart_of_accounts?  @relation("acct_chart_of_accountsToacct_chart_of_accounts", fields: [parentId], references: [id])
  other_acct_chart_of_accounts acct_chart_of_accounts[] @relation("acct_chart_of_accountsToacct_chart_of_accounts")
  acct_ledger_accounts         acct_ledger_accounts[]

  @@unique([tenantId, code])
  @@index([accountType])
  @@index([isActive])
  @@index([parentId])
  @@index([tenantId])
}

model acct_expense_records {
  id                     String                   @id
  tenantId               String
  expenseNumber          String
  expenseDate            DateTime
  ledgerAccountId        String
  categoryName           String?
  amount                 Decimal                  @db.Decimal(18, 4)
  currency               String                   @default("NGN")
  taxAmount              Decimal?                 @db.Decimal(18, 4)
  taxCode                String?
  isVatInclusive         Boolean                  @default(false)
  paymentMethod          AcctExpensePaymentMethod @default(CASH)
  paidFrom               String?
  vendorName             String?
  vendorId               String?
  vendorContact          String?
  vendorPhone            String?
  description            String
  memo                   String?
  receiptNumber          String?
  receiptDate            DateTime?
  attachmentUrls         String[]                 @default([])
  status                 AcctExpenseStatus        @default(DRAFT)
  submittedAt            DateTime?
  submittedBy            String?
  approvedAt             DateTime?
  approvedBy             String?
  rejectedAt             DateTime?
  rejectedBy             String?
  rejectionReason        String?
  journalEntryId         String?
  postedAt               DateTime?
  periodId               String?
  metadata               Json?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  createdBy              String?
  acct_financial_periods acct_financial_periods?  @relation(fields: [periodId], references: [id])

  @@unique([tenantId, expenseNumber])
  @@index([expenseDate])
  @@index([ledgerAccountId])
  @@index([periodId])
  @@index([status])
  @@index([tenantId])
  @@index([vendorId])
}

model acct_financial_periods {
  id                   String                 @id
  tenantId             String
  name                 String
  code                 String
  periodType           String                 @default("MONTHLY")
  startDate            DateTime
  endDate              DateTime
  status               AcctPeriodStatus       @default(OPEN)
  fiscalYear           Int
  closedAt             DateTime?
  closedBy             String?
  lockedAt             DateTime?
  lockedBy             String?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  acct_expense_records acct_expense_records[]
  acct_journal_entries acct_journal_entries[]
  acct_ledger_accounts acct_ledger_accounts[]
  acct_ledger_entries  acct_ledger_entries[]
  acct_tax_summaries   acct_tax_summaries[]

  @@unique([tenantId, code])
  @@index([fiscalYear])
  @@index([startDate, endDate])
  @@index([status])
  @@index([tenantId])
}

model acct_journal_entries {
  id                         String                 @id
  tenantId                   String
  journalNumber              String
  entryDate                  DateTime
  postDate                   DateTime?
  sourceType                 AcctJournalSourceType
  sourceId                   String?
  sourceModule               String?
  eventId                    String?
  idempotencyKey             String?                @unique
  description                String
  memo                       String?
  status                     AcctJournalStatus      @default(DRAFT)
  totalDebit                 Decimal                @db.Decimal(18, 4)
  totalCredit                Decimal                @db.Decimal(18, 4)
  currency                   String                 @default("NGN")
  taxAmount                  Decimal?               @db.Decimal(18, 4)
  taxCode                    String?
  periodId                   String
  isReversal                 Boolean                @default(false)
  reversedJournalId          String?                @unique
  attachmentUrls             String[]               @default([])
  metadata                   Json?
  createdAt                  DateTime               @default(now())
  updatedAt                  DateTime
  createdBy                  String?
  postedBy                   String?
  postedAt                   DateTime?
  acct_financial_periods     acct_financial_periods @relation(fields: [periodId], references: [id])
  acct_journal_entries       acct_journal_entries?  @relation("acct_journal_entriesToacct_journal_entries", fields: [reversedJournalId], references: [id])
  other_acct_journal_entries acct_journal_entries?  @relation("acct_journal_entriesToacct_journal_entries")
  acct_ledger_entries        acct_ledger_entries[]

  @@unique([tenantId, journalNumber])
  @@index([entryDate])
  @@index([eventId])
  @@index([periodId])
  @@index([sourceId])
  @@index([sourceType])
  @@index([status])
  @@index([tenantId])
}

model acct_ledger_accounts {
  id                     String                  @id
  tenantId               String
  chartOfAccountId       String
  currentBalance         Decimal                 @default(0) @db.Decimal(18, 4)
  currency               String                  @default("NGN")
  openingBalance         Decimal                 @default(0) @db.Decimal(18, 4)
  periodDebit            Decimal                 @default(0) @db.Decimal(18, 4)
  periodCredit           Decimal                 @default(0) @db.Decimal(18, 4)
  currentPeriodId        String?
  isActive               Boolean                 @default(true)
  lastReconciledAt       DateTime?
  lastReconciledBalance  Decimal?                @db.Decimal(18, 4)
  createdAt              DateTime                @default(now())
  updatedAt              DateTime
  acct_chart_of_accounts acct_chart_of_accounts  @relation(fields: [chartOfAccountId], references: [id])
  acct_financial_periods acct_financial_periods? @relation(fields: [currentPeriodId], references: [id])
  acct_ledger_entries    acct_ledger_entries[]

  @@unique([tenantId, chartOfAccountId, currency])
  @@index([chartOfAccountId])
  @@index([currentPeriodId])
  @@index([tenantId])
}

model acct_ledger_entries {
  id                     String                 @id
  tenantId               String
  ledgerAccountId        String
  journalEntryId         String
  entryDate              DateTime
  debitAmount            Decimal                @default(0) @db.Decimal(18, 4)
  creditAmount           Decimal                @default(0) @db.Decimal(18, 4)
  balanceAfter           Decimal                @db.Decimal(18, 4)
  currency               String                 @default("NGN")
  description            String?
  memo                   String?
  referenceType          String?
  referenceId            String?
  referenceNumber        String?
  periodId               String
  createdAt              DateTime               @default(now())
  createdBy              String?
  lineNumber             Int
  acct_journal_entries   acct_journal_entries   @relation(fields: [journalEntryId], references: [id])
  acct_ledger_accounts   acct_ledger_accounts   @relation(fields: [ledgerAccountId], references: [id])
  acct_financial_periods acct_financial_periods @relation(fields: [periodId], references: [id])

  @@index([entryDate])
  @@index([journalEntryId])
  @@index([ledgerAccountId])
  @@index([periodId])
  @@index([referenceType, referenceId])
  @@index([tenantId])
}

model acct_tax_summaries {
  id                     String                 @id
  tenantId               String
  periodId               String
  taxCode                String
  taxName                String
  taxRate                Decimal                @db.Decimal(6, 4)
  taxableAmount          Decimal                @db.Decimal(18, 4)
  taxCollected           Decimal                @db.Decimal(18, 4)
  taxPaid                Decimal                @db.Decimal(18, 4)
  netTaxLiability        Decimal                @db.Decimal(18, 4)
  currency               String                 @default("NGN")
  salesTaxAmount         Decimal                @default(0) @db.Decimal(18, 4)
  expenseTaxAmount       Decimal                @default(0) @db.Decimal(18, 4)
  adjustmentAmount       Decimal                @default(0) @db.Decimal(18, 4)
  reportGeneratedAt      DateTime?
  reportGeneratedBy      String?
  notes                  String?
  createdAt              DateTime               @default(now())
  updatedAt              DateTime
  acct_financial_periods acct_financial_periods @relation(fields: [periodId], references: [id])

  @@unique([tenantId, periodId, taxCode])
  @@index([periodId])
  @@index([taxCode])
  @@index([tenantId])
}

model ai_event_logs {
  id               String   @id
  tenantId         String?
  eventType        String
  eventData        Json
  insightId        String?
  recommendationId String?
  ruleId           String?
  runId            String?
  actorId          String?
  actorType        String?
  occurredAt       DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([tenantId])
}

model ai_insights {
  id              String    @id
  tenantId        String
  insightType     String
  title           String
  summary         String
  details         Json
  explanation     String
  dataSourcesUsed String[]
  confidence      Decimal   @db.Decimal(5, 2)
  severity        String    @default("INFO")
  relatedType     String?
  relatedId       String?
  status          String    @default("ACTIVE")
  acknowledgedAt  DateTime?
  acknowledgedBy  String?
  validFrom       DateTime  @default(now())
  validTo         DateTime?
  metadata        Json?
  createdAt       DateTime  @default(now())

  @@index([insightType])
  @@index([status])
  @@index([tenantId])
}

model ai_recommendations {
  id                 String    @id
  tenantId           String
  recommendationType String
  title              String
  summary            String
  details            Json
  explanation        String
  expectedOutcome    String
  dataSourcesUsed    String[]
  confidence         Decimal   @db.Decimal(5, 2)
  relatedType        String?
  relatedId          String?
  suggestedAction    Json
  status             String    @default("PENDING")
  acceptedAt         DateTime?
  acceptedBy         String?
  rejectedAt         DateTime?
  rejectedBy         String?
  rejectionReason    String?
  expiresAt          DateTime?
  metadata           Json?
  createdAt          DateTime  @default(now())

  @@index([recommendationType])
  @@index([status])
  @@index([tenantId])
}

model analytics_configurations {
  id                    String    @id
  tenantId              String    @unique
  analyticsEnabled      Boolean   @default(true)
  dashboardsEnabled     Boolean   @default(true)
  reportsEnabled        Boolean   @default(true)
  forecastingEnabled    Boolean   @default(false)
  exportEnabled         Boolean   @default(true)
  snapshotRetentionDays Int       @default(365)
  autoRefreshEnabled    Boolean   @default(true)
  refreshIntervalMins   Int       @default(60)
  lastRefreshedAt       DateTime?
  defaultCurrency       String    @default("NGN")
  timezone              String    @default("Africa/Lagos")
  fiscalYearStart       Int       @default(1)
  metadata              Json?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
}

model analytics_dashboard_widgets {
  id                   String               @id
  dashboardId          String
  title                String
  type                 String
  metricKeys           Json
  dimensions           Json?
  config               Json
  gridX                Int
  gridY                Int
  gridW                Int
  gridH                Int
  isActive             Boolean              @default(true)
  sortOrder            Int                  @default(0)
  analytics_dashboards analytics_dashboards @relation(fields: [dashboardId], references: [id], onDelete: Cascade)

  @@index([dashboardId])
}

model analytics_dashboards {
  id                          String                        @id
  tenantId                    String
  key                         String
  name                        String
  description                 String?
  layout                      Json
  isSystem                    Boolean                       @default(false)
  isDefault                   Boolean                       @default(false)
  isActive                    Boolean                       @default(true)
  visibility                  String                        @default("TENANT")
  metadata                    Json?
  createdBy                   String?
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  analytics_dashboard_widgets analytics_dashboard_widgets[]

  @@unique([tenantId, key])
  @@index([tenantId])
}

model analytics_event_logs {
  id             String   @id
  tenantId       String
  sourceModule   String
  eventType      String
  eventId        String
  eventData      Json
  processedAt    DateTime @default(now())
  metricsUpdated Json?

  @@unique([tenantId, sourceModule, eventId])
  @@index([eventType])
  @@index([processedAt])
  @@index([tenantId])
}

model analytics_insights {
  id              String    @id
  tenantId        String
  type            String
  title           String
  description     String
  severity        String
  category        String
  data            Json
  suggestedAction String?
  actionUrl       String?
  status          String    @default("NEW")
  acknowledgedBy  String?
  acknowledgedAt  DateTime?
  resolvedAt      DateTime?
  validUntil      DateTime?
  metadata        Json?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime

  @@index([severity])
  @@index([status])
  @@index([tenantId])
  @@index([type])
}

model analytics_metric_definitions {
  id                         String                       @id
  tenantId                   String
  key                        String
  name                       String
  description                String?
  category                   String
  aggregationType            String
  sourceEvent                String
  sourceField                String?
  formula                    String?
  format                     String                       @default("number")
  unit                       String?
  precision                  Int                          @default(2)
  isSystem                   Boolean                      @default(false)
  isActive                   Boolean                      @default(true)
  metadata                   Json?
  createdAt                  DateTime                     @default(now())
  updatedAt                  DateTime
  analytics_metric_snapshots analytics_metric_snapshots[]

  @@unique([tenantId, key])
  @@index([category])
  @@index([tenantId])
}

model analytics_metric_snapshots {
  id                           String                       @id
  tenantId                     String
  metricId                     String
  periodType                   String
  periodStart                  DateTime
  periodEnd                    DateTime
  value                        Decimal                      @db.Decimal(20, 4)
  count                        Int                          @default(1)
  dimensionKey                 String?
  dimensionValue               String?
  previousValue                Decimal?                     @db.Decimal(20, 4)
  changePercent                Decimal?                     @db.Decimal(10, 4)
  computedAt                   DateTime                     @default(now())
  analytics_metric_definitions analytics_metric_definitions @relation(fields: [metricId], references: [id], onDelete: Cascade)

  @@unique([metricId, periodType, periodStart, dimensionKey, dimensionValue])
  @@index([metricId])
  @@index([periodType, periodStart])
  @@index([tenantId])
}

model analytics_report_definitions {
  id              String    @id
  tenantId        String
  key             String
  name            String
  description     String?
  category        String
  metricKeys      Json
  dimensions      Json?
  filters         Json?
  format          String    @default("PDF")
  isScheduled     Boolean   @default(false)
  schedule        String?
  recipients      Json?
  isSystem        Boolean   @default(false)
  isActive        Boolean   @default(true)
  metadata        Json?
  lastGeneratedAt DateTime?
  createdBy       String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime

  @@unique([tenantId, key])
  @@index([tenantId])
}

model api_keys {
  id             String         @id
  appId          String
  tenantId       String?
  name           String
  keyPrefix      String
  keyHash        String
  scopes         String[]
  status         ApiKeyStatus   @default(ACTIVE)
  expiresAt      DateTime?
  rateLimit      Int?
  lastUsedAt     DateTime?
  usageCount     Int            @default(0)
  allowedIps     String[]
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  revokedAt      DateTime?
  revokedBy      String?
  revokedReason  String?
  developer_apps developer_apps @relation(fields: [appId], references: [id], onDelete: Cascade)

  @@index([appId])
  @@index([keyPrefix])
  @@index([status])
  @@index([tenantId])
}

model audit_artifacts {
  id           String    @id
  tenantId     String
  artifactType String
  artifactName String
  periodStart  DateTime?
  periodEnd    DateTime?
  artifactData Json
  sourceType   String?
  sourceId     String?
  status       String    @default("ACTIVE")
  metadata     Json?
  createdAt    DateTime  @default(now())

  @@index([artifactType])
  @@index([sourceType, sourceId])
  @@index([tenantId])
}

model automation_rules {
  id                String            @id
  tenantId          String
  name              String
  description       String?
  triggerType       String
  triggerConfig     Json
  actionType        String
  actionConfig      Json
  requiresApproval  Boolean           @default(false)
  approvalConfig    Json?
  isActive          Boolean           @default(true)
  lastTriggeredAt   DateTime?
  triggerCount      Int               @default(0)
  maxTriggersPerDay Int?
  cooldownMinutes   Int?
  metadata          Json?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  automation_runs   automation_runs[]

  @@index([isActive])
  @@index([tenantId])
}

model automation_runs {
  id               String           @id
  tenantId         String
  ruleId           String
  triggeredAt      DateTime         @default(now())
  triggerData      Json
  actionTaken      String
  actionData       Json
  status           String           @default("COMPLETED")
  resultMessage    String?
  approvedAt       DateTime?
  approvedBy       String?
  rejectedAt       DateTime?
  rejectedBy       String?
  metadata         Json?
  createdAt        DateTime         @default(now())
  automation_rules automation_rules @relation(fields: [ruleId], references: [id])

  @@index([ruleId])
  @@index([status])
  @@index([tenantId])
}

model b2b_bulk_order_drafts {
  id                    String                @id
  tenantId              String
  profileId             String
  name                  String?
  description           String?
  items                 Json
  itemCount             Int                   @default(0)
  subtotal              Decimal               @default(0) @db.Decimal(12, 2)
  discountTotal         Decimal               @default(0) @db.Decimal(12, 2)
  estimatedTotal        Decimal               @default(0) @db.Decimal(12, 2)
  status                B2BBulkOrderStatus    @default(DRAFT)
  pricingSnapshot       Json?
  convertedOrderId      String?
  convertedAt           DateTime?
  offlineId             String?
  createdBy             String?
  submittedBy           String?
  submittedAt           DateTime?
  metadata              Json?
  createdAt             DateTime              @default(now())
  updatedAt             DateTime
  b2b_customer_profiles b2b_customer_profiles @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@unique([tenantId, offlineId])
  @@index([createdAt])
  @@index([profileId])
  @@index([status])
  @@index([tenantId])
}

model b2b_configurations {
  id                       String   @id
  tenantId                 String   @unique
  b2bEnabled               Boolean  @default(true)
  wholesalePricing         Boolean  @default(true)
  creditSalesEnabled       Boolean  @default(false)
  bulkOrderingEnabled      Boolean  @default(true)
  defaultCreditDays        Int      @default(30)
  defaultCreditLimit       Decimal  @default(0) @db.Decimal(12, 2)
  defaultMinOrderValue     Decimal  @default(0) @db.Decimal(12, 2)
  defaultCurrency          String   @default("NGN")
  wholesaleTaxExempt       Boolean  @default(false)
  vatRate                  Decimal  @default(7.5) @db.Decimal(5, 2)
  creditApprovalRequired   Boolean  @default(true)
  autoApproveBelow         Decimal  @default(0) @db.Decimal(12, 2)
  negotiatedPricingEnabled Boolean  @default(true)
  manualOverrideEnabled    Boolean  @default(true)
  metadata                 Json?
  createdAt                DateTime @default(now())
  updatedAt                DateTime
}

model b2b_credit_ledger {
  id                    String                   @id
  tenantId              String
  profileId             String
  transactionType       B2BCreditTransactionType
  amount                Decimal                  @db.Decimal(12, 2)
  balanceBefore         Decimal                  @db.Decimal(12, 2)
  balanceAfter          Decimal                  @db.Decimal(12, 2)
  referenceType         String?
  referenceId           String?
  invoiceId             String?
  description           String?
  dueDate               DateTime?
  performedBy           String?
  performedAt           DateTime                 @default(now())
  notes                 String?
  metadata              Json?
  createdAt             DateTime                 @default(now())
  b2b_invoices          b2b_invoices?            @relation(fields: [invoiceId], references: [id])
  b2b_customer_profiles b2b_customer_profiles    @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([invoiceId])
  @@index([profileId])
  @@index([tenantId])
  @@index([transactionType])
}

model b2b_credit_terms {
  id                    String                  @id
  tenantId              String
  name                  String
  code                  String
  description           String?
  creditDays            Int                     @default(30)
  creditLimit           Decimal                 @default(0) @db.Decimal(12, 2)
  gracePeriod           Int                     @default(0)
  lateFeeType           B2BLateFeeType          @default(NONE)
  lateFeeValue          Decimal                 @default(0) @db.Decimal(5, 2)
  depositRequired       Boolean                 @default(false)
  depositPercent        Decimal                 @default(0) @db.Decimal(5, 2)
  isActive              Boolean                 @default(true)
  metadata              Json?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime
  b2b_customer_profiles b2b_customer_profiles[]

  @@unique([tenantId, code])
  @@index([tenantId])
}

model b2b_customer_profiles {
  id                      String                  @id
  tenantId                String
  customerId              String                  @unique
  isB2B                   Boolean                 @default(true)
  customerType            B2BCustomerType         @default(RETAILER)
  businessName            String?
  businessRegNo           String?
  taxId                   String?
  primaryContact          String?
  primaryPhone            String?
  primaryEmail            String?
  businessAddress         Json?
  priceTierId             String?
  creditTermId            String?
  creditLimit             Decimal                 @default(0) @db.Decimal(12, 2)
  creditUsed              Decimal                 @default(0) @db.Decimal(12, 2)
  creditStatus            B2BCreditStatus         @default(ACTIVE)
  preferredPaymentMethod  String?
  preferredShippingMethod String?
  allowCashPurchase       Boolean                 @default(true)
  allowCreditPurchase     Boolean                 @default(false)
  status                  B2BProfileStatus        @default(ACTIVE)
  verifiedAt              DateTime?
  verifiedBy              String?
  notes                   String?
  metadata                Json?
  createdAt               DateTime                @default(now())
  updatedAt               DateTime
  b2b_bulk_order_drafts   b2b_bulk_order_drafts[]
  b2b_credit_ledger       b2b_credit_ledger[]
  b2b_credit_terms        b2b_credit_terms?       @relation(fields: [creditTermId], references: [id])
  b2b_price_tiers         b2b_price_tiers?        @relation(fields: [priceTierId], references: [id])
  b2b_invoices            b2b_invoices[]

  @@unique([tenantId, customerId])
  @@index([customerId])
  @@index([priceTierId])
  @@index([status])
  @@index([tenantId])
}

model b2b_event_logs {
  id         String   @id
  tenantId   String
  eventType  String
  eventData  Json
  profileId  String?
  invoiceId  String?
  orderId    String?
  actorId    String?
  actorType  String?
  occurredAt DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([profileId])
  @@index([tenantId])
}

model b2b_invoices {
  id                    String                @id
  tenantId              String
  invoiceNumber         String
  profileId             String
  orderId               String?
  orderNumber           String?
  subtotal              Decimal               @db.Decimal(12, 2)
  discountTotal         Decimal               @default(0) @db.Decimal(12, 2)
  taxTotal              Decimal               @default(0) @db.Decimal(12, 2)
  totalAmount           Decimal               @db.Decimal(12, 2)
  amountPaid            Decimal               @default(0) @db.Decimal(12, 2)
  amountDue             Decimal               @db.Decimal(12, 2)
  invoiceDate           DateTime              @default(now())
  dueDate               DateTime
  paidDate              DateTime?
  status                B2BInvoiceStatus      @default(DRAFT)
  creditTermId          String?
  paymentTerms          String?
  lineItems             Json?
  notes                 String?
  internalNotes         String?
  createdBy             String?
  approvedBy            String?
  approvedAt            DateTime?
  metadata              Json?
  createdAt             DateTime              @default(now())
  updatedAt             DateTime
  b2b_credit_ledger     b2b_credit_ledger[]
  b2b_customer_profiles b2b_customer_profiles @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@unique([tenantId, invoiceNumber])
  @@index([dueDate])
  @@index([orderId])
  @@index([profileId])
  @@index([status])
  @@index([tenantId])
}

model b2b_price_tiers {
  id                        String                      @id
  tenantId                  String
  name                      String
  code                      String
  description               String?
  defaultDiscount           Decimal                     @default(0) @db.Decimal(5, 2)
  discountType              B2BDiscountType             @default(PERCENTAGE)
  minOrderValue             Decimal                     @default(0) @db.Decimal(12, 2)
  minOrderQuantity          Int                         @default(1)
  priority                  Int                         @default(0)
  isActive                  Boolean                     @default(true)
  metadata                  Json?
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  b2b_customer_profiles     b2b_customer_profiles[]
  b2b_wholesale_price_rules b2b_wholesale_price_rules[]

  @@unique([tenantId, code])
  @@index([tenantId])
}

model b2b_wholesale_price_rules {
  id              String           @id
  tenantId        String
  productId       String?
  categoryId      String?
  priceTierId     String?
  name            String
  description     String?
  priceType       B2BPriceType     @default(DISCOUNT_PERCENTAGE)
  value           Decimal          @db.Decimal(12, 2)
  quantityBreaks  Json?
  validFrom       DateTime?
  validTo         DateTime?
  priority        Int              @default(0)
  isActive        Boolean          @default(true)
  createdBy       String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime
  b2b_price_tiers b2b_price_tiers? @relation(fields: [priceTierId], references: [id])

  @@index([categoryId])
  @@index([isActive])
  @@index([priceTierId])
  @@index([productId])
  @@index([tenantId])
}

model billing_addon_subscriptions {
  id              String         @id
  tenantId        String
  subscriptionId  String
  addOnId         String
  quantity        Int            @default(1)
  priceAtPurchase Decimal        @db.Decimal(12, 2)
  currency        String         @default("NGN")
  status          AddOnStatus    @default(ACTIVE)
  startDate       DateTime       @default(now())
  endDate         DateTime?
  cancelledAt     DateTime?
  metadata        Json?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime
  billing_addons  billing_addons @relation(fields: [addOnId], references: [id])

  @@index([status])
  @@index([subscriptionId])
  @@index([tenantId])
}

model billing_addons {
  id                          String                        @id
  tenantId                    String?
  name                        String
  slug                        String
  description                 String?
  addOnType                   AddOnType                     @default(FEATURE)
  price                       Decimal                       @db.Decimal(12, 2)
  currency                    String                        @default("NGN")
  billingInterval             String                        @default("MONTHLY")
  isQuantityBased             Boolean                       @default(false)
  unitName                    String?
  minQuantity                 Int                           @default(1)
  maxQuantity                 Int?
  moduleKey                   String?
  featureKey                  String?
  featureValue                Json?
  isActive                    Boolean                       @default(true)
  metadata                    Json?
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  billing_addon_subscriptions billing_addon_subscriptions[]

  @@unique([tenantId, slug])
  @@index([isActive])
}

model billing_adjustments {
  id             String           @id
  tenantId       String
  subscriptionId String?
  type           AdjustmentType
  reason         String
  description    String?
  amount         Decimal          @db.Decimal(12, 2)
  currency       String           @default("NGN")
  appliedAt      DateTime?
  expiresAt      DateTime?
  status         AdjustmentStatus @default(PENDING)
  createdBy      String?
  approvedBy     String?
  approvedAt     DateTime?
  metadata       Json?
  createdAt      DateTime         @default(now())

  @@index([status])
  @@index([subscriptionId])
  @@index([tenantId])
}

model billing_bundle_items {
  id              String          @id
  bundleId        String
  moduleKey       String
  moduleName      String?
  featureLimits   Json?
  displayOrder    Int             @default(0)
  isHighlighted   Boolean         @default(false)
  createdAt       DateTime        @default(now())
  billing_bundles billing_bundles @relation(fields: [bundleId], references: [id], onDelete: Cascade)

  @@unique([bundleId, moduleKey])
}

model billing_bundles {
  id                   String                 @id
  tenantId             String?
  name                 String
  slug                 String
  description          String?
  price                Decimal                @db.Decimal(12, 2)
  currency             String                 @default("NGN")
  billingInterval      String                 @default("MONTHLY")
  savingsPercent       Decimal?               @db.Decimal(5, 2)
  isActive             Boolean                @default(true)
  isPromoted           Boolean                @default(false)
  displayOrder         Int                    @default(0)
  badgeText            String?
  metadata             Json?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  billing_bundle_items billing_bundle_items[]

  @@unique([tenantId, slug])
  @@index([isActive])
}

model billing_configurations {
  id                      String   @id
  tenantId                String   @unique
  bundlesEnabled          Boolean  @default(false)
  addOnsEnabled           Boolean  @default(false)
  usageBillingEnabled     Boolean  @default(false)
  gracePeriodsEnabled     Boolean  @default(true)
  defaultGraceDays        Int      @default(7)
  graceSuspendFeatures    Boolean  @default(true)
  usageAlertThreshold     Int      @default(80)
  manualRenewalsAllowed   Boolean  @default(true)
  informalUpgradesAllowed Boolean  @default(true)
  metadata                Json?
  createdAt               DateTime @default(now())
  updatedAt               DateTime
}

model billing_discount_rules {
  id               String       @id
  tenantId         String?
  name             String
  code             String?      @unique
  description      String?
  discountType     DiscountType @default(PERCENTAGE)
  value            Decimal      @db.Decimal(12, 2)
  planIds          String[]     @default([])
  moduleIds        String[]     @default([])
  partnerId        String?
  maxUses          Int?
  maxUsesPerTenant Int?
  currentUses      Int          @default(0)
  validFrom        DateTime?
  validTo          DateTime?
  minOrderValue    Decimal?     @db.Decimal(12, 2)
  firstTimeOnly    Boolean      @default(false)
  isActive         Boolean      @default(true)
  metadata         Json?
  createdAt        DateTime     @default(now())
  updatedAt        DateTime

  @@index([isActive])
  @@index([partnerId])
}

model billing_event_logs {
  id             String   @id
  tenantId       String?
  eventType      String
  eventData      Json
  subscriptionId String?
  bundleId       String?
  addOnId        String?
  adjustmentId   String?
  actorId        String?
  actorType      String?
  occurredAt     DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([subscriptionId])
  @@index([tenantId])
}

model billing_grace_policies {
  id                    String   @id
  tenantId              String?
  name                  String
  description           String?
  graceDays             Int      @default(7)
  limitFeatures         Boolean  @default(true)
  sendReminders         Boolean  @default(true)
  reminderDays          Int[]    @default([1, 3, 7])
  suspendAfterGrace     Boolean  @default(true)
  dataRetentionDays     Int      @default(90)
  manualOverrideAllowed Boolean  @default(true)
  isActive              Boolean  @default(true)
  isDefault             Boolean  @default(false)
  metadata              Json?
  createdAt             DateTime @default(now())
  updatedAt             DateTime
}

model billing_usage_metrics {
  id                    String                  @id
  tenantId              String?
  key                   String
  name                  String
  description           String?
  unit                  String
  aggregationType       UsageAggregationType    @default(SUM)
  includedUnits         Int?
  overageRate           Decimal?                @db.Decimal(12, 4)
  billingPeriod         String                  @default("MONTHLY")
  isActive              Boolean                 @default(true)
  metadata              Json?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime
  billing_usage_records billing_usage_records[]

  @@unique([tenantId, key])
}

model billing_usage_records {
  id                    String                @id
  tenantId              String
  metricId              String
  periodStart           DateTime
  periodEnd             DateTime
  quantity              Decimal               @db.Decimal(16, 4)
  sourceType            String?
  sourceId              String?
  metadata              Json?
  createdAt             DateTime              @default(now())
  billing_usage_metrics billing_usage_metrics @relation(fields: [metricId], references: [id])

  @@index([metricId])
  @@index([periodStart, periodEnd])
  @@index([tenantId])
}

model commerce_payouts {
  id             String             @id
  tenantId       String
  walletId       String
  walletType     CommerceWalletType
  amount         Decimal            @db.Decimal(12, 2)
  currency       String             @default("USD")
  processingFee  Decimal            @default(0) @db.Decimal(12, 2)
  netAmount      Decimal            @db.Decimal(12, 2)
  status         PayoutStatus       @default(PENDING)
  paymentMethod  String?
  paymentDetails Json?
  externalRef    String?
  processedAt    DateTime?
  completedAt    DateTime?
  failedAt       DateTime?
  failureReason  String?
  failureCode    String?
  triggeredBy    String?
  ledgerEntryId  String?
  createdAt      DateTime           @default(now())
  updatedAt      DateTime

  @@index([createdAt])
  @@index([status])
  @@index([tenantId])
  @@index([walletId])
}

model commerce_wallet_ledger {
  id                    String            @id
  walletId              String
  entryType             LedgerEntryType
  status                LedgerEntryStatus @default(COMPLETED)
  amount                Decimal           @db.Decimal(12, 2)
  currency              String            @default("USD")
  balanceAfter          Decimal           @db.Decimal(12, 2)
  pendingBalanceAfter   Decimal           @default(0) @db.Decimal(12, 2)
  availableBalanceAfter Decimal           @db.Decimal(12, 2)
  referenceType         String?
  referenceId           String?
  counterpartyWalletId  String?
  holdId                String?
  idempotencyKey        String            @unique
  description           String?
  metadata              Json?
  createdAt             DateTime          @default(now())
  createdBy             String?
  commerce_wallets      commerce_wallets  @relation(fields: [walletId], references: [id])

  @@index([createdAt])
  @@index([entryType])
  @@index([holdId])
  @@index([referenceType, referenceId])
  @@index([status])
  @@index([walletId])
}

model commerce_wallets {
  id                     String                   @id
  tenantId               String
  type                   CommerceWalletType
  customerId             String?
  vendorId               String?
  balance                Decimal                  @default(0) @db.Decimal(12, 2)
  pendingBalance         Decimal                  @default(0) @db.Decimal(12, 2)
  availableBalance       Decimal                  @default(0) @db.Decimal(12, 2)
  currency               String                   @default("USD")
  status                 CommerceWalletStatus     @default(ACTIVE)
  metadata               Json?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  commerce_wallet_ledger commerce_wallet_ledger[]

  @@unique([tenantId, type, customerId, vendorId])
  @@index([customerId])
  @@index([status])
  @@index([tenantId])
  @@index([type])
  @@index([vendorId])
}

model compliance_event_logs {
  id         String   @id
  tenantId   String?
  eventType  String
  eventData  Json
  profileId  String?
  reportId   String?
  artifactId String?
  actorId    String?
  actorType  String?
  occurredAt DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([tenantId])
}

model compliance_profiles {
  id                    String                  @id
  tenantId              String                  @unique
  businessRegistered    Boolean                 @default(false)
  vatRegistered         Boolean                 @default(false)
  tinRegistered         Boolean                 @default(false)
  cacNumber             String?
  tinNumber             String?
  vatNumber             String?
  industryCode          String?
  businessCategory      String?
  maturityLevel         ComplianceMaturityLevel @default(INFORMAL)
  taxTrackingEnabled    Boolean                 @default(false)
  auditTrailEnabled     Boolean                 @default(true)
  reportingEnabled      Boolean                 @default(false)
  progressiveActivation Boolean                 @default(true)
  metadata              Json?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime
  tax_configurations    tax_configurations?
}

model compliance_statuses {
  id              String    @id
  tenantId        String
  statusType      String
  severity        String    @default("INFO")
  title           String
  description     String
  suggestedAction String?
  isResolved      Boolean   @default(false)
  resolvedAt      DateTime?
  isDismissable   Boolean   @default(true)
  dismissedAt     DateTime?
  metadata        Json?
  createdAt       DateTime  @default(now())

  @@index([isResolved])
  @@index([statusType])
  @@index([tenantId])
}

model core_capabilities {
  id                                 String                               @id
  key                                String                               @unique
  displayName                        String
  domain                             String
  description                        String?
  dependencies                       String[]                             @default([])
  isCore                             Boolean                              @default(false)
  isAvailable                        Boolean                              @default(true)
  sortOrder                          Int                                  @default(0)
  icon                               String?
  metadata                           Json?
  createdAt                          DateTime                             @default(now())
  updatedAt                          DateTime
  core_tenant_capability_activations core_tenant_capability_activations[]

  @@index([domain])
  @@index([isAvailable])
  @@index([isCore])
}

model core_capability_event_logs {
  id             String              @id
  eventType      String
  tenantId       String
  capabilityKey  String
  triggeredBy    CapabilityActivator
  userId         String?
  previousStatus String?
  newStatus      String?
  reason         String?
  metadata       Json?
  timestamp      DateTime            @default(now())

  @@index([capabilityKey])
  @@index([eventType])
  @@index([tenantId])
  @@index([timestamp])
}

model core_tenant_capability_activations {
  id                String               @id
  tenantId          String
  capabilityKey     String
  status            CapabilityStatus     @default(INACTIVE)
  activatedAt       DateTime?
  deactivatedAt     DateTime?
  suspendedAt       DateTime?
  activatedBy       CapabilityActivator?
  activatedByUserId String?
  suspensionReason  String?
  configuration     Json?
  auditLog          Json?
  createdAt         DateTime             @default(now())
  updatedAt         DateTime
  core_capabilities core_capabilities    @relation(fields: [capabilityKey], references: [key], onDelete: Cascade)

  @@unique([tenantId, capabilityKey])
  @@index([capabilityKey])
  @@index([status])
  @@index([tenantId])
}

model crm_campaign_audiences {
  id                    String                 @id
  tenantId              String
  campaignId            String
  audienceType          String
  segmentId             String?
  customerIds           String[]               @default([])
  excludeSegmentIds     String[]               @default([])
  excludeCustomerIds    String[]               @default([])
  estimatedReach        Int?
  createdAt             DateTime               @default(now())
  crm_campaigns         crm_campaigns          @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  crm_customer_segments crm_customer_segments? @relation(fields: [segmentId], references: [id])

  @@index([campaignId])
  @@index([segmentId])
}

model crm_campaigns {
  id                     String                   @id
  tenantId               String
  name                   String
  slug                   String
  description            String?
  campaignType           CrmCampaignType
  status                 CrmCampaignStatus        @default(DRAFT)
  channels               CrmCampaignChannel[]
  content                Json?
  scheduledAt            DateTime?
  startsAt               DateTime?
  endsAt                 DateTime?
  triggerConfig          Json?
  offerType              String?
  offerValue             Decimal?                 @db.Decimal(10, 2)
  offerCode              String?
  budgetLimit            Decimal?                 @db.Decimal(12, 2)
  budgetUsed             Decimal                  @default(0) @db.Decimal(12, 2)
  maxRecipients          Int?
  currentRecipients      Int                      @default(0)
  sentCount              Int                      @default(0)
  deliveredCount         Int                      @default(0)
  openedCount            Int                      @default(0)
  clickedCount           Int                      @default(0)
  convertedCount         Int                      @default(0)
  tags                   String[]                 @default([])
  metadata               Json?
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  createdBy              String?
  publishedAt            DateTime?
  publishedBy            String?
  crm_campaign_audiences crm_campaign_audiences[]

  @@unique([tenantId, slug])
  @@index([campaignType])
  @@index([scheduledAt])
  @@index([status])
  @@index([tenantId])
}

model crm_configurations {
  id                     String   @id
  tenantId               String   @unique
  autoUpdateSegments     Boolean  @default(true)
  segmentUpdateFrequency String   @default("HOURLY")
  loyaltyEnabled         Boolean  @default(false)
  loyaltyProgramId       String?
  campaignsEnabled       Boolean  @default(false)
  defaultSmsTemplate     String?
  defaultEmailTemplate   String?
  smsEnabled             Boolean  @default(true)
  emailEnabled           Boolean  @default(true)
  pushEnabled            Boolean  @default(false)
  whatsappEnabled        Boolean  @default(false)
  phoneNumberFormat      String   @default("NG")
  defaultCurrency        String   @default("NGN")
  metadata               Json?
  createdAt              DateTime @default(now())
  updatedAt              DateTime
}

model crm_customer_segments {
  id                      String                    @id
  tenantId                String
  name                    String
  slug                    String
  description             String?
  segmentType             CrmSegmentType            @default(DYNAMIC)
  status                  CrmSegmentStatus          @default(ACTIVE)
  rules                   Json?
  memberCount             Int                       @default(0)
  lastComputedAt          DateTime?
  computeError            String?
  priority                Int                       @default(0)
  tags                    String[]                  @default([])
  metadata                Json?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  createdBy               String?
  crm_campaign_audiences  crm_campaign_audiences[]
  crm_loyalty_rules       crm_loyalty_rules[]
  crm_segment_memberships crm_segment_memberships[]

  @@unique([tenantId, slug])
  @@index([segmentType])
  @@index([status])
  @@index([tenantId])
}

model crm_engagement_events {
  id            String            @id
  tenantId      String
  customerId    String
  eventType     CrmEngagementType
  channel       String?
  description   String?
  sourceType    String?
  sourceId      String?
  monetaryValue Decimal?          @db.Decimal(12, 2)
  pointsValue   Int?
  campaignId    String?
  sessionId     String?
  deviceId      String?
  ipAddress     String?
  userAgent     String?
  metadata      Json?
  occurredAt    DateTime          @default(now())

  @@index([campaignId])
  @@index([customerId])
  @@index([eventType])
  @@index([occurredAt])
  @@index([tenantId])
}

model crm_loyalty_programs {
  id                       String                     @id
  tenantId                 String                     @unique
  name                     String
  description              String?
  isActive                 Boolean                    @default(true)
  startsAt                 DateTime?
  endsAt                   DateTime?
  pointsName               String                     @default("Points")
  pointsSymbol             String                     @default("pts")
  pointsPerCurrency        Decimal                    @default(1) @db.Decimal(10, 4)
  currencyPerPoint         Decimal?                   @db.Decimal(10, 4)
  pointsExpireMonths       Int?
  tierConfig               Json?
  metadata                 Json?
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime
  createdBy                String?
  crm_loyalty_rules        crm_loyalty_rules[]
  crm_loyalty_transactions crm_loyalty_transactions[]
}

model crm_loyalty_rules {
  id                    String                 @id
  tenantId              String
  programId             String
  name                  String
  description           String?
  ruleType              String
  conditions            Json?
  pointsValue           Int?
  pointsMultiplier      Decimal?               @db.Decimal(5, 2)
  percentValue          Decimal?               @db.Decimal(5, 2)
  segmentId             String?
  isActive              Boolean                @default(true)
  startsAt              DateTime?
  endsAt                DateTime?
  maxUsesPerCustomer    Int?
  maxTotalUses          Int?
  currentUses           Int                    @default(0)
  priority              Int                    @default(0)
  createdAt             DateTime               @default(now())
  updatedAt             DateTime
  crm_loyalty_programs  crm_loyalty_programs   @relation(fields: [programId], references: [id], onDelete: Cascade)
  crm_customer_segments crm_customer_segments? @relation(fields: [segmentId], references: [id])

  @@index([programId])
  @@index([ruleType])
  @@index([tenantId])
}

model crm_loyalty_transactions {
  id                   String                    @id
  tenantId             String
  programId            String
  customerId           String
  transactionType      CrmLoyaltyTransactionType
  points               Int
  balanceAfter         Int
  sourceType           String?
  sourceId             String?
  ruleId               String?
  description          String?
  memo                 String?
  expiresAt            DateTime?
  isExpired            Boolean                   @default(false)
  metadata             Json?
  createdAt            DateTime                  @default(now())
  createdBy            String?
  crm_loyalty_programs crm_loyalty_programs      @relation(fields: [programId], references: [id])

  @@index([customerId])
  @@index([expiresAt])
  @@index([programId])
  @@index([sourceType, sourceId])
  @@index([tenantId])
  @@index([transactionType])
}

model crm_segment_memberships {
  id                    String                @id
  tenantId              String
  segmentId             String
  customerId            String
  addedAt               DateTime              @default(now())
  addedBy               String?
  isManual              Boolean               @default(false)
  score                 Float?
  metadata              Json?
  crm_customer_segments crm_customer_segments @relation(fields: [segmentId], references: [id], onDelete: Cascade)

  @@unique([segmentId, customerId])
  @@index([customerId])
  @@index([tenantId])
}

model developer_apps {
  id             String     @id
  tenantId       String?
  name           String
  description    String?
  logoUrl        String?
  websiteUrl     String?
  developerName  String
  developerEmail String
  clientId       String     @unique
  clientSecret   String
  redirectUris   String[]
  allowedScopes  String[]
  isVerified     Boolean    @default(false)
  isActive       Boolean    @default(true)
  rateLimit      Int        @default(100)
  totalRequests  Int        @default(0)
  lastRequestAt  DateTime?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime
  verifiedAt     DateTime?
  verifiedBy     String?
  api_keys       api_keys[]

  @@index([clientId])
  @@index([isVerified])
  @@index([tenantId])
}

model hr_attendance_records {
  id                   String               @id
  tenantId             String
  employeeProfileId    String
  date                 DateTime             @db.Date
  clockIn              DateTime?
  clockOut             DateTime?
  breakStart           DateTime?
  breakEnd             DateTime?
  status               HrAttendanceStatus   @default(PRESENT)
  scheduledMinutes     Int?
  workedMinutes        Int?
  breakMinutes         Int?
  overtimeMinutes      Int?
  lateMinutes          Int?
  earlyLeaveMinutes    Int?
  clockInMethod        HrClockMethod?
  clockOutMethod       HrClockMethod?
  clockInLocationId    String?
  clockOutLocationId   String?
  clockInLatitude      Decimal?             @db.Decimal(10, 8)
  clockInLongitude     Decimal?             @db.Decimal(11, 8)
  clockOutLatitude     Decimal?             @db.Decimal(10, 8)
  clockOutLongitude    Decimal?             @db.Decimal(11, 8)
  leaveRequestId       String?
  requiresApproval     Boolean              @default(false)
  approvedBy           String?
  approvedAt           DateTime?
  rejectedBy           String?
  rejectedAt           DateTime?
  rejectionReason      String?
  offlineId            String?
  recordedAt           DateTime             @default(now())
  syncedAt             DateTime?
  notes                String?
  adminNotes           String?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  createdBy            String?
  updatedBy            String?
  hr_employee_profiles hr_employee_profiles @relation(fields: [employeeProfileId], references: [id], onDelete: Cascade)

  @@unique([employeeProfileId, date])
  @@index([date])
  @@index([employeeProfileId])
  @@index([offlineId])
  @@index([status])
  @@index([tenantId])
}

model hr_configurations {
  id                         String          @id
  tenantId                   String          @unique
  hrEnabled                  Boolean         @default(true)
  attendanceEnabled          Boolean         @default(true)
  leaveEnabled               Boolean         @default(true)
  payrollEnabled             Boolean         @default(true)
  defaultPayFrequency        HrPayFrequency  @default(MONTHLY)
  defaultPaymentMethod       HrPaymentMethod @default(CASH)
  defaultCurrency            String          @default("NGN")
  defaultWorkHoursPerDay     Int             @default(8)
  defaultWorkDaysPerWeek     Int             @default(5)
  overtimeMultiplier         Decimal         @default(1.5) @db.Decimal(5, 2)
  allowManualAttendance      Boolean         @default(true)
  allowSelfClockIn           Boolean         @default(true)
  requireLocationForClockIn  Boolean         @default(false)
  lateThresholdMinutes       Int             @default(15)
  earlyLeaveThresholdMinutes Int             @default(15)
  defaultAnnualLeave         Int             @default(15)
  defaultSickLeave           Int             @default(10)
  defaultCasualLeave         Int             @default(5)
  leaveCarryForwardLimit     Int             @default(5)
  requireLeaveApproval       Boolean         @default(true)
  requirePayrollApproval     Boolean         @default(true)
  autoCalculatePayroll       Boolean         @default(false)
  payeTaxEnabled             Boolean         @default(true)
  pensionEnabled             Boolean         @default(true)
  pensionEmployeeRate        Decimal         @default(8) @db.Decimal(5, 2)
  pensionEmployerRate        Decimal         @default(10) @db.Decimal(5, 2)
  nhfEnabled                 Boolean         @default(false)
  nhfRate                    Decimal         @default(2.5) @db.Decimal(5, 2)
  operatingHours             Json?
  metadata                   Json?
  createdAt                  DateTime        @default(now())
  updatedAt                  DateTime
}

model hr_employee_profiles {
  id                       String                    @id
  tenantId                 String
  staffId                  String                    @unique
  employmentType           HrEmploymentType          @default(FULL_TIME)
  jobTitle                 String?
  department               String?
  grade                    String?
  baseSalary               Decimal?                  @db.Decimal(12, 2)
  hourlyRate               Decimal?                  @db.Decimal(12, 2)
  dailyRate                Decimal?                  @db.Decimal(12, 2)
  payFrequency             HrPayFrequency            @default(MONTHLY)
  paymentMethod            HrPaymentMethod           @default(CASH)
  currency                 String                    @default("NGN")
  bankName                 String?
  bankAccountNumber        String?
  bankAccountName          String?
  mobileMoneyProvider      String?
  mobileMoneyNumber        String?
  hireDate                 DateTime?
  confirmationDate         DateTime?
  terminationDate          DateTime?
  terminationReason        String?
  primaryLocationId        String?
  supervisorStaffId        String?
  annualLeaveEntitlement   Int                       @default(15)
  sickLeaveEntitlement     Int                       @default(10)
  casualLeaveEntitlement   Int                       @default(5)
  taxIdNumber              String?
  pensionNumber            String?
  nhfNumber                String?
  emergencyContactName     String?
  emergencyContactPhone    String?
  emergencyContactRelation String?
  metadata                 Json?
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime
  hr_attendance_records    hr_attendance_records[]
  hr_employment_contracts  hr_employment_contracts[]
  hr_leave_balances        hr_leave_balances[]
  hr_leave_requests        hr_leave_requests[]
  hr_payroll_calculations  hr_payroll_calculations[]
  hr_payslips              hr_payslips[]
  hr_work_schedules        hr_work_schedules[]

  @@index([department])
  @@index([employmentType])
  @@index([staffId])
  @@index([tenantId])
}

model hr_employment_contracts {
  id                   String               @id
  tenantId             String
  employeeProfileId    String
  contractNumber       String?
  contractType         HrEmploymentType
  status               HrContractStatus     @default(DRAFT)
  startDate            DateTime
  endDate              DateTime?
  probationEndDate     DateTime?
  agreedSalary         Decimal              @db.Decimal(12, 2)
  salaryType           String               @default("MONTHLY")
  currency             String               @default("NGN")
  benefits             Json?
  allowances           Json?
  deductions           Json?
  workHoursPerDay      Int                  @default(8)
  workDaysPerWeek      Int                  @default(5)
  overtimeRate         Decimal?             @db.Decimal(5, 2)
  noticePeriodDays     Int                  @default(30)
  employeeSignedAt     DateTime?
  employerSignedAt     DateTime?
  signedBy             String?
  metadata             Json?
  notes                String?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  hr_employee_profiles hr_employee_profiles @relation(fields: [employeeProfileId], references: [id], onDelete: Cascade)

  @@index([employeeProfileId])
  @@index([status])
  @@index([tenantId])
}

model hr_leave_balances {
  id                   String               @id
  tenantId             String
  employeeProfileId    String
  year                 Int
  leaveType            HrLeaveType
  entitlement          Int                  @default(0)
  carriedForward       Int                  @default(0)
  adjustments          Int                  @default(0)
  used                 Int                  @default(0)
  pending              Int                  @default(0)
  available            Int                  @default(0)
  notes                String?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  hr_employee_profiles hr_employee_profiles @relation(fields: [employeeProfileId], references: [id], onDelete: Cascade)

  @@unique([employeeProfileId, year, leaveType])
  @@index([employeeProfileId])
  @@index([tenantId])
  @@index([year])
}

model hr_leave_requests {
  id                   String               @id
  tenantId             String
  employeeProfileId    String
  leaveType            HrLeaveType
  status               HrLeaveStatus        @default(PENDING)
  startDate            DateTime             @db.Date
  endDate              DateTime             @db.Date
  totalDays            Int
  halfDay              Boolean              @default(false)
  halfDayType          String?
  reason               String?
  attachmentUrl        String?
  approverStaffId      String?
  approvedBy           String?
  approvedAt           DateTime?
  rejectedBy           String?
  rejectedAt           DateTime?
  rejectionReason      String?
  cancelledBy          String?
  cancelledAt          DateTime?
  cancellationReason   String?
  balanceDeducted      Int?
  balanceType          HrLeaveType?
  reliefStaffId        String?
  handoverNotes        String?
  offlineId            String?
  syncedAt             DateTime?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime
  hr_employee_profiles hr_employee_profiles @relation(fields: [employeeProfileId], references: [id], onDelete: Cascade)

  @@index([employeeProfileId])
  @@index([offlineId])
  @@index([startDate])
  @@index([status])
  @@index([tenantId])
}

model hr_payroll_calculations {
  id                   String                     @id
  tenantId             String
  payrollPeriodId      String
  employeeProfileId    String
  status               HrPayrollCalculationStatus @default(PENDING)
  basePay              Decimal                    @default(0) @db.Decimal(12, 2)
  overtimePay          Decimal                    @default(0) @db.Decimal(12, 2)
  allowances           Decimal                    @default(0) @db.Decimal(12, 2)
  bonuses              Decimal                    @default(0) @db.Decimal(12, 2)
  otherEarnings        Decimal                    @default(0) @db.Decimal(12, 2)
  grossPay             Decimal                    @default(0) @db.Decimal(12, 2)
  taxDeduction         Decimal                    @default(0) @db.Decimal(12, 2)
  pensionDeduction     Decimal                    @default(0) @db.Decimal(12, 2)
  nhfDeduction         Decimal                    @default(0) @db.Decimal(12, 2)
  loanDeduction        Decimal                    @default(0) @db.Decimal(12, 2)
  advanceDeduction     Decimal                    @default(0) @db.Decimal(12, 2)
  otherDeductions      Decimal                    @default(0) @db.Decimal(12, 2)
  totalDeductions      Decimal                    @default(0) @db.Decimal(12, 2)
  netPay               Decimal                    @default(0) @db.Decimal(12, 2)
  currency             String                     @default("NGN")
  earningsBreakdown    Json?
  deductionsBreakdown  Json?
  daysWorked           Int                        @default(0)
  daysAbsent           Int                        @default(0)
  daysLeave            Int                        @default(0)
  overtimeHours        Decimal                    @default(0) @db.Decimal(10, 2)
  lateCount            Int                        @default(0)
  approvedBy           String?
  approvedAt           DateTime?
  rejectedBy           String?
  rejectedAt           DateTime?
  rejectionReason      String?
  notes                String?
  adminNotes           String?
  createdAt            DateTime                   @default(now())
  updatedAt            DateTime
  hr_employee_profiles hr_employee_profiles       @relation(fields: [employeeProfileId], references: [id], onDelete: Cascade)
  hr_payroll_periods   hr_payroll_periods         @relation(fields: [payrollPeriodId], references: [id], onDelete: Cascade)

  @@unique([payrollPeriodId, employeeProfileId])
  @@index([employeeProfileId])
  @@index([payrollPeriodId])
  @@index([status])
  @@index([tenantId])
}

model hr_payroll_periods {
  id                      String                    @id
  tenantId                String
  name                    String
  payFrequency            HrPayFrequency
  periodStart             DateTime                  @db.Date
  periodEnd               DateTime                  @db.Date
  payDate                 DateTime                  @db.Date
  status                  HrPayrollPeriodStatus     @default(DRAFT)
  calculatedAt            DateTime?
  calculatedBy            String?
  finalizedAt             DateTime?
  finalizedBy             String?
  paidMarkedAt            DateTime?
  paidMarkedBy            String?
  employeeCount           Int                       @default(0)
  totalGrossPay           Decimal                   @default(0) @db.Decimal(14, 2)
  totalDeductions         Decimal                   @default(0) @db.Decimal(14, 2)
  totalNetPay             Decimal                   @default(0) @db.Decimal(14, 2)
  currency                String                    @default("NGN")
  notes                   String?
  metadata                Json?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  hr_payroll_calculations hr_payroll_calculations[]
  hr_payslips             hr_payslips[]

  @@unique([tenantId, periodStart, periodEnd, payFrequency])
  @@index([periodStart])
  @@index([status])
  @@index([tenantId])
}

model hr_payslips {
  id                   String               @id
  tenantId             String
  payrollPeriodId      String
  employeeProfileId    String
  payslipNumber        String               @unique
  employeeName         String
  employeeId           String
  department           String?
  jobTitle             String?
  bankName             String?
  bankAccountNumber    String?
  periodStart          DateTime             @db.Date
  periodEnd            DateTime             @db.Date
  payDate              DateTime             @db.Date
  basePay              Decimal              @db.Decimal(12, 2)
  overtimePay          Decimal              @default(0) @db.Decimal(12, 2)
  allowances           Decimal              @default(0) @db.Decimal(12, 2)
  bonuses              Decimal              @default(0) @db.Decimal(12, 2)
  otherEarnings        Decimal              @default(0) @db.Decimal(12, 2)
  grossPay             Decimal              @db.Decimal(12, 2)
  taxDeduction         Decimal              @default(0) @db.Decimal(12, 2)
  pensionDeduction     Decimal              @default(0) @db.Decimal(12, 2)
  nhfDeduction         Decimal              @default(0) @db.Decimal(12, 2)
  loanDeduction        Decimal              @default(0) @db.Decimal(12, 2)
  advanceDeduction     Decimal              @default(0) @db.Decimal(12, 2)
  otherDeductions      Decimal              @default(0) @db.Decimal(12, 2)
  totalDeductions      Decimal              @db.Decimal(12, 2)
  netPay               Decimal              @db.Decimal(12, 2)
  currency             String               @default("NGN")
  earningsDetails      Json?
  deductionsDetails    Json?
  daysWorked           Int
  daysAbsent           Int
  daysLeave            Int
  overtimeHours        Decimal              @db.Decimal(10, 2)
  paymentMethod        HrPaymentMethod      @default(CASH)
  paymentStatus        String               @default("PENDING")
  paymentReference     String?
  paidAt               DateTime?
  paidBy               String?
  deliveredAt          DateTime?
  deliveredMethod      String?
  viewedAt             DateTime?
  isFinalized          Boolean              @default(true)
  generatedAt          DateTime             @default(now())
  generatedBy          String?
  hr_employee_profiles hr_employee_profiles @relation(fields: [employeeProfileId], references: [id])
  hr_payroll_periods   hr_payroll_periods   @relation(fields: [payrollPeriodId], references: [id])

  @@index([employeeProfileId])
  @@index([paymentStatus])
  @@index([payrollPeriodId])
  @@index([periodStart])
  @@index([tenantId])
}

model hr_work_schedules {
  id                      String                @id
  tenantId                String
  name                    String
  description             String?
  scheduleType            HrScheduleType        @default(FIXED)
  isDefault               Boolean               @default(false)
  employeeProfileId       String?
  locationId              String?
  effectiveFrom           DateTime
  effectiveUntil          DateTime?
  weeklySchedule          Json
  hoursPerDay             Int                   @default(8)
  hoursPerWeek            Int                   @default(40)
  overtimeThresholdDaily  Int?
  overtimeThresholdWeekly Int?
  isActive                Boolean               @default(true)
  metadata                Json?
  createdAt               DateTime              @default(now())
  updatedAt               DateTime
  hr_employee_profiles    hr_employee_profiles? @relation(fields: [employeeProfileId], references: [id])

  @@index([employeeProfileId])
  @@index([isActive])
  @@index([tenantId])
}

model integration_credentials {
  id                    String                @id
  instanceId            String
  key                   String
  encryptedValue        String
  isRequired            Boolean               @default(true)
  lastRotated           DateTime?
  expiresAt             DateTime?
  maskedValue           String?
  createdAt             DateTime              @default(now())
  updatedAt             DateTime
  createdBy             String?
  integration_instances integration_instances @relation(fields: [instanceId], references: [id], onDelete: Cascade)

  @@unique([instanceId, key])
  @@index([instanceId])
}

model integration_event_logs {
  id         String   @id
  tenantId   String?
  eventType  String
  eventData  Json
  providerId String?
  instanceId String?
  appId      String?
  keyId      String?
  actorId    String?
  actorType  String?
  occurredAt DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([tenantId])
}

model integration_instances {
  id                      String                    @id
  tenantId                String
  providerId              String
  displayName             String?
  environment             String                    @default("production")
  status                  IntegrationInstanceStatus @default(PENDING_SETUP)
  enabledScopes           String[]
  configuration           Json?
  activatedAt             DateTime?
  activatedBy             String?
  suspendedAt             DateTime?
  suspendedBy             String?
  suspensionReason        String?
  revokedAt               DateTime?
  revokedBy               String?
  revocationReason        String?
  lastHealthCheck         DateTime?
  healthStatus            String?
  lastError               String?
  errorCount              Int                       @default(0)
  rateLimitOverride       Int?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  integration_credentials integration_credentials[]
  integration_providers   integration_providers     @relation(fields: [providerId], references: [id])
  integration_logs        integration_logs[]
  integration_webhooks    integration_webhooks[]

  @@unique([tenantId, providerId, environment])
  @@index([providerId])
  @@index([status])
  @@index([tenantId])
}

model integration_logs {
  id                    String                 @id
  tenantId              String
  instanceId            String?
  logType               String
  direction             String
  method                String?
  url                   String?
  requestHeaders        Json?
  requestBody           Json?
  responseStatus        Int?
  responseHeaders       Json?
  responseBody          Json?
  startedAt             DateTime
  completedAt           DateTime?
  durationMs            Int?
  success               Boolean
  errorCode             String?
  errorMessage          String?
  retryCount            Int                    @default(0)
  isRetry               Boolean                @default(false)
  parentLogId           String?
  actorId               String?
  actorType             String?
  metadata              Json?
  createdAt             DateTime               @default(now())
  integration_instances integration_instances? @relation(fields: [instanceId], references: [id])

  @@index([createdAt])
  @@index([instanceId])
  @@index([logType])
  @@index([success])
  @@index([tenantId])
}

model integration_providers {
  id                    String                    @id
  key                   String                    @unique
  name                  String
  category              IntegrationCategory
  description           String?
  logoUrl               String?
  websiteUrl            String?
  documentationUrl      String?
  apiBaseUrl            String?
  apiVersion            String?
  isNigeriaFirst        Boolean                   @default(false)
  supportedScopes       String[]
  requiredCredentials   String[]
  supportsWebhooks      Boolean                   @default(false)
  webhookSignatureAlgo  String?
  defaultRateLimit      Int?
  status                IntegrationProviderStatus @default(ACTIVE)
  version               String                    @default("1.0.0")
  createdAt             DateTime                  @default(now())
  updatedAt             DateTime
  createdBy             String?
  integration_instances integration_instances[]

  @@index([category])
  @@index([isNigeriaFirst])
  @@index([status])
}

model integration_webhooks {
  id                    String                @id
  instanceId            String
  name                  String
  direction             WebhookDirection
  url                   String
  events                String[]
  secretKey             String?
  status                WebhookStatus         @default(ACTIVE)
  retryEnabled          Boolean               @default(true)
  maxRetries            Int                   @default(3)
  retryDelayMs          Int                   @default(1000)
  totalCalls            Int                   @default(0)
  successCount          Int                   @default(0)
  failureCount          Int                   @default(0)
  lastCalledAt          DateTime?
  lastSuccessAt         DateTime?
  lastFailureAt         DateTime?
  createdAt             DateTime              @default(now())
  updatedAt             DateTime
  integration_instances integration_instances @relation(fields: [instanceId], references: [id], onDelete: Cascade)

  @@index([direction])
  @@index([instanceId])
  @@index([status])
}

model inv_audit_items {
  id                     String     @id
  auditId                String
  productId              String
  variantId              String?
  productName            String
  variantName            String?
  sku                    String?
  binLocation            String?
  expectedQuantity       Int
  countedQuantity        Int?
  varianceQuantity       Int?
  varianceValue          Decimal?   @db.Decimal(12, 2)
  varianceReason         String?
  unitCost               Decimal?   @db.Decimal(12, 2)
  batchNumber            String?
  lotNumber              String?
  countedById            String?
  countedByName          String?
  countedAt              DateTime?
  recountRequired        Boolean    @default(false)
  recountedAt            DateTime?
  adjustmentApproved     Boolean    @default(false)
  adjustmentApprovedById String?
  adjustmentApprovedAt   DateTime?
  notes                  String?
  createdAt              DateTime   @default(now())
  updatedAt              DateTime
  inv_audits             inv_audits @relation(fields: [auditId], references: [id], onDelete: Cascade)

  @@unique([auditId, productId, variantId, binLocation, batchNumber])
  @@index([auditId])
  @@index([productId])
  @@index([varianceQuantity])
}

model inv_audits {
  id                     String               @id
  tenantId               String
  auditNumber            String               @unique
  warehouseId            String
  categoryIds            String[]             @default([])
  productIds             String[]             @default([])
  binLocations           String[]             @default([])
  auditType              String               @default("FULL")
  status                 InventoryAuditStatus @default(DRAFT)
  scheduledDate          DateTime?
  startedAt              DateTime?
  completedAt            DateTime?
  approvedAt             DateTime?
  totalItemsCounted      Int                  @default(0)
  itemsWithVariance      Int                  @default(0)
  totalVarianceValue     Decimal?             @db.Decimal(12, 2)
  variancePercentage     Decimal?             @db.Decimal(5, 2)
  currency               String               @default("NGN")
  createdById            String?
  createdByName          String?
  supervisorId           String?
  supervisorName         String?
  approvedById           String?
  approvedByName         String?
  notes                  String?
  internalNotes          String?
  requiresApproval       Boolean              @default(true)
  varianceThresholdPct   Decimal?             @db.Decimal(5, 2)
  varianceThresholdValue Decimal?             @db.Decimal(12, 2)
  adjustmentEventId      String?
  isOfflineCreated       Boolean              @default(false)
  offlineId              String?
  syncedAt               DateTime?
  metadata               Json?
  createdAt              DateTime             @default(now())
  updatedAt              DateTime
  inv_audit_items        inv_audit_items[]
  inv_warehouses         inv_warehouses       @relation(fields: [warehouseId], references: [id])

  @@index([auditType])
  @@index([scheduledDate])
  @@index([status])
  @@index([tenantId])
  @@index([warehouseId])
}

model inv_reorder_rules {
  id                      String                    @id
  tenantId                String
  productId               String?
  variantId               String?
  categoryId              String?
  locationId              String?
  name                    String
  description             String?
  triggerType             ReorderTriggerType        @default(BELOW_THRESHOLD)
  reorderPoint            Int?
  reorderQuantity         Int?
  minDaysOfStock          Int?
  targetDaysOfStock       Int?
  velocityPeriodDays      Int                       @default(30)
  preferredSupplierId     String?
  minOrderQuantity        Int?
  maxOrderQuantity        Int?
  orderMultiple           Int?
  supplierLeadTimeDays    Int                       @default(7)
  maxUnitCost             Decimal?                  @db.Decimal(12, 2)
  currency                String                    @default("NGN")
  scheduleExpression      String?
  isActive                Boolean                   @default(true)
  priority                Int                       @default(0)
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  inv_reorder_suggestions inv_reorder_suggestions[]

  @@index([categoryId])
  @@index([isActive])
  @@index([locationId])
  @@index([productId])
  @@index([tenantId])
}

model inv_reorder_suggestions {
  id                    String                  @id
  tenantId              String
  ruleId                String?
  productId             String
  variantId             String?
  productName           String
  variantName           String?
  sku                   String?
  locationId            String
  locationName          String
  currentQuantity       Int
  reservedQuantity      Int
  availableQuantity     Int
  avgDailySales         Decimal?                @db.Decimal(10, 2)
  daysOfStockLeft       Int?
  velocityTrend         String?
  suggestedQuantity     Int
  suggestedSupplierId   String?
  suggestedSupplierName String?
  estimatedUnitCost     Decimal?                @db.Decimal(12, 2)
  estimatedTotalCost    Decimal?                @db.Decimal(12, 2)
  currency              String                  @default("NGN")
  urgency               String                  @default("NORMAL")
  status                ReorderSuggestionStatus @default(PENDING)
  reviewedById          String?
  reviewedByName        String?
  reviewedAt            DateTime?
  rejectionReason       String?
  expiresAt             DateTime
  notes                 String?
  calculationDetails    Json?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime
  inv_reorder_rules     inv_reorder_rules?      @relation(fields: [ruleId], references: [id])

  @@index([createdAt])
  @@index([expiresAt])
  @@index([locationId])
  @@index([productId])
  @@index([status])
  @@index([tenantId])
  @@index([urgency])
}

model inv_stock_movements {
  id               String              @id
  tenantId         String
  productId        String
  variantId        String?
  locationId       String
  reason           StockMovementReason
  quantity         Int
  quantityBefore   Int
  unitCost         Decimal?            @db.Decimal(12, 2)
  currency         String              @default("NGN")
  referenceType    String?
  referenceId      String?
  batchNumber      String?
  lotNumber        String?
  expiryDate       DateTime?
  serialNumbers    String[]            @default([])
  binLocation      String?
  notes            String?
  eventId          String?             @unique
  eventEmittedAt   DateTime?
  eventProcessed   Boolean             @default(false)
  performedBy      String?
  performedByName  String?
  isOfflineCreated Boolean             @default(false)
  offlineId        String?
  syncedAt         DateTime?
  createdAt        DateTime            @default(now())

  @@index([batchNumber])
  @@index([createdAt])
  @@index([eventProcessed])
  @@index([expiryDate])
  @@index([locationId])
  @@index([productId])
  @@index([reason])
  @@index([referenceType, referenceId])
  @@index([tenantId])
  @@index([variantId])
}

model inv_stock_transfer_items {
  id                  String              @id
  transferId          String
  productId           String
  variantId           String?
  productName         String
  variantName         String?
  sku                 String?
  quantityRequested   Int
  quantityShipped     Int                 @default(0)
  quantityReceived    Int                 @default(0)
  varianceQuantity    Int?
  varianceReason      String?
  batchNumber         String?
  lotNumber           String?
  expiryDate          DateTime?
  unitCost            Decimal?            @db.Decimal(12, 2)
  fromBinLocation     String?
  toBinLocation       String?
  notes               String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  inv_stock_transfers inv_stock_transfers @relation(fields: [transferId], references: [id], onDelete: Cascade)

  @@unique([transferId, productId, variantId, batchNumber])
  @@index([productId])
  @@index([transferId])
}

model inv_stock_transfers {
  id                                                                 String                     @id
  tenantId                                                           String
  transferNumber                                                     String                     @unique
  fromWarehouseId                                                    String
  toWarehouseId                                                      String
  status                                                             StockTransferStatus        @default(DRAFT)
  requestedDate                                                      DateTime                   @default(now())
  approvedDate                                                       DateTime?
  shippedDate                                                        DateTime?
  expectedArrival                                                    DateTime?
  receivedDate                                                       DateTime?
  priority                                                           String                     @default("NORMAL")
  reason                                                             String?
  shippingMethod                                                     String?
  trackingNumber                                                     String?
  carrierName                                                        String?
  shippingCost                                                       Decimal?                   @db.Decimal(12, 2)
  currency                                                           String                     @default("NGN")
  notes                                                              String?
  internalNotes                                                      String?
  requestedById                                                      String?
  requestedByName                                                    String?
  approvedById                                                       String?
  approvedByName                                                     String?
  rejectedById                                                       String?
  rejectedByName                                                     String?
  rejectionReason                                                    String?
  receivedById                                                       String?
  receivedByName                                                     String?
  receivingNotes                                                     String?
  eventId                                                            String?                    @unique
  eventEmittedAt                                                     DateTime?
  isOfflineCreated                                                   Boolean                    @default(false)
  offlineId                                                          String?
  syncedAt                                                           DateTime?
  metadata                                                           Json?
  createdAt                                                          DateTime                   @default(now())
  updatedAt                                                          DateTime
  inv_stock_transfer_items                                           inv_stock_transfer_items[]
  inv_warehouses_inv_stock_transfers_fromWarehouseIdToinv_warehouses inv_warehouses             @relation("inv_stock_transfers_fromWarehouseIdToinv_warehouses", fields: [fromWarehouseId], references: [id])
  inv_warehouses_inv_stock_transfers_toWarehouseIdToinv_warehouses   inv_warehouses             @relation("inv_stock_transfers_toWarehouseIdToinv_warehouses", fields: [toWarehouseId], references: [id])

  @@index([fromWarehouseId])
  @@index([priority])
  @@index([requestedDate])
  @@index([status])
  @@index([tenantId])
  @@index([toWarehouseId])
}

model inv_supplier_replenishment_rules {
  id                       String          @id
  tenantId                 String
  supplierId               String
  warehouseId              String?
  name                     String
  description              String?
  supplierName             String
  supplierContact          String?
  supplierPhone            String?
  supplierEmail            String?
  preferredOrderDays       String[]        @default([])
  minimumOrderValue        Decimal?        @db.Decimal(12, 2)
  minimumOrderQuantity     Int?
  currency                 String          @default("NGN")
  standardLeadTimeDays     Int             @default(7)
  expressLeadTimeDays      Int?
  orderMethod              String          @default("MANUAL")
  paymentTerms             String?
  creditLimit              Decimal?        @db.Decimal(12, 2)
  productIds               String[]        @default([])
  categoryIds              String[]        @default([])
  isPreferredForCategories Boolean         @default(false)
  discountPercentage       Decimal?        @db.Decimal(5, 2)
  volumeDiscounts          Json?
  reliabilityScore         Int?
  qualityScore             Int?
  lastDeliveryRating       Int?
  isActive                 Boolean         @default(true)
  notes                    String?
  metadata                 Json?
  createdAt                DateTime        @default(now())
  updatedAt                DateTime
  inv_warehouses           inv_warehouses? @relation(fields: [warehouseId], references: [id])

  @@unique([tenantId, supplierId, warehouseId])
  @@index([isActive])
  @@index([supplierId])
  @@index([tenantId])
  @@index([warehouseId])
}

model inv_warehouses {
  id                                                                      String                             @id
  tenantId                                                                String
  locationId                                                              String                             @unique
  name                                                                    String
  code                                                                    String
  description                                                             String?
  warehouseType                                                           String                             @default("GENERAL")
  totalCapacity                                                           Int?
  usedCapacity                                                            Int?
  capacityUnit                                                            String?
  fulfillmentPriority                                                     Int                                @default(0)
  isActive                                                                Boolean                            @default(true)
  acceptsTransfersIn                                                      Boolean                            @default(true)
  acceptsTransfersOut                                                     Boolean                            @default(true)
  isDefaultForReceiving                                                   Boolean                            @default(false)
  managerName                                                             String?
  managerPhone                                                            String?
  managerEmail                                                            String?
  operatingHours                                                          Json?
  lgaCode                                                                 String?
  stateCode                                                               String?
  metadata                                                                Json?
  createdAt                                                               DateTime                           @default(now())
  updatedAt                                                               DateTime
  inv_audits                                                              inv_audits[]
  inv_stock_transfers_inv_stock_transfers_fromWarehouseIdToinv_warehouses inv_stock_transfers[]              @relation("inv_stock_transfers_fromWarehouseIdToinv_warehouses")
  inv_stock_transfers_inv_stock_transfers_toWarehouseIdToinv_warehouses   inv_stock_transfers[]              @relation("inv_stock_transfers_toWarehouseIdToinv_warehouses")
  inv_supplier_replenishment_rules                                        inv_supplier_replenishment_rules[]

  @@unique([tenantId, code])
  @@index([isActive])
  @@index([locationId])
  @@index([tenantId])
  @@index([warehouseType])
}

model logistics_configurations {
  id                         String                    @id
  tenantId                   String                    @unique
  deliveryEnabled            Boolean                   @default(true)
  autoAssignmentEnabled      Boolean                   @default(false)
  realTimeTrackingEnabled    Boolean                   @default(false)
  proofOfDeliveryRequired    Boolean                   @default(true)
  defaultPriority            LogisticsDeliveryPriority @default(STANDARD)
  defaultCurrency            String                    @default("NGN")
  photoProofRequired         Boolean                   @default(true)
  signatureProofRequired     Boolean                   @default(false)
  pinVerificationEnabled     Boolean                   @default(false)
  otpVerificationEnabled     Boolean                   @default(false)
  assignmentAlgorithm        String                    @default("NEAREST")
  maxConcurrentDeliveries    Int                       @default(5)
  defaultDeliveryWindowHours Int                       @default(4)
  expressDeliveryWindowHours Int                       @default(2)
  sameDayDeliveryWindowHours Int                       @default(6)
  operatingHours             Json?
  maxDeliveryAttempts        Int                       @default(3)
  retryDelayHours            Int                       @default(24)
  notifyCustomerOnAssignment Boolean                   @default(true)
  notifyCustomerOnPickup     Boolean                   @default(true)
  notifyCustomerOnTransit    Boolean                   @default(true)
  notifyCustomerOnArrival    Boolean                   @default(true)
  notifyCustomerOnDelivery   Boolean                   @default(true)
  notifyCustomerOnFailure    Boolean                   @default(true)
  supportInformalAddresses   Boolean                   @default(true)
  landmarkRequired           Boolean                   @default(true)
  metadata                   Json?
  createdAt                  DateTime                  @default(now())
  updatedAt                  DateTime
}

model logistics_delivery_agents {
  id                             String                           @id
  tenantId                       String
  firstName                      String
  lastName                       String
  phone                          String
  email                          String?
  photoUrl                       String?
  agentType                      LogisticsAgentType               @default(IN_HOUSE)
  vehicleType                    String?
  vehiclePlate                   String?
  vehicleModel                   String?
  defaultZoneId                  String?
  assignedZoneIds                String[]                         @default([])
  status                         LogisticsAgentStatus             @default(ACTIVE)
  availability                   LogisticsAgentAvailability       @default(OFFLINE)
  lastLatitude                   Decimal?                         @db.Decimal(10, 8)
  lastLongitude                  Decimal?                         @db.Decimal(11, 8)
  lastLocationAt                 DateTime?
  totalDeliveries                Int                              @default(0)
  completedDeliveries            Int                              @default(0)
  failedDeliveries               Int                              @default(0)
  averageRating                  Decimal?                         @db.Decimal(3, 2)
  totalRatings                   Int                              @default(0)
  employeeId                     String?
  hireDate                       DateTime?
  terminatedAt                   DateTime?
  bankName                       String?
  bankAccount                    String?
  bankAccountName                String?
  metadata                       Json?
  createdAt                      DateTime                         @default(now())
  updatedAt                      DateTime
  logistics_delivery_assignments logistics_delivery_assignments[]

  @@unique([tenantId, phone])
  @@index([agentType])
  @@index([availability])
  @@index([status])
  @@index([tenantId])
}

model logistics_delivery_assignments {
  id                                String                              @id
  tenantId                          String
  orderId                           String
  orderType                         String
  orderNumber                       String?
  customerId                        String?
  customerName                      String?
  customerPhone                     String?
  zoneId                            String?
  agentId                           String?
  deliveryAddress                   Json?
  deliveryLatitude                  Decimal?                            @db.Decimal(10, 8)
  deliveryLongitude                 Decimal?                            @db.Decimal(11, 8)
  pickupLocationId                  String?
  pickupAddress                     Json?
  pickupLatitude                    Decimal?                            @db.Decimal(10, 8)
  pickupLongitude                   Decimal?                            @db.Decimal(11, 8)
  status                            LogisticsDeliveryStatus             @default(PENDING)
  priority                          LogisticsDeliveryPriority           @default(STANDARD)
  estimatedFee                      Decimal?                            @db.Decimal(12, 2)
  actualFee                         Decimal?                            @db.Decimal(12, 2)
  currency                          String                              @default("NGN")
  feeCalculation                    Json?
  estimatedDistanceKm               Decimal?                            @db.Decimal(10, 2)
  estimatedDurationMin              Int?
  actualDistanceKm                  Decimal?                            @db.Decimal(10, 2)
  actualDurationMin                 Int?
  scheduledPickupAt                 DateTime?
  scheduledDeliveryAt               DateTime?
  actualPickupAt                    DateTime?
  actualDeliveryAt                  DateTime?
  deliveryWindowStart               DateTime?
  deliveryWindowEnd                 DateTime?
  specialInstructions               String?
  contactOnArrival                  Boolean                             @default(true)
  packageCount                      Int                                 @default(1)
  totalWeight                       Decimal?                            @db.Decimal(10, 2)
  packageDetails                    Json?
  failureReason                     String?
  failureCode                       String?
  failedAttempts                    Int                                 @default(0)
  maxAttempts                       Int                                 @default(3)
  customerRating                    Int?
  customerReview                    String?
  ratedAt                           DateTime?
  assignedBy                        String?
  assignedAt                        DateTime?
  autoAssigned                      Boolean                             @default(false)
  metadata                          Json?
  createdAt                         DateTime                            @default(now())
  updatedAt                         DateTime
  logistics_delivery_agents         logistics_delivery_agents?          @relation(fields: [agentId], references: [id])
  logistics_delivery_zones          logistics_delivery_zones?           @relation(fields: [zoneId], references: [id])
  logistics_delivery_proofs         logistics_delivery_proofs[]
  logistics_delivery_status_history logistics_delivery_status_history[]

  @@unique([orderId, orderType])
  @@index([agentId])
  @@index([createdAt])
  @@index([orderId])
  @@index([scheduledDeliveryAt])
  @@index([status])
  @@index([tenantId])
}

model logistics_delivery_pricing_rules {
  id                       String                   @id
  tenantId                 String
  zoneId                   String
  name                     String
  description              String?
  pricingType              LogisticsPricingType     @default(FLAT_RATE)
  baseFee                  Decimal                  @default(0) @db.Decimal(12, 2)
  feePerKm                 Decimal?                 @db.Decimal(12, 2)
  feePerKg                 Decimal?                 @db.Decimal(12, 2)
  percentOfOrder           Decimal?                 @db.Decimal(5, 2)
  freeDeliveryThreshold    Decimal?                 @db.Decimal(12, 2)
  minOrderValue            Decimal?                 @db.Decimal(12, 2)
  maxOrderValue            Decimal?                 @db.Decimal(12, 2)
  minFee                   Decimal?                 @db.Decimal(12, 2)
  maxFee                   Decimal?                 @db.Decimal(12, 2)
  tiers                    Json?
  expressMultiplier        Decimal?                 @db.Decimal(5, 2)
  weekendMultiplier        Decimal?                 @db.Decimal(5, 2)
  peakHourMultiplier       Decimal?                 @db.Decimal(5, 2)
  currency                 String                   @default("NGN")
  isActive                 Boolean                  @default(true)
  priority                 Int                      @default(0)
  validFrom                DateTime?
  validUntil               DateTime?
  createdAt                DateTime                 @default(now())
  updatedAt                DateTime
  logistics_delivery_zones logistics_delivery_zones @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@index([isActive])
  @@index([tenantId])
  @@index([zoneId])
}

model logistics_delivery_proofs {
  id                             String                         @id
  assignmentId                   String
  proofType                      LogisticsProofType
  imageUrl                       String?
  signatureData                  String?
  pinCode                        String?
  otpCode                        String?
  recipientName                  String?
  notes                          String?
  latitude                       Decimal?                       @db.Decimal(10, 8)
  longitude                      Decimal?                       @db.Decimal(11, 8)
  capturedBy                     String?
  capturedByType                 String?
  offlineId                      String?
  capturedAt                     DateTime
  syncedAt                       DateTime?
  metadata                       Json?
  createdAt                      DateTime                       @default(now())
  logistics_delivery_assignments logistics_delivery_assignments @relation(fields: [assignmentId], references: [id], onDelete: Cascade)

  @@index([assignmentId])
  @@index([capturedAt])
  @@index([proofType])
}

model logistics_delivery_status_history {
  id                             String                         @id
  assignmentId                   String
  fromStatus                     LogisticsDeliveryStatus?
  toStatus                       LogisticsDeliveryStatus
  latitude                       Decimal?                       @db.Decimal(10, 8)
  longitude                      Decimal?                       @db.Decimal(11, 8)
  address                        String?
  changedBy                      String?
  changedByType                  String?
  notes                          String?
  offlineId                      String?
  recordedAt                     DateTime
  syncedAt                       DateTime?
  metadata                       Json?
  createdAt                      DateTime                       @default(now())
  logistics_delivery_assignments logistics_delivery_assignments @relation(fields: [assignmentId], references: [id], onDelete: Cascade)

  @@index([assignmentId])
  @@index([offlineId])
  @@index([recordedAt])
  @@index([toStatus])
}

model logistics_delivery_zones {
  id                               String                             @id
  tenantId                         String
  name                             String
  code                             String?
  description                      String?
  zoneType                         LogisticsZoneType                  @default(CITY)
  city                             String?
  state                            String?
  lga                              String?
  postalCodes                      String[]                           @default([])
  centerLatitude                   Decimal?                           @db.Decimal(10, 8)
  centerLongitude                  Decimal?                           @db.Decimal(11, 8)
  radiusKm                         Decimal?                           @db.Decimal(10, 2)
  polygon                          Json?
  status                           LogisticsZoneStatus                @default(ACTIVE)
  sortOrder                        Int                                @default(0)
  metadata                         Json?
  createdAt                        DateTime                           @default(now())
  updatedAt                        DateTime
  createdBy                        String?
  logistics_delivery_assignments   logistics_delivery_assignments[]
  logistics_delivery_pricing_rules logistics_delivery_pricing_rules[]

  @@unique([tenantId, code])
  @@index([city])
  @@index([lga])
  @@index([state])
  @@index([status])
  @@index([tenantId])
}

model mkt_automation_actions {
  id                       String                   @id
  workflowId               String
  type                     MktActionType
  config                   Json
  delayMinutes             Int                      @default(0)
  sortOrder                Int                      @default(0)
  isActive                 Boolean                  @default(true)
  mkt_automation_workflows mkt_automation_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([workflowId])
}

model mkt_automation_logs {
  id         String   @id
  tenantId   String
  eventType  String
  eventData  Json
  workflowId String?
  runId      String?
  customerId String?
  actorId    String?
  actorType  String?
  occurredAt DateTime @default(now())

  @@index([occurredAt])
  @@index([runId])
  @@index([tenantId])
  @@index([workflowId])
}

model mkt_automation_runs {
  id                       String                   @id
  tenantId                 String
  workflowId               String
  customerId               String?
  customerPhone            String?
  triggeredBy              String
  triggerData              Json?
  status                   MktRunStatus             @default(PENDING)
  startedAt                DateTime?
  completedAt              DateTime?
  errorMessage             String?
  actionsExecuted          Int                      @default(0)
  actionResults            Json?
  coreRequestId            String?
  metadata                 Json?
  createdAt                DateTime                 @default(now())
  updatedAt                DateTime
  mkt_automation_workflows mkt_automation_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([customerId])
  @@index([status])
  @@index([tenantId])
  @@index([workflowId])
}

model mkt_automation_triggers {
  id                       String                   @id
  workflowId               String
  type                     MktTriggerType
  eventName                String?
  conditions               Json?
  scheduleType             String?
  scheduleDays             Int?
  sortOrder                Int                      @default(0)
  isActive                 Boolean                  @default(true)
  mkt_automation_workflows mkt_automation_workflows @relation(fields: [workflowId], references: [id], onDelete: Cascade)

  @@index([workflowId])
}

model mkt_automation_workflows {
  id                      String                    @id
  tenantId                String
  name                    String
  description             String?
  status                  MktAutomationStatus       @default(DRAFT)
  isRecurring             Boolean                   @default(true)
  startDate               DateTime?
  endDate                 DateTime?
  templateKey             String?
  isTemplate              Boolean                   @default(false)
  totalRuns               Int                       @default(0)
  successfulRuns          Int                       @default(0)
  failedRuns              Int                       @default(0)
  lastRunAt               DateTime?
  offlineId               String?
  metadata                Json?
  createdBy               String?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  mkt_automation_actions  mkt_automation_actions[]
  mkt_automation_runs     mkt_automation_runs[]
  mkt_automation_triggers mkt_automation_triggers[]

  @@unique([tenantId, offlineId])
  @@index([status])
  @@index([tenantId])
}

model mkt_configurations {
  id                     String   @id
  tenantId               String   @unique
  automationEnabled      Boolean  @default(true)
  smsAutomation          Boolean  @default(true)
  emailAutomation        Boolean  @default(true)
  pushAutomation         Boolean  @default(false)
  maxMessagesPerDay      Int      @default(100)
  maxMessagesPerCustomer Int      @default(3)
  quietHoursStart        Int?
  quietHoursEnd          Int?
  defaultChannel         String   @default("SMS")
  smsFirst               Boolean  @default(true)
  timezone               String   @default("Africa/Lagos")
  metadata               Json?
  createdAt              DateTime @default(now())
  updatedAt              DateTime
}

model partner_attributions_ext {
  id                             String                           @id
  partnerId                      String
  referralLinkId                 String?
  tenantId                       String                           @unique
  tenantSlug                     String?
  attributedAt                   DateTime                         @default(now())
  firstSubscription              DateTime?
  utmSource                      String?
  utmMedium                      String?
  utmCampaign                    String?
  status                         AttributionStatus                @default(ATTRIBUTED)
  isLocked                       Boolean                          @default(false)
  lockedAt                       DateTime?
  metadata                       Json?
  createdAt                      DateTime                         @default(now())
  partner_referral_links_ext     partner_referral_links_ext?      @relation(fields: [referralLinkId], references: [id])
  partner_commission_records_ext partner_commission_records_ext[]

  @@index([attributedAt])
  @@index([partnerId])
  @@index([tenantId])
}

model partner_commission_records_ext {
  id                       String                   @id
  partnerId                String
  attributionId            String
  eventType                CommissionEventType
  eventId                  String?
  eventDate                DateTime
  grossAmount              Decimal                  @db.Decimal(12, 2)
  commissionRate           Decimal                  @db.Decimal(5, 2)
  commissionAmount         Decimal                  @db.Decimal(12, 2)
  currency                 String                   @default("NGN")
  status                   CommissionStatusExt      @default(PENDING)
  payoutId                 String?
  paidAt                   DateTime?
  metadata                 Json?
  createdAt                DateTime                 @default(now())
  partner_attributions_ext partner_attributions_ext @relation(fields: [attributionId], references: [id])

  @@index([attributionId])
  @@index([eventDate])
  @@index([partnerId])
  @@index([status])
}

model partner_commission_rules_ext {
  id             String            @id
  partnerId      String?
  name           String
  description    String?
  planId         String?
  moduleId       String?
  commissionType CommissionTypeExt @default(PERCENTAGE)
  value          Decimal           @db.Decimal(12, 2)
  isRecurring    Boolean           @default(true)
  maxRecurrences Int?
  validFrom      DateTime?
  validTo        DateTime?
  priority       Int               @default(0)
  isActive       Boolean           @default(true)
  metadata       Json?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime

  @@index([isActive])
  @@index([partnerId])
  @@index([planId])
}

model partner_configurations {
  id                   String   @id
  programEnabled       Boolean  @default(true)
  autoApproval         Boolean  @default(false)
  minPayoutThreshold   Decimal  @default(10000) @db.Decimal(12, 2)
  defaultCommission    Decimal  @default(10) @db.Decimal(5, 2)
  attributionWindow    Int      @default(30)
  cookieDuration       Int      @default(30)
  attributionLock      Boolean  @default(true)
  verificationRequired Boolean  @default(true)
  manualVerification   Boolean  @default(true)
  metadata             Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime
}

model partner_event_logs_ext {
  id            String   @id
  eventType     String
  eventData     Json
  partnerId     String?
  attributionId String?
  commissionId  String?
  actorId       String?
  actorType     String?
  occurredAt    DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([partnerId])
}

model partner_profiles_ext {
  id              String      @id
  partnerId       String      @unique
  partnerType     PartnerType @default(INDIVIDUAL)
  cacNumber       String?
  tinNumber       String?
  bankName        String?
  bankCode        String?
  accountNumber   String?
  accountName     String?
  bio             String?
  linkedinUrl     String?
  industries      String[]    @default([])
  specialties     String[]    @default([])
  languages       String[]    @default(["en"])
  teamSize        Int?
  yearsExperience Int?
  servicesOffered String[]    @default([])
  regionsServed   String[]    @default([])
  totalReferrals  Int         @default(0)
  totalEarnings   Decimal     @default(0) @db.Decimal(12, 2)
  pendingEarnings Decimal     @default(0) @db.Decimal(12, 2)
  metadata        Json?
  createdAt       DateTime    @default(now())
  updatedAt       DateTime

  @@index([partnerId])
}

model partner_referral_links_ext {
  id                       String                     @id
  partnerId                String
  code                     String                     @unique
  name                     String?
  destinationUrl           String?
  campaign                 String?
  source                   String?
  medium                   String?
  isActive                 Boolean                    @default(true)
  expiresAt                DateTime?
  clicks                   Int                        @default(0)
  signups                  Int                        @default(0)
  conversions              Int                        @default(0)
  metadata                 Json?
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime
  partner_attributions_ext partner_attributions_ext[]

  @@index([code])
  @@index([isActive])
  @@index([partnerId])
}

model partner_verifications {
  id              String             @id
  partnerId       String             @unique
  documentType    String?
  documentNumber  String?
  documentUrl     String?
  status          VerificationStatus @default(PENDING)
  verifiedAt      DateTime?
  verifiedBy      String?
  rejectedAt      DateTime?
  rejectedBy      String?
  rejectionReason String?
  attempts        Int                @default(0)
  lastAttemptAt   DateTime?
  metadata        Json?
  createdAt       DateTime           @default(now())
  updatedAt       DateTime

  @@index([partnerId])
  @@index([status])
}

model pay_configurations {
  id                   String   @id
  tenantId             String   @unique
  paymentsEnabled      Boolean  @default(true)
  walletsEnabled       Boolean  @default(true)
  refundsEnabled       Boolean  @default(true)
  defaultCurrency      String   @default("NGN")
  supportedCurrencies  Json     @default("[\"NGN\"]")
  cashEnabled          Boolean  @default(true)
  cardEnabled          Boolean  @default(false)
  bankTransferEnabled  Boolean  @default(true)
  mobileMoneyEnabled   Boolean  @default(false)
  paystackEnabled      Boolean  @default(false)
  paystackPublicKey    String?
  paystackSecretKey    String?
  flutterwaveEnabled   Boolean  @default(false)
  flutterwavePublicKey String?
  flutterwaveSecretKey String?
  autoSettlement       Boolean  @default(false)
  settlementSchedule   String   @default("MANUAL")
  settlementThreshold  Decimal  @default(0) @db.Decimal(12, 2)
  vendorPayoutsEnabled Boolean  @default(false)
  platformCommission   Decimal  @default(0) @db.Decimal(5, 2)
  offlineCashEnabled   Boolean  @default(true)
  metadata             Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime
}

model pay_event_logs {
  id           String   @id
  tenantId     String
  eventType    String
  eventData    Json
  walletId     String?
  paymentId    String?
  refundId     String?
  settlementId String?
  payoutId     String?
  actorId      String?
  actorType    String?
  occurredAt   DateTime @default(now())

  @@index([eventType])
  @@index([occurredAt])
  @@index([paymentId])
  @@index([tenantId])
  @@index([walletId])
}

model pay_payment_intents {
  id               String            @id
  tenantId         String
  intentId         String            @unique
  amount           Decimal           @db.Decimal(12, 2)
  currency         String            @default("NGN")
  orderId          String?
  orderNumber      String?
  customerId       String?
  customerEmail    String?
  customerPhone    String?
  paymentMethod    PayPaymentMethod?
  methodDetails    Json?
  gatewayProvider  String?
  gatewayReference String?
  gatewayResponse  Json?
  status           PayIntentStatus   @default(CREATED)
  expiresAt        DateTime?
  paymentId        String?
  idempotencyKey   String?
  metadata         Json?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime

  @@unique([tenantId, idempotencyKey])
  @@index([customerId])
  @@index([gatewayReference])
  @@index([orderId])
  @@index([status])
  @@index([tenantId])
}

model pay_payment_transactions {
  id                      String                    @id
  tenantId                String
  transactionNumber       String
  intentId                String?
  amount                  Decimal                   @db.Decimal(12, 2)
  currency                String                    @default("NGN")
  gatewayFee              Decimal                   @default(0) @db.Decimal(12, 2)
  platformFee             Decimal                   @default(0) @db.Decimal(12, 2)
  netAmount               Decimal                   @db.Decimal(12, 2)
  orderId                 String?
  orderNumber             String?
  customerId              String?
  customerEmail           String?
  customerPhone           String?
  paymentMethod           PayPaymentMethod
  methodDetails           Json?
  gatewayProvider         String?
  gatewayReference        String?
  gatewayResponse         Json?
  destinationWalletId     String?
  status                  PayPaymentStatus          @default(PENDING)
  statusMessage           String?
  confirmedAt             DateTime?
  failedAt                DateTime?
  idempotencyKey          String?
  processedBy             String?
  metadata                Json?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  pay_refunds             pay_refunds[]
  pay_settlement_items    pay_settlement_items[]
  pay_wallet_transactions pay_wallet_transactions[]

  @@unique([tenantId, idempotencyKey])
  @@unique([tenantId, transactionNumber])
  @@index([createdAt])
  @@index([customerId])
  @@index([gatewayReference])
  @@index([orderId])
  @@index([status])
  @@index([tenantId])
}

model pay_payout_requests {
  id               String          @id
  tenantId         String
  payoutNumber     String
  walletId         String
  amount           Decimal         @db.Decimal(12, 2)
  currency         String          @default("NGN")
  fee              Decimal         @default(0) @db.Decimal(12, 2)
  netAmount        Decimal         @db.Decimal(12, 2)
  payoutMethod     PayPayoutMethod
  bankName         String?
  bankCode         String?
  accountNumber    String?
  accountName      String?
  status           PayPayoutStatus @default(PENDING)
  gatewayReference String?
  gatewayResponse  Json?
  processedAt      DateTime?
  failedAt         DateTime?
  failureReason    String?
  requestedBy      String?
  approvedBy       String?
  approvedAt       DateTime?
  metadata         Json?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime
  pay_wallets      pay_wallets     @relation(fields: [walletId], references: [id])

  @@unique([tenantId, payoutNumber])
  @@index([status])
  @@index([tenantId])
  @@index([walletId])
}

model pay_refunds {
  id                       String                   @id
  tenantId                 String
  refundNumber             String
  paymentId                String
  amount                   Decimal                  @db.Decimal(12, 2)
  currency                 String                   @default("NGN")
  reason                   PayRefundReason
  notes                    String?
  gatewayReference         String?
  gatewayResponse          Json?
  status                   PayRefundStatus          @default(PENDING)
  refundMethod             PayRefundMethod          @default(ORIGINAL_METHOD)
  processedAt              DateTime?
  failedAt                 DateTime?
  requestedBy              String?
  approvedBy               String?
  metadata                 Json?
  createdAt                DateTime                 @default(now())
  updatedAt                DateTime
  pay_payment_transactions pay_payment_transactions @relation(fields: [paymentId], references: [id])

  @@unique([tenantId, refundNumber])
  @@index([paymentId])
  @@index([status])
  @@index([tenantId])
}

model pay_settlement_items {
  id                       String                   @id
  settlementId             String
  paymentId                String
  grossAmount              Decimal                  @db.Decimal(12, 2)
  commissionAmount         Decimal                  @db.Decimal(12, 2)
  netAmount                Decimal                  @db.Decimal(12, 2)
  createdAt                DateTime                 @default(now())
  pay_payment_transactions pay_payment_transactions @relation(fields: [paymentId], references: [id])
  pay_settlements          pay_settlements          @relation(fields: [settlementId], references: [id], onDelete: Cascade)

  @@index([paymentId])
  @@index([settlementId])
}

model pay_settlements {
  id                   String                 @id
  tenantId             String
  settlementNumber     String
  walletId             String
  periodStart          DateTime
  periodEnd            DateTime
  grossAmount          Decimal                @db.Decimal(12, 2)
  commissionAmount     Decimal                @db.Decimal(12, 2)
  feeAmount            Decimal                @db.Decimal(12, 2)
  refundAmount         Decimal                @db.Decimal(12, 2)
  netAmount            Decimal                @db.Decimal(12, 2)
  itemCount            Int                    @default(0)
  status               PaySettlementStatus    @default(PENDING)
  processedAt          DateTime?
  paidAt               DateTime?
  payoutId             String?
  createdBy            String?
  approvedBy           String?
  approvedAt           DateTime?
  metadata             Json?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  pay_settlement_items pay_settlement_items[]
  pay_wallets          pay_wallets            @relation(fields: [walletId], references: [id])

  @@unique([tenantId, settlementNumber])
  @@index([periodStart, periodEnd])
  @@index([status])
  @@index([tenantId])
  @@index([walletId])
}

model pay_wallet_transactions {
  id                       String                    @id
  tenantId                 String
  walletId                 String
  transactionNumber        String
  type                     PayTransactionType
  direction                PayTransactionDirection
  amount                   Decimal                   @db.Decimal(12, 2)
  currency                 String                    @default("NGN")
  balanceBefore            Decimal                   @db.Decimal(12, 2)
  balanceAfter             Decimal                   @db.Decimal(12, 2)
  referenceType            String?
  referenceId              String?
  paymentId                String?
  settlementId             String?
  payoutId                 String?
  description              String?
  status                   PayTxStatus               @default(COMPLETED)
  performedBy              String?
  performedAt              DateTime                  @default(now())
  metadata                 Json?
  createdAt                DateTime                  @default(now())
  pay_payment_transactions pay_payment_transactions? @relation(fields: [paymentId], references: [id])
  pay_wallets              pay_wallets               @relation(fields: [walletId], references: [id])

  @@unique([tenantId, transactionNumber])
  @@index([createdAt])
  @@index([referenceType, referenceId])
  @@index([tenantId])
  @@index([type])
  @@index([walletId])
}

model pay_wallets {
  id                      String                    @id
  tenantId                String
  ownerType               PayWalletOwnerType
  ownerId                 String?
  walletNumber            String
  name                    String?
  currency                String                    @default("NGN")
  balance                 Decimal                   @default(0) @db.Decimal(12, 2)
  pendingBalance          Decimal                   @default(0) @db.Decimal(12, 2)
  totalBalance            Decimal                   @default(0) @db.Decimal(12, 2)
  dailyLimit              Decimal?                  @db.Decimal(12, 2)
  monthlyLimit            Decimal?                  @db.Decimal(12, 2)
  minBalance              Decimal                   @default(0) @db.Decimal(12, 2)
  status                  PayWalletStatus           @default(ACTIVE)
  suspendedAt             DateTime?
  suspendedReason         String?
  metadata                Json?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  pay_payout_requests     pay_payout_requests[]
  pay_settlements         pay_settlements[]
  pay_wallet_transactions pay_wallet_transactions[]

  @@unique([tenantId, ownerType, ownerId, currency])
  @@unique([tenantId, walletNumber])
  @@index([ownerType, ownerId])
  @@index([status])
  @@index([tenantId])
}

model proc_configurations {
  id                         String   @id
  tenantId                   String   @unique
  procurementEnabled         Boolean  @default(true)
  purchaseRequestsEnabled    Boolean  @default(true)
  supplierPriceListEnabled   Boolean  @default(true)
  performanceTrackingEnabled Boolean  @default(true)
  requireApprovalForPR       Boolean  @default(true)
  approvalThresholdAmount    Decimal? @db.Decimal(15, 2)
  defaultPaymentTerms        String   @default("NET30")
  defaultCurrency            String   @default("NGN")
  allowInformalSuppliers     Boolean  @default(true)
  allowCashPurchases         Boolean  @default(true)
  requireReceiptPhotos       Boolean  @default(false)
  poNumberPrefix             String   @default("PO")
  poNumberSequence           Int      @default(1)
  autoConfirmPO              Boolean  @default(false)
  notifyOnPRApproval         Boolean  @default(true)
  notifyOnPOConfirmation     Boolean  @default(true)
  notifyOnGoodsReceipt       Boolean  @default(true)
  metadata                   Json?
  createdAt                  DateTime @default(now())
  updatedAt                  DateTime
}

model proc_event_logs {
  id         String   @id
  tenantId   String
  eventType  String
  eventData  Json
  entityType String
  entityId   String
  actorId    String?
  actorType  String?
  occurredAt DateTime @default(now())
  metadata   Json?

  @@index([entityType, entityId])
  @@index([eventType])
  @@index([occurredAt])
  @@index([tenantId])
}

model proc_goods_receipt_items {
  id                  String              @id
  goodsReceiptId      String
  purchaseOrderItemId String
  productId           String
  productSku          String?
  productName         String
  orderedQuantity     Decimal             @db.Decimal(15, 4)
  receivedQuantity    Decimal             @db.Decimal(15, 4)
  acceptedQuantity    Decimal             @default(0) @db.Decimal(15, 4)
  rejectedQuantity    Decimal             @default(0) @db.Decimal(15, 4)
  damagedQuantity     Decimal             @default(0) @db.Decimal(15, 4)
  missingQuantity     Decimal             @default(0) @db.Decimal(15, 4)
  unit                String              @default("UNIT")
  qualityStatus       String?
  qualityNotes        String?
  batchNumber         String?
  expiryDate          DateTime?
  serialNumbers       Json?
  notes               String?
  proc_goods_receipts proc_goods_receipts @relation(fields: [goodsReceiptId], references: [id], onDelete: Cascade)

  @@index([goodsReceiptId])
  @@index([productId])
  @@index([purchaseOrderItemId])
}

model proc_goods_receipts {
  id                       String                     @id
  tenantId                 String
  receiptNumber            String
  purchaseOrderId          String
  status                   ProcGoodsReceiptStatus     @default(PENDING)
  receivedDate             DateTime                   @default(now())
  receivedBy               String
  locationId               String?
  deliveryNote             String?
  invoiceNumber            String?
  invoiceDate              DateTime?
  qualityCheckedBy         String?
  qualityCheckedAt         DateTime?
  qualityNotes             String?
  inventoryEventEmitted    Boolean                    @default(false)
  inventoryEventId         String?
  inventoryEventAt         DateTime?
  photoUrls                Json?
  offlineId                String?
  notes                    String?
  metadata                 Json?
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime
  proc_goods_receipt_items proc_goods_receipt_items[]
  proc_purchase_orders     proc_purchase_orders       @relation(fields: [purchaseOrderId], references: [id])

  @@unique([tenantId, offlineId])
  @@unique([tenantId, receiptNumber])
  @@index([purchaseOrderId])
  @@index([receivedDate])
  @@index([status])
  @@index([tenantId])
}

model proc_purchase_order_items {
  id                   String               @id
  purchaseOrderId      String
  productId            String
  productSku           String?
  productName          String
  orderedQuantity      Decimal              @db.Decimal(15, 4)
  receivedQuantity     Decimal              @default(0) @db.Decimal(15, 4)
  pendingQuantity      Decimal              @db.Decimal(15, 4)
  unit                 String               @default("UNIT")
  unitPrice            Decimal              @db.Decimal(15, 4)
  taxRate              Decimal              @default(0) @db.Decimal(5, 4)
  discount             Decimal              @default(0) @db.Decimal(15, 2)
  lineTotal            Decimal              @db.Decimal(15, 2)
  specifications       String?
  notes                String?
  lineNumber           Int
  isFulfilled          Boolean              @default(false)
  proc_purchase_orders proc_purchase_orders @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([purchaseOrderId])
}

model proc_purchase_orders {
  id                        String                      @id
  tenantId                  String
  poNumber                  String
  status                    ProcPurchaseOrderStatus     @default(DRAFT)
  priority                  ProcPriority                @default(NORMAL)
  supplierId                String
  supplierName              String
  supplierPhone             String?
  purchaseRequestId         String?
  shipToLocationId          String?
  shipToAddress             String?
  orderDate                 DateTime                    @default(now())
  expectedDelivery          DateTime?
  confirmedDelivery         DateTime?
  paymentTerms              String                      @default("NET30")
  currency                  String                      @default("NGN")
  subtotal                  Decimal                     @db.Decimal(15, 2)
  taxAmount                 Decimal                     @default(0) @db.Decimal(15, 2)
  shippingCost              Decimal                     @default(0) @db.Decimal(15, 2)
  discount                  Decimal                     @default(0) @db.Decimal(15, 2)
  totalAmount               Decimal                     @db.Decimal(15, 2)
  createdBy                 String
  confirmedBy               String?
  confirmedAt               DateTime?
  cancelledBy               String?
  cancelledAt               DateTime?
  cancellationReason        String?
  closedAt                  DateTime?
  isCashPurchase            Boolean                     @default(false)
  supplierContactPhone      String?
  offlineId                 String?
  internalNotes             String?
  supplierNotes             String?
  termsAndConditions        String?
  metadata                  Json?
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  proc_goods_receipts       proc_goods_receipts[]
  proc_purchase_order_items proc_purchase_order_items[]

  @@unique([tenantId, offlineId])
  @@unique([tenantId, poNumber])
  @@index([orderDate])
  @@index([status])
  @@index([supplierId])
  @@index([tenantId])
}

model proc_purchase_request_items {
  id                     String                 @id
  purchaseRequestId      String
  productId              String
  productSku             String?
  productName            String
  quantity               Decimal                @db.Decimal(15, 4)
  unit                   String                 @default("UNIT")
  estimatedUnitPrice     Decimal?               @db.Decimal(15, 4)
  estimatedTotal         Decimal?               @db.Decimal(15, 2)
  specifications         String?
  notes                  String?
  lineNumber             Int
  proc_purchase_requests proc_purchase_requests @relation(fields: [purchaseRequestId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([purchaseRequestId])
}

model proc_purchase_requests {
  id                          String                        @id
  tenantId                    String
  requestNumber               String
  status                      ProcPurchaseRequestStatus     @default(DRAFT)
  priority                    ProcPriority                  @default(NORMAL)
  requestedBy                 String
  requestedAt                 DateTime                      @default(now())
  department                  String?
  locationId                  String?
  preferredSupplierId         String?
  title                       String
  description                 String?
  justification               String?
  estimatedTotal              Decimal?                      @db.Decimal(15, 2)
  budgetCode                  String?
  neededByDate                DateTime?
  approvedBy                  String?
  approvedAt                  DateTime?
  rejectedBy                  String?
  rejectedAt                  DateTime?
  rejectionReason             String?
  convertedToPOId             String?
  convertedAt                 DateTime?
  offlineId                   String?
  notes                       String?
  metadata                    Json?
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  proc_purchase_request_items proc_purchase_request_items[]

  @@unique([tenantId, offlineId])
  @@unique([tenantId, requestNumber])
  @@index([preferredSupplierId])
  @@index([requestedBy])
  @@index([status])
  @@index([tenantId])
}

model proc_supplier_performance {
  id                 String   @id
  tenantId           String
  supplierId         String
  periodStart        DateTime
  periodEnd          DateTime
  totalOrders        Int      @default(0)
  completedOrders    Int      @default(0)
  cancelledOrders    Int      @default(0)
  totalOrderValue    Decimal  @default(0) @db.Decimal(15, 2)
  onTimeDeliveries   Int      @default(0)
  lateDeliveries     Int      @default(0)
  avgDeliveryDays    Decimal? @db.Decimal(5, 2)
  totalItemsReceived Int      @default(0)
  acceptedItems      Int      @default(0)
  rejectedItems      Int      @default(0)
  damagedItems       Int      @default(0)
  qualityScore       Decimal? @db.Decimal(5, 2)
  priceVariance      Decimal? @db.Decimal(5, 2)
  overallScore       Decimal? @db.Decimal(5, 2)
  notes              String?
  calculatedAt       DateTime @default(now())
  createdAt          DateTime @default(now())
  updatedAt          DateTime

  @@unique([tenantId, supplierId, periodStart, periodEnd])
  @@index([periodStart])
  @@index([supplierId])
  @@index([tenantId])
}

model proc_supplier_price_lists {
  id               String    @id
  tenantId         String
  supplierId       String
  productId        String
  unitPrice        Decimal   @db.Decimal(15, 4)
  currency         String    @default("NGN")
  minOrderQuantity Decimal   @default(1) @db.Decimal(15, 4)
  unit             String    @default("UNIT")
  validFrom        DateTime  @default(now())
  validTo          DateTime?
  isActive         Boolean   @default(true)
  leadTimeDays     Int?
  notes            String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime

  @@unique([tenantId, supplierId, productId, validFrom])
  @@index([isActive])
  @@index([productId])
  @@index([supplierId])
  @@index([tenantId])
}

model regulatory_reports {
  id              String   @id
  tenantId        String
  reportType      String
  reportName      String
  periodStart     DateTime
  periodEnd       DateTime
  reportData      Json
  format          String   @default("JSON")
  exportUrl       String?
  status          String   @default("GENERATED")
  referenceNumber String?
  disclaimer      String   @default("NOT FILED - For informational purposes only")
  generatedAt     DateTime @default(now())
  generatedBy     String?
  metadata        Json?
  createdAt       DateTime @default(now())

  @@index([periodStart, periodEnd])
  @@index([reportType])
  @@index([tenantId])
}

model svm_cart_items {
  id             String    @id
  cartId         String
  productId      String
  variantId      String?
  productName    String
  variantName    String?
  sku            String?
  imageUrl       String?
  unitPrice      Decimal   @db.Decimal(12, 2)
  quantity       Int       @default(1)
  lineTotal      Decimal   @db.Decimal(12, 2)
  discountAmount Decimal   @default(0) @db.Decimal(12, 2)
  customizations Json?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  svm_carts      svm_carts @relation(fields: [cartId], references: [id], onDelete: Cascade)

  @@unique([cartId, productId, variantId])
  @@index([cartId])
  @@index([productId])
}

model svm_carts {
  id                  String           @id
  tenantId            String
  customerId          String?
  sessionId           String?
  email               String?
  status              SvmCartStatus    @default(ACTIVE)
  expiresAt           DateTime?
  itemCount           Int              @default(0)
  subtotal            Decimal          @default(0) @db.Decimal(12, 2)
  discountTotal       Decimal          @default(0) @db.Decimal(12, 2)
  shippingTotal       Decimal          @default(0) @db.Decimal(12, 2)
  taxTotal            Decimal          @default(0) @db.Decimal(12, 2)
  grandTotal          Decimal          @default(0) @db.Decimal(12, 2)
  promotionCode       String?
  promotionId         String?
  shippingZoneId      String?
  shippingRateId      String?
  shippingMethod      String?
  currency            String           @default("USD")
  shippingAddress     Json?
  convertedToOrderId  String?
  convertedAt         DateTime?
  recoveryEmailSentAt DateTime?
  createdAt           DateTime         @default(now())
  updatedAt           DateTime
  svm_cart_items      svm_cart_items[]

  @@unique([tenantId, sessionId])
  @@index([customerId])
  @@index([email])
  @@index([sessionId])
  @@index([status])
  @@index([tenantId])
}

model svm_order_items {
  id                String     @id
  orderId           String
  productId         String
  variantId         String?
  productName       String
  variantName       String?
  sku               String?
  imageUrl          String?
  unitPrice         Decimal    @db.Decimal(12, 2)
  quantity          Int
  discountAmount    Decimal    @default(0) @db.Decimal(12, 2)
  taxAmount         Decimal    @default(0) @db.Decimal(12, 2)
  lineTotal         Decimal    @db.Decimal(12, 2)
  fulfilledQuantity Int        @default(0)
  refundedQuantity  Int        @default(0)
  customizations    Json?
  createdAt         DateTime   @default(now())
  svm_orders        svm_orders @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@index([productId])
}

model svm_orders {
  id                String               @id
  tenantId          String
  orderNumber       String               @unique
  customerId        String?
  customerEmail     String
  customerPhone     String?
  customerName      String?
  status            SvmOrderStatus       @default(PENDING)
  paymentStatus     SvmPaymentStatus     @default(PENDING)
  fulfillmentStatus SvmFulfillmentStatus @default(UNFULFILLED)
  sourceCartId      String?
  channel           String               @default("WEB")
  shippingAddress   Json
  billingAddress    Json?
  shippingMethod    String?
  shippingCarrier   String?
  shippingTotal     Decimal              @db.Decimal(12, 2)
  trackingNumber    String?
  trackingUrl       String?
  shippedAt         DateTime?
  estimatedDelivery DateTime?
  deliveredAt       DateTime?
  currency          String               @default("USD")
  subtotal          Decimal              @db.Decimal(12, 2)
  discountTotal     Decimal              @default(0) @db.Decimal(12, 2)
  taxTotal          Decimal              @db.Decimal(12, 2)
  grandTotal        Decimal              @db.Decimal(12, 2)
  promotionCode     String?
  promotionId       String?
  paymentMethod     String?
  paymentRef        String?
  paidAt            DateTime?
  refundedAmount    Decimal              @default(0) @db.Decimal(12, 2)
  refundedAt        DateTime?
  refundReason      String?
  customerNotes     String?
  internalNotes     String?
  ipAddress         String?
  userAgent         String?
  createdAt         DateTime             @default(now())
  updatedAt         DateTime
  cancelledAt       DateTime?
  svm_order_items   svm_order_items[]

  @@index([createdAt])
  @@index([customerEmail])
  @@index([customerId])
  @@index([orderNumber])
  @@index([paymentStatus])
  @@index([status])
  @@index([tenantId])
}

model svm_promotion_usages {
  id              String         @id
  promotionId     String
  orderId         String
  customerId      String?
  discountApplied Decimal        @db.Decimal(10, 2)
  createdAt       DateTime       @default(now())
  svm_promotions  svm_promotions @relation(fields: [promotionId], references: [id], onDelete: Cascade)

  @@index([customerId])
  @@index([promotionId])
}

model svm_promotions {
  id                   String                 @id
  tenantId             String
  name                 String
  description          String?
  code                 String?
  type                 SvmPromotionType       @default(COUPON)
  discountType         SvmDiscountType
  discountValue        Decimal                @db.Decimal(10, 2)
  maxDiscount          Decimal?               @db.Decimal(10, 2)
  minOrderTotal        Decimal?               @db.Decimal(10, 2)
  minQuantity          Int?
  productIds           String[]
  categoryIds          String[]
  excludeProductIds    String[]
  customerIds          String[]
  firstOrderOnly       Boolean                @default(false)
  usageLimit           Int?
  usageCount           Int                    @default(0)
  perCustomerLimit     Int?
  buyQuantity          Int?
  getQuantity          Int?
  getDiscountPercent   Int?
  startsAt             DateTime               @default(now())
  endsAt               DateTime?
  isActive             Boolean                @default(true)
  stackable            Boolean                @default(false)
  priority             Int                    @default(0)
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  svm_promotion_usages svm_promotion_usages[]

  @@unique([tenantId, code])
  @@index([code])
  @@index([isActive, startsAt, endsAt])
  @@index([tenantId])
}

model svm_shipping_rates {
  id                  String              @id
  zoneId              String
  name                String
  description         String?
  carrier             String?
  rateType            SvmShippingRateType @default(FLAT)
  flatRate            Decimal?            @db.Decimal(10, 2)
  minWeight           Decimal?            @db.Decimal(10, 2)
  maxWeight           Decimal?            @db.Decimal(10, 2)
  weightRate          Decimal?            @db.Decimal(10, 4)
  baseWeightFee       Decimal?            @db.Decimal(10, 2)
  minOrderTotal       Decimal?            @db.Decimal(10, 2)
  maxOrderTotal       Decimal?            @db.Decimal(10, 2)
  percentageRate      Decimal?            @db.Decimal(5, 4)
  perItemRate         Decimal?            @db.Decimal(10, 2)
  allowedProductIds   String[]
  excludedProductIds  String[]
  allowedCategoryIds  String[]
  excludedCategoryIds String[]
  freeAbove           Decimal?            @db.Decimal(10, 2)
  minDays             Int?
  maxDays             Int?
  isActive            Boolean             @default(true)
  priority            Int                 @default(0)
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  svm_shipping_zones  svm_shipping_zones  @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@index([zoneId])
}

model svm_shipping_zones {
  id                 String               @id
  tenantId           String
  name               String
  description        String?
  countries          String[]
  states             String[]
  postalCodes        String[]
  cities             String[]
  isDefault          Boolean              @default(false)
  isActive           Boolean              @default(true)
  priority           Int                  @default(0)
  createdAt          DateTime             @default(now())
  updatedAt          DateTime
  svm_shipping_rates svm_shipping_rates[]

  @@index([tenantId])
}

model tax_computation_records {
  id               String    @id
  tenantId         String
  periodStart      DateTime
  periodEnd        DateTime
  periodType       String    @default("MONTHLY")
  totalSales       Decimal   @db.Decimal(14, 2)
  exemptSales      Decimal   @default(0) @db.Decimal(14, 2)
  taxableSales     Decimal   @db.Decimal(14, 2)
  outputVat        Decimal   @db.Decimal(14, 2)
  totalPurchases   Decimal   @default(0) @db.Decimal(14, 2)
  exemptPurchases  Decimal   @default(0) @db.Decimal(14, 2)
  taxablePurchases Decimal   @default(0) @db.Decimal(14, 2)
  inputVat         Decimal   @default(0) @db.Decimal(14, 2)
  netVatPayable    Decimal   @db.Decimal(14, 2)
  status           String    @default("COMPUTED")
  computedAt       DateTime  @default(now())
  computedBy       String?
  verifiedAt       DateTime?
  verifiedBy       String?
  sourceType       String    @default("AUTO")
  metadata         Json?
  createdAt        DateTime  @default(now())

  @@index([periodStart, periodEnd])
  @@index([tenantId])
}

model tax_configurations {
  id                  String              @id
  tenantId            String              @unique
  vatEnabled          Boolean             @default(false)
  vatRate             Decimal             @default(7.5) @db.Decimal(5, 2)
  vatInclusive        Boolean             @default(true)
  isSmallBusiness     Boolean             @default(true)
  annualThreshold     Decimal?            @db.Decimal(14, 2)
  multiStateEnabled   Boolean             @default(false)
  primaryState        String?
  operatingStates     String[]            @default([])
  roundingMode        String              @default("ROUND_HALF_UP")
  decimalPlaces       Int                 @default(2)
  exemptCategories    String[]            @default([])
  exemptProducts      String[]            @default([])
  metadata            Json?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  compliance_profiles compliance_profiles @relation(fields: [tenantId], references: [tenantId])
}

model user_intents {
  id           String       @id
  userId       String?
  tenantId     String?
  intentKey    String
  intentDomain IntentDomain @default(COMMERCE)
  intentSource IntentSource @default(DIRECT)
  sourceUrl    String?
  campaignId   String?
  referralCode String?
  metadata     Json?
  isProcessed  Boolean      @default(false)
  processedAt  DateTime?
  capturedAt   DateTime     @default(now())
  expiresAt    DateTime?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
  User         User?        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([capturedAt])
  @@index([intentDomain])
  @@index([intentKey])
  @@index([tenantId])
  @@index([userId])
}

enum AccessScopeType {
  READ
  WRITE
  ADMIN
}

enum AcctAccountSubType {
  CASH
  BANK
  ACCOUNTS_RECEIVABLE
  INVENTORY
  PREPAID_EXPENSE
  FIXED_ASSET
  OTHER_ASSET
  ACCOUNTS_PAYABLE
  ACCRUED_EXPENSE
  VAT_PAYABLE
  OTHER_TAX_PAYABLE
  SHORT_TERM_DEBT
  LONG_TERM_DEBT
  OTHER_LIABILITY
  OWNER_EQUITY
  RETAINED_EARNINGS
  OWNER_DRAW
  SALES_REVENUE
  SERVICE_REVENUE
  OTHER_INCOME
  COST_OF_GOODS
  OPERATING_EXPENSE
  PAYROLL_EXPENSE
  RENT_EXPENSE
  UTILITIES_EXPENSE
  MARKETING_EXPENSE
  OTHER_EXPENSE
}

enum AcctAccountType {
  ASSET
  LIABILITY
  EQUITY
  REVENUE
  EXPENSE
  CONTRA_ASSET
  CONTRA_LIABILITY
  CONTRA_EQUITY
  CONTRA_REVENUE
  CONTRA_EXPENSE
}

enum AcctExpensePaymentMethod {
  CASH
  BANK_TRANSFER
  MOBILE_MONEY
  CARD
  CREDIT
  OTHER
}

enum AcctExpenseStatus {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
  POSTED
}

enum AcctJournalSourceType {
  MANUAL
  POS_SALE
  SVM_ORDER
  MVM_ORDER
  REFUND
  INVENTORY_ADJUSTMENT
  EXPENSE
  WALLET_TRANSACTION
  SYSTEM
}

enum AcctJournalStatus {
  DRAFT
  POSTED
  VOIDED
}

enum AcctPeriodStatus {
  OPEN
  CLOSING
  CLOSED
  LOCKED
}

enum AddOnStatus {
  ACTIVE
  CANCELLED
  EXPIRED
}

enum AddOnType {
  FEATURE
  CAPACITY
  MODULE
  TIME_BOUND
}

enum AddressType {
  SHIPPING
  BILLING
  BOTH
}

enum AdjustmentStatus {
  PENDING
  APPROVED
  APPLIED
  EXPIRED
  CANCELLED
}

enum AdjustmentType {
  CREDIT
  DISCOUNT
  REFUND
  PROMO
  WAIVER
}

enum AgreementStatus {
  DRAFT
  ACTIVE
  SUPERSEDED
  TERMINATED
}

enum ApiKeyStatus {
  ACTIVE
  REVOKED
  EXPIRED
  RATE_LIMITED
}

enum AttributionMethod {
  PARTNER_CREATED
  REFERRAL_LINK
  MANUAL_ASSIGNMENT
}

enum AttributionStatus {
  ATTRIBUTED
  CONVERTED
  CHURNED
  EXPIRED
}

enum AuditAction {
  TENANT_CREATED
  TENANT_UPDATED
  TENANT_SUSPENDED
  TENANT_ACTIVATED
  TENANT_DEACTIVATED
  DOMAIN_ADDED
  DOMAIN_REMOVED
  DOMAIN_VERIFIED
  USER_INVITED
  USER_REMOVED
  USER_ROLE_CHANGED
  USER_LOGIN
  USER_LOGOUT
  SUPER_ADMIN_IMPERSONATION_START
  SUPER_ADMIN_IMPERSONATION_END
  PARTNER_CREATED
  PARTNER_UPDATED
  PARTNER_APPROVED
  PARTNER_SUSPENDED
  PARTNER_TERMINATED
  PARTNER_USER_ADDED
  PARTNER_USER_REMOVED
  PARTNER_AGREEMENT_CREATED
  PARTNER_AGREEMENT_SIGNED
  PARTNER_AGREEMENT_APPROVED
  PARTNER_REFERRAL_CREATED
  PARTNER_REFERRAL_LOCKED
  PARTNER_EARNING_CREATED
  PARTNER_EARNING_APPROVED
  PARTNER_EARNING_PAID
  ATTRIBUTION_CREATED
  ATTRIBUTION_LOCKED
  ATTRIBUTION_LOCK_ATTEMPTED
  ATTRIBUTION_REASSIGN_BLOCKED
  PARTNER_TENANT_CREATED
  PARTNER_TENANT_ACTIVATED
  SUBSCRIPTION_CREATED
  SUBSCRIPTION_ACTIVATED
  SUBSCRIPTION_RENEWED
  SUBSCRIPTION_CANCELLED
  SUBSCRIPTION_PAUSED
  SUBSCRIPTION_RESUMED
  SUBSCRIPTION_UPGRADED
  SUBSCRIPTION_DOWNGRADED
  SUBSCRIPTION_EXPIRED
  ENTITLEMENT_GRANTED
  ENTITLEMENT_REVOKED
  ENTITLEMENT_EXPIRED
  INVOICE_CREATED
  INVOICE_PAID
  INVOICE_VOIDED
  COMMISSION_CALCULATED
  EARNING_CREATED
  EARNING_CLEARED
  EARNING_APPROVED
  EARNING_PAID
  EARNING_DISPUTED
  EARNING_REVERSED
  EARNING_VOIDED
  PAYOUT_BATCH_CREATED
  PAYOUT_BATCH_APPROVED
  PAYOUT_BATCH_PROCESSED
  PAYOUT_BATCH_FAILED
  PAYOUT_BATCH_CANCELLED
  PAYOUT_READINESS_CHECKED
  PAYOUT_HOLD_APPLIED
  PAYOUT_HOLD_RELEASED
  PAYOUT_SETTINGS_UPDATED
  TAX_DOCUMENT_SUBMITTED
  TAX_DOCUMENT_VERIFIED
  SUBSCRIPTION_UPDATED
  SUBSCRIPTION_GRACE_PERIOD_STARTED
  SUBSCRIPTION_SUSPENDED
}

enum B2BBulkOrderStatus {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
  CONVERTED
  CANCELLED
  EXPIRED
}

enum B2BCreditStatus {
  ACTIVE
  SUSPENDED
  EXCEEDED
  BLOCKED
}

enum B2BCreditTransactionType {
  CREDIT_GRANTED
  CREDIT_REDUCED
  PURCHASE
  PAYMENT
  REFUND
  ADJUSTMENT
  LATE_FEE
  WRITE_OFF
}

enum B2BCustomerType {
  RETAILER
  DISTRIBUTOR
  WHOLESALER
  AGENT
  RESELLER
  OTHER
}

enum B2BDiscountType {
  PERCENTAGE
  FIXED_AMOUNT
  TIERED_QUANTITY
}

enum B2BInvoiceStatus {
  DRAFT
  SENT
  VIEWED
  PARTIAL
  PAID
  OVERDUE
  CANCELLED
  DISPUTED
}

enum B2BLateFeeType {
  NONE
  FIXED
  PERCENTAGE_DAILY
  PERCENTAGE_TOTAL
}

enum B2BPriceType {
  FIXED_PRICE
  DISCOUNT_PERCENTAGE
  DISCOUNT_AMOUNT
  TIERED_PRICE
}

enum B2BProfileStatus {
  PENDING
  ACTIVE
  SUSPENDED
  INACTIVE
}

enum BillingInterval {
  MONTHLY
  QUARTERLY
  YEARLY
}

enum CapabilityActivator {
  SELF
  ADMIN
  SYSTEM
}

enum CapabilityStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum CommerceWalletStatus {
  ACTIVE
  FROZEN
  SUSPENDED
  CLOSED
}

enum CommerceWalletType {
  CUSTOMER
  VENDOR
  PLATFORM
}

enum CommissionEventType {
  SUBSCRIPTION_CREATED
  SUBSCRIPTION_RENEWED
  SUBSCRIPTION_UPGRADED
  ONE_TIME_PURCHASE
}

enum CommissionStatusExt {
  PENDING
  EARNED
  READY_FOR_PAYOUT
  PAID
  CANCELLED
}

enum CommissionTrigger {
  ON_PAYMENT
  ON_ACTIVATION
  ON_RENEWAL
  ON_SIGNUP
}

enum CommissionType {
  PERCENTAGE
  FIXED
  TIERED
  HYBRID
}

enum CommissionTypeExt {
  PERCENTAGE
  FIXED
  TIERED
}

enum ComplianceMaturityLevel {
  INFORMAL
  EMERGING
  COMPLIANT
  ADVANCED
}

enum CrmCampaignChannel {
  SMS
  EMAIL
  PUSH
  WHATSAPP
  IN_APP
}

enum CrmCampaignStatus {
  DRAFT
  SCHEDULED
  ACTIVE
  PAUSED
  COMPLETED
  CANCELLED
}

enum CrmCampaignType {
  PROMOTIONAL
  LOYALTY
  ENGAGEMENT
  ANNOUNCEMENT
  BIRTHDAY
  WINBACK
}

enum CrmEngagementType {
  PURCHASE
  VISIT
  CART_ABANDON
  WISHLIST_ADD
  REVIEW_SUBMIT
  REFERRAL
  CAMPAIGN_RESPONSE
  LOYALTY_REDEEM
  SUPPORT_CONTACT
}

enum CrmLoyaltyTier {
  BRONZE
  SILVER
  GOLD
  PLATINUM
  DIAMOND
}

enum CrmLoyaltyTransactionType {
  EARN
  REDEEM
  BONUS
  ADJUSTMENT
  EXPIRY
  TRANSFER_IN
  TRANSFER_OUT
}

enum CrmSegmentStatus {
  ACTIVE
  PAUSED
  ARCHIVED
}

enum CrmSegmentType {
  DYNAMIC
  STATIC
  COMBINED
}

enum CustomerStatus {
  ACTIVE
  INACTIVE
  BLOCKED
}

enum DiscountType {
  PERCENTAGE
  FIXED_AMOUNT
  FREE_MONTHS
}

enum DomainStatus {
  PENDING
  VERIFIED
  FAILED
}

enum DomainType {
  SUBDOMAIN
  CUSTOM
}

enum EarningEntryType {
  CREDIT
  DEBIT
  ADJUSTMENT
}

enum EarningStatus {
  PENDING
  CLEARED
  APPROVED
  PAID
  DISPUTED
  REVERSED
  VOIDED
}

enum EntitlementStatus {
  ACTIVE
  SUSPENDED
  EXPIRED
}

enum GlobalRole {
  SUPER_ADMIN
  USER
}

enum HrAttendanceStatus {
  PRESENT
  ABSENT
  LATE
  HALF_DAY
  LEAVE
  HOLIDAY
  REST_DAY
}

enum HrClockMethod {
  MANUAL
  SELF_SERVICE
  BIOMETRIC
  LOCATION
  QR_CODE
}

enum HrContractStatus {
  DRAFT
  ACTIVE
  EXPIRED
  TERMINATED
  RENEWED
}

enum HrEmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  CASUAL
  INTERN
  APPRENTICE
}

enum HrLeaveStatus {
  DRAFT
  PENDING
  APPROVED
  REJECTED
  CANCELLED
  COMPLETED
}

enum HrLeaveType {
  ANNUAL
  SICK
  CASUAL
  MATERNITY
  PATERNITY
  COMPASSIONATE
  UNPAID
  STUDY
}

enum HrPayFrequency {
  DAILY
  WEEKLY
  BI_WEEKLY
  MONTHLY
}

enum HrPaymentMethod {
  CASH
  BANK_TRANSFER
  MOBILE_MONEY
  CHECK
}

enum HrPayrollCalculationStatus {
  PENDING
  CALCULATED
  APPROVED
  FINALIZED
}

enum HrPayrollPeriodStatus {
  DRAFT
  OPEN
  PROCESSING
  FINALIZED
  PAID
  CLOSED
}

enum HrScheduleType {
  FIXED
  ROTATING
  FLEXIBLE
  ON_CALL
}

enum InstanceSubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  SUSPENDED
  CANCELLED
}

enum IntegrationCategory {
  PAYMENT_GATEWAY
  BANKING
  LOGISTICS
  SMS_GATEWAY
  WHATSAPP
  EMAIL
  ACCOUNTING
  ERP
  CRM
  MARKETPLACE
  CUSTOM
}

enum IntegrationInstanceStatus {
  PENDING_SETUP
  ACTIVE
  SUSPENDED
  REVOKED
  FAILED
}

enum IntegrationProviderStatus {
  ACTIVE
  DEPRECATED
  DISABLED
  BETA
}

enum IntentDomain {
  COMMERCE
  EDUCATION
  HEALTHCARE
  HOSPITALITY
  SERVICES
  LOGISTICS
  GENERAL
}

enum IntentSource {
  MARKETING_PAGE
  PARTNER_LINK
  DIRECT
  APP_STORE
  CAMPAIGN
}

enum InventoryAuditStatus {
  DRAFT
  IN_PROGRESS
  PENDING_REVIEW
  APPROVED
  ADJUSTMENTS_PENDING
  COMPLETED
  CANCELLED
}

enum LedgerEntryStatus {
  PENDING
  COMPLETED
  FAILED
  REVERSED
}

enum LedgerEntryType {
  CREDIT_ORDER_PAYMENT
  CREDIT_REFUND
  CREDIT_SALE_PROCEEDS
  CREDIT_PLATFORM_FEE
  CREDIT_ADJUSTMENT
  CREDIT_TRANSFER_IN
  CREDIT_PAYOUT_REVERSAL
  DEBIT_ORDER_PAYMENT
  DEBIT_VENDOR_COMMISSION
  DEBIT_PLATFORM_FEE
  DEBIT_PAYOUT
  DEBIT_ADJUSTMENT
  DEBIT_TRANSFER_OUT
  DEBIT_CHARGEBACK
  HOLD_CREATED
  HOLD_RELEASED
  HOLD_CAPTURED
}

enum LocationStatus {
  ACTIVE
  INACTIVE
  CLOSED
}

enum LogisticsAgentAvailability {
  AVAILABLE
  BUSY
  OFFLINE
  ON_DELIVERY
}

enum LogisticsAgentStatus {
  ACTIVE
  INACTIVE
  ON_LEAVE
  SUSPENDED
  TERMINATED
}

enum LogisticsAgentType {
  IN_HOUSE
  FREELANCE
  THIRD_PARTY
}

enum LogisticsDeliveryPriority {
  STANDARD
  EXPRESS
  SAME_DAY
  NEXT_DAY
}

enum LogisticsDeliveryStatus {
  PENDING
  ASSIGNED
  ACCEPTED
  PICKING_UP
  PICKED_UP
  IN_TRANSIT
  ARRIVING
  DELIVERED
  FAILED
  RETURNED
  CANCELLED
}

enum LogisticsPricingType {
  FLAT_RATE
  DISTANCE_BASED
  WEIGHT_BASED
  ORDER_VALUE
  TIERED
}

enum LogisticsProofType {
  PHOTO
  SIGNATURE
  PIN_CODE
  OTP
  RECIPIENT_NAME
  NOTES
}

enum LogisticsZoneStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum LogisticsZoneType {
  CITY
  LGA
  STATE
  DISTANCE
  CUSTOM
}

enum MktActionType {
  SEND_MESSAGE
  APPLY_TAG
  AWARD_POINTS
  INTERNAL_NOTIFY
  WAIT
}

enum MktAutomationStatus {
  DRAFT
  ACTIVE
  PAUSED
  COMPLETED
  ARCHIVED
}

enum MktRunStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
  SKIPPED
  CANCELLED
}

enum MktTriggerType {
  EVENT
  TIME
  CONDITION
  MANUAL
}

enum NotificationChannel {
  IN_APP
  EMAIL
  SMS
  PUSH
}

enum NotificationStatus {
  PENDING
  SENT
  DELIVERED
  FAILED
  READ
}

enum OtpChannel {
  SMS
  VOICE
  EMAIL
  WHATSAPP
}

enum OtpPurpose {
  LOGIN
  SIGNUP
  PASSWORD_RESET
  PHONE_VERIFY
  EMAIL_VERIFY
}

enum OtpStatus {
  PENDING
  VERIFIED
  EXPIRED
  FAILED
}

enum PartnerRole {
  PARTNER_OWNER
  PARTNER_STAFF
  PARTNER_ADMIN
  PARTNER_SALES
  PARTNER_SUPPORT
}

enum PartnerStatus {
  PENDING
  ACTIVE
  SUSPENDED
  TERMINATED
}

enum PartnerTier {
  BRONZE
  SILVER
  GOLD
  PLATINUM
}

enum PartnerType {
  INDIVIDUAL
  COMPANY
  CONSULTANT
  AGENCY
  RESELLER
}

enum PayIntentStatus {
  CREATED
  PROCESSING
  REQUIRES_ACTION
  SUCCEEDED
  FAILED
  CANCELLED
  EXPIRED
}

enum PayPaymentMethod {
  CASH
  CARD
  BANK_TRANSFER
  MOBILE_MONEY
  WALLET
  POS_TERMINAL
}

enum PayPaymentStatus {
  PENDING
  PROCESSING
  CONFIRMED
  FAILED
  CANCELLED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum PayPayoutMethod {
  BANK_TRANSFER
  MOBILE_MONEY
  CASH
}

enum PayPayoutStatus {
  PENDING
  APPROVED
  PROCESSING
  COMPLETED
  FAILED
  REJECTED
}

enum PayRefundMethod {
  ORIGINAL_METHOD
  WALLET
  BANK_TRANSFER
  CASH
}

enum PayRefundReason {
  CUSTOMER_REQUEST
  ORDER_CANCELLED
  DUPLICATE_PAYMENT
  FRAUD
  OTHER
}

enum PayRefundStatus {
  PENDING
  APPROVED
  PROCESSING
  COMPLETED
  FAILED
  REJECTED
}

enum PaySettlementStatus {
  PENDING
  CALCULATED
  APPROVED
  PROCESSING
  PAID
  FAILED
}

enum PayTransactionDirection {
  CREDIT
  DEBIT
}

enum PayTransactionType {
  DEPOSIT
  WITHDRAWAL
  PAYMENT_RECEIVED
  PAYMENT_MADE
  REFUND_RECEIVED
  REFUND_MADE
  SETTLEMENT
  PAYOUT
  COMMISSION
  FEE
  ADJUSTMENT
  TRANSFER_IN
  TRANSFER_OUT
}

enum PayTxStatus {
  PENDING
  COMPLETED
  FAILED
  REVERSED
}

enum PayWalletOwnerType {
  BUSINESS
  VENDOR
  CUSTOMER
  PLATFORM
}

enum PayWalletStatus {
  ACTIVE
  SUSPENDED
  FROZEN
  CLOSED
}

enum PayoutStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  CANCELLED
}

enum PricingRuleScope {
  ALL_PRODUCTS
  CATEGORY
  PRODUCT
  VARIANT
  CUSTOMER_GROUP
}

enum PricingRuleType {
  PERCENTAGE_DISCOUNT
  FIXED_DISCOUNT
  PERCENTAGE_MARKUP
  FIXED_MARKUP
  FIXED_PRICE
}

enum ProcGoodsReceiptStatus {
  PENDING
  VERIFIED
  REJECTED
  ACCEPTED
}

enum ProcPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

enum ProcPurchaseOrderStatus {
  DRAFT
  PENDING
  CONFIRMED
  PARTIALLY_RECEIVED
  RECEIVED
  CANCELLED
  CLOSED
}

enum ProcPurchaseRequestStatus {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
  CANCELLED
  CONVERTED
}

enum ProductStatus {
  DRAFT
  ACTIVE
  ARCHIVED
}

enum ProductType {
  PHYSICAL
  DIGITAL
  SERVICE
  BUNDLE
}

enum ReorderSuggestionStatus {
  PENDING
  APPROVED
  REJECTED
  CONVERTED
  EXPIRED
}

enum ReorderTriggerType {
  BELOW_THRESHOLD
  VELOCITY_BASED
  SCHEDULED
  MANUAL
}

enum SignupStep {
  IDENTITY
  OTP_SENT
  OTP_VERIFIED
  USER_INTENT
  BUSINESS_BASICS
  DISCOVERY
  COMPLETED
  ABANDONED
}

enum StaffStatus {
  ACTIVE
  INACTIVE
  TERMINATED
}

enum StockMovementReason {
  PURCHASE_ORDER
  SALE
  RETURN_FROM_CUSTOMER
  RETURN_TO_SUPPLIER
  TRANSFER_IN
  TRANSFER_OUT
  ADJUSTMENT_POSITIVE
  ADJUSTMENT_NEGATIVE
  AUDIT_CORRECTION
  INITIAL_STOCK
  EXPIRED
  DAMAGED
  THEFT
  WRITE_OFF
}

enum StockTransferStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  IN_TRANSIT
  PARTIALLY_RECEIVED
  COMPLETED
  CANCELLED
  REJECTED
}

enum SubscriptionEventType {
  SUBSCRIPTION_CREATED
  SUBSCRIPTION_ACTIVATED
  SUBSCRIPTION_RENEWED
  SUBSCRIPTION_CANCELLED
  SUBSCRIPTION_PAUSED
  SUBSCRIPTION_RESUMED
  SUBSCRIPTION_UPGRADED
  SUBSCRIPTION_DOWNGRADED
  SUBSCRIPTION_EXPIRED
  PAYMENT_SUCCEEDED
  PAYMENT_FAILED
  TRIAL_STARTED
  TRIAL_ENDED
  SUBSCRIPTION_SUSPENDED
  SUBSCRIPTION_GRACE_PERIOD_STARTED
  SUBSCRIPTION_RECOVERED
}

enum SubscriptionStatus {
  PENDING
  TRIALING
  ACTIVE
  PAST_DUE
  CANCELLED
  EXPIRED
  PAUSED
  GRACE_PERIOD
  SUSPENDED
}

enum SupplierStatus {
  ACTIVE
  INACTIVE
}

enum SvmCartStatus {
  ACTIVE
  CONVERTED
  ABANDONED
  EXPIRED
}

enum SvmDiscountType {
  PERCENTAGE
  FIXED_AMOUNT
  FIXED_PER_ITEM
  FREE_SHIPPING
  BUY_X_GET_Y
}

enum SvmFulfillmentStatus {
  UNFULFILLED
  PARTIALLY_FULFILLED
  FULFILLED
  CANCELLED
}

enum SvmOrderStatus {
  PENDING
  CONFIRMED
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum SvmPaymentStatus {
  PENDING
  AUTHORIZED
  CAPTURED
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum SvmPromotionType {
  COUPON
  AUTOMATIC
  FLASH_SALE
}

enum SvmShippingRateType {
  FLAT
  WEIGHT_BASED
  PRICE_BASED
  ITEM_BASED
}

enum TenantRole {
  TENANT_ADMIN
  TENANT_USER
}

enum TenantStatus {
  ACTIVE
  SUSPENDED
  DEACTIVATED
  PENDING_ACTIVATION
}

enum UsageAggregationType {
  SUM
  MAX
  AVG
  COUNT
}

enum VerificationStatus {
  PENDING
  IN_REVIEW
  VERIFIED
  REJECTED
  EXPIRED
}

enum WalletStatus {
  ACTIVE
  FROZEN
  EXPIRED
}

enum WalletTransactionType {
  CREDIT
  DEBIT
  ADJUSTMENT
  EXPIRY
}

enum WalletType {
  STORE_CREDIT
  GIFT_CARD
  LOYALTY_POINTS
  PREPAID
}

enum WebhookDirection {
  INBOUND
  OUTBOUND
}

enum WebhookStatus {
  ACTIVE
  PAUSED
  DISABLED
}
